{"version":3,"file":"channel-B5mbi9G0.js","names":["route: Route","got","InvalidParameterError"],"sources":["../../lib/routes/guokr/channel.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport got from '@/utils/got';\r\nimport { parseList, parseItem } from './utils';\r\nimport InvalidParameterError from '@/errors/types/invalid-parameter';\r\n\r\nconst channelMap = {\r\n    calendar: 'pac',\r\n    institute: 'predator',\r\n    foodlab: 'predator',\r\n    pretty: 'beauty',\r\n};\r\n\r\nexport const route: Route = {\r\n    path: '/column/:channel',\r\n    categories: ['new-media'],\r\n    example: '/guokr/column/calendar',\r\n    parameters: { channel: '专栏类别' },\r\n    radar: [\r\n        {\r\n            source: ['guokr.com/:channel'],\r\n        },\r\n    ],\r\n    name: '果壳网专栏',\r\n    maintainers: ['DHPO', 'hoilc'],\r\n    handler,\r\n    url: 'guokr.com/',\r\n    description: `| 物种日历 | 吃货研究所 | 美丽也是技术活 |\r\n| -------- | ---------- | -------------- |\r\n| calendar | institute  | beauty         |`,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const channel = channelMap[ctx.req.param('channel')] ?? ctx.req.param('channel');\r\n\r\n    const { data: response } = await got(`https://www.guokr.com/apis/minisite/article.json`, {\r\n        searchParams: {\r\n            retrieve_type: 'by_wx',\r\n            channel_key: channel,\r\n            offset: 0,\r\n            limit: 10,\r\n        },\r\n    });\r\n    const result = parseList(response.result);\r\n\r\n    if (result.length === 0) {\r\n        throw new InvalidParameterError('Unknown channel');\r\n    }\r\n\r\n    const channelName = result[0].channels[0].name;\r\n    const channelUrl = result[0].channels[0].url;\r\n\r\n    const items = await Promise.all(result.map((item) => parseItem(item)));\r\n\r\n    return {\r\n        title: `果壳网 ${channelName}`,\r\n        link: channelUrl,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"waAKA,MAAM,EAAa,CACf,SAAU,MACV,UAAW,WACX,QAAS,WACT,OAAQ,UAGCA,EAAe,CACxB,KAAM,mBACN,WAAY,CAAC,aACb,QAAS,yBACT,WAAY,CAAE,QAAS,QACvB,MAAO,CACH,CACI,OAAQ,CAAC,wBAGjB,KAAM,QACN,YAAa,CAAC,OAAQ,SACtB,UACA,IAAK,aACL,YAAa;;6CAKjB,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAU,EAAW,EAAI,IAAI,MAAM,aAAe,EAAI,IAAI,MAAM,WAEhE,CAAE,KAAM,GAAa,MAAMC,EAAI,mDAAoD,CACrF,aAAc,CACV,cAAe,QACf,YAAa,EACb,OAAQ,EACR,MAAO,MAGT,EAAS,EAAU,EAAS,QAElC,GAAI,EAAO,SAAW,EAClB,MAAM,IAAIC,EAAsB,mBAGpC,IAAM,EAAc,EAAO,GAAG,SAAS,GAAG,KACpC,EAAa,EAAO,GAAG,SAAS,GAAG,IAEnC,EAAQ,MAAM,QAAQ,IAAI,EAAO,IAAK,GAAS,EAAU,KAE/D,MAAO,CACH,MAAO,OAAO,IACd,KAAM,EACN,KAAM"}