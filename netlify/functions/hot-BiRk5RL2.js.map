{"version":3,"file":"hot-BiRk5RL2.js","names":["route: Route","got"],"sources":["../../lib/routes/zyw/hot.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport got from '@/utils/got';\r\n\r\nexport const route: Route = {\r\n    path: '/hot/:site?',\r\n    categories: ['new-media'],\r\n    example: '/zyw/hot',\r\n    parameters: { site: '站点，见下表，默认为空，即全部' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    name: '今日热榜',\r\n    maintainers: ['nczitzk'],\r\n    handler,\r\n    description: `::: tip\r\n  全部站点请见 [此处](https://hot.zyw.asia/#/list)\r\n:::\r\n\r\n| 哔哩哔哩 | 微博 | 知乎 | 36 氪 | 百度 | 少数派 | IT 之家 | 澎湃新闻 | 今日头条 | 百度贴吧 | 稀土掘金 | 腾讯新闻 |\r\n| -------- | ---- | ---- | ----- | ---- | ------ | ------- | -------- | -------- | -------- | -------- | -------- |`,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const site = ctx.req.param('site') ?? '';\r\n\r\n    const rootUrl = 'https://hot.zyw.asia';\r\n    const apiRootUrl = 'https://api-hot.zyw.asia';\r\n\r\n    let response = await got({\r\n        method: 'get',\r\n        url: rootUrl,\r\n    });\r\n\r\n    const jsUrl = `${rootUrl}${response.data.match(/crossorigin src=\"(\\/assets\\/index-\\w+\\.js)\">/)[1]}`;\r\n\r\n    response = await got({\r\n        method: 'get',\r\n        url: jsUrl,\r\n    });\r\n\r\n    const sites = response.data\r\n        .match(/label:\"(.*?)\",value:\"(.*?)\",order/g)\r\n        .map((a) => {\r\n            const matches = a.match(/label:\"(.*?)\",value:\"(.*?)\"/);\r\n            return {\r\n                label: matches[1],\r\n                value: matches[2],\r\n            };\r\n        })\r\n        .filter((a) => (site ? a.label === site || a.value === site : true));\r\n\r\n    const currentUrl = `${rootUrl}${site ? `/#/list?type=${sites[0].value}` : ''}`;\r\n\r\n    const items = [];\r\n\r\n    await Promise.all(\r\n        sites.map(async (a) => {\r\n            const detailResponse = await got({\r\n                method: 'get',\r\n                url: `${apiRootUrl}/${a.value}`,\r\n                headers: {\r\n                    referer: rootUrl,\r\n                },\r\n            });\r\n\r\n            for (const d of detailResponse.data.data) {\r\n                items.push({\r\n                    link: d.url,\r\n                    title: d.title,\r\n                    description: d.desc,\r\n                });\r\n            }\r\n\r\n            return;\r\n        })\r\n    );\r\n\r\n    return {\r\n        title: `今日热榜${site ? ` - ${sites[0].label}` : ''}`,\r\n        link: currentUrl,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"gOAGA,MAAaA,EAAe,CACxB,KAAM,cACN,WAAY,CAAC,aACb,QAAS,WACT,WAAY,CAAE,KAAM,mBACpB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,KAAM,OACN,YAAa,CAAC,WACd,UACA,YAAa;;;;;sHAQjB,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAO,EAAI,IAAI,MAAM,SAAW,GAEhC,EAAU,uBAGZ,EAAW,MAAMC,EAAI,CACrB,OAAQ,MACR,IAAK,IAGH,EAAQ,GAAG,IAAU,EAAS,KAAK,MAAM,gDAAgD,KAE/F,EAAW,MAAMA,EAAI,CACjB,OAAQ,MACR,IAAK,IAGT,IAAM,EAAQ,EAAS,KAClB,MAAM,sCACN,IAAK,GAAM,CACR,IAAM,EAAU,EAAE,MAAM,+BACxB,MAAO,CACH,MAAO,EAAQ,GACf,MAAO,EAAQ,MAGtB,OAAQ,GAAO,EAAO,EAAE,QAAU,GAAQ,EAAE,QAAU,EAAO,IAE5D,EAAa,GAAG,IAAU,EAAO,gBAAgB,EAAM,GAAG,QAAU,KAEpE,EAAQ,GAwBd,OAtBA,MAAM,QAAQ,IACV,EAAM,IAAI,KAAO,IAAM,CACnB,IAAM,EAAiB,MAAMA,EAAI,CAC7B,OAAQ,MACR,IAAK,4BAAiB,EAAE,QACxB,QAAS,CACL,QAAS,KAIjB,IAAK,IAAM,KAAK,EAAe,KAAK,KAChC,EAAM,KAAK,CACP,KAAM,EAAE,IACR,MAAO,EAAE,MACT,YAAa,EAAE,UAQxB,CACH,MAAO,OAAO,EAAO,MAAM,EAAM,GAAG,QAAU,KAC9C,KAAM,EACN,KAAM"}