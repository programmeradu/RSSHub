{"version":3,"file":"utils-BPi-cbiF.js","names":[],"sources":["../../lib/routes/meteor/utils.ts"],"sourcesContent":["import got from '@/utils/got';\r\nimport { art } from '@/utils/render';\r\nimport path from 'node:path';\r\nconst baseUrl = 'https://meteor.today';\r\n\r\nconst getBoards = (tryGet) =>\r\n    tryGet('meteor:boards', async () => {\r\n        const { data: response } = await got.post(`${baseUrl}/board/get_boards`, {\r\n            json: {\r\n                isCollege: 'false',\r\n            },\r\n        });\r\n\r\n        return JSON.parse(decodeURIComponent(response.result)).map((item) => ({\r\n            title: `${item.category ? `${item.category} - ` : ''}${item.name}`,\r\n            description: item.id,\r\n            feedDescription: item.description,\r\n            category: item.articleCategory,\r\n            link: `${baseUrl}/board/${item.alias ?? item.name}`,\r\n            alias: item.alias,\r\n            imgUrl: item.imageUrl,\r\n            id: item.id,\r\n        }));\r\n    });\r\n\r\nconst renderDesc = (desc) => {\r\n    const youTube = /(?:https?:\\/\\/)?(?:www\\.)?youtu\\.?be(?:\\.com)?\\/?.*(?:watch|embed)?(?:.*v=|v\\/|\\/)([\\w-]+)&?/g;\r\n    const matchYouTube = desc.match(youTube);\r\n    const matchImgur = desc.match(/https:\\/\\/i.imgur.com\\/\\w*.(jpg|png|gif|jpeg)/g);\r\n    const matchVideo = desc.match(/(https:\\/\\/storage\\.meteor\\.today\\/video\\/[\\da-f]{24}\\.)(mp4|mov|avi|flv|wmv|mpeg|mkv)/gi);\r\n    const matchSticker = desc.match(/assets\\/images\\/stickers\\/(duck|ep2|ep1)\\/\\w*.(jpg|png|gif|jpeg)/g);\r\n    const matchEmoji = desc.match(/assets\\/images\\/emoji\\/\\w*.(jpg|png|gif|jpeg)/g);\r\n\r\n    if (matchYouTube) {\r\n        desc = desc.replaceAll(\r\n            youTube,\r\n            art(path.join(__dirname, 'templates/desc.art'), {\r\n                youTube: '$1',\r\n            })\r\n        );\r\n    }\r\n    if (matchImgur) {\r\n        for (const img of matchImgur) {\r\n            desc = desc.replace(\r\n                img,\r\n                art(path.join(__dirname, 'templates/desc.art'), {\r\n                    img,\r\n                })\r\n            );\r\n        }\r\n    }\r\n    if (matchVideo) {\r\n        for (const video of matchVideo) {\r\n            desc = desc.replace(\r\n                video,\r\n                art(path.join(__dirname, 'templates/desc.art'), {\r\n                    video,\r\n                })\r\n            );\r\n        }\r\n    }\r\n    if (matchSticker) {\r\n        for (const sticker of matchSticker) {\r\n            desc = desc.replace(\r\n                sticker,\r\n                art(path.join(__dirname, 'templates/desc.art'), {\r\n                    img: sticker,\r\n                })\r\n            );\r\n        }\r\n    }\r\n    if (matchEmoji) {\r\n        for (const emoji of matchEmoji) {\r\n            desc = desc.replace(\r\n                emoji,\r\n                art(path.join(__dirname, 'templates/desc.art'), {\r\n                    img: emoji,\r\n                })\r\n            );\r\n        }\r\n    }\r\n\r\n    return desc.replaceAll('\\n', '<br>');\r\n};\r\n\r\nexport { baseUrl, getBoards, renderDesc };\r\n"],"mappings":"gMAGA,MAAM,EAAU,uBAEV,EAAa,GACf,EAAO,gBAAiB,SAAY,CAChC,GAAM,CAAE,KAAM,GAAa,MAAM,EAAI,KAAK,GAAG,EAAQ,mBAAoB,CACrE,KAAM,CACF,UAAW,WAInB,OAAO,KAAK,MAAM,mBAAmB,EAAS,SAAS,IAAK,IAAU,CAClE,MAAO,GAAG,EAAK,SAAW,GAAG,EAAK,SAAS,KAAO,KAAK,EAAK,OAC5D,YAAa,EAAK,GAClB,gBAAiB,EAAK,YACtB,SAAU,EAAK,gBACf,KAAM,GAAG,EAAQ,SAAS,EAAK,OAAS,EAAK,OAC7C,MAAO,EAAK,MACZ,OAAQ,EAAK,SACb,GAAI,EAAK,QAIf,EAAc,GAAS,CACzB,IAAM,EAAU,gGACV,EAAe,EAAK,MAAM,GAC1B,EAAa,EAAK,MAAM,kDACxB,EAAa,EAAK,MAAM,4FACxB,EAAe,EAAK,MAAM,qEAC1B,EAAa,EAAK,MAAM,kDAU9B,GARI,IACA,EAAO,EAAK,WACR,EACA,EAAI,EAAA,KAAA,EAAA,+BAA4C,CAC5C,QAAS,SAIjB,EACA,IAAK,IAAM,KAAO,EACd,EAAO,EAAK,QACR,EACA,EAAI,EAAA,KAAA,EAAA,+BAA4C,CAC5C,SAKhB,GAAI,EACA,IAAK,IAAM,KAAS,EAChB,EAAO,EAAK,QACR,EACA,EAAI,EAAA,KAAA,EAAA,+BAA4C,CAC5C,WAKhB,GAAI,EACA,IAAK,IAAM,KAAW,EAClB,EAAO,EAAK,QACR,EACA,EAAI,EAAA,KAAA,EAAA,+BAA4C,CAC5C,IAAK,KAKrB,GAAI,EACA,IAAK,IAAM,KAAS,EAChB,EAAO,EAAK,QACR,EACA,EAAI,EAAA,KAAA,EAAA,+BAA4C,CAC5C,IAAK,KAMrB,OAAO,EAAK,WAAW;EAAM"}