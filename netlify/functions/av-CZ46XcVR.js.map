{"version":3,"file":"av-CZ46XcVR.js","names":["route: Route","got","cache"],"sources":["../../lib/routes/playno1/av.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport cache from '@/utils/cache';\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport timezone from '@/utils/timezone';\r\nimport { cookieJar, processArticle } from './utils';\r\nconst baseUrl = 'http://www.playno1.com';\r\n\r\nexport const route: Route = {\r\n    path: '/av/:catid?',\r\n    categories: ['bbs'],\r\n    example: '/playno1/av',\r\n    parameters: { catid: '分类，见下表，默认为全部文章' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n        nsfw: true,\r\n    },\r\n    name: 'AV',\r\n    maintainers: ['TonyRL'],\r\n    handler,\r\n    description: `::: warning\r\n目前观测到该博客可能禁止日本 IP 访问。建议部署在日本区以外的服务器上。\r\n:::\r\n\r\n| 全部文章 | AV 新聞 | AV 導覽 |\r\n| -------- | ------- | ------- |\r\n| 78       | 3       | 5       |`,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const { catid = '78' } = ctx.req.param();\r\n    const url = `${baseUrl}/portal.php?mod=list&catid=${catid}`;\r\n    const response = await got(url, {\r\n        cookieJar,\r\n    });\r\n    const $ = load(response.data);\r\n\r\n    let items = $('.fire_float')\r\n        .toArray()\r\n        .filter((i) => $(i).text().length)\r\n        .map((item) => {\r\n            item = $(item);\r\n            return {\r\n                title: item.find('h3 a').attr('title'),\r\n                link: item.find('h3 a').attr('href'),\r\n                pubDate: timezone(parseDate(item.find('.fire_left').text()), 8),\r\n                author: item\r\n                    .find('.fire_right')\r\n                    .text()\r\n                    .match(/作者：(.*)\\s*\\|/)[1]\r\n                    .trim(),\r\n            };\r\n        });\r\n\r\n    items = await processArticle(items, cache);\r\n\r\n    return {\r\n        title: $('head title').text(),\r\n        link: url,\r\n        item: items,\r\n        language: 'zh-TW',\r\n    };\r\n}\r\n"],"mappings":"8dAOA,MAEaA,EAAe,CACxB,KAAM,cACN,WAAY,CAAC,OACb,QAAS,cACT,WAAY,CAAE,MAAO,kBACrB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,GACf,KAAM,IAEV,KAAM,KACN,YAAa,CAAC,UACd,UACA,YAAa;;;;;;mCASjB,eAAe,EAAQ,EAAK,CACxB,GAAM,CAAE,QAAQ,MAAS,EAAI,IAAI,QAC3B,EAAM,oDAAwC,IAC9C,EAAW,MAAMC,EAAI,EAAK,CAC5B,cAEE,EAAI,EAAK,EAAS,MAEpB,EAAQ,EAAE,eACT,UACA,OAAQ,GAAM,EAAE,GAAG,OAAO,QAC1B,IAAK,IACF,EAAO,EAAE,GACF,CACH,MAAO,EAAK,KAAK,QAAQ,KAAK,SAC9B,KAAM,EAAK,KAAK,QAAQ,KAAK,QAC7B,QAAS,EAAS,EAAU,EAAK,KAAK,cAAc,QAAS,GAC7D,OAAQ,EACH,KAAK,eACL,OACA,MAAM,gBAAgB,GACtB,UAMjB,MAFA,GAAQ,MAAM,EAAe,EAAOC,GAE7B,CACH,MAAO,EAAE,cAAc,OACvB,KAAM,EACN,KAAM,EACN,SAAU"}