{"version":3,"file":"topic-BLYNG7mT.js","names":["route: Route","ofetch"],"sources":["../../lib/routes/psyche/topic.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport { load } from 'cheerio';\r\nimport ofetch from '@/utils/ofetch';\r\nimport { getData } from './utils';\r\n\r\nexport const route: Route = {\r\n    path: '/topic/:topic',\r\n    categories: ['new-media'],\r\n    example: '/psyche/topic/therapeia',\r\n    parameters: { topic: 'Topic' },\r\n    radar: [\r\n        {\r\n            source: ['psyche.co/:topic'],\r\n        },\r\n    ],\r\n    name: 'Topics',\r\n    maintainers: ['emdoe'],\r\n    handler,\r\n    description: 'Supported categories: Therapeia, Eudaimonia, and Poiesis.',\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const url = `https://psyche.co/${ctx.req.param('topic')}`;\r\n    const response = await ofetch(url);\r\n    const $ = load(response);\r\n\r\n    const data = JSON.parse($('script#__NEXT_DATA__').text());\r\n    const articles = data.props.pageProps.articles;\r\n    const prefix = `https://psyche.co/_next/data/${data.buildId}`;\r\n    const list = Object.keys(articles).flatMap((type) =>\r\n        articles[type].edges.map((item) => ({\r\n            title: item.node.title,\r\n            link: `https://psyche.co/${type}/${item.node.slug}`,\r\n            json: `${prefix}/${type}/${item.node.slug}.json`,\r\n        }))\r\n    );\r\n\r\n    const items = await getData(list);\r\n\r\n    return {\r\n        title: `Psyche | ${data.props.pageProps.section.title}`,\r\n        link: url,\r\n        description: data.props.pageProps.section.metaDescription,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"iTAKA,MAAaA,EAAe,CACxB,KAAM,gBACN,WAAY,CAAC,aACb,QAAS,0BACT,WAAY,CAAE,MAAO,SACrB,MAAO,CACH,CACI,OAAQ,CAAC,sBAGjB,KAAM,SACN,YAAa,CAAC,SACd,UACA,YAAa,6DAGjB,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAM,qBAAqB,EAAI,IAAI,MAAM,WACzC,EAAW,MAAMC,EAAO,GACxB,EAAI,EAAK,GAET,EAAO,KAAK,MAAM,EAAE,wBAAwB,QAC5C,EAAW,EAAK,MAAM,UAAU,SAChC,EAAS,gCAAgC,EAAK,UAC9C,EAAO,OAAO,KAAK,GAAU,QAAS,GACxC,EAAS,GAAM,MAAM,IAAK,IAAU,CAChC,MAAO,EAAK,KAAK,MACjB,KAAM,qBAAqB,EAAK,GAAG,EAAK,KAAK,OAC7C,KAAM,GAAG,EAAO,GAAG,EAAK,GAAG,EAAK,KAAK,KAAK,WAI5C,EAAQ,MAAM,EAAQ,GAE5B,MAAO,CACH,MAAO,YAAY,EAAK,MAAM,UAAU,QAAQ,QAChD,KAAM,EACN,YAAa,EAAK,MAAM,UAAU,QAAQ,gBAC1C,KAAM"}