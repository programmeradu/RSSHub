import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import{config as n}from"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as r}from"./cache-kimkMTWJ.js";import{art as i}from"./render-CxhTJIsl.js";import"./ofetch-Bzt0BXUH.js";import{got_default as a}from"./got-CdvI2yKX.js";import{invalid_parameter_default as o}from"./invalid-parameter-CUJdROXf.js";import s from"node:path";t();const c=`https://kyfw.12306.cn`;async function l(e){let t=await a({method:`get`,url:e,headers:{UserAgent:n.ua,Referer:`https://www.12306.cn/index/index.html`}});return t.headers[`set-cookie`].join(`,`).match(/JSESSIONID=([^;]+);/)[0]}function u(e){return r.tryGet(e,async()=>{let t=await a({method:`get`,url:`${c}/otn/resources/js/framework/station_name.js`,headers:{UserAgent:n.ua,Referer:`https://kyfw.12306.cn/otn/leftTicket/init`}});return t.data.split(`@`).map(t=>{let n=t.split(`|`);return n.includes(e)?{code:n[2],name:n[1]}:null}).find(Boolean)})}const d={path:`/:date/:from/:to/:type?`,categories:[`travel`],example:`/12306/2022-02-19/重庆/永川东`,parameters:{date:`时间，格式为（YYYY-MM-DD）`,from:`始发站`,to:`终点站`,type:`售票类型，成人和学生可选，默认为成人`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`售票信息`,maintainers:[`Fatpandac`],handler:f};async function f(t){let r=t.req.param(`date`),d=await u(t.req.param(`from`)),f=await u(t.req.param(`to`)),p=t.req.param(`type`)??`ADULT`,m=`${c}/otn/leftTicket/queryA?leftTicketDTO.train_date=${r}&leftTicketDTO.from_station=${d.code}&leftTicketDTO.to_station=${f.code}&purpose_codes=${p}`,h=`${c}/otn/leftTicket/init?linktypeid=dc&fs=${d.code}&ts=${f.code}&date=${r}&flag=N,N,Y`,g=await a.get(m,{headers:{UserAgent:n.ua,Referer:`https://kyfw.12306.cn/otn/leftTicket/init`,Cookie:await l(h)}});if(g.data.data===void 0||g.data.data.length===0)throw new o(`没有找到相关车次，请检查参数是否正确`);let _=g.data.data.result,v=g.data.data.map,y=_.map(t=>{let n=t.split(`|`),r={trainNo:n[3],fromStation:v[n[6]],toStation:v[n[7]],startTime:n[8],arriveTime:n[9],duration:n[10],today:n[11],A9:n[32],M:n[31],O:n[30],A6:n[29],A4:n[28],F:n[27],A3:n[26],A2:n[25],A1:n[24],WZ:n[23],QT:n[22]};return{title:`${r.fromStation} → ${r.toStation} ${r.startTime} ${r.arriveTime}`,description:i(s.join(e,`templates/train-aafe404d.art`),{trainInfo:r}),link:h,guid:Object.values(r).join(`|`)}});return{title:`${d.name} → ${f.name} ${r}`,link:h,item:y}}export{d as route};
//# sourceMappingURL=12306-BZ99sANk.js.map