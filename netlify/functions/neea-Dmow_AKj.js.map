{"version":3,"file":"neea-Dmow_AKj.js","names":["cache","got","route: Route"],"sources":["../../lib/routes/neea/index.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport cache from '@/utils/cache';\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport timezone from '@/utils/timezone';\r\n\r\nfunction loadContent(link) {\r\n    return cache.tryGet(link, async () => {\r\n        // 开始加载页面\r\n        const response = await got.get(link);\r\n        const $ = load(response.data);\r\n        // 获取标题\r\n        const title = $('#Content1 > div > ul > li > h1').text();\r\n        // 获取正文内容\r\n        const introduce = $('#ReportIDtext').html();\r\n\r\n        return {\r\n            title,\r\n            description: introduce,\r\n            link,\r\n        };\r\n    });\r\n}\r\n\r\nasync function handler(ctx) {\r\n    const type = ctx.req.param('type');\r\n    const host = `https://${type}.neea.edu.cn${typeDic[type].url}`;\r\n    const response = await got({\r\n        method: 'get',\r\n        url: host,\r\n    });\r\n    const data = response.data;\r\n\r\n    const $ = load(data);\r\n    const list = $(`#ReportIDname > a`).parent().parent().toArray();\r\n\r\n    const process = await Promise.all(\r\n        list.map(async (item) => {\r\n            const ReportIDname = $(item).find('#ReportIDname > a');\r\n            const ReportIDIssueTime = $(item).find('#ReportIDIssueTime');\r\n            const itemUrl = `https://${type}.neea.edu.cn` + $(ReportIDname).attr('href');\r\n            const time = ReportIDIssueTime.text();\r\n            const single = {\r\n                title: $(ReportIDname).text(),\r\n                link: itemUrl,\r\n                guid: itemUrl,\r\n                pubDate: timezone(parseDate(time), +8),\r\n            };\r\n            const other = await loadContent(String(itemUrl));\r\n            return Object.assign({}, single, other);\r\n        })\r\n    );\r\n    return {\r\n        title: `${typeDic[String(type)].title}动态`,\r\n        link: host,\r\n        description: `${typeDic[String(type)].title}动态 `,\r\n        item: process,\r\n    };\r\n}\r\n\r\nconst typeDic = {\r\n    // 国家教育考试\r\n    gaokao: {\r\n        url: '/html1/category/1507/1945-1.htm',\r\n        title: '普通高考',\r\n    },\r\n    chengkao: {\r\n        url: '/html1/category/1507/1960-1.htm',\r\n        title: '成人高考',\r\n    },\r\n    yankao: {\r\n        url: '/html1/category/1507/2005-1.htm',\r\n        title: '研究生考试',\r\n    },\r\n    zikao: {\r\n        url: '/html1/category/1508/1403-1.htm',\r\n        title: '自学考试',\r\n    },\r\n    ntce: {\r\n        url: '/html1/category/1507/1148-1.htm',\r\n        title: '中小学教师资格考试',\r\n    },\r\n    tdxl: {\r\n        url: '/html1/category/2210/313-1.htm',\r\n        title: '同等学力申请硕士学位考试',\r\n    },\r\n    // 社会证书考试\r\n    cet: {\r\n        url: '/html1/category/16093/1124-1.htm',\r\n        title: '全国四六级考试（CET）',\r\n    },\r\n    ncre: {\r\n        url: '/html1/category/1507/872-1.htm',\r\n        title: '全国计算机等级考试（NCRE）',\r\n    },\r\n    nit: {\r\n        url: '/html1/category/1507/1630-1.htm',\r\n        title: '全国计算机应用水平考试（NIT）',\r\n    },\r\n\r\n    pets: {\r\n        url: '/html1/category/1507/1570-1.htm',\r\n        title: '全国英语等级考试（PETS）',\r\n    },\r\n    wsk: {\r\n        url: '/html1/category/1507/1646-1.htm',\r\n        title: '全国外语水平考试（WSK）',\r\n    },\r\n    ccpt: {\r\n        url: '/html1/category/1507/2035-1.htm',\r\n        title: '书画等级考试（CCPT）',\r\n    },\r\n};\r\n\r\nexport const route: Route = {\r\n    path: '/local/:type',\r\n    name: '国内考试动态',\r\n    url: 'www.neea.edu.cn',\r\n    maintainers: ['SunShinenny'],\r\n    example: '/neea/local/cet',\r\n    parameters: { type: '考试项目，见下表' },\r\n    categories: ['study'],\r\n    features: {\r\n        supportRadar: true,\r\n    },\r\n    radar: Object.entries(typeDic).map(([type, value]) => ({\r\n        title: `${value.title}动态`,\r\n        source: [`${type}.neea.edu.cn`, `${type}.neea.cn`],\r\n        target: `/local/${type}`,\r\n    })),\r\n    handler,\r\n    description: `|              | 考试项目                      | type     |\r\n| ------------ | ----------------------------- | -------- |\r\n| 国家教育考试 | 普通高考                      | gaokao   |\r\n|              | 成人高考                      | chengkao |\r\n|              | 研究生考试                    | yankao   |\r\n|              | 自学考试                      | zikao    |\r\n|              | 中小学教师资格考试            | ntce     |\r\n|              | 同等学力申请硕士学位考试      | tdxl     |\r\n| 社会证书考试 | 全国四六级考试（CET）         | cet      |\r\n|              | 全国计算机等级考试（NCRE）    | ncre     |\r\n|              | 全国计算机应用水平考试（NIT） | nit      |\r\n|              | 全国英语等级考试（PETS）      | pets     |\r\n|              | 全国外语水平考试（WSK）       | wsk      |\r\n|              | 书画等级考试（CCPT）          | ccpt     |`,\r\n};\r\n"],"mappings":"0ZAOA,SAAS,EAAY,EAAM,CACvB,OAAOA,EAAM,OAAO,EAAM,SAAY,CAElC,IAAM,EAAW,MAAMC,EAAI,IAAI,GACzB,EAAI,EAAK,EAAS,MAElB,EAAQ,EAAE,kCAAkC,OAE5C,EAAY,EAAE,iBAAiB,OAErC,MAAO,CACH,QACA,YAAa,EACb,UAKZ,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAO,EAAI,IAAI,MAAM,QACrB,EAAO,WAAW,EAAK,cAAc,EAAQ,GAAM,MACnD,EAAW,MAAMA,EAAI,CACvB,OAAQ,MACR,IAAK,IAEH,EAAO,EAAS,KAEhB,EAAI,EAAK,GACT,EAAO,EAAE,qBAAqB,SAAS,SAAS,UAEhD,EAAU,MAAM,QAAQ,IAC1B,EAAK,IAAI,KAAO,IAAS,CACrB,IAAM,EAAe,EAAE,GAAM,KAAK,qBAC5B,EAAoB,EAAE,GAAM,KAAK,sBACjC,EAAU,WAAW,EAAK,cAAgB,EAAE,GAAc,KAAK,QAC/D,EAAO,EAAkB,OACzB,EAAS,CACX,MAAO,EAAE,GAAc,OACvB,KAAM,EACN,KAAM,EACN,QAAS,EAAS,EAAU,GAAO,IAEjC,EAAQ,MAAM,EAAY,OAAO,IACvC,OAAO,OAAO,OAAO,GAAI,EAAQ,MAGzC,MAAO,CACH,MAAO,GAAG,EAAQ,OAAO,IAAO,MAAM,IACtC,KAAM,EACN,YAAa,GAAG,EAAQ,OAAO,IAAO,MAAM,KAC5C,KAAM,GAId,MAAM,EAAU,CAEZ,OAAQ,CACJ,IAAK,kCACL,MAAO,QAEX,SAAU,CACN,IAAK,kCACL,MAAO,QAEX,OAAQ,CACJ,IAAK,kCACL,MAAO,SAEX,MAAO,CACH,IAAK,kCACL,MAAO,QAEX,KAAM,CACF,IAAK,kCACL,MAAO,aAEX,KAAM,CACF,IAAK,iCACL,MAAO,gBAGX,IAAK,CACD,IAAK,mCACL,MAAO,gBAEX,KAAM,CACF,IAAK,iCACL,MAAO,mBAEX,IAAK,CACD,IAAK,kCACL,MAAO,oBAGX,KAAM,CACF,IAAK,kCACL,MAAO,kBAEX,IAAK,CACD,IAAK,kCACL,MAAO,iBAEX,KAAM,CACF,IAAK,kCACL,MAAO,iBAIFC,EAAe,CACxB,KAAM,eACN,KAAM,SACN,IAAK,kBACL,YAAa,CAAC,eACd,QAAS,kBACT,WAAY,CAAE,KAAM,YACpB,WAAY,CAAC,SACb,SAAU,CACN,aAAc,IAElB,MAAO,OAAO,QAAQ,GAAS,KAAK,CAAC,EAAM,MAAY,CACnD,MAAO,GAAG,EAAM,MAAM,IACtB,OAAQ,CAAC,GAAG,EAAK,cAAe,GAAG,EAAK,WACxC,OAAQ,UAAU,OAEtB,UACA,YAAa"}