{"version":3,"file":"news-CQ6jJ1yr.js","names":["route: Route","got","cache"],"sources":["../../lib/routes/mpaypass/news.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport cache from '@/utils/cache';\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport timezone from '@/utils/timezone';\r\n\r\nexport const route: Route = {\r\n    path: '/news',\r\n    categories: ['new-media'],\r\n    example: '/mpaypass/news',\r\n    parameters: {},\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['mpaypass.com.cn/'],\r\n        },\r\n    ],\r\n    name: '新闻',\r\n    maintainers: ['LogicJake', 'genghis-yang'],\r\n    handler,\r\n    url: 'mpaypass.com.cn/',\r\n};\r\n\r\nasync function handler() {\r\n    const link = 'http://m.mpaypass.com.cn';\r\n    const listData = await got(link);\r\n    const $list = load(listData.data);\r\n    return {\r\n        title: '新闻 - 移动支付网',\r\n        link,\r\n        language: 'zh-CN',\r\n        item: await Promise.all(\r\n            $list('.Newslist-li')\r\n                .toArray()\r\n                .map((el) => {\r\n                    const $el = $list(el);\r\n                    const $a = $el.find('.Newslist-title a');\r\n                    const href = $a.attr('href');\r\n                    const title = $a.text();\r\n                    const date = $el.find('.Newslist-time span').text();\r\n\r\n                    return cache.tryGet(href, async () => {\r\n                        const contentData = await got.get(href);\r\n                        const $content = load(contentData.data);\r\n                        const description = $content('.newslist-body').html();\r\n\r\n                        return {\r\n                            title,\r\n                            description,\r\n                            link: href,\r\n                            pubDate: timezone(parseDate(date), +8),\r\n                        };\r\n                    });\r\n                })\r\n        ),\r\n    };\r\n}\r\n"],"mappings":"0ZAOA,MAAaA,EAAe,CACxB,KAAM,QACN,WAAY,CAAC,aACb,QAAS,iBACT,WAAY,GACZ,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,sBAGjB,KAAM,KACN,YAAa,CAAC,YAAa,gBAC3B,UACA,IAAK,oBAGT,eAAe,GAAU,CACrB,IAAM,EAAO,2BACP,EAAW,MAAMC,EAAI,GACrB,EAAQ,EAAK,EAAS,MAC5B,MAAO,CACH,MAAO,aACP,OACA,SAAU,QACV,KAAM,MAAM,QAAQ,IAChB,EAAM,gBACD,UACA,IAAK,GAAO,CACT,IAAM,EAAM,EAAM,GACZ,EAAK,EAAI,KAAK,qBACd,EAAO,EAAG,KAAK,QACf,EAAQ,EAAG,OACX,EAAO,EAAI,KAAK,uBAAuB,OAE7C,OAAOC,EAAM,OAAO,EAAM,SAAY,CAClC,IAAM,EAAc,MAAMD,EAAI,IAAI,GAC5B,EAAW,EAAK,EAAY,MAC5B,EAAc,EAAS,kBAAkB,OAE/C,MAAO,CACH,QACA,cACA,KAAM,EACN,QAAS,EAAS,EAAU,GAAO"}