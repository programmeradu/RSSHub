{"version":3,"file":"pdf-ZxlcQr3n.js","names":["got","route: Route"],"sources":["../../lib/routes/go/mhlw/pdf.ts"],"sourcesContent":["import { Route } from '@/types';\r\n\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\n\r\nexport const handler = async (ctx) => {\r\n    const { category = 'stf/seisakunitsuite/bunya/houkokusuunosuii' } = ctx.req.param();\r\n    const limit = ctx.req.query('limit') ? Number.parseInt(ctx.req.query('limit'), 10) : 30;\r\n\r\n    const rootUrl = 'https://www.mhlw.go.jp';\r\n    const currentUrl = new URL(category.endsWith('.html') ? category : `${category}.html`, rootUrl).href;\r\n\r\n    const { data: response } = await got(currentUrl);\r\n\r\n    const $ = load(response);\r\n\r\n    const language = $('html').prop('lang');\r\n\r\n    const items = $('a[data-icon=\"pdf\"]')\r\n        .slice(0, limit)\r\n        .toArray()\r\n        .map((item) => {\r\n            item = $(item);\r\n\r\n            const title = item.find('font').text() || item.text();\r\n            const link = new URL(item.prop('href'), rootUrl).href;\r\n\r\n            return {\r\n                title,\r\n                link,\r\n                language,\r\n                enclosure_url: link,\r\n                enclosure_type: link ? 'application/pdf' : undefined,\r\n                enclosure_title: title,\r\n            };\r\n        });\r\n\r\n    const image = new URL($('div.m-headerLogo img').first().prop('src'), rootUrl).href;\r\n\r\n    return {\r\n        title: $('title').text(),\r\n        description: $('meta[property=\"og:description\"]').prop('content'),\r\n        link: currentUrl,\r\n        item: items,\r\n        allowEmpty: true,\r\n        image,\r\n        author: $('meta[property=\"og:site_name\"]').prop('content'),\r\n        language,\r\n    };\r\n};\r\n\r\nexport const route: Route = {\r\n    path: '/mhlw/pdf/:category{.+}?',\r\n    name: 'PDF',\r\n    url: 'www.mhlw.go.jp',\r\n    maintainers: ['nczitzk'],\r\n    handler,\r\n    example: '/go/mhlw/pdf/stf/seisakunitsuite/bunya/houkokusuunosuii',\r\n    parameters: { category: 'Category, `stf/seisakunitsuite/bunya/houkokusuunosuii` as 新型コロナウイルス感染症の定点当たり報告数の推移 by default' },\r\n    description: `::: tip\r\n  Subscribing to this route will give you access to all PDF files on this page.\r\n\r\n  If you subscribe to [新型コロナウイルス感染症の定点当たり報告数の推移](https://www.mhlw.go.jp/stf/seisakunitsuite/bunya/houkokusuunosuii.html)，where the URL is \\`https://www.mhlw.go.jp/stf/seisakunitsuite/bunya/houkokusuunosuii.html\\`, extract the part \\`https://www.mhlw.go.jp/\\` to the end, which is \\`.html\\`, and use it as the parameter to fill in. Therefore, the route will be [\\`/go/mhlw/stf/seisakunitsuite/bunya/houkokusuunosuii\\`](https://rsshub.app/go/mhlw/stf/seisakunitsuite/bunya/houkokusuunosuii).\r\n:::\r\n  `,\r\n    categories: ['government'],\r\n\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportRadar: true,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['www.mhlw.go.jp'],\r\n            target: (_, url) => {\r\n                const category = new URL(url).href.match(/mhlw\\.go\\.jp\\/(.*)$/)?.[1] ?? undefined;\r\n\r\n                return `/mhlw/pdf${category ? `/${category}` : ''}`;\r\n            },\r\n        },\r\n    ],\r\n};\r\n"],"mappings":"+PAKA,MAAa,EAAU,KAAO,IAAQ,CAClC,GAAM,CAAE,WAAW,8CAAiD,EAAI,IAAI,QACtE,EAAQ,EAAI,IAAI,MAAM,SAAW,OAAO,SAAS,EAAI,IAAI,MAAM,SAAU,IAAM,GAE/E,EAAU,yBACV,EAAa,IAAI,IAAI,EAAS,SAAS,SAAW,EAAW,GAAG,EAAS,OAAQ,GAAS,KAE1F,CAAE,KAAM,GAAa,MAAMA,EAAI,GAE/B,EAAI,EAAK,GAET,EAAW,EAAE,QAAQ,KAAK,QAE1B,EAAQ,EAAE,sBACX,MAAM,EAAG,GACT,UACA,IAAK,GAAS,CACX,EAAO,EAAE,GAET,IAAM,EAAQ,EAAK,KAAK,QAAQ,QAAU,EAAK,OACzC,EAAO,IAAI,IAAI,EAAK,KAAK,QAAS,GAAS,KAEjD,MAAO,CACH,QACA,OACA,WACA,cAAe,EACf,eAAgB,EAAO,kBAAoB,IAAA,GAC3C,gBAAiB,KAIvB,EAAQ,IAAI,IAAI,EAAE,wBAAwB,QAAQ,KAAK,OAAQ,GAAS,KAE9E,MAAO,CACH,MAAO,EAAE,SAAS,OAClB,YAAa,EAAE,mCAAmC,KAAK,WACvD,KAAM,EACN,KAAM,EACN,WAAY,GACZ,QACA,OAAQ,EAAE,iCAAiC,KAAK,WAChD,aAIKC,EAAe,CACxB,KAAM,2BACN,KAAM,MACN,IAAK,iBACL,YAAa,CAAC,WACd,UACA,QAAS,0DACT,WAAY,CAAE,SAAU,iGACxB,YAAa,ykBAMb,WAAY,CAAC,cAEb,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,aAAc,GACd,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,kBACT,QAAS,EAAG,IAAQ,CAChB,IAAM,EAAW,IAAI,IAAI,GAAK,KAAK,MAAM,yBAAyB,IAAM,IAAA,GAExE,MAAO,YAAY,EAAW,IAAI,IAAa"}