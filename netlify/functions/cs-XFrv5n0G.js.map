{"version":3,"file":"cs-XFrv5n0G.js","names":["got","route: Route","got","util","cache"],"sources":["../../lib/routes/bit/cs/utils.ts","../../lib/routes/bit/cs/cs.ts"],"sourcesContent":["import got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport timezone from '@/utils/timezone';\r\n\r\n// 专门定义一个function用于加载文章内容\r\nasync function loadContent(item) {\r\n    // 异步请求文章\r\n    const response = await got(item.link);\r\n    // 加载文章内容\r\n    const $ = load(response.data);\r\n\r\n    // 提取作者\r\n    const zuozhe = $('.zuozhe').children().next();\r\n    item.author = zuozhe.first().text();\r\n\r\n    // 提取内容\r\n    item.description = $('.wz_art').html();\r\n\r\n    // 返回解析的结果\r\n    return item;\r\n}\r\n\r\nconst ProcessFeed = (list, caches) => {\r\n    const host = 'https://cs.bit.edu.cn/tzgg/';\r\n\r\n    return Promise.all(\r\n        // 遍历每一篇文章\r\n        list.map((item) => {\r\n            const $ = load(item);\r\n\r\n            const $title = $('a');\r\n            // 还原相对链接为绝对链接\r\n            const itemUrl = new URL($title.attr('href'), host).href;\r\n\r\n            // 列表上提取到的信息\r\n            const single = {\r\n                title: $title.text(),\r\n                link: itemUrl,\r\n                // author: '教务部',\r\n                pubDate: timezone(parseDate($('span').text()), 8),\r\n            };\r\n\r\n            // 使用tryGet方法从缓存获取内容。\r\n            // 当缓存中无法获取到链接内容的时候，则使用load方法加载文章内容。\r\n            return caches.tryGet(single.link, () => loadContent(single));\r\n        })\r\n    );\r\n};\r\n\r\nexport default { ProcessFeed };\r\n","import { Route } from '@/types';\r\nimport cache from '@/utils/cache';\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\nimport util from './utils';\r\n\r\nexport const route: Route = {\r\n    path: '/cs',\r\n    categories: ['university'],\r\n    example: '/bit/cs',\r\n    parameters: {},\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['cs.bit.edu.cn/tzgg', 'cs.bit.edu.cn/'],\r\n        },\r\n    ],\r\n    name: '计院通知',\r\n    maintainers: ['sinofp'],\r\n    handler,\r\n    url: 'cs.bit.edu.cn/tzgg',\r\n};\r\n\r\nasync function handler() {\r\n    const link = 'https://cs.bit.edu.cn/tzgg/';\r\n    const response = await got({\r\n        method: 'get',\r\n        url: link,\r\n    });\r\n\r\n    const $ = load(response.data);\r\n\r\n    const list = $('.box_list01 li').toArray();\r\n\r\n    const result = await util.ProcessFeed(list, cache);\r\n\r\n    return {\r\n        title: $('title').text(),\r\n        link,\r\n        description: $('meta[name=\"description\"]').attr('content'),\r\n        item: result,\r\n    };\r\n}\r\n"],"mappings":"0ZAMA,eAAe,EAAY,EAAM,CAE7B,IAAM,EAAW,MAAME,EAAI,EAAK,MAE1B,EAAI,EAAK,EAAS,MAGlB,EAAS,EAAE,WAAW,WAAW,OAOvC,MANA,GAAK,OAAS,EAAO,QAAQ,OAG7B,EAAK,YAAc,EAAE,WAAW,OAGzB,EAGX,MAAM,GAAe,EAAM,IAGhB,QAAQ,IAEX,EAAK,IAAK,GAAS,CACf,IAAM,EAAI,EAAK,GAET,EAAS,EAAE,KAEX,EAAU,IAAI,IAAI,EAAO,KAAK,QAAS,+BAAM,KAG7C,EAAS,CACX,MAAO,EAAO,OACd,KAAM,EAEN,QAAS,EAAS,EAAU,EAAE,QAAQ,QAAS,IAKnD,OAAO,EAAO,OAAO,EAAO,SAAY,EAAY,OAKhE,IAAA,EAAe,CAAE,eC5CjB,MAAaD,EAAe,CACxB,KAAM,MACN,WAAY,CAAC,cACb,QAAS,UACT,WAAY,GACZ,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,qBAAsB,oBAGvC,KAAM,OACN,YAAa,CAAC,UACd,UACA,IAAK,sBAGT,eAAe,GAAU,CACrB,IAAM,EAAO,8BACP,EAAW,MAAMC,EAAI,CACvB,OAAQ,MACR,IAAK,IAGH,EAAI,EAAK,EAAS,MAElB,EAAO,EAAE,kBAAkB,UAE3B,EAAS,MAAMC,EAAK,YAAY,EAAMC,GAE5C,MAAO,CACH,MAAO,EAAE,SAAS,OAClB,OACA,YAAa,EAAE,4BAA4B,KAAK,WAChD,KAAM"}