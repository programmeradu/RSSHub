import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as n}from"./cache-kimkMTWJ.js";import{art as r}from"./render-CxhTJIsl.js";import"./ofetch-Bzt0BXUH.js";import{got_default as i}from"./got-CdvI2yKX.js";import a from"node:path";import{load as o}from"cheerio";t();const s=({subtitle:t,quotation:n,pics:i,article:o})=>r(a.join(e,`templates/description-38757817.art`),{subtitle:t,quotation:n,pics:i,article:o}),c=async e=>{let t=await i({method:`get`,url:e}),n=o(t.data),r=n(`.right1 .bmname`).children().length;return{pageLength:r,$:n}},l=(e,t)=>{let n=e(`.zi .zi-top .banci strong`).text(),r=e(`.zi-meat ul>li`).toArray().map(r=>{let i=e(r).find(`a`).attr(`href`),a=e(r).find(`a div`).text();return{link:`${t}/${i}`,title:`[${n}] ${a}`}});return r},u=(e,t=1)=>{let n=async()=>{let n=`${e}/node_${t+1}.htm`,r=await i({method:`get`,url:n}),a=o(r.data);return l(a,e)};return n},d=async(e,t)=>{let n=await Promise.all(e.map(e=>t.tryGet(e.link,async()=>{let{data:t}=await i(e.link),n=o(t),r=n(`.right-meat .yinti`).text(),a=n(`.right-meat .futi`).text(),c=n(`.right-meat .tuwen .article #ozoom`).html(),l=n(`.right-meat .tuwen .picture`).toArray().map(e=>{let t={};return n(e).find(`tr`).toArray().map(e=>{let r=n(e).find(`img`).attr(`src`);return r?t.src=r:t.des=n(e).find(`td`).text(),null}),t});return e.author=n(`.right-meat .author`).text(),e.description=s({subtitle:a,quotation:r,article:c,pics:l}),e})));return n},f={path:`/digitalpaper`,categories:[`traditional-media`],example:`/stdaily/digitalpaper`,parameters:{},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`科技日报`,maintainers:[`lyqluis`],handler:p};async function p(){let e=new Date,t=e.toLocaleDateString(`zh-CN`,{year:`numeric`,month:`2-digit`,day:`2-digit`}),r=t.replace(`/`,`-`),i=`http://digitalpaper.stdaily.com/http_www.kjrb.com/kjrb/html/${r}`,a=[],o=[],{pageLength:s,$:f}=await c(`${i}/node_2.htm`);o.push(...l(f,i));for(let e=2;e<=s;e++)a.push(u(i,e));o.push(...(await Promise.all(a.map(e=>e()))).flat());let p=await d(o,n);return{title:`科技日报`,link:`http://digitalpaper.stdaily.com`,item:p}}export{f as route};
//# sourceMappingURL=digitalpaper-DyYHVrCw.js.map