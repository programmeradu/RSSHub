{"version":3,"file":"changelog-CkSQy8Fz.js","names":["route: Route","ofetch"],"sources":["../../lib/routes/kovidgoyal/kitty/changelog.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport ofetch from '@/utils/ofetch';\r\nimport { load } from 'cheerio';\r\nimport { parseDate } from '@/utils/parse-date';\r\n\r\nexport const route: Route = {\r\n    path: '/kitty/changelog',\r\n    categories: ['program-update'],\r\n    example: '/kovidgoyal/kitty/changelog',\r\n    parameters: {},\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['sw.kovidgoyal.net/kitty/changelog/'],\r\n            target: '/kitty/changelog',\r\n        },\r\n    ],\r\n    name: 'Changelog',\r\n    maintainers: ['xbot'],\r\n    handler,\r\n    url: 'sw.kovidgoyal.net/kitty/changelog/',\r\n};\r\n\r\nasync function handler() {\r\n    const url = 'https://sw.kovidgoyal.net/kitty/changelog/';\r\n    const response = await ofetch(url);\r\n    const $ = load(response);\r\n\r\n    // Find the \"Detailed list of changes\" section\r\n    const detailedSection = $('#detailed-list-of-changes');\r\n\r\n    const items = detailedSection\r\n        .find('section[id^=\"id\"]')\r\n        .toArray()\r\n        .map((section) => {\r\n            const $section = $(section);\r\n\r\n            // Extract version and date from h3 title\r\n            const titleText = $section.find('h3').first().text().trim();\r\n            const versionMatch = titleText.match(/^([\\d.]+)\\s*\\[([^\\]]+)\\]/);\r\n\r\n            if (!versionMatch) {\r\n                return null;\r\n            }\r\n\r\n            const version = versionMatch[1];\r\n            const dateStr = versionMatch[2];\r\n\r\n            // Extract changelog items from the ul list\r\n            const changelogItems = $section\r\n                .find('ul.simple li')\r\n                .toArray()\r\n                .map((li) => $(li).html())\r\n                .filter(Boolean);\r\n\r\n            // Create description from changelog items\r\n            const description = changelogItems.length > 0 ? '<ul>' + changelogItems.map((item) => `<li>${item}</li>`).join('') + '</ul>' : 'No changelog items available.';\r\n\r\n            return {\r\n                title: `Kitty ${version}`,\r\n                description,\r\n                link: `${url}#${$section.attr('id')}`,\r\n                pubDate: parseDate(dateStr, 'YYYY-MM-DD'),\r\n                guid: `kitty-${version}`,\r\n            };\r\n        })\r\n        .filter(Boolean);\r\n\r\n    return {\r\n        title: 'Kitty Changelog',\r\n        link: url,\r\n        description: 'Changelog for Kitty terminal emulator',\r\n        language: 'en',\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"+PAKA,MAAaA,EAAe,CACxB,KAAM,mBACN,WAAY,CAAC,kBACb,QAAS,8BACT,WAAY,GACZ,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,sCACT,OAAQ,qBAGhB,KAAM,YACN,YAAa,CAAC,QACd,UACA,IAAK,sCAGT,eAAe,GAAU,CACrB,IAAM,EAAM,6CACN,EAAW,MAAMC,EAAO,GACxB,EAAI,EAAK,GAGT,EAAkB,EAAE,6BAEpB,EAAQ,EACT,KAAK,qBACL,UACA,IAAK,GAAY,CACd,IAAM,EAAW,EAAE,GAGb,EAAY,EAAS,KAAK,MAAM,QAAQ,OAAO,OAC/C,EAAe,EAAU,MAAM,4BAErC,GAAI,CAAC,EACD,OAAO,KAGX,IAAM,EAAU,EAAa,GACvB,EAAU,EAAa,GAGvB,EAAiB,EAClB,KAAK,gBACL,UACA,IAAK,GAAO,EAAE,GAAI,QAClB,OAAO,SAGN,EAAc,EAAe,OAAS,EAAI,OAAS,EAAe,IAAK,GAAS,OAAO,EAAK,QAAQ,KAAK,IAAM,QAAU,gCAE/H,MAAO,CACH,MAAO,SAAS,IAChB,cACA,KAAM,GAAG,EAAI,GAAG,EAAS,KAAK,QAC9B,QAAS,EAAU,EAAS,cAC5B,KAAM,SAAS,OAGtB,OAAO,SAEZ,MAAO,CACH,MAAO,kBACP,KAAM,EACN,YAAa,wCACb,SAAU,KACV,KAAM"}