{"version":3,"file":"posts-MQarF1Fo.js","names":["route: Route","got"],"sources":["../../lib/routes/runtrail/posts.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport got from '@/utils/got';\r\nimport { parseDate } from '@/utils/parse-date';\r\n\r\nexport const route: Route = {\r\n    path: '/',\r\n    radar: [\r\n        {\r\n            source: ['runtrail.cn/'],\r\n            target: '',\r\n        },\r\n    ],\r\n    name: 'Unknown',\r\n    maintainers: ['TonyRL'],\r\n    handler,\r\n    url: 'runtrail.cn/',\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const baseUrl = 'https://runtrail.cn';\r\n    const { data: response } = await got(`${baseUrl}/wp-json/wp/v2/posts`, {\r\n        searchParams: {\r\n            _embed: true,\r\n            per_page: ctx.req.query('limit') ? Number.parseInt(ctx.req.query('limit')) : 30,\r\n        },\r\n    });\r\n\r\n    let data = response;\r\n    if (typeof response !== 'object') {\r\n        // remove php warnings before JSON\r\n        data = JSON.parse(response.match(/\\[(.*)]/)[0]);\r\n    }\r\n\r\n    const items = data.map((item) => ({\r\n        title: item.title.rendered,\r\n        description: item.content.rendered,\r\n        pubDate: parseDate(item.date_gmt),\r\n        updated: parseDate(item.modified_gmt),\r\n        author: item._embedded.author.map((a) => a.name).join(', '),\r\n        category: item._embedded['wp:term'][0].map((c) => c.name),\r\n        link: item.link,\r\n    }));\r\n\r\n    return {\r\n        title: '最新文章 - 跑野大爆炸',\r\n        link: baseUrl,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"qRAIA,MAAaA,EAAe,CACxB,KAAM,IACN,MAAO,CACH,CACI,OAAQ,CAAC,gBACT,OAAQ,KAGhB,KAAM,UACN,YAAa,CAAC,UACd,UACA,IAAK,gBAGT,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAU,sBACV,CAAE,KAAM,GAAa,MAAMC,EAAI,GAAG,EAAQ,sBAAuB,CACnE,aAAc,CACV,OAAQ,GACR,SAAU,EAAI,IAAI,MAAM,SAAW,OAAO,SAAS,EAAI,IAAI,MAAM,UAAY,MAIjF,EAAO,EACP,OAAO,GAAa,WAEpB,EAAO,KAAK,MAAM,EAAS,MAAM,WAAW,KAGhD,IAAM,EAAQ,EAAK,IAAK,IAAU,CAC9B,MAAO,EAAK,MAAM,SAClB,YAAa,EAAK,QAAQ,SAC1B,QAAS,EAAU,EAAK,UACxB,QAAS,EAAU,EAAK,cACxB,OAAQ,EAAK,UAAU,OAAO,IAAK,GAAM,EAAE,MAAM,KAAK,MACtD,SAAU,EAAK,UAAU,WAAW,GAAG,IAAK,GAAM,EAAE,MACpD,KAAM,EAAK,QAGf,MAAO,CACH,MAAO,eACP,KAAM,EACN,KAAM"}