import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import{art as n}from"./render-CxhTJIsl.js";import{parseDate as r}from"./parse-date-Bgabdhlb.js";import{got_default as i}from"./got-CdvI2yKX.js";import{timezone as a}from"./timezone-BrNu6iXe.js";import o from"node:path";import{load as s}from"cheerio";t();const c=`whu.edu.cn`,l=e=>{let t={};return e.replaceAll(/<meta name="(.*?)" content="(.*?)"/gi,(e,n,r)=>{t[n]=r}),t},u=(e,t)=>Object.hasOwn(e,t)?e[t]:void 0,d=async(t,c)=>{try{let{data:d}=await i(t.link),f=s(d);f(`p.vsbcontent_img`).each(function(){let t=f(this).find(`img`);f(this).replaceWith(n(o.join(e,`templates/description-47111791.art`),{image:{src:new URL(t.prop(`orisrc`),c).href,width:t.prop(`width`)}}))}),f(`script[name="_videourl"]`).each(function(){let t=f(this);t.replaceWith(n(o.join(e,`templates/description-47111791.art`),{video:{src:new URL(t.prop(`vurl`).split(`?`)[0],c).href,width:f(t).prop(`vwidth`),height:f(t).prop(`vheight`)}}))});let p=f(`div.v_news_content`).html();f(`form[name="_newscontent_fromname"] table`).remove();let m=f(`form[name="_newscontent_fromname"] ul li`).toArray().map(e=>(e=f(e).find(`a`),{title:e.text(),link:new URL(e.prop(`href`),c).href})),h=l(d);t.title=u(h,`ArticleTitle`)??t.title,t.description=n(o.join(e,`templates/description-47111791.art`),{description:p,attachments:m}),t.author=u(h,`ContentSource`),t.category=u(h,`Keywords`)?.split(` `).filter(Boolean)??[],t.guid=u(h,`Url`)??t.link,t.pubDate=u(h,`PubDate`)?a(r(u(h,`PubDate`)),8):t.pubDate,m.length>0&&(t.enclosure_url=m[0].link,t.enclosure_type=`application/${m[0].title.split(`.`).pop()}`)}catch{}return t},f=async(e,t,n)=>await Promise.all(e.map(e=>e.link.includes(c)?t(e.link,async()=>await d(e,n)):e));export{c as domain,u as getMeta,f as processItems,l as processMeta};
//# sourceMappingURL=util-BjzbIVC4.js.map