import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{art as n}from"./render-CxhTJIsl.js";import{parseDate as r}from"./parse-date-Bgabdhlb.js";import{ofetch_default as i}from"./ofetch-Bzt0BXUH.js";import{ViewType as a}from"./types-A5bA50Mg.js";import o from"node:path";import{load as s}from"cheerio";t();const c=e=>{let t={0:`search.score() desc, Metadata/OfficialRepositoryNumber desc, NameSortable asc`,1:`NameSortable asc, Metadata/OfficialRepositoryNumber desc, Metadata/RepositoryStars desc, Metadata/Committed desc`,2:`Metadata/Committed desc, Metadata/OfficialRepositoryNumber desc, Metadata/RepositoryStars desc`};if(e===`1`)return t;let n={};for(let e in t){let r=t[e];n[e]=r.replaceAll(/\b(desc|asc)\b/gi,e=>e.toLowerCase()===`desc`?`asc`:`desc`)}return n},l={o:`Metadata/OfficialRepositoryNumber eq 1`,dm:`Metadata/DuplicateOf eq null`},u=async t=>{let{query:a=`s=2&d=1&n=true&dm=true&o=true`}=t.req.param(),u=Number.parseInt(t.req.query(`limit`)??`50`,10),d=`https://scoop.sh`,f=new URL(`/#/apps?${a}`,d).href,p=new URL(`indexes/apps/docs/search`,`https://scoopsearch.search.windows.net`).href,m=await i(f),h=s(m),g=h(`html`).attr(`lang`)??`en`,_=/<script type="module" crossorigin src="(.*?)"><\/script>/,v=_.test(m)?new URL(m.match(_)?.[1],d).href:``;if(!v)throw Error(`JavaScript file not found.`);let y=await i(v,{parseResponse:e=>e}),b=y.match(/VITE_APP_AZURESEARCH_KEY:"(.*?)"/)?.[1];if(!b)throw Error(`Key not found.`);let x=!a.includes(`o=false`),S=!a.includes(`dm=false`),C=a.match(/s=(\d+)/)?.[1]??`2`,w=a.match(/d=(\d+)/)?.[1]??`1`,T=await i(p,{method:`post`,query:{"api-version":`2020-06-30`},headers:{"api-key":b,origin:d,referer:d},body:{count:!0,search:``,searchMode:`all`,filter:[x?l.o:void 0,S?l.dm:void 0].filter(Boolean).join(` and `),orderby:c(w)[C],skip:0,top:u,select:`Id,Name,NamePartial,NameSuffix,Description,Notes,Homepage,License,Version,Metadata/Repository,Metadata/FilePath,Metadata/OfficialRepository,Metadata/RepositoryStars,Metadata/Committed,Metadata/Sha`,highlight:`Name,NamePartial,NameSuffix,Description,Version,License,Metadata/Repository`,highlightPreTag:`<mark>`,highlightPostTag:`</mark>`}}),E=[];E=T.value.slice(0,u).map(t=>{let i=t.Metadata.Repository.split(/\//),a=i.slice(-2).join(`/`),s=`${t.Name} ${t.Version} in ${a}`,c=n(o.join(e,`templates/description-ce60bb07.art`),{item:t}),l=t.Metadata.Committed,u=t.Homepage,d=[{name:a,url:t.Metadata.Repository,avatar:void 0}],f=`scoop-${t.Name}-${t.Version}-${t.Metadata.Sha}`,p=l,m={title:s,description:c,pubDate:l?r(l):void 0,link:u,author:d,guid:f,id:f,content:{html:c,text:c},updated:p?r(p):void 0,language:g};return m});let D=`Scoop`;return{title:`${D} - Apps`,description:void 0,link:f,item:E,allowEmpty:!0,author:D,language:g,id:f}},d={path:`/apps/:query?`,name:`Apps`,url:`scoop.sh`,maintainers:[`nczitzk`],handler:u,example:`/scoop/apps`,parameters:{query:{description:"Query, `s=2&d=1&n=true&dm=true&o=true` by default"}},description:`:::tip
To subscribe to [Apps](https://scoop.sh/#/apps?s=2&d=1&n=true&dm=true&o=true), where the source URL is \`https://scoop.sh/#/apps?s=2&d=1&n=true&dm=true&o=true\`, extract the certain parts from this URL to be used as parameters, resulting in the route as [\`/scoop/apps/s=2&d=1&n=true&dm=true&o=true\`](https://rsshub.app/scoop/apps/s=2&d=1&n=true&dm=true&o=true).

:::
`,categories:[`program-update`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`scoop.sh/#/apps`,`scoop.sh`],target:(e,t)=>{let n=new URL(t),r=n.searchParams.toString()??void 0;return`/scoop/apps${r?`/${r}`:``}`}}],view:a.Notifications};export{u as handler,d as route};
//# sourceMappingURL=apps-DoSGzdWf.js.map