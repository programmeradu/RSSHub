{"version":3,"file":"ithome-DrGpp_6N.js","names":["route: Route","InvalidParameterError","got","cache"],"sources":["../../lib/routes/ithome/index.ts"],"sourcesContent":["import InvalidParameterError from '@/errors/types/invalid-parameter';\r\nimport { Route } from '@/types';\r\nimport cache from '@/utils/cache';\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\n\r\nconst get_url = (caty) => `https://${caty}.ithome.com/`;\r\n\r\nconst config = {\r\n    it: {\r\n        title: 'IT 资讯',\r\n    },\r\n    soft: {\r\n        title: '软件之家',\r\n    },\r\n    win10: {\r\n        title: 'win10 之家',\r\n    },\r\n    win11: {\r\n        title: 'win11 之家',\r\n    },\r\n    iphone: {\r\n        title: 'iphone 之家',\r\n    },\r\n    ipad: {\r\n        title: 'ipad 之家',\r\n    },\r\n    android: {\r\n        title: 'android 之家',\r\n    },\r\n    digi: {\r\n        title: '数码之家',\r\n    },\r\n    next: {\r\n        title: '智能时代',\r\n    },\r\n};\r\n\r\nexport const route: Route = {\r\n    path: '/:caty',\r\n    categories: ['new-media'],\r\n    example: '/ithome/it',\r\n    parameters: { caty: '类别' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    name: '分类资讯',\r\n    maintainers: ['luyuhuang'],\r\n    handler,\r\n    description: `| it      | soft     | win10      | win11      | iphone      | ipad      | android      | digi     | next     |\r\n| ------- | -------- | ---------- | ---------- | ----------- | --------- | ------------ | -------- | -------- |\r\n| IT 资讯 | 软件之家 | win10 之家 | win11 之家 | iphone 之家 | ipad 之家 | android 之家 | 数码之家 | 智能时代 |`,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const cfg = config[ctx.req.param('caty')];\r\n    if (!cfg) {\r\n        throw new InvalidParameterError('Bad category. See <a href=\"https://docs.rsshub.app/routes/new-media#it-zhi-jia\">https://docs.rsshub.app/routes/new-media#it-zhi-jia</a>');\r\n    }\r\n\r\n    const current_url = get_url(ctx.req.param('caty'));\r\n    const response = await got({\r\n        method: 'get',\r\n        url: current_url,\r\n    });\r\n\r\n    const $ = load(response.data);\r\n    const list = $('#list > div.fl > ul > li > div > h2 > a')\r\n        .slice(0, 10)\r\n        .toArray()\r\n        .map((item) => {\r\n            item = $(item);\r\n            return {\r\n                title: item.text(),\r\n                link: item.attr('href'),\r\n            };\r\n        });\r\n\r\n    const items = await Promise.all(\r\n        list.map((item) =>\r\n            cache.tryGet(item.link, async () => {\r\n                const res = await got({ method: 'get', url: item.link });\r\n                const content = load(res.data);\r\n                const post = content('#paragraph');\r\n                post.find('img[data-original]').each((_, ele) => {\r\n                    ele = $(ele);\r\n                    ele.attr('src', ele.attr('data-original'));\r\n                    ele.removeAttr('class');\r\n                    ele.removeAttr('data-original');\r\n                });\r\n                item.description = post.html();\r\n                item.pubDate = new Date(content('#pubtime_baidu').text() + ' GMT+8').toUTCString();\r\n                return item;\r\n            })\r\n        )\r\n    );\r\n\r\n    return {\r\n        title: 'IT 之家 - ' + cfg.title,\r\n        link: current_url,\r\n        image: 'https://img.ithome.com/m/images/logo.png',\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"+XAMA,MAAM,EAAW,GAAS,WAAW,EAAK,cAEpC,EAAS,CACX,GAAI,CACA,MAAO,SAEX,KAAM,CACF,MAAO,QAEX,MAAO,CACH,MAAO,YAEX,MAAO,CACH,MAAO,YAEX,OAAQ,CACJ,MAAO,aAEX,KAAM,CACF,MAAO,WAEX,QAAS,CACL,MAAO,cAEX,KAAM,CACF,MAAO,QAEX,KAAM,CACF,MAAO,SAIFA,EAAe,CACxB,KAAM,SACN,WAAY,CAAC,aACb,QAAS,aACT,WAAY,CAAE,KAAM,MACpB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,KAAM,OACN,YAAa,CAAC,aACd,UACA,YAAa;;0FAKjB,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAM,EAAO,EAAI,IAAI,MAAM,SACjC,GAAI,CAAC,EACD,MAAM,IAAIC,EAAsB,2IAGpC,IAAM,EAAc,EAAQ,EAAI,IAAI,MAAM,SACpC,EAAW,MAAMC,EAAI,CACvB,OAAQ,MACR,IAAK,IAGH,EAAI,EAAK,EAAS,MAClB,EAAO,EAAE,2CACV,MAAM,EAAG,IACT,UACA,IAAK,IACF,EAAO,EAAE,GACF,CACH,MAAO,EAAK,OACZ,KAAM,EAAK,KAAK,WAItB,EAAQ,MAAM,QAAQ,IACxB,EAAK,IAAK,GACNC,EAAM,OAAO,EAAK,KAAM,SAAY,CAChC,IAAM,EAAM,MAAMD,EAAI,CAAE,OAAQ,MAAO,IAAK,EAAK,OAC3C,EAAU,EAAK,EAAI,MACnB,EAAO,EAAQ,cASrB,OARA,EAAK,KAAK,sBAAsB,MAAM,EAAG,IAAQ,CAC7C,EAAM,EAAE,GACR,EAAI,KAAK,MAAO,EAAI,KAAK,kBACzB,EAAI,WAAW,SACf,EAAI,WAAW,mBAEnB,EAAK,YAAc,EAAK,OACxB,EAAK,QAAU,IAAI,KAAK,EAAQ,kBAAkB,OAAS,UAAU,cAC9D,MAKnB,MAAO,CACH,MAAO,WAAa,EAAI,MACxB,KAAM,EACN,MAAO,2CACP,KAAM"}