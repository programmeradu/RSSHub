{"version":3,"file":"jornada-BETkcvVP.js","names":["route: Route","got"],"sources":["../../lib/routes/jornada/index.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport got from '@/utils/got';\r\nimport { parseDate } from '@/utils/parse-date';\r\n\r\nconst rootUrl = 'https://www.jornada.com.mx';\r\n\r\nconst categories = {\r\n    capital: 'Capital',\r\n    cartones: 'Cartones',\r\n    ciencia: 'Ciencia-Y-Tecnologia',\r\n    cultura: 'Cultura',\r\n    deportes: 'Deportes',\r\n    economia: 'Economia',\r\n    estados: 'Estados',\r\n    mundo: 'Mundo',\r\n    opinion: 'Opinion',\r\n    politica: 'Politica',\r\n    sociedad: 'Sociedad',\r\n};\r\n\r\nconst getDateForToday = () => {\r\n    const date = new Date(Date.now());\r\n    const today = date.getFullYear() + '-' + ('0' + (date.getMonth() + 1)).slice(-2) + '-' + ('0' + date.getDate()).slice(-2);\r\n    return today;\r\n};\r\n\r\nexport const route: Route = {\r\n    path: '/:date?/:category?',\r\n    categories: ['traditional-media'],\r\n    example: '/jornada/2022-10-12/capital',\r\n    parameters: { date: \"Date string, must be in format of `YYYY-MM-DD`. You can get today's news using `today`\", category: 'Category, refer to the table below' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    name: 'News',\r\n    maintainers: ['Thealf154'],\r\n    handler,\r\n    description: `Provides a way to get an specific rss feed by date and category over the official one.\r\n\r\n| Category             | \\`:category\\` |\r\n| -------------------- | ----------- |\r\n| Capital              | capital     |\r\n| Cartones             | cartones    |\r\n| Ciencia y Tecnología | ciencia     |\r\n| Cultura              | cultura     |\r\n| Deportes             | deportes    |\r\n| Economía             | economia    |\r\n| Estados              | estados     |\r\n| Mundo                | mundo       |\r\n| Opinión              | opinion     |\r\n| Política             | politica    |\r\n| Sociedad             | sociedad    |`,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const date = ctx.req.param('date') === 'today' || ctx.req.param('date') === undefined ? getDateForToday() : ctx.req.param('date');\r\n    const category = ctx.req.param('category');\r\n    const url = `${rootUrl}/jsonstorage/articles_${date}_.json`;\r\n\r\n    const response = await got(url);\r\n    const data = response.data;\r\n\r\n    let items = {};\r\n\r\n    if (category) {\r\n        const newsFilteredByCategory = data.filter((item) => item.category === categories[category]);\r\n\r\n        items = newsFilteredByCategory.map((item) => ({\r\n            title: item.title,\r\n            description: item.content,\r\n            pubDate: parseDate(item.date),\r\n            link: `${rootUrl}/${item.url}`,\r\n        }));\r\n    } else {\r\n        items = data.map((item) => ({\r\n            title: item.title,\r\n            description: item.content,\r\n            pubDate: parseDate(item.date),\r\n            link: `${rootUrl}/${item.url}`,\r\n        }));\r\n    }\r\n\r\n    return {\r\n        title: 'La Jornada',\r\n        link: rootUrl,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"qRAIA,MAAM,EAAU,6BAEV,EAAa,CACf,QAAS,UACT,SAAU,WACV,QAAS,uBACT,QAAS,UACT,SAAU,WACV,SAAU,WACV,QAAS,UACT,MAAO,QACP,QAAS,UACT,SAAU,WACV,SAAU,YAGR,MAAwB,CAC1B,IAAM,EAAO,IAAI,KAAK,KAAK,OACrB,EAAQ,EAAK,cAAgB,KAAO,KAAO,EAAK,WAAa,IAAI,MAAM,IAAM,KAAO,IAAM,EAAK,WAAW,MAAM,IACtH,OAAO,GAGEA,EAAe,CACxB,KAAM,qBACN,WAAY,CAAC,qBACb,QAAS,8BACT,WAAY,CAAE,KAAM,yFAA0F,SAAU,sCACxH,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,KAAM,OACN,YAAa,CAAC,aACd,UACA,YAAa;;;;;;;;;;;;;;yCAiBjB,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAO,EAAI,IAAI,MAAM,UAAY,SAAW,EAAI,IAAI,MAAM,UAAY,IAAA,GAAY,IAAoB,EAAI,IAAI,MAAM,QACpH,EAAW,EAAI,IAAI,MAAM,YACzB,EAAM,GAAG,EAAQ,wBAAwB,EAAK,QAE9C,EAAW,MAAMC,EAAI,GACrB,EAAO,EAAS,KAElB,EAAQ,GAEZ,GAAI,EAAU,CACV,IAAM,EAAyB,EAAK,OAAQ,GAAS,EAAK,WAAa,EAAW,IAElF,EAAQ,EAAuB,IAAK,IAAU,CAC1C,MAAO,EAAK,MACZ,YAAa,EAAK,QAClB,QAAS,EAAU,EAAK,MACxB,KAAM,GAAG,EAAQ,GAAG,EAAK,cAG7B,EAAQ,EAAK,IAAK,IAAU,CACxB,MAAO,EAAK,MACZ,YAAa,EAAK,QAClB,QAAS,EAAU,EAAK,MACxB,KAAM,GAAG,EAAQ,GAAG,EAAK,SAIjC,MAAO,CACH,MAAO,aACP,KAAM,EACN,KAAM"}