{"version":3,"file":"column-DEpXhmAV.js","names":[],"sources":["../../lib/routes/cntv/column.ts"],"sourcesContent":["import { Route } from '@/types';\r\n\r\nimport got from '@/utils/got';\r\nimport { art } from '@/utils/render';\r\nimport path from 'node:path';\r\nimport { parseDate } from '@/utils/parse-date';\r\n\r\nexport const route: Route = {\r\n    path: '/:column',\r\n    categories: ['multimedia'],\r\n    example: '/cntv/TOPC1451528971114112',\r\n    parameters: { column: '栏目ID, 可在对应CNTV栏目页面找到' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['navi.cctv.com/'],\r\n        },\r\n    ],\r\n    name: '栏目',\r\n    maintainers: ['WhoIsSure', 'Fatpandac'],\r\n    handler,\r\n    url: 'navi.cctv.com/',\r\n    description: `::: tip\r\n栏目 ID 查找示例:\r\n打开栏目具体某一期页面，F12 控制台输入\\`column_id\\`得到栏目 ID。\r\n:::\r\n\r\n  栏目\r\n\r\n| 新闻联播             | 新闻周刊             | 天下足球             |\r\n| -------------------- | -------------------- | -------------------- |\r\n| TOPC1451528971114112 | TOPC1451559180488841 | TOPC1451551777876756 |`,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const id = ctx.req.param('column');\r\n    const limit = Number.isNaN(Number.parseInt(ctx.req.query('limit'))) ? 25 : Number.parseInt(ctx.req.query('limit'));\r\n\r\n    const response = await got({\r\n        method: 'get',\r\n        url: `https://api.cntv.cn/NewVideo/getVideoListByColumn?id=${id}&n=${limit}&sort=desc&p=1&mode=0&serviceId=tvcctv`,\r\n    });\r\n    const data = response.data.data.list;\r\n    const name = data[0].title.match(/《(.*?)》/)[1];\r\n\r\n    return {\r\n        title: `CNTV 栏目 - ${name}`,\r\n        description: `${name} 栏目的视频更新`,\r\n        item: data.map((item) => ({\r\n            title: item.title,\r\n            description: art(path.join(__dirname, 'templates/column.art'), {\r\n                item,\r\n            }),\r\n            pubDate: parseDate(item.time),\r\n            link: item.url,\r\n        })),\r\n    };\r\n}\r\n"],"mappings":"qYAOA,MAAa,EAAe,CACxB,KAAM,WACN,WAAY,CAAC,cACb,QAAS,6BACT,WAAY,CAAE,OAAQ,wBACtB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,oBAGjB,KAAM,KACN,YAAa,CAAC,YAAa,aAC3B,UACA,IAAK,iBACL,YAAa;;;;;;;;;yEAYjB,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAK,EAAI,IAAI,MAAM,UACnB,EAAQ,OAAO,MAAM,OAAO,SAAS,EAAI,IAAI,MAAM,WAAa,GAAK,OAAO,SAAS,EAAI,IAAI,MAAM,UAEnG,EAAW,MAAM,EAAI,CACvB,OAAQ,MACR,IAAK,wDAAwD,EAAG,KAAK,EAAM,0CAEzE,EAAO,EAAS,KAAK,KAAK,KAC1B,EAAO,EAAK,GAAG,MAAM,MAAM,WAAW,GAE5C,MAAO,CACH,MAAO,aAAa,IACpB,YAAa,GAAG,EAAK,UACrB,KAAM,EAAK,IAAK,IAAU,CACtB,MAAO,EAAK,MACZ,YAAa,EAAI,EAAA,KAAA,EAAA,iCAA8C,CAC3D,SAEJ,QAAS,EAAU,EAAK,MACxB,KAAM,EAAK"}