{"version":3,"file":"recently-B-vN0E34.js","names":["got","route: Route","categories"],"sources":["../../lib/routes/macmenubar/recently.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport got from '@/utils/got';\r\n\r\nasync function getCategoryId(categories) {\r\n    const baseUrl = `https://macmenubar.com/wp-json/wp/v2/categories`;\r\n    const { data: response } = await got(baseUrl, {\r\n        method: 'GET',\r\n        searchParams: {\r\n            slug: categories,\r\n        },\r\n    });\r\n    return response.reduce((queryString, item) => queryString + item.id + ',', '');\r\n}\r\n\r\nexport const route: Route = {\r\n    path: '/recently/:category?',\r\n    categories: ['blog'],\r\n    example: '/macmenubar/recently/developer-apps,system-tools',\r\n    parameters: { category: 'Category path name, seperate by comma, default is all categories. Category path name can be found in url' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    name: 'Recently',\r\n    maintainers: ['5upernova-heng'],\r\n    handler,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const baseUrl = 'https://macmenubar.com/wp-json/wp/v2/posts';\r\n    const categories = ctx.req.param('category');\r\n    const searchParams = {\r\n        per_page: 100,\r\n    };\r\n    if (categories) {\r\n        searchParams.categories = await getCategoryId(categories);\r\n    }\r\n    const response = await got(baseUrl, {\r\n        method: 'GET',\r\n        searchParams,\r\n    });\r\n    const items = response.data.map((post) => {\r\n        const title = post.title.rendered;\r\n        const link = post.link;\r\n        const pubDate = post.date_gmt;\r\n        const description = post.content.rendered;\r\n        const tags = post.tag_info.map((tag) => tag.name);\r\n        const categories = post.category_info.map((category) => category.name);\r\n        return {\r\n            title,\r\n            link,\r\n            pubDate,\r\n            description,\r\n            category: [...tags, ...categories],\r\n        };\r\n    });\r\n    return {\r\n        title: 'Recent Posts | MacMenuBar.com',\r\n        link: 'https://macmenubar.com/recently-added/',\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"gOAGA,eAAe,EAAc,EAAY,CACrC,GACM,CAAE,KAAM,GAAa,MAAMA,EAAI,kDAAS,CAC1C,OAAQ,MACR,aAAc,CACV,KAAM,KAGd,OAAO,EAAS,QAAQ,EAAa,IAAS,EAAc,EAAK,GAAK,IAAK,IAG/E,MAAaC,EAAe,CACxB,KAAM,uBACN,WAAY,CAAC,QACb,QAAS,mDACT,WAAY,CAAE,SAAU,4GACxB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,KAAM,WACN,YAAa,CAAC,kBACd,WAGJ,eAAe,EAAQ,EAAK,CACxB,IACM,EAAa,EAAI,IAAI,MAAM,YAC3B,EAAe,CACjB,SAAU,KAEV,IACA,EAAa,WAAa,MAAM,EAAc,IAElD,IAAM,EAAW,MAAMD,EAAI,6CAAS,CAChC,OAAQ,MACR,iBAEE,EAAQ,EAAS,KAAK,IAAK,GAAS,CACtC,IAAM,EAAQ,EAAK,MAAM,SACnB,EAAO,EAAK,KACZ,EAAU,EAAK,SACf,EAAc,EAAK,QAAQ,SAC3B,EAAO,EAAK,SAAS,IAAK,GAAQ,EAAI,MACtCE,EAAa,EAAK,cAAc,IAAK,GAAa,EAAS,MACjE,MAAO,CACH,QACA,OACA,UACA,cACA,SAAU,CAAC,GAAG,EAAM,GAAGA,MAG/B,MAAO,CACH,MAAO,gCACP,KAAM,yCACN,KAAM"}