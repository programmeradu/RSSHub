{"version":3,"file":"mostwanted-9uRYf_ui.js","names":["limit: number","targetUrl: string","ofetch","$: CheerioAPI","selector: string","items: DataItem[]","title: string","tabTitle: string","route: Route"],"sources":["../../lib/routes/app-sales/mostwanted.ts"],"sourcesContent":["import { type Data, type DataItem, type Route, ViewType } from '@/types';\r\n\r\nimport ofetch from '@/utils/ofetch';\r\n\r\nimport { type CheerioAPI, load } from 'cheerio';\r\nimport { type Context } from 'hono';\r\n\r\nimport { baseUrl, fetchItems } from './util';\r\n\r\nexport const handler = async (ctx: Context): Promise<Data> => {\r\n    const { time = '24h', country = 'us' } = ctx.req.param();\r\n    const limit: number = Number.parseInt(ctx.req.query('limit') ?? '30', 10);\r\n\r\n    const targetUrl: string = new URL('mostwanted/', baseUrl).href;\r\n\r\n    const response = await ofetch(targetUrl, {\r\n        headers: {\r\n            Cookie: `countryId=${country};`,\r\n        },\r\n    });\r\n    const $: CheerioAPI = load(response);\r\n    const language = $('html').attr('lang') ?? 'en';\r\n    const selector: string = time ? `div[id$=\"-${time}\"] div.card-panel` : 'div.card-panel';\r\n\r\n    const items: DataItem[] = await fetchItems($, selector, targetUrl, country, limit);\r\n\r\n    const title: string = $('title').text();\r\n    const tabTitle: string = $(`ul.tabs li.tab a[href$=\"-${time}\"]`).text();\r\n\r\n    return {\r\n        title: `${title}${tabTitle ? ` - ${tabTitle}` : ''}`,\r\n        description: $('meta[name=\"description\"]').attr('content'),\r\n        link: targetUrl,\r\n        item: items,\r\n        allowEmpty: true,\r\n        image: $('a.brand-logo img').attr('src') ? new URL($('a.brand-logo img').attr('src') as string, baseUrl).href : undefined,\r\n        author: title.split(/\\|/).pop(),\r\n        language,\r\n        id: targetUrl,\r\n    };\r\n};\r\n\r\nexport const route: Route = {\r\n    path: '/mostwanted/:time?/:country?',\r\n    name: 'Watchlist Charts',\r\n    url: 'app-sales.net',\r\n    maintainers: ['nczitzk'],\r\n    handler,\r\n    example: '/app-sales/mostwanted',\r\n    parameters: {\r\n        time: {\r\n            description: 'Time, `24h` as Last 24h by default',\r\n            options: [\r\n                {\r\n                    label: 'Last 24h',\r\n                    value: '24h',\r\n                },\r\n                {\r\n                    label: 'Last Week',\r\n                    value: 'week',\r\n                },\r\n                {\r\n                    label: 'All Time',\r\n                    value: 'alltime',\r\n                },\r\n            ],\r\n        },\r\n        country: {\r\n            description: 'Country ID, `us` as United States by default',\r\n            options: [\r\n                {\r\n                    label: 'United States',\r\n                    value: 'us',\r\n                },\r\n                {\r\n                    label: 'Austria',\r\n                    value: 'at',\r\n                },\r\n                {\r\n                    label: 'Australia',\r\n                    value: 'au',\r\n                },\r\n                {\r\n                    label: 'Brazil',\r\n                    value: 'br',\r\n                },\r\n                {\r\n                    label: 'Canada',\r\n                    value: 'ca',\r\n                },\r\n                {\r\n                    label: 'France',\r\n                    value: 'fr',\r\n                },\r\n                {\r\n                    label: 'Germany',\r\n                    value: 'de',\r\n                },\r\n                {\r\n                    label: 'India',\r\n                    value: 'in',\r\n                },\r\n                {\r\n                    label: 'Italy',\r\n                    value: 'it',\r\n                },\r\n                {\r\n                    label: 'Netherlands',\r\n                    value: 'nl',\r\n                },\r\n                {\r\n                    label: 'Poland',\r\n                    value: 'pl',\r\n                },\r\n                {\r\n                    label: 'Russia',\r\n                    value: 'ru',\r\n                },\r\n                {\r\n                    label: 'Spain',\r\n                    value: 'es',\r\n                },\r\n                {\r\n                    label: 'Sweden',\r\n                    value: 'se',\r\n                },\r\n                {\r\n                    label: 'Great Britain',\r\n                    value: 'gb',\r\n                },\r\n            ],\r\n        },\r\n    },\r\n    description: `\r\n| Last 24h | Last Week | All Time |\r\n| -------- | --------- | -------- |\r\n| 24h      | week      | alltime  |\r\n\r\n<details>\r\n  <summary>More countries</summary>\r\n\r\n| Currency | Country       | ID  |\r\n| -------- | ------------- | --- |\r\n| USD      | United States | us  |\r\n| EUR      | Austria       | at  |\r\n| AUD      | Australia     | au  |\r\n| BRL      | Brazil        | br  |\r\n| CAD      | Canada        | ca  |\r\n| EUR      | France        | fr  |\r\n| EUR      | Germany       | de  |\r\n| INR      | India         | in  |\r\n| EUR      | Italy         | it  |\r\n| EUR      | Netherlands   | nl  |\r\n| PLN      | Poland        | pl  |\r\n| RUB      | Russia        | ru  |\r\n| EUR      | Spain         | es  |\r\n| SEK      | Sweden        | se  |\r\n| GBP      | Great Britain | gb  |\r\n\r\n</details>\r\n`,\r\n    categories: ['program-update'],\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportRadar: true,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['app-sales.net/mostwanted'],\r\n            target: '/mostwanted',\r\n        },\r\n        {\r\n            title: 'Watchlist Charts - Last 24h',\r\n            source: ['app-sales.net/mostwanted'],\r\n            target: '/mostwanted/24h',\r\n        },\r\n        {\r\n            title: 'Watchlist Charts - Last Week',\r\n            source: ['app-sales.net/mostwanted'],\r\n            target: '/mostwanted/week',\r\n        },\r\n        {\r\n            title: 'Watchlist Charts - All Time',\r\n            source: ['app-sales.net/mostwanted'],\r\n            target: '/mostwanted/alltime',\r\n        },\r\n    ],\r\n    view: ViewType.Articles,\r\n};\r\n"],"mappings":"mVASA,MAAa,EAAU,KAAO,IAAgC,CAC1D,GAAM,CAAE,OAAO,MAAO,UAAU,MAAS,EAAI,IAAI,QAC3CA,EAAgB,OAAO,SAAS,EAAI,IAAI,MAAM,UAAY,KAAM,IAEhEC,EAAoB,IAAI,IAAI,cAAe,GAAS,KAEpD,EAAW,MAAMC,EAAO,EAAW,CACrC,QAAS,CACL,OAAQ,aAAa,EAAQ,MAG/BC,EAAgB,EAAK,GACrB,EAAW,EAAE,QAAQ,KAAK,SAAW,KACrCC,EAAmB,EAAO,aAAa,EAAK,mBAAqB,iBAEjEC,EAAoB,MAAM,EAAW,EAAG,EAAU,EAAW,EAAS,GAEtEC,EAAgB,EAAE,SAAS,OAC3BC,EAAmB,EAAE,4BAA4B,EAAK,KAAK,OAEjE,MAAO,CACH,MAAO,GAAG,IAAQ,EAAW,MAAM,IAAa,KAChD,YAAa,EAAE,4BAA4B,KAAK,WAChD,KAAM,EACN,KAAM,EACN,WAAY,GACZ,MAAO,EAAE,oBAAoB,KAAK,OAAS,IAAI,IAAI,EAAE,oBAAoB,KAAK,OAAkB,GAAS,KAAO,IAAA,GAChH,OAAQ,EAAM,MAAM,MAAM,MAC1B,WACA,GAAI,IAICC,EAAe,CACxB,KAAM,+BACN,KAAM,mBACN,IAAK,gBACL,YAAa,CAAC,WACd,UACA,QAAS,wBACT,WAAY,CACR,KAAM,CACF,YAAa,qCACb,QAAS,CACL,CACI,MAAO,WACP,MAAO,OAEX,CACI,MAAO,YACP,MAAO,QAEX,CACI,MAAO,WACP,MAAO,aAInB,QAAS,CACL,YAAa,+CACb,QAAS,CACL,CACI,MAAO,gBACP,MAAO,MAEX,CACI,MAAO,UACP,MAAO,MAEX,CACI,MAAO,YACP,MAAO,MAEX,CACI,MAAO,SACP,MAAO,MAEX,CACI,MAAO,SACP,MAAO,MAEX,CACI,MAAO,SACP,MAAO,MAEX,CACI,MAAO,UACP,MAAO,MAEX,CACI,MAAO,QACP,MAAO,MAEX,CACI,MAAO,QACP,MAAO,MAEX,CACI,MAAO,cACP,MAAO,MAEX,CACI,MAAO,SACP,MAAO,MAEX,CACI,MAAO,SACP,MAAO,MAEX,CACI,MAAO,QACP,MAAO,MAEX,CACI,MAAO,SACP,MAAO,MAEX,CACI,MAAO,gBACP,MAAO,SAKvB,YAAa;;;;;;;;;;;;;;;;;;;;;;;;;;;EA4Bb,WAAY,CAAC,kBACb,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,aAAc,GACd,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,4BACT,OAAQ,eAEZ,CACI,MAAO,8BACP,OAAQ,CAAC,4BACT,OAAQ,mBAEZ,CACI,MAAO,+BACP,OAAQ,CAAC,4BACT,OAAQ,oBAEZ,CACI,MAAO,8BACP,OAAQ,CAAC,4BACT,OAAQ,wBAGhB,KAAM,EAAS"}