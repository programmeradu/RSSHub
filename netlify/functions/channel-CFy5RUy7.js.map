{"version":3,"file":"channel-CFy5RUy7.js","names":["route: Route","got","utils"],"sources":["../../lib/routes/thepaper/channel.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport utils from './utils';\r\nimport { load } from 'cheerio';\r\nimport got from '@/utils/got';\r\n\r\nexport const route: Route = {\r\n    path: '/channel/:id',\r\n    categories: ['new-media'],\r\n    example: '/thepaper/channel/25950',\r\n    parameters: { id: '频道 id，可在频道页 URL 中找到' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    name: '频道',\r\n    maintainers: ['xyqfer', 'nczitzk', 'bigfei'],\r\n    handler,\r\n    description: `| 频道 ID | 频道名 |\r\n| ------- | ------ |\r\n| 26916   | 视频   |\r\n| 108856  | 战疫   |\r\n| 25950   | 时事   |\r\n| 25951   | 财经   |\r\n| 36079   | 澎湃号 |\r\n| 119908  | 科技   |\r\n| 25952   | 思想   |\r\n| 119489  | 智库   |\r\n| 25953   | 生活   |\r\n| 26161   | 问吧   |\r\n| 122908  | 国际   |\r\n| -21     | 体育   |\r\n| -24     | 评论   |`,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const id = ctx.req.param('id');\r\n    const channel_url = `https://m.thepaper.cn/channel/${id}`;\r\n    const channel_url_resp = await got(channel_url);\r\n    const channel_url_data = JSON.parse(load(channel_url_resp.data)('#__NEXT_DATA__').html());\r\n\r\n    const resp = await got.post('https://api.thepaper.cn/contentapi/nodeCont/getByChannelId', {\r\n        json: {\r\n            channelId: id,\r\n        },\r\n    });\r\n    const list = resp.data.data.list;\r\n\r\n    const items = await Promise.all(list.map((item) => utils.ProcessItem(item, ctx)));\r\n    return {\r\n        title: `澎湃新闻频道 - ${utils.ChannelIdToName(id, channel_url_data)}`,\r\n        link: channel_url,\r\n        item: items,\r\n        itunes_author: '澎湃新闻',\r\n        image: utils.ExtractLogo(channel_url_resp),\r\n    };\r\n}\r\n"],"mappings":"6YAKA,MAAaA,EAAe,CACxB,KAAM,eACN,WAAY,CAAC,aACb,QAAS,0BACT,WAAY,CAAE,GAAI,uBAClB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,KAAM,KACN,YAAa,CAAC,SAAU,UAAW,UACnC,UACA,YAAa;;;;;;;;;;;;;;qBAiBjB,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAK,EAAI,IAAI,MAAM,MACnB,EAAc,iCAAiC,IAC/C,EAAmB,MAAMC,EAAI,GAC7B,EAAmB,KAAK,MAAM,EAAK,EAAiB,MAAM,kBAAkB,QAE5E,EAAO,MAAMA,EAAI,KAAK,6DAA8D,CACtF,KAAM,CACF,UAAW,KAGb,EAAO,EAAK,KAAK,KAAK,KAEtB,EAAQ,MAAM,QAAQ,IAAI,EAAK,IAAK,GAASC,EAAM,YAAY,EAAM,KAC3E,MAAO,CACH,MAAO,YAAYA,EAAM,gBAAgB,EAAI,KAC7C,KAAM,EACN,KAAM,EACN,cAAe,OACf,MAAOA,EAAM,YAAY"}