import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import{config as n}from"./config-Dl8a1sIg.js";import{cache_default as r}from"./cache-kimkMTWJ.js";import{art as i}from"./render-CxhTJIsl.js";import{ofetch_default as a}from"./ofetch-Bzt0BXUH.js";import{got_default as o}from"./got-CdvI2yKX.js";import s from"node:path";import{load as c}from"cheerio";t();const l=new URL(`https://openai.com`),u=async e=>{let t=await a(e),n=c(t),r=n(`#main article`),i=n(`h1`).prev().find(`a[href]`).toArray().map(e=>n(e).text());return n(r.find(`h1`).parents().get(4)).remove(),r.children().last().remove(),r.find(`#citations`).remove(),{content:r.html()??void 0,categories:i,image:n(`meta[property="og:image"]`).attr(`content`)}},d=async e=>{let t=await a(`https://openai.com/news/rss.xml`,{responseType:`text`,headers:{"User-Agent":n.ua}}),i=c(t,{xml:!0});return Promise.all(i(`item`).toArray().slice(0,e).map(e=>{let t=i(e).find(`guid`).text();return r.tryGet(`openai:news:${t}`,async()=>{let n=i(e).find(`title`).text(),r=i(e).find(`pubDate`).text(),a=i(e).find(`link`).text(),{content:o,categories:s}=await u(a);return{guid:t,title:n,link:a,pubDate:r,description:o,category:s}})}))},f=async()=>{let e=await o({method:`get`,url:`https://openai.com/blog`}),t=e.data.toString().match(/(?<=TWILL_API_BASE:").+?(?=")/)[0].replaceAll(String.raw`\u002F`,`/`);return new URL(t)},p=(t,n,a)=>r.tryGet(a.slug,async()=>{let t=`${n}/${a.slug}`,r=await o({method:`get`,url:t}),l=c(r.data),u=l(`[aria-labelledby="metaAuthorsHeading"] > li > a > span > span`).toArray().map(e=>l(e).text()).join(`, `),d=l(`*`).contents().filter(function(){return this.nodeType===8});d.remove(),l=l(`#content`);let f=a.seo.ogImageSrc,p=a.seo.ogImageAlt,m=i(s.join(e,`templates/article-12ffab87.art`),{content:l,imageSrc:f,imageAlt:p});return a.tags=a.tags||[],{title:a.title,author:u,description:m,pubDate:a.createdAt,category:a.tags.map(e=>e.title),link:t}});export{l as BASE_URL,d as fetchArticles,f as getApiUrl,p as parseArticle};
//# sourceMappingURL=common-Dtbc3bt2.js.map