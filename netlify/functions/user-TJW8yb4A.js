import"./esm-shims-Dqvxr0BZ.js";import{config as e}from"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./proxy-D7ccvALx.js";import"./dist-IvUHtNe1.js";import{cache_default as t}from"./cache-kimkMTWJ.js";import"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{ViewType as n}from"./types-A5bA50Mg.js";import{invalid_parameter_default as r}from"./invalid-parameter-CUJdROXf.js";import"./puppeteer-f0D6AISB.js";import{fallback as i,queryToBoolean as a}from"./readable-social-D7TWDGpz.js";import"./captcha-D9zPeElr.js";import{getUser as o,getUserWithCookie as s,renderNotesFulltext as c}from"./util-BUhLyohA.js";import l from"node:querystring";const u={path:`/user/:user_id/:category/:routeParams?`,name:`用户笔记/收藏`,categories:[`social-media`],view:n.Articles,maintainers:[`lotosbin`,`howerhe`,`rien7`,`dddaniel1`,`pseudoyu`],handler:d,radar:[{source:[`xiaohongshu.com/user/profile/:user_id`],target:`/user/:user_id/notes`}],example:`/xiaohongshu/user/593032945e87e77791e03696/notes`,features:{antiCrawler:!0,requirePuppeteer:!0,requireConfig:[{name:`XIAOHONGSHU_COOKIE`,optional:!0,description:`小红书 cookie 值，可在网络里面看到。`}]},parameters:{user_id:`user id, length 24 characters`,category:{description:`category, notes or collect`,options:[{value:`notes`,label:`notes`},{value:`collect`,label:`collect`}],default:`notes`},routeParams:{description:"displayLivePhoto,`/user/:user_id/notes/displayLivePhoto=0`,不限时LivePhoto显示为图片,`/user/:user_id/notes/displayLivePhoto=1`,取值不为0时LivePhoto显示为视频",default:`0`}}};async function d(t){let n=t.req.param(`user_id`),r=t.req.param(`category`),o=l.parse(t.req.param(`routeParams`)),u=!!i(void 0,a(o.displayLivePhoto),!1),d=`https://www.xiaohongshu.com/user/profile/${n}`,p=e.xiaohongshu.cookie;if(p&&r===`notes`)try{let e=await s(d),t=await c(e.notes,`https://www.xiaohongshu.com/explore`,u);return{title:`${e.userPageData.basicInfo.nickname} - 笔记 • 小红书 / RED`,description:e.userPageData.basicInfo.desc,image:e.userPageData.basicInfo.imageb||e.userPageData.basicInfo.images,link:d,item:t}}catch{return await f(d,r)}else return await f(d,r)}async function f(e,n){let{userPageData:{basicInfo:i,interactions:a,tags:s},notes:c,collect:l}=await o(e,t),u=`${i.nickname} - 小红书${n===`notes`?`笔记`:`收藏`}`,d=`${i.desc} ${s.map(e=>e.name).join(` `)} ${a.map(e=>`${e.count} ${e.name}`).join(` `)}`,f=i.imageb||i.images,p=t=>t.flatMap(t=>t.map(({id:t,noteCard:n})=>({title:n.displayTitle,link:new URL(n.noteId||t,e).toString(),guid:n.displayTitle,description:`<img src ="${n.cover.infoList.pop().url}"><br>${n.displayTitle}`,author:n.user.nickname,upvotes:n.interactInfo.likedCount}))),m=t=>{if(!t)throw new r(`该用户已设置收藏内容不可见`);if(t.code!==0)throw Error(JSON.stringify(t));if(!t.data.notes.length)throw new r(`该用户已设置收藏内容不可见`);return t.data.notes.map(t=>({title:t.display_title,link:`${e}/${t.note_id}`,description:`<img src ="${t.cover.info_list.pop().url}"><br>${t.display_title}`,author:t.user.nickname,upvotes:t.interact_info.likedCount}))};return{title:u,description:d,image:f,link:e,item:n===`notes`?p(c):m(l)}}export{u as route};
//# sourceMappingURL=user-TJW8yb4A.js.map