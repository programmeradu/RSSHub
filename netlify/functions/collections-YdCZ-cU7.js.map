{"version":3,"file":"collections-YdCZ-cU7.js","names":["route: Route","ofetch"],"sources":["../../lib/routes/juejin/collections.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport ofetch from '@/utils/ofetch';\r\nimport { getCollection, parseList, ProcessFeed } from './utils';\r\nimport { Article } from './types';\r\n\r\nexport const route: Route = {\r\n    path: '/collections/:userId',\r\n    categories: ['programming'],\r\n    example: '/juejin/collections/1697301682482439',\r\n    parameters: { userId: '用户唯一标志符, 在浏览器地址栏URL中能够找到' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['juejin.cn/user/:id', 'juejin.cn/user/:id/collections'],\r\n            target: '/collections/:id',\r\n        },\r\n    ],\r\n    name: '收藏集',\r\n    maintainers: ['yang131323'],\r\n    handler,\r\n};\r\n\r\n// 获取所有收藏夹文章内容\r\nasync function getArticleList(collectionId) {\r\n    const collectPage = await getCollection(collectionId);\r\n\r\n    return collectPage.article_list;\r\n}\r\n\r\nasync function handler(ctx) {\r\n    const userId = ctx.req.param('userId');\r\n    const response = await ofetch(`https://api.juejin.cn/interact_api/v1/collectionSet/list?user_id=${userId}&cursor=0&limit=20`);\r\n\r\n    // 获取用户所有收藏夹id\r\n    const collectionId = response.data.map((item) => item.tag_id);\r\n\r\n    const temp = (await Promise.all(collectionId.map((id) => getArticleList(id)))) as Article[][];\r\n    const posts = temp.flat().filter(Boolean);\r\n    const list = parseList(posts);\r\n\r\n    const result = await ProcessFeed(list);\r\n\r\n    return {\r\n        title: '掘金 - 收藏集',\r\n        link: `https://juejin.im/user/${userId}/collections`,\r\n        description: '掘金，指定用户整个收藏集',\r\n        item: result,\r\n        allowEmpty: true,\r\n    };\r\n}\r\n"],"mappings":"4TAKA,MAAaA,EAAe,CACxB,KAAM,uBACN,WAAY,CAAC,eACb,QAAS,uCACT,WAAY,CAAE,OAAQ,4BACtB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,qBAAsB,kCAC/B,OAAQ,qBAGhB,KAAM,MACN,YAAa,CAAC,cACd,WAIJ,eAAe,EAAe,EAAc,CACxC,IAAM,EAAc,MAAM,EAAc,GAExC,OAAO,EAAY,aAGvB,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAS,EAAI,IAAI,MAAM,UACvB,EAAW,MAAMC,EAAO,oEAAoE,EAAO,qBAGnG,EAAe,EAAS,KAAK,IAAK,GAAS,EAAK,QAEhD,EAAQ,MAAM,QAAQ,IAAI,EAAa,IAAK,GAAO,EAAe,KAClE,EAAQ,EAAK,OAAO,OAAO,SAC3B,EAAO,EAAU,GAEjB,EAAS,MAAM,EAAY,GAEjC,MAAO,CACH,MAAO,WACP,KAAM,0BAA0B,EAAO,cACvC,YAAa,eACb,KAAM,EACN,WAAY"}