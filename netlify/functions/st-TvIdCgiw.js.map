{"version":3,"file":"st-TvIdCgiw.js","names":["route: Route","got","cache"],"sources":["../../lib/routes/playno1/st.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport cache from '@/utils/cache';\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport timezone from '@/utils/timezone';\r\nimport { cookieJar, processArticle } from './utils';\r\nconst baseUrl = 'http://stno1.playno1.com';\r\n\r\nexport const route: Route = {\r\n    path: '/st/:catid?',\r\n    categories: ['bbs'],\r\n    example: '/playno1/st',\r\n    parameters: { catid: '分类，见下表，默认为全部文章' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['stno1.playno1.com/stno1/:catid/'],\r\n            target: '/st/:catid',\r\n        },\r\n    ],\r\n    name: '情趣',\r\n    maintainers: ['TonyRL'],\r\n    handler,\r\n    description: `| 全部文章 | 情趣體驗報告 | 情趣新聞 | 情趣研究所 |\r\n| -------- | ------------ | -------- | ---------- |\r\n| all      | experience   | news     | graduate   |`,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const { catid = 'all' } = ctx.req.param();\r\n    const url = `${baseUrl}/stno1/${catid}/`;\r\n    const response = await got(url, {\r\n        cookieJar,\r\n    });\r\n    const $ = load(response.data);\r\n\r\n    let items = $('.fallsBox')\r\n        .toArray()\r\n        .map((item) => {\r\n            item = $(item);\r\n            return {\r\n                title: item.find('.ftitle a').attr('title'),\r\n                link: item.find('.ftitle a').attr('href'),\r\n                pubDate: timezone(parseDate(item.find('.dateBox').text(), 'YYYY-MM-DD HH:mm'), 8),\r\n                author: item.find('.dateBox span a').eq(0).text().trim(),\r\n            };\r\n        });\r\n\r\n    items = await processArticle(items, cache);\r\n\r\n    return {\r\n        title: $('head title').text(),\r\n        link: url,\r\n        item: items,\r\n        language: 'zh-TW',\r\n    };\r\n}\r\n"],"mappings":"8dAOA,MAEaA,EAAe,CACxB,KAAM,cACN,WAAY,CAAC,OACb,QAAS,cACT,WAAY,CAAE,MAAO,kBACrB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,mCACT,OAAQ,eAGhB,KAAM,KACN,YAAa,CAAC,UACd,UACA,YAAa;;sDAKjB,eAAe,EAAQ,EAAK,CACxB,GAAM,CAAE,QAAQ,OAAU,EAAI,IAAI,QAC5B,EAAM,kCAAoB,EAAM,GAChC,EAAW,MAAMC,EAAI,EAAK,CAC5B,cAEE,EAAI,EAAK,EAAS,MAEpB,EAAQ,EAAE,aACT,UACA,IAAK,IACF,EAAO,EAAE,GACF,CACH,MAAO,EAAK,KAAK,aAAa,KAAK,SACnC,KAAM,EAAK,KAAK,aAAa,KAAK,QAClC,QAAS,EAAS,EAAU,EAAK,KAAK,YAAY,OAAQ,oBAAqB,GAC/E,OAAQ,EAAK,KAAK,mBAAmB,GAAG,GAAG,OAAO,UAM9D,MAFA,GAAQ,MAAM,EAAe,EAAOC,GAE7B,CACH,MAAO,EAAE,cAAc,OACvB,KAAM,EACN,KAAM,EACN,SAAU"}