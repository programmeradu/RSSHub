{"version":3,"file":"jobs-1OPaTVhK.js","names":[],"sources":["../../lib/routes/lmu/jobs.ts"],"sourcesContent":["import { Route } from '@/types';\r\n\r\nimport got from '@/utils/got';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport { art } from '@/utils/render';\r\nimport path from 'node:path';\r\n\r\nconst apiUrl = 'https://jobs.b-ite.com/api/v1/postings/search';\r\n\r\n// 辅助函数：根据 value 查找对应的 label\r\nfunction findLabel(value: string, options: Array<{ value: string; label: string }>): string {\r\n    const option = options.find((option) => option.value === value);\r\n    return option?.label ?? value; // 如果找不到匹配项，返回 value 本身\r\n}\r\n\r\nasync function handler() {\r\n    const { data: response } = await got.post(apiUrl, {\r\n        json: {\r\n            key: '7d4ebad4ecdfd3e99a89596c85c5e4be21cd9c12',\r\n            channel: 0,\r\n            locale: 'en',\r\n            sort: {\r\n                by: 'custom.bereich',\r\n                order: 'asc',\r\n            },\r\n            origin: 'https://www.lmu.de/en/about-lmu/working-at-lmu/job-portal/academic-staff/',\r\n            page: {\r\n                offset: 0,\r\n                num: 1000,\r\n            },\r\n            filter: {\r\n                locale: {\r\n                    in: ['en'],\r\n                },\r\n                'custom.beschaeftigtengruppe': {\r\n                    in: ['02_wiss'],\r\n                },\r\n            },\r\n        },\r\n        headers: {\r\n            'content-type': 'application/json',\r\n            'bite-jobsapi-client': 'v5-20230925-9df79de',\r\n        },\r\n    });\r\n\r\n    const jobPostings = response.jobPostings;\r\n    const bereichOptions = response.fields['custom.bereich'].options;\r\n    const verguetungOptions = response.fields['custom.verguetung'].options;\r\n\r\n    const items = jobPostings.map((job) => {\r\n        const pubDate = parseDate(job.createdOn, 'YYYY-MM-DDTHH:mm:ssZ');\r\n\r\n        // 获取 Institution 的 label\r\n        const institutionLabel = findLabel(job.custom.bereich, bereichOptions);\r\n        const RemunerationGroupLabel = findLabel(job.custom.verguetung, verguetungOptions);\r\n\r\n        // 渲染模板\r\n        const description = art(path.join(__dirname, 'templates/jobPosting.art'), {\r\n            institutionLabel,\r\n            RemunerationGroupLabel,\r\n            job,\r\n        });\r\n\r\n        return {\r\n            title: job.title,\r\n            link: job.url,\r\n            description,\r\n            pubDate,\r\n        };\r\n    });\r\n\r\n    return {\r\n        title: 'LMU Academic Staff Job Openings',\r\n        link: 'https://www.lmu.de/en/about-lmu/working-at-lmu/job-portal/academic-staff/',\r\n        item: items,\r\n    };\r\n}\r\n\r\nexport const route: Route = {\r\n    path: '/jobs',\r\n    name: 'Job Openings',\r\n    url: 'lmu.de',\r\n    example: '/lmu/jobs',\r\n    maintainers: ['StarDxxx'],\r\n    categories: ['university', 'study'],\r\n    radar: [\r\n        {\r\n            source: ['www.lmu.de/en/about-lmu/working-at-lmu/job-portal/academic-staff/'],\r\n            target: '/lmu/jobs',\r\n        },\r\n    ],\r\n    description: 'RSS feed for LMU academic staff job openings.',\r\n    handler,\r\n};\r\n"],"mappings":"qYAUA,SAAS,EAAU,EAAe,EAA0D,CACxF,IAAM,EAAS,EAAQ,KAAM,GAAW,EAAO,QAAU,GACzD,OAAO,GAAQ,OAAS,EAG5B,eAAe,GAAU,CACrB,GAAM,CAAE,KAAM,GAAa,MAAM,EAAI,KAAK,gDAAQ,CAC9C,KAAM,CACF,IAAK,2CACL,QAAS,EACT,OAAQ,KACR,KAAM,CACF,GAAI,iBACJ,MAAO,OAEX,OAAQ,4EACR,KAAM,CACF,OAAQ,EACR,IAAK,KAET,OAAQ,CACJ,OAAQ,CACJ,GAAI,CAAC,OAET,8BAA+B,CAC3B,GAAI,CAAC,cAIjB,QAAS,CACL,eAAgB,mBAChB,sBAAuB,yBAIzB,EAAc,EAAS,YACvB,EAAiB,EAAS,OAAO,kBAAkB,QACnD,EAAoB,EAAS,OAAO,qBAAqB,QAEzD,EAAQ,EAAY,IAAK,GAAQ,CACnC,IAAM,EAAU,EAAU,EAAI,UAAW,wBAGnC,EAAmB,EAAU,EAAI,OAAO,QAAS,GACjD,EAAyB,EAAU,EAAI,OAAO,WAAY,GAG1D,EAAc,EAAI,EAAA,KAAA,EAAA,qCAAkD,CACtE,mBACA,yBACA,QAGJ,MAAO,CACH,MAAO,EAAI,MACX,KAAM,EAAI,IACV,cACA,aAIR,MAAO,CACH,MAAO,kCACP,KAAM,4EACN,KAAM,GAId,MAAa,EAAe,CACxB,KAAM,QACN,KAAM,eACN,IAAK,SACL,QAAS,YACT,YAAa,CAAC,YACd,WAAY,CAAC,aAAc,SAC3B,MAAO,CACH,CACI,OAAQ,CAAC,qEACT,OAAQ,cAGhB,YAAa,gDACb"}