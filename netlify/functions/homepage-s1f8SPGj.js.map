{"version":3,"file":"homepage-s1f8SPGj.js","names":["route: Route","ofetch"],"sources":["../../lib/routes/deepin/homepage.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport ofetch from '@/utils/ofetch';\r\nimport { parseDate } from '@/utils/parse-date';\r\n\r\nexport const route: Route = {\r\n    path: '/homepage/:user_id',\r\n    categories: ['bbs'],\r\n    example: '/deepin/homepage/78326',\r\n    parameters: { user_id: 'user id' },\r\n    name: 'BBS Home Page',\r\n    maintainers: ['tensor-tech'],\r\n    radar: [\r\n        {\r\n            source: ['bbs.deepin.org/user/:user_id'],\r\n            target: '/homepage/:user_id',\r\n        },\r\n    ],\r\n    handler,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const { user_id } = ctx.req.param();\r\n    const res = await ofetch(`https://bbs.deepin.org/api/v1/user/thread?date_type=0&limit=10&offset=0&user_id=${user_id}`, {\r\n        headers: {\r\n            accept: 'application/json',\r\n        },\r\n    });\r\n\r\n    const items = res.data.map((item) => ({\r\n        title: item.subject,\r\n        link: `https://bbs.deepin.org/post/${item.id}`,\r\n        description: item.post.message,\r\n        pubDate: parseDate(item.created_at),\r\n        author: item.user.nickname,\r\n        category: item.forum.name,\r\n    }));\r\n\r\n    return {\r\n        title: `${items[0].author}/deepin论坛主页`,\r\n        link: `https://bbs.deepin.org/user/${user_id}`,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"gOAIA,MAAaA,EAAe,CACxB,KAAM,qBACN,WAAY,CAAC,OACb,QAAS,yBACT,WAAY,CAAE,QAAS,WACvB,KAAM,gBACN,YAAa,CAAC,eACd,MAAO,CACH,CACI,OAAQ,CAAC,gCACT,OAAQ,uBAGhB,WAGJ,eAAe,EAAQ,EAAK,CACxB,GAAM,CAAE,WAAY,EAAI,IAAI,QACtB,EAAM,MAAMC,EAAO,mFAAmF,IAAW,CACnH,QAAS,CACL,OAAQ,sBAIV,EAAQ,EAAI,KAAK,IAAK,IAAU,CAClC,MAAO,EAAK,QACZ,KAAM,+BAA+B,EAAK,KAC1C,YAAa,EAAK,KAAK,QACvB,QAAS,EAAU,EAAK,YACxB,OAAQ,EAAK,KAAK,SAClB,SAAU,EAAK,MAAM,QAGzB,MAAO,CACH,MAAO,GAAG,EAAM,GAAG,OAAO,aAC1B,KAAM,+BAA+B,IACrC,KAAM"}