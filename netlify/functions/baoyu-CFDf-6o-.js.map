{"version":3,"file":"baoyu-CFDf-6o-.js","names":["route: Route","parser","cache","got"],"sources":["../../lib/routes/baoyu/index.ts"],"sourcesContent":["import { Route, DataItem } from '@/types';\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport parser from '@/utils/rss-parser';\r\nimport cache from '@/utils/cache';\r\n\r\nexport const route: Route = {\r\n    path: '/blog',\r\n    categories: ['blog'],\r\n    example: '/baoyu/blog',\r\n    radar: [\r\n        {\r\n            source: ['baoyu.io/'],\r\n        },\r\n    ],\r\n    url: 'baoyu.io/',\r\n    name: 'Blog',\r\n    maintainers: ['liyaozhong'],\r\n    handler,\r\n    description: '宝玉 - 博客文章',\r\n};\r\n\r\nasync function handler() {\r\n    const rootUrl = 'https://baoyu.io';\r\n    const feedUrl = `${rootUrl}/feed.xml`;\r\n\r\n    const feed = await parser.parseURL(feedUrl);\r\n\r\n    const items = await Promise.all(\r\n        feed.items.map((item) => {\r\n            const link = item.link;\r\n\r\n            return cache.tryGet(link as string, async () => {\r\n                const response = await got(link);\r\n                const $ = load(response.data);\r\n\r\n                const container = $('.container');\r\n                const content = container.find('.prose').html() || '';\r\n\r\n                return {\r\n                    title: item.title,\r\n                    description: content,\r\n                    link,\r\n                    pubDate: item.pubDate ? parseDate(item.pubDate) : undefined,\r\n                    author: item.creator || '宝玉',\r\n                } as DataItem;\r\n            });\r\n        })\r\n    );\r\n\r\n    return {\r\n        title: '宝玉的博客',\r\n        link: rootUrl,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"saAOA,MAAaA,EAAe,CACxB,KAAM,QACN,WAAY,CAAC,QACb,QAAS,cACT,MAAO,CACH,CACI,OAAQ,CAAC,eAGjB,IAAK,YACL,KAAM,OACN,YAAa,CAAC,cACd,UACA,YAAa,aAGjB,eAAe,GAAU,CACrB,IAAM,EAAU,mBACV,EAAU,GAAG,EAAQ,WAErB,EAAO,MAAMC,EAAO,SAAS,GAE7B,EAAQ,MAAM,QAAQ,IACxB,EAAK,MAAM,IAAK,GAAS,CACrB,IAAM,EAAO,EAAK,KAElB,OAAOC,EAAM,OAAO,EAAgB,SAAY,CAC5C,IAAM,EAAW,MAAMC,EAAI,GACrB,EAAI,EAAK,EAAS,MAElB,EAAY,EAAE,cACd,EAAU,EAAU,KAAK,UAAU,QAAU,GAEnD,MAAO,CACH,MAAO,EAAK,MACZ,YAAa,EACb,OACA,QAAS,EAAK,QAAU,EAAU,EAAK,SAAW,IAAA,GAClD,OAAQ,EAAK,SAAW,WAMxC,MAAO,CACH,MAAO,QACP,KAAM,EACN,KAAM"}