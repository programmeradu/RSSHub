{"version":3,"file":"weather-C0AHaRDr.js","names":["ofetch","route: Route"],"sources":["../../lib/routes/hko/weather.ts"],"sourcesContent":["import type { Route } from '@/types';\r\nimport ofetch from '@/utils/ofetch';\r\nimport * as cheerio from 'cheerio';\r\nimport { parseDate } from '@/utils/parse-date';\r\n\r\nconst handler = async () => {\r\n    const url = 'http://rss.weather.gov.hk/rss/CurrentWeather.xml';\r\n    const pageUrl = 'https://www.weather.gov.hk/en/wxinfo/currwx/current.htm';\r\n\r\n    const data = await ofetch(url);\r\n    const $ = cheerio.load(data, {\r\n        xmlMode: true,\r\n    });\r\n\r\n    const description = $('item').first().find('description');\r\n\r\n    const $$ = cheerio.load(description.text());\r\n\r\n    const items = $$('table tr')\r\n        .toArray()\r\n        .map((item) => {\r\n            const $item = $(item);\r\n            const area = $item.find('td').first().text();\r\n            const degree = $item.find('td').last().text();\r\n\r\n            return {\r\n                title: area,\r\n                description: degree,\r\n                pubDate: parseDate($('pubDate').text()),\r\n                link: pageUrl,\r\n                guid: `${$('guid').text()}#${area}`,\r\n            };\r\n        });\r\n\r\n    return {\r\n        title: 'Current Weather Report',\r\n        description: `provided by the Hong Kong Observatory: ${$('pubDate').text()}`,\r\n        link: pageUrl,\r\n        item: items,\r\n    };\r\n};\r\n\r\nexport const route: Route = {\r\n    path: '/weather',\r\n    radar: [\r\n        {\r\n            source: ['www.weather.gov.hk/en/wxinfo/currwx/current.htm'],\r\n        },\r\n    ],\r\n    name: 'Current Weather Report',\r\n    example: '/hko/weather',\r\n    maintainers: ['calpa'],\r\n    categories: ['forecast'],\r\n    handler,\r\n    url: 'www.weather.gov.hk/en/wxinfo/currwx/current.htm',\r\n};\r\n"],"mappings":"0PAKA,MAAM,EAAU,SAAY,CACxB,IACM,EAAU,0DAEV,EAAO,MAAMA,EAAO,oDACpB,EAAI,EAAQ,KAAK,EAAM,CACzB,QAAS,KAGP,EAAc,EAAE,QAAQ,QAAQ,KAAK,eAErC,EAAK,EAAQ,KAAK,EAAY,QAE9B,EAAQ,EAAG,YACZ,UACA,IAAK,GAAS,CACX,IAAM,EAAQ,EAAE,GACV,EAAO,EAAM,KAAK,MAAM,QAAQ,OAChC,EAAS,EAAM,KAAK,MAAM,OAAO,OAEvC,MAAO,CACH,MAAO,EACP,YAAa,EACb,QAAS,EAAU,EAAE,WAAW,QAChC,KAAM,EACN,KAAM,GAAG,EAAE,QAAQ,OAAO,GAAG,OAIzC,MAAO,CACH,MAAO,yBACP,YAAa,0CAA0C,EAAE,WAAW,SACpE,KAAM,EACN,KAAM,IAIDC,EAAe,CACxB,KAAM,WACN,MAAO,CACH,CACI,OAAQ,CAAC,qDAGjB,KAAM,yBACN,QAAS,eACT,YAAa,CAAC,SACd,WAAY,CAAC,YACb,UACA,IAAK"}