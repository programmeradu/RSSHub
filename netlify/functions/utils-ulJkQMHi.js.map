{"version":3,"file":"utils-ulJkQMHi.js","names":[],"sources":["../../lib/routes/douyin/utils.ts"],"sourcesContent":["import path from 'node:path';\r\n\r\nconst templates = {\r\n    desc: path.join(__dirname, 'templates/desc.art'),\r\n    cover: path.join(__dirname, 'templates/cover.art'),\r\n    embed: path.join(__dirname, 'templates/embed.art'),\r\n    iframe: path.join(__dirname, 'templates/iframe.art'),\r\n};\r\n\r\nconst resolveUrl = (url, tls = true, forceResolve = false) => {\r\n    if (!url) {\r\n        return '';\r\n    }\r\n    if (url.startsWith('//')) {\r\n        return (tls ? 'https:' : 'http:') + url;\r\n    }\r\n    if (forceResolve && !/^https?:\\/\\//.test(url)) {\r\n        return (tls ? 'https://' : 'http://') + url;\r\n    }\r\n    return url;\r\n};\r\n\r\nconst proxyVideo = (url, proxy) => {\r\n    if (!(url && proxy)) {\r\n        return url + '';\r\n    }\r\n    if (proxy.includes('?')) {\r\n        if (!proxy.endsWith('=')) {\r\n            proxy += '=';\r\n        }\r\n        return proxy + encodeURIComponent(url);\r\n    } else {\r\n        if (!proxy.endsWith('/')) {\r\n            proxy += '/';\r\n        }\r\n        return proxy + url;\r\n    }\r\n};\r\n\r\nconst getOriginAvatar = (url) =>\r\n    resolveUrl(url)\r\n        .replace(/^(.*\\.douyinpic\\.com\\/).*(\\/aweme-avatar\\/)([^?]*)(\\?.*)?$/, '$1origin$2$3')\r\n        .replaceAll(/~\\w+_\\d+x\\d+/g, '');\r\n\r\nexport { templates, resolveUrl, proxyVideo, getOriginAvatar };\r\n"],"mappings":"qGAEA,MAAM,EAAY,CACd,KAAM,EAAA,KAAA,EAAA,+BACN,MAAO,EAAA,KAAA,EAAA,gCACP,MAAO,EAAA,KAAA,EAAA,gCACP,OAAQ,EAAA,KAAA,EAAA,kCAGN,GAAc,EAAK,EAAM,GAAM,EAAe,KAC3C,EAGD,EAAI,WAAW,OACP,EAAM,SAAW,SAAW,EAEpC,GAAgB,CAAC,eAAe,KAAK,IAC7B,EAAM,WAAa,WAAa,EAErC,EARI,GAWT,GAAc,EAAK,IACf,GAAO,EAGT,EAAM,SAAS,MACV,EAAM,SAAS,OAChB,GAAS,KAEN,EAAQ,mBAAmB,KAE7B,EAAM,SAAS,OAChB,GAAS,KAEN,EAAQ,GAXR,EAAM,GAef,EAAmB,GACrB,EAAW,GACN,QAAQ,6DAA8D,gBACtE,WAAW,gBAAiB"}