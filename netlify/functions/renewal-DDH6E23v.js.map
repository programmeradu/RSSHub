{"version":3,"file":"renewal-DDH6E23v.js","names":[],"sources":["../../lib/routes/sse/renewal.ts"],"sourcesContent":["import { Route } from '@/types';\r\n\r\nimport got from '@/utils/got';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport { art } from '@/utils/render';\r\nimport path from 'node:path';\r\nimport dayjs from 'dayjs';\r\nimport localizedFormat from 'dayjs/plugin/localizedFormat.js';\r\nimport 'dayjs/locale/zh-cn.js';\r\ndayjs.extend(localizedFormat);\r\n\r\nconst currStatusName = ['全部', '已受理', '已询问', '通过', '未通过', '提交注册', '补充审核', '注册结果', '中止', '终止'];\r\n\r\nexport const route: Route = {\r\n    path: '/renewal',\r\n    categories: ['finance'],\r\n    example: '/sse/renewal',\r\n    parameters: {},\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['kcb.sse.com.cn/home', 'kcb.sse.com.cn/'],\r\n        },\r\n    ],\r\n    name: '科创板项目动态',\r\n    maintainers: ['Jeason0228'],\r\n    handler,\r\n    url: 'kcb.sse.com.cn/home',\r\n};\r\n\r\nasync function handler() {\r\n    const pageUrl = 'https://kcb.sse.com.cn/renewal/';\r\n    const host = `https://kcb.sse.com.cn`;\r\n\r\n    const response = await got('https://query.sse.com.cn/statusAction.do', {\r\n        searchParams: {\r\n            isPagination: true,\r\n            sqlId: 'SH_XM_LB',\r\n            'pageHelp.pageSize': 20,\r\n            offerType: '',\r\n            commitiResult: '',\r\n            registeResult: '',\r\n            province: '',\r\n            csrcCode: '',\r\n            currStatus: '',\r\n            order: 'updateDate|desc,stockAuditNum|desc',\r\n            keyword: '',\r\n            auditApplyDateBegin: '',\r\n            auditApplyDateEnd: '',\r\n            _: Date.now(),\r\n        },\r\n        headers: {\r\n            Referer: pageUrl,\r\n        },\r\n    });\r\n\r\n    // console.log(response.data.result);\r\n    const items = response.data.result.map((item) => ({\r\n        title: `【${currStatusName[item.currStatus]}】${item.stockAuditName}`,\r\n        description: art(path.resolve(__dirname, 'templates/renewal.art'), {\r\n            item,\r\n            currStatus: currStatusName[item.currStatus],\r\n            updateDate: dayjs(item.updateDate, 'YYYYMMDDHHmmss').locale('zh-cn').format('lll'),\r\n            auditApplyDate: dayjs(item.auditApplyDate, 'YYYYMMDDHHmmss').locale('zh-cn').format('lll'),\r\n        }),\r\n        pubDate: parseDate(item.updateDate, 'YYYYMMDDHHmmss'),\r\n        link: `${host}/renewal/xmxq/index.shtml?auditId=${item.stockAuditNum}`,\r\n        author: item.stockAuditName,\r\n    }));\r\n\r\n    return {\r\n        title: '上海证券交易所 - 科创板项目动态',\r\n        link: pageUrl,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"ueASA,EAAM,OAAO,GAEb,MAAM,EAAiB,CAAC,KAAM,MAAO,MAAO,KAAM,MAAO,OAAQ,OAAQ,OAAQ,KAAM,MAE1E,EAAe,CACxB,KAAM,WACN,WAAY,CAAC,WACb,QAAS,eACT,WAAY,GACZ,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,sBAAuB,qBAGxC,KAAM,UACN,YAAa,CAAC,cACd,UACA,IAAK,uBAGT,eAAe,GAAU,CACrB,IAAM,EAAU,kCAGV,EAAW,MAAM,EAAI,2CAA4C,CACnE,aAAc,CACV,aAAc,GACd,MAAO,WACP,oBAAqB,GACrB,UAAW,GACX,cAAe,GACf,cAAe,GACf,SAAU,GACV,SAAU,GACV,WAAY,GACZ,MAAO,qCACP,QAAS,GACT,oBAAqB,GACrB,kBAAmB,GACnB,EAAG,KAAK,OAEZ,QAAS,CACL,QAAS,KAKX,EAAQ,EAAS,KAAK,OAAO,IAAK,IAAU,CAC9C,MAAO,IAAI,EAAe,EAAK,YAAY,GAAG,EAAK,iBACnD,YAAa,EAAI,EAAA,QAAA,EAAA,kCAAkD,CAC/D,OACA,WAAY,EAAe,EAAK,YAChC,WAAY,EAAM,EAAK,WAAY,kBAAkB,OAAO,SAAS,OAAO,OAC5E,eAAgB,EAAM,EAAK,eAAgB,kBAAkB,OAAO,SAAS,OAAO,SAExF,QAAS,EAAU,EAAK,WAAY,kBACpC,KAAM,2DAA4C,EAAK,gBACvD,OAAQ,EAAK,kBAGjB,MAAO,CACH,MAAO,oBACP,KAAM,EACN,KAAM"}