{"version":3,"file":"audio-Bfv5VANf.js","names":["route: Route","got","title","link"],"sources":["../../lib/routes/bilibili/audio.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport got from '@/utils/got';\r\n\r\nconst audio = 'https://www.bilibili.com/audio/au';\r\n\r\nexport const route: Route = {\r\n    path: '/audio/:id',\r\n    categories: ['social-media'],\r\n    example: '/bilibili/audio/10624',\r\n    parameters: { id: '歌单 id, 可在歌单页 URL 中找到' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    name: '歌单',\r\n    maintainers: ['LogicJake'],\r\n    handler,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const id = Number.parseInt(ctx.req.param('id'));\r\n    const link = `https://www.bilibili.com/audio/am${id}`;\r\n\r\n    const apiMenuUrl = `https://www.bilibili.com/audio/music-service-c/web/menu/info?sid=${id}`;\r\n    const menuResponse = await got.get(apiMenuUrl);\r\n    const menuData = menuResponse.data.data;\r\n    const introduction = menuData.intro;\r\n    const title = menuData.title;\r\n\r\n    const apiUrl = `https://www.bilibili.com/audio/music-service-c/web/song/of-menu?sid=${id}&pn=1&ps=100`;\r\n    const response = await got.get(apiUrl);\r\n    const data = response.data.data.data;\r\n\r\n    const out = data.map((item) => {\r\n        const title = item.title;\r\n        const link = audio + item.statistic.sid;\r\n        const author = item.author;\r\n        const description = item.intro + `<br><img src=\"${item.cover}\">`;\r\n\r\n        const single = {\r\n            title,\r\n            link,\r\n            author,\r\n            pubDate: new Date(item.passtime * 1000).toUTCString(),\r\n            description,\r\n        };\r\n\r\n        return single;\r\n    });\r\n\r\n    return {\r\n        title,\r\n        link,\r\n        description: introduction,\r\n        item: out,\r\n    };\r\n}\r\n"],"mappings":"gOAGA,MAEaA,EAAe,CACxB,KAAM,aACN,WAAY,CAAC,gBACb,QAAS,wBACT,WAAY,CAAE,GAAI,wBAClB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,KAAM,KACN,YAAa,CAAC,aACd,WAGJ,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAK,OAAO,SAAS,EAAI,IAAI,MAAM,OACnC,EAAO,oCAAoC,IAE3C,EAAa,oEAAoE,IACjF,EAAe,MAAMC,EAAI,IAAI,GAC7B,EAAW,EAAa,KAAK,KAC7B,EAAe,EAAS,MACxB,EAAQ,EAAS,MAEjB,EAAS,uEAAuE,EAAG,cACnF,EAAW,MAAMA,EAAI,IAAI,GACzB,EAAO,EAAS,KAAK,KAAK,KAE1B,EAAM,EAAK,IAAK,GAAS,CAC3B,IAAMC,EAAQ,EAAK,MACbC,EAAO,oCAAQ,EAAK,UAAU,IAC9B,EAAS,EAAK,OACd,EAAc,EAAK,MAAQ,iBAAiB,EAAK,MAAM,IAEvD,EAAS,CACX,MAAA,EACA,KAAA,EACA,SACA,QAAS,IAAI,KAAK,EAAK,SAAW,KAAM,cACxC,eAGJ,OAAO,IAGX,MAAO,CACH,QACA,OACA,YAAa,EACb,KAAM"}