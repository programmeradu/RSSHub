import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as n}from"./cache-kimkMTWJ.js";import{art as r}from"./render-CxhTJIsl.js";import{parseDate as i}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as a}from"./got-CdvI2yKX.js";import{timezone as o}from"./timezone-BrNu6iXe.js";import s from"node:path";import{load as c}from"cheerio";t();const l={path:[`/lc_report/:id?`,`/report/:id?`],categories:[`new-media`],example:`/logclub/lc_report`,parameters:{id:`报告 id，见下表，默认为罗戈研究出品`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`报告`,maintainers:[`nczitzk`],handler:u,description:`| 罗戈研究出品 | 物流报告       | 绿色双碳报告          |
| ------------ | -------------- | --------------------- |
| Report       | IndustryReport | GreenDualCarbonReport |`};async function u(t){let{id:l=`Report`}=t.req.param(),u=t.req.query(`limit`)?Number.parseInt(t.req.query(`limit`),10):11,d=`https://www.logclub.com`,f=new URL(`lc_report`,d).href,p=new URL(`front/lc_report/load${l}List`,d).href,{data:m}=await a.post(p,{json:{page:1}}),h=m.list.slice(0,u).map(t=>({title:t.title,link:new URL(`front/lc_report/get_report_info/${t.id}`,d).href,description:r(s.join(e,`templates/description-65888a65.art`),{image:{src:t.img_url?.split(/\?/)[0]??void 0,alt:t.title}}),author:t.author,category:[t.channel_name],guid:`logclub-report-${t.id}`,pubDate:o(i(t.release_time),8)}));h=await Promise.all(h.map(t=>n.tryGet(t.link,async()=>{let{data:n}=await a(t.link),i=c(n);return i(`img`).each((t,n)=>{n=i(n),n.replaceWith(r(s.join(e,`templates/description-65888a65.art`),{image:{src:n.prop(`src`)?.split(/\?/)[0]??void 0,alt:n.prop(`title`)}}))}),t.title=i(`h1`).first().text(),t.description+=r(s.join(e,`templates/description-65888a65.art`),{description:i(`div.article-cont`).html()}),t.author=i(`div.lc-infos a`).toArray().map(e=>i(e).text()).join(`/`),t.category=[...new Set([...t.category??[],...i(`div.article-label-r a.label`).toArray().map(e=>i(e).text())])].filter(Boolean),t})));let{data:g}=await a(f),_=c(g),v=_(`div.this_nav`).text().trim(),y=new URL(_(`link[rel="shortcut icon"]`).prop(`href`),d).href,b=_(`meta[name="keywords"]`).prop(`content`);return{item:h,title:`${_(`title`).text()}${v}`,link:f,description:_(`meta[name="description"]`).prop(`content`),language:`zh`,image:new URL(_(`div.logo_img img`).prop(`src`),d).href,icon:y,logo:y,subtitle:b.replaceAll(`,`,``),author:b.split(/,/)[0]}}export{l as route};
//# sourceMappingURL=report-C11mQkgm.js.map