import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{cache_default as n}from"./cache-kimkMTWJ.js";import{art as r}from"./render-CxhTJIsl.js";import{parseDate as i}from"./parse-date-Bgabdhlb.js";import{ofetch_default as a}from"./ofetch-Bzt0BXUH.js";import{invalid_parameter_default as o}from"./invalid-parameter-CUJdROXf.js";import s from"node:path";import*as c from"cheerio";t();const l=`https://kpmg.com`,u={query:``,filters:{all:[{kpmg_tab_type:[`Insights`]},{kpmg_article_type:[`Article-General`]},{kpmg_template_type:[`article-details-template`,`insights-flexible-template`,`editable-flex-template`,`editable-campaign-template`]}]},result_fields:{kpmg_description:{raw:{}},kpmg_banner_flag:{raw:{}},kpmg_primary_tag:{raw:{}},kpmg_article_date:{raw:{}},kpmg_contact_job_ttl:{raw:{}},kpmg_title:{raw:{}},kpmg_contact_city:{raw:{}},kpmg_event_start_time:{raw:{}},kpmg_article_date_time:{raw:{}},kpmg_tab_type:{raw:{}},kpmg_short_desc:{raw:{}},kpmg_image_alt:{raw:{}},kpmg_url:{raw:{}},kpmg_template_type:{raw:{}},kpmg_image:{raw:{}},kpmg_non_decorative_alt_text:{raw:{}},kpmg_article_readtime:{raw:{}},kpmg_contact_fn:{raw:{}},kpmg_contact_ln:{raw:{}},kpmg_event_type:{raw:{}},kpmg_contact_country:{raw:{}},kpmg_is_rendition_optimized:{raw:{}},kpmg_article_primary_format:{raw:{}},kpmg_article_type:{raw:{}},kpmg_event_startdate:{raw:{}}},page:{size:20,current:1},sort:{kpmg_filter_date:`desc`}},d={en:{title:`Insights - KPMG `,link:`${l}/xx/en/home/insights.html`,api:`${l}/esearch/xx-en`},zh:{title:`洞察 - 毕马威`,link:`${l}/cn/zh/home/insights.html`,api:`${l}/esearch/cn-zh`}},f=t=>r(s.join(e,`templates/description-73cb46f2.art`),t),p=async e=>{let{lang:t=`en`}=e.req.param(),r=d[t];if(!r)throw new o(`Invalid language`);let s=r.link,l=await a(r.api,{method:`POST`,body:u}),p=l.results.map(e=>({title:e.kpmg_title.raw,description:e.kpmg_description.raw,link:e.kpmg_url.raw,pubDate:i(e.kpmg_article_date_time.raw),image:e.kpmg_image.raw,imageAlt:e.kpmg_image_alt?.raw})),m=await Promise.all(p.map(e=>n.tryGet(e.link,async()=>{let t=await a(e.link),n=c.load(t),r=n(`.bodytext-data`).toArray().map(e=>{let t=n(e);return t.find(`.hidden-xs, .sr-only`).remove(),t.parent().html()}).join(``),i=n(`.pdfdetails`).parent().parent().parent();return i.find(`.hidden-xs, .sr-only`).remove(),e.description=f({image:e.image,alt:e.imageAlt,content:r,pdf:i.prop(`outerHTML`)}),e})));return{title:`KPMG Insights`,link:s,item:m}},m={path:`/insights/:lang?`,example:`/kpmg/insights`,parameters:{lang:"Language, either `en` or `zh`"},radar:[{source:[`kpmg.com/xx/en/home/insights.html`],target:`/insights/en`},{source:[`kpmg.com/cn/zh/home/insights.html`],target:`/insights/zh`}],name:`Insights`,maintainers:[`LogicJake`],handler:p,url:`kpmg.com/xx/en/home/insights.html`,zh:{name:`洞察`}};export{m as route};
//# sourceMappingURL=insights-v2VYH1SM.js.map