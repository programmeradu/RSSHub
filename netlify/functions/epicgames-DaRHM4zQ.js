import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{art as n}from"./render-CxhTJIsl.js";import{parseDate as r}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as i}from"./got-CdvI2yKX.js";import{ViewType as a}from"./types-A5bA50Mg.js";import o from"node:path";import s from"dayjs";t();const c={path:`/freegames/:locale?/:country?`,categories:[`game`],view:a.Notifications,example:`/epicgames/freegames/en-US/US`,parameters:{locale:{description:`Locale`,default:`en-US`},country:{description:`Country`,default:`US`}},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`store.epicgames.com/:locale/free-games`],target:`/freegames/:locale`}],name:`Free games`,maintainers:[`DIYgod`,`NeverBehave`,`Zyx-A`,`junfengP`,`nczitzk`,`KotaHv`],handler:l};async function l(t){let a=t.req.param(`locale`)??`en-US`,c=t.req.param(`country`)??`US`,l=`https://store.epicgames.com`,u=`${l}/${a}/free-games?lang=${a}`,d=`https://store-site-backend-static-ipv4.ak.epicgames.com/freeGamesPromotions?locale=${a}&country=${c}&allowCountries=${c}`,f=`https://store-content-ipv4.ak.epicgames.com/api/${a}/content`,p=await i({method:`get`,url:d}),m=s(),h=p.data.data.Catalog.searchStore.elements.filter(e=>e.promotions&&e.promotions.promotionalOffers&&e.promotions.promotionalOffers.length&&e.promotions.promotionalOffers[0].promotionalOffers[0].discountSetting.discountType===`PERCENTAGE`&&e.promotions.promotionalOffers[0].promotionalOffers[0].discountSetting.discountPercentage===0&&s(e.promotions.promotionalOffers[0].promotionalOffers[0].startDate)<=m&&s(e.promotions.promotionalOffers[0].promotionalOffers[0].endDate)>m).map(async t=>{let c=`${l}/${a}/p/`,u=`${f}/products/`,d=!1;t.categories.some(e=>e.path===`bundles`)&&(c=`${l}/${a}/bundles/`,d=!0,u=`${f}/bundles/`);let p=t.catalogNs.mappings&&t.catalogNs.mappings.length>0?t.catalogNs.mappings[0].pageSlug:t.offerMappings&&t.offerMappings.length>0?t.offerMappings[0].pageSlug:t.productSlug??t.urlSlug;t.offerType===`ADD_ON`&&(p=t.offerMappings[0].pageSlug),c+=p,u+=p;let m=t.description;if(d){let e=await i({method:`get`,url:u});m=e.data.data.about.shortDescription}let h=t.keyImages[0].url;t.keyImages.some(e=>e.type===`DieselStoreFrontWide`?(h=e.url,!0):!1);let g=s(t.promotions.promotionalOffers[0].promotionalOffers[0].endDate).toISOString();return{title:t.title,author:t.seller.name,link:c,description:n(o.join(e,`templates/description-3503c581.art`),{description:m,image:h,endDate:g}),pubDate:r(t.promotions.promotionalOffers[0].promotionalOffers[0].startDate)}});return{title:`Epic Games Store - Free Games`,link:u,item:await Promise.all(h)}}export{c as route};
//# sourceMappingURL=epicgames-DaRHM4zQ.js.map