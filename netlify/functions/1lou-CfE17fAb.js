import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as e}from"./cache-kimkMTWJ.js";import{parseDate as t}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as n}from"./got-CdvI2yKX.js";import{timezone as r}from"./timezone-BrNu6iXe.js";import{load as i}from"cheerio";const a=`https://www.1lou.me`,o=async o=>{let{params:s}=o.req.param(),c=o.req.query(`limit`)?Number.parseInt(o.req.query(`limit`),10):50,l=Object.entries(o.req.query()).map(([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`).join(`&`),u=new URL(`${s&&s.endsWith(`.htm`)?s:`${s}.htm`}${l?`?${l}`:``}`,a).href,{data:d}=await n(u),f=i(d),p=f(`html`).prop(`lang`),m=f(`li.media.thread.tap:not(li.hidden-sm)`).slice(0,c).toArray().map(e=>{e=f(e);let n=e.find(`div.subject`).children(`a`).first();return{title:n.text(),pubDate:r(t(e.find(`span.date`).text()),8),link:new URL(n.prop(`href`),a).href,category:[e.find(`a.text-secondary`).text().replaceAll(`[]`,``),...e.find(`a.badge`).toArray().map(e=>f(e).text())].filter(Boolean),author:e.find(`a.username`).text(),language:p}});m=await Promise.all(m.map(o=>e.tryGet(o.link,async()=>{let{data:e}=await n(o.link),s=i(e),c=s(`h4.break-all`).contents().last().text();if(c){let e=s(`div.message.break-all`).html(),n=new URL(s(`img`).first().prop(`src`),a).href;o.title=c,o.description=e,o.pubDate=r(t(s(`span.date`).text()),8),o.category=s(`a.badge`).toArray().map(e=>s(e).text()),o.content={html:e,text:s(`div.message.break-all`).text()},o.image=n,o.banner=n,o.language=p;let i=s(`ul.attachlist li a`);if(i.length>0){let e=i.first();o.enclosure_url=new URL(e.prop(`href`),a).href,o.enclosure_type=`application/x-bittorrent`,o.enclosure_title=e.text()}}return o})));let h=`BT 之家 1LOU 站`,g=new URL(f(`img.logo-2`).prop(`src`),a).href;return{title:`${f(`title`).text().split(/-/)[0]} - ${h}`,description:f(`meta[name="description"]`).prop(`content`),link:u,item:m,allowEmpty:!0,image:g,author:h,language:p}},s={path:`/:params{.+}?`,name:`通用`,url:`1lou.me`,maintainers:[`falling`,`nczitzk`],handler:o,example:`/1lou/forum-2-1`,parameters:{params:`路径参数，可以在对应页面的 URL 中找到`},description:"::: tip\n  `1lou.me/` 后的内容填入 params 参数，以下是几个例子：\n\n  若订阅 [大陆电视剧](https://www.1lou.me/forum-2-1.htm?tagids=0_97_0_0)，网址为 `https://www.1lou.me/forum-2-1.htm?tagids=0_97_0_0`。截取 `https://www.1lou.me/` 到末尾 `.htm` 的部分 `forum-2-1` 作为参数，并补充 `tagids`，此时路由为 [`/1lou/forum-2-1?tagids=0_97_0_0`](https://rsshub.app/1lou/forum-2-1?tagids=0_97_0_0)。\n  \n  若订阅 [最新发帖电视剧](https://www.1lou.me/forum-2-1.htm?orderby=tid&digest=0)，网址为 `https://www.1lou.me/forum-2-1.htm?orderby=tid&digest=0`。截取 `https://www.1lou.me/` 到末尾 `.htm` 的部分 `forum-2-1` 作为参数，并补充 `orderby`，此时路由为 [`/1lou/forum-2-1?orderby=tid`](https://rsshub.app/1lou/forum-2-1?orderby=tid)。\n  \n  若订阅 [搜素繁花主题贴](https://www.1lou.me/search-_E7_B9_81_E8_8A_B1-1.htm)，网址为 `https://www.1lou.me/search-_E7_B9_81_E8_8A_B1-1.htm`。截取 `https://www.1lou.me/` 到末尾 `.htm` 的部分 `search-_E7_B9_81_E8_8A_B1-1` 作为参数，此时路由为 [`/1lou/search-_E7_B9_81_E8_8A_B1-1`](https://rsshub.app/1lou/search-_E7_B9_81_E8_8A_B1-1)。\n:::",categories:[`multimedia`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`1lou.me/:params`],target:(e,t)=>(t=new URL(t),`/1lou${t.href.replace(a,``)}`)}]};export{o as handler,s as route};
//# sourceMappingURL=1lou-CfE17fAb.js.map