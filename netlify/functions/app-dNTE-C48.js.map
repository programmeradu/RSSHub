{"version":3,"file":"app-dNTE-C48.js","names":["route: Route","ofetch"],"sources":["../../lib/routes/macupdate/app.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport ofetch from '@/utils/ofetch';\r\nimport { load } from 'cheerio';\r\nimport { parseDate } from '@/utils/parse-date';\r\n\r\nexport const route: Route = {\r\n    path: '/app/:appId/:appSlug?',\r\n    categories: ['program-update'],\r\n    example: '/macupdate/app/11942',\r\n    parameters: { appId: 'Application unique ID, can be found in URL', appSlug: 'Application slug, can be found in URL' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['macupdate.com/app/mac/:appId/:appSlug'],\r\n        },\r\n    ],\r\n    name: 'Update',\r\n    maintainers: ['TonyRL'],\r\n    handler,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const { appId, appSlug } = ctx.req.param();\r\n    const baseUrl = 'https://www.macupdate.com';\r\n    const link = `${baseUrl}/app/mac/${appId}${appSlug ? `/${appSlug}` : ''}`;\r\n\r\n    const response = await ofetch(link);\r\n    const $ = load(response);\r\n\r\n    const nextData = JSON.parse($('#__NEXT_DATA__').text());\r\n\r\n    const {\r\n        asPath,\r\n        appData: { data: appData },\r\n    } = nextData.props.pageProps;\r\n\r\n    const item = {\r\n        title: `${appData.title} ${appData.version}`,\r\n        description: appData.release_notes,\r\n        pubDate: parseDate(appData.date.timestamp, 'X'),\r\n        link: `${baseUrl}${asPath}`,\r\n        guid: `macupdate/app/${appId}/${appData.version}`,\r\n        category: [appData.category.name, appData.subcategory?.name],\r\n        author: appData.developer.name,\r\n    };\r\n\r\n    return {\r\n        title: appData.title,\r\n        description: appData.description,\r\n        link: `${baseUrl}${asPath}`,\r\n        logo: appData.logo.source,\r\n        icon: appData.logo.source,\r\n        item: [item],\r\n        language: 'en',\r\n    };\r\n}\r\n"],"mappings":"+PAKA,MAAaA,EAAe,CACxB,KAAM,wBACN,WAAY,CAAC,kBACb,QAAS,uBACT,WAAY,CAAE,MAAO,6CAA8C,QAAS,yCAC5E,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,2CAGjB,KAAM,SACN,YAAa,CAAC,UACd,WAGJ,eAAe,EAAQ,EAAK,CACxB,GAAM,CAAE,QAAO,WAAY,EAAI,IAAI,QAC7B,EAAU,4BACV,EAAO,GAAG,EAAQ,WAAW,IAAQ,EAAU,IAAI,IAAY,KAE/D,EAAW,MAAMC,EAAO,GACxB,EAAI,EAAK,GAET,EAAW,KAAK,MAAM,EAAE,kBAAkB,QAE1C,CACF,SACA,QAAS,CAAE,KAAM,IACjB,EAAS,MAAM,UAEb,EAAO,CACT,MAAO,GAAG,EAAQ,MAAM,GAAG,EAAQ,UACnC,YAAa,EAAQ,cACrB,QAAS,EAAU,EAAQ,KAAK,UAAW,KAC3C,KAAM,GAAG,IAAU,IACnB,KAAM,iBAAiB,EAAM,GAAG,EAAQ,UACxC,SAAU,CAAC,EAAQ,SAAS,KAAM,EAAQ,aAAa,MACvD,OAAQ,EAAQ,UAAU,MAG9B,MAAO,CACH,MAAO,EAAQ,MACf,YAAa,EAAQ,YACrB,KAAM,GAAG,IAAU,IACnB,KAAM,EAAQ,KAAK,OACnB,KAAM,EAAQ,KAAK,OACnB,KAAM,CAAC,GACP,SAAU"}