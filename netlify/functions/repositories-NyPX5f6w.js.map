{"version":3,"file":"repositories-NyPX5f6w.js","names":["route: Route","got"],"sources":["../../lib/routes/dockerhub/repositories.ts"],"sourcesContent":["import { Route, ViewType } from '@/types';\r\nimport got from '@/utils/got';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport { Context } from 'hono';\r\n\r\nexport const route: Route = {\r\n    name: 'Owner Repositories',\r\n    description: 'List of repositories for an image owner',\r\n    maintainers: ['CaoMeiYouRen'],\r\n    path: '/repositories/:owner',\r\n    categories: ['program-update'],\r\n    view: ViewType.Notifications,\r\n    example: '/dockerhub/repositories/diygod',\r\n    parameters: { owner: 'Image owner' },\r\n    handler,\r\n};\r\n\r\nasync function handler(ctx: Context) {\r\n    const owner = ctx.req.param('owner').toLowerCase();\r\n    const limit = Number.parseInt(ctx.req.query('limit') || '10');\r\n    const link = `https://hub.docker.com/r/${owner}`;\r\n    const url = `https://hub.docker.com/v2/repositories/${owner}`;\r\n    const response = await got(url, {\r\n        searchParams: {\r\n            page_size: limit,\r\n        },\r\n    });\r\n    const item = response.data.results.map((repo) => ({\r\n        title: repo.name,\r\n        description: `${repo.description}<br>status: ${repo.status_description}<br>stars: ${repo.star_count}<br>pulls: ${repo.pull_count}`,\r\n        link: `https://hub.docker.com/r/${owner}/${repo.name}`,\r\n        author: owner,\r\n        pubDate: parseDate(repo.last_updated),\r\n        guid: `${owner}/${repo.name}`,\r\n    }));\r\n    return {\r\n        title: `${owner} repositories`,\r\n        description: `List of repositories for ${owner}`,\r\n        link,\r\n        item,\r\n    };\r\n}\r\n"],"mappings":"oUAKA,MAAaA,EAAe,CACxB,KAAM,qBACN,YAAa,0CACb,YAAa,CAAC,gBACd,KAAM,uBACN,WAAY,CAAC,kBACb,KAAM,EAAS,cACf,QAAS,iCACT,WAAY,CAAE,MAAO,eACrB,WAGJ,eAAe,EAAQ,EAAc,CACjC,IAAM,EAAQ,EAAI,IAAI,MAAM,SAAS,cAC/B,EAAQ,OAAO,SAAS,EAAI,IAAI,MAAM,UAAY,MAClD,EAAO,4BAA4B,IACnC,EAAM,0CAA0C,IAChD,EAAW,MAAMC,EAAI,EAAK,CAC5B,aAAc,CACV,UAAW,KAGb,EAAO,EAAS,KAAK,QAAQ,IAAK,IAAU,CAC9C,MAAO,EAAK,KACZ,YAAa,GAAG,EAAK,YAAY,cAAc,EAAK,mBAAmB,aAAa,EAAK,WAAW,aAAa,EAAK,aACtH,KAAM,4BAA4B,EAAM,GAAG,EAAK,OAChD,OAAQ,EACR,QAAS,EAAU,EAAK,cACxB,KAAM,GAAG,EAAM,GAAG,EAAK,UAE3B,MAAO,CACH,MAAO,GAAG,EAAM,eAChB,YAAa,4BAA4B,IACzC,OACA"}