import{cache_default as e}from"./cache-kimkMTWJ.js";import{parseDate as t}from"./parse-date-Bgabdhlb.js";import{md5 as n}from"./md5-4BNsOP-F.js";import{got_default as r}from"./got-CdvI2yKX.js";import{load as i}from"cheerio";const a={0:`基本动态`,8:`酷图`,9:`评论`,10:`提问`,11:`回答`,12:`图文`,15:`二手`,17:`观点`,20:`交易动态`},o=()=>{let e=[10,6,6,6,14];return e=e.map(e=>Math.random().toString(36).substring(2,e)),e.join(`-`)},s=()=>{let e=o(),t=Math.round(Date.now()/1e3),r=`0x`+t.toString(16),i=n(t.toString()),a=`token://com.coolapk.market/c67ef5943784d09750dcfbb31020f0ab?`+i+`$`+e+`&com.coolapk.market`,s=n(Buffer.from(a).toString(`base64`)),c=s+e+r;return c},c=()=>({"X-Requested-With":`XMLHttpRequest`,"X-App-Id":`com.coolapk.market`,"X-App-Token":s(),"X-Sdk-Int":`29`,"X-Sdk-Locale":`zh-CN`,"X-App-Version":`11.0`,"X-Api-Version":`11`,"X-App-Code":`2101202`,"User-Agent":`Dalvik/2.1.0 (Linux; U; Android 10; Redmi K30 5G MIUI/V12.0.3.0.QGICMXM) (#Build; Redmi; Redmi K30 5G; QKQ1.191222.002 test-keys; 10) +CoolMarket/11.0-2101202`}),l=e=>e.map(e=>{if(e.type===`text`){let t=e.message.split(`
`).filter(e=>e!==``).map(e=>`<p>${e}</p>`).join(``);return t}else if(e.type===`image`)return`<div class="img-container" style="text-align: center;">
                <img src="${e.url}">
                <p class="image-caption" style="text-align: center;">${e.description}</p></div>`;else return`Unkown type`}),u=async n=>{let a=t(n.dateline,`X`);if(n.entityType===`sponsorCard`||n.shareUrl===void 0)return;let o=n.shareUrl.split(`?`)[0],s,u,d=Number.parseInt(n.type);switch(d){case 0:case 5:case 7:case 8:case 9:case 10:case 11:case 13:case 15:case 17:case 20:{if(n.issummary)s=await e.tryGet(o,async()=>{let e=await r(o,{headers:c()}),t=`<p>`+e.data.data?.message.split(`
`).join(`<br>`)+`</p>`,i=n.picArr.filter(Boolean).map(e=>`<img src="${e}">`);return t+i.join(``)});else{let e=n.picArr.filter(Boolean).map(e=>`<img src="${e}">`);s=`<p>`+n.message+`</p>`+e.join(``)}let t=i(`<div class="title-filter">`+s+`</div>`);if(u=t(`.title-filter`).text().trim(),d===17){let e=n.extra_key.split(`,`);s+=`<p>`+n.vote.message_title+` 已选${e.length}项</p>`;for(let t of n.vote.options)e.includes(String(t.id))&&(s+=`<p>${t.title}√</p>`)}else (d===10||d===11)&&(u=`${n.message_title} 更多:`+u);break}case 12:u=n.title,s=await e.tryGet(o,async()=>{let e=await r(o,{headers:c()}),t=JSON.parse(e.data.data.message_raw_output),n=l(t);return`<img src="${e.data.data.pic}"><hr>`+n.join(``)});break;default:break}return{title:u,description:s,pubDate:a,link:n.shareUrl,guid:o,author:n.username}};var d={get_app_token:s,base_url:`https://api.coolapk.com`,getHeaders:c,parseDynamic:u,dynamicTpye:a};export{d as utils_default};
//# sourceMappingURL=utils-z7BK1QoO.js.map