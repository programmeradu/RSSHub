{"version":3,"file":"news-Dk_EuCEA.js","names":["route: Route","got","cache","$"],"sources":["../../lib/routes/neu/news.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport cache from '@/utils/cache';\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\nimport { parseDate } from '@/utils/parse-date';\r\nconst baseUrl = 'https://neunews.neu.edu.cn';\r\n\r\nexport const route: Route = {\r\n    path: '/news/:type',\r\n    categories: ['university'],\r\n    example: '/neu/news/ddyw',\r\n    parameters: { type: '种类名，见下表' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['neunews.neu.edu.cn/:type/list.htm'],\r\n        },\r\n    ],\r\n    name: '新闻网',\r\n    maintainers: ['JeasonLau'],\r\n    handler,\r\n    description: `| 种类名   | 参数 |\r\n| -------- | ---- |\r\n| 东大要闻 | ddyw |\r\n| 媒体东大 | mtdd |\r\n| 通知公告 | tzgg |\r\n| 新闻纵横 | xwzh |\r\n| 人才培养 | rcpy |\r\n| 学术科研 | xsky |\r\n| 英文新闻 | 217  |\r\n| 招生就业 | zsjy |\r\n| 考研出国 | kycg |\r\n| 校园文学 | xywx |\r\n| 校友风采 | xyfc |\r\n| 时事热点 | ssrd |\r\n| 教育前沿 | jyqy |\r\n| 文化体育 | whty |\r\n| 最新科技 | zxkj |`,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const type = ctx.req.param('type');\r\n    const newsUrl = `${baseUrl}/${type}/list.htm`;\r\n    const response = await got(newsUrl);\r\n\r\n    const data = response.data;\r\n    const $ = load(data);\r\n\r\n    const items = $('.column-news-list > .news_list > .news')\r\n        .toArray()\r\n        .map((item) => {\r\n            item = $(item);\r\n            return {\r\n                title: item.find('a').attr('title'),\r\n                link: new URL(item.find('a').attr('href'), baseUrl).href,\r\n                pubDate: parseDate(item.find('.news_meta').text(), 'YYYY-MM-DD'),\r\n            };\r\n        });\r\n\r\n    const results = await Promise.all(\r\n        items.map((item) =>\r\n            cache.tryGet(item.link, async () => {\r\n                const result = await got(item.link);\r\n                const $ = load(result.data);\r\n\r\n                item.author = $('.arti-metas').text().split('更新日期')[0];\r\n                item.description = $('.article_content').html();\r\n\r\n                return item;\r\n            })\r\n        )\r\n    );\r\n\r\n    return {\r\n        title: `东北大学新闻网-${$('head title').text()}`,\r\n        link: newsUrl,\r\n        item: results,\r\n    };\r\n}\r\n"],"mappings":"wWAKA,MAAM,EAAU,6BAEHA,EAAe,CACxB,KAAM,cACN,WAAY,CAAC,cACb,QAAS,iBACT,WAAY,CAAE,KAAM,WACpB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,uCAGjB,KAAM,MACN,YAAa,CAAC,aACd,UACA,YAAa;;;;;;;;;;;;;;;;kBAmBjB,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAO,EAAI,IAAI,MAAM,QACrB,EAAU,GAAG,EAAQ,GAAG,EAAK,WAC7B,EAAW,MAAMC,EAAI,GAErB,EAAO,EAAS,KAChB,EAAI,EAAK,GAET,EAAQ,EAAE,0CACX,UACA,IAAK,IACF,EAAO,EAAE,GACF,CACH,MAAO,EAAK,KAAK,KAAK,KAAK,SAC3B,KAAM,IAAI,IAAI,EAAK,KAAK,KAAK,KAAK,QAAS,GAAS,KACpD,QAAS,EAAU,EAAK,KAAK,cAAc,OAAQ,iBAIzD,EAAU,MAAM,QAAQ,IAC1B,EAAM,IAAK,GACPC,EAAM,OAAO,EAAK,KAAM,SAAY,CAChC,IAAM,EAAS,MAAMD,EAAI,EAAK,MACxBE,EAAI,EAAK,EAAO,MAKtB,MAHA,GAAK,OAASA,EAAE,eAAe,OAAO,MAAM,QAAQ,GACpD,EAAK,YAAcA,EAAE,oBAAoB,OAElC,MAKnB,MAAO,CACH,MAAO,WAAW,EAAE,cAAc,SAClC,KAAM,EACN,KAAM"}