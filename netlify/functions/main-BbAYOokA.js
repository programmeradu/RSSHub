import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as n}from"./cache-kimkMTWJ.js";import{art as r}from"./render-CxhTJIsl.js";import"./ofetch-Bzt0BXUH.js";import{got_default as i}from"./got-CdvI2yKX.js";import a from"node:path";import{load as o}from"cheerio";t();async function s(e){let t=`article.g-main-video-article`,n=await i(e),r=o(n.data),a=[],s=[],c=[],l=[],u=`https://oreno3d.com`+r(`header > figure.video-figure > a `).find(`img`).attr(`src`),d=r(`header > h1.video-h1 `).text();r(t).find(`section:nth-child(4) > a > div.video-center`).each(function(e){s[e]=r(this).text(),s[e].replace(` `,``),s[e].trim()}),r(t).find(`section:nth-child(5) > a > div.video-center`).each(function(e){c[e]=r(this).text(),c[e].replace(` `,``),c[e].trim()}),r(t).find(`section:nth-child(6) > a > div.video-center`).each(function(e){l[e]=r(this).text(),l[e].replace(` `,``),l[e].trim()}),r(t).find(`section:nth-child(7) > ul > li > a div.tag-text`).each(function(e){a[e]=r(this).text(),a[e].replace(` `,``),a[e].trim()});let f=r(t).find(`section blockquote.video-information-comment`).text(),p=r(`header > figure.video-figure > a`).attr(`href`);return{raw_pic_link:u,video_name:d,authors:s.join(` `),origins:c.join(` `),characters:l.join(` `),tags:a.join(` `),desc:f,iwara_link:p,oreno3d_link:e}}var c=s;const l={favorites:`高評価`,hot:`急上昇`,latest:`新着`,popularity:`人気`};function u(e,t,n){let r=``;if(t.req.param(`keyword`)){let i=t.req.param(`keyword`);r=`${e}/search?sort=${n}&keyword=${i}`}else if(t.req.param(`characterid`)){let i=t.req.param(`characterid`);r=`${e}/characters/${i}?sort=${n}`}else if(t.req.param(`authorid`)){let i=t.req.param(`authorid`);r=`${e}/authors/${i}?sort=${n}`}else if(t.req.param(`tagid`)){let i=t.req.param(`tagid`);r=`${e}/tags/${i}?sort=${n}`}else if(t.req.param(`originid`)){let i=t.req.param(`originid`);r=`${e}/origins/${i}?sort=${n}`}return r}const d={path:[`/authors/:authorid/:sort/:pagelimit?`,`/characters/:characterid/:sort/:pagelimit?`,`/origins/:originid/:sort/:pagelimit?`,`/search/:keyword/:sort/:pagelimit?`,`/tags/:tagid/:sort/:pagelimit?`],categories:[`anime`],example:`/oreno3d/authors/3189/latest/1`,parameters:{authorid:`Author id, can be found in URL`,sort:`Sort method, see the table above`,pagelimit:`The maximum number of pages to be crawled, the default is 1`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`Author Search`,maintainers:[`xueli_sherryli`],handler:f,description:`| favorites | hot | latest | popularity |
| --------- | --- | ------ | ---------- |
| favorites | hot | latest | popularity |`};async function f(t){function s(e){let t=o(e.data),n=t(`div.g-main-list`).find(`h1.main-h`).text(),r=t(`a.box`);return{title:n,list:r}}async function d(t){let i=o(t.data),l=s(t).title,u=s(t).list,d=await Promise.all(u.toArray().map(async t=>{let o=i(t).attr(`href`),s=await c(o),l=s.raw_pic_link,u=s.video_name,d=s.authors,f=s.origins,p=s.characters,m=s.tags,h=s.desc,g=s.iwara_link,_=s.oreno3d_link,v=r(a.join(e,`templates/description-96c60240.art`),{raw_pic_link:l,video_name:u,authors:d,origins:f,characters:p,tags:m,desc:h,iwara_link:g,oreno3d_link:_}),y=`${u} - ${d}`,b=await n.tryGet(_,()=>{let e={title:y,author:d,link:_,category:m.split(` `),description:v};return e});return b}));return{items:d,title:l}}let f=t.req.param(`sort`),p=t.req.param(`pagelimit`)??1,m=u(`https://oreno3d.com`,t,f),h=await i(m),g=o(h.data),_=`div.container > main > div.g-main-list > ul.pagination > li:last-child > a`;if(g(_)){let e=new URLSearchParams(g(_).attr(`href`)),t=e.get(`page`);Number.parseInt(p)>=Number.parseInt(t)&&(p=t)}else p=1;let v=[];v.push(h);let y=[];for(let e=1;e<p;e++)y.push(`${m}&page=${e+1}`);await Promise.all(y.map(async e=>{let t=await i(e);v.push(t)}));let b=[];await Promise.all(v.map(async e=>{let t=await d(e);b.push(t)}));let x=[];for(let e of b)x=[...x,...e.items];let S={title:b[0].title,item:x};return{title:`${S.title} - ${l[f]}(Page 1-${p})`,link:m,item:S.item}}export{d as route};
//# sourceMappingURL=main-BbAYOokA.js.map