{"version":3,"file":"exchangesys-D7qP0C19.js","names":["route: Route","got"],"sources":["../../lib/routes/nju/exchangesys.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport got from '@/utils/got';\r\nimport dayjs from 'dayjs';\r\n\r\nexport const route: Route = {\r\n    path: '/exchangesys/:type',\r\n    categories: ['university'],\r\n    example: '/nju/exchangesys/proj',\r\n    parameters: { type: '分类名' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    name: '本科生交换生系统',\r\n    maintainers: [],\r\n    handler,\r\n    description: `| 新闻通知 | 交换生项目 |\r\n| -------- | ---------- |\r\n| news     | proj       |`,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const type = ctx.req.param('type');\r\n    const type_dict = {\r\n        news: ['http://elite.nju.edu.cn/exchangesystem/index/moreList', 'http://elite.nju.edu.cn/exchangesystem/index/more?type=xw', '新闻通知'],\r\n        proj: ['http://elite.nju.edu.cn/exchangesystem/index/moreXmList', 'http://elite.nju.edu.cn/exchangesystem/index/more?type=xm', '交换生项目'],\r\n    };\r\n\r\n    const url = type_dict[type][0] + '?page=1&limit=20&.me=c3lzLmluZGV4';\r\n    const { data } = await got({\r\n        url,\r\n        headers: {\r\n            Referer: type_dict[type][1],\r\n        },\r\n    });\r\n\r\n    return {\r\n        title: `本科生交换生管理系统-${type_dict[type][2]}`,\r\n        link: type_dict[type][1],\r\n        item:\r\n            data &&\r\n            data.data &&\r\n            data.data.map((item) => {\r\n                if (type === 'proj') {\r\n                    return {\r\n                        title: item.mc,\r\n                        description: item.mc,\r\n                        pubDate: dayjs(item.cjsj),\r\n                        link: item.sqyq,\r\n                    };\r\n                }\r\n                if (type === 'news') {\r\n                    return {\r\n                        title: item.bt,\r\n                        author: item.createBy,\r\n                        description: item.nr,\r\n                        pubDate: dayjs(item.createDate),\r\n                        link: `http://elite.nju.edu.cn/exchangesystem/index/detail?pid=${item.pid}`,\r\n                    };\r\n                }\r\n                return null;\r\n            }),\r\n    };\r\n}\r\n"],"mappings":"qPAIA,MAAaA,EAAe,CACxB,KAAM,qBACN,WAAY,CAAC,cACb,QAAS,wBACT,WAAY,CAAE,KAAM,OACpB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,KAAM,WACN,YAAa,GACb,UACA,YAAa;;4BAKjB,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAO,EAAI,IAAI,MAAM,QACrB,EAAY,CACd,KAAM,CAAC,wDAAyD,4DAA6D,QAC7H,KAAM,CAAC,0DAA2D,4DAA6D,UAG7H,EAAM,EAAU,GAAM,GAAK,oCAC3B,CAAE,QAAS,MAAMC,EAAI,CACvB,MACA,QAAS,CACL,QAAS,EAAU,GAAM,MAIjC,MAAO,CACH,MAAO,cAAc,EAAU,GAAM,KACrC,KAAM,EAAU,GAAM,GACtB,KACI,GACA,EAAK,MACL,EAAK,KAAK,IAAK,GACP,IAAS,OACF,CACH,MAAO,EAAK,GACZ,YAAa,EAAK,GAClB,QAAS,EAAM,EAAK,MACpB,KAAM,EAAK,MAGf,IAAS,OACF,CACH,MAAO,EAAK,GACZ,OAAQ,EAAK,SACb,YAAa,EAAK,GAClB,QAAS,EAAM,EAAK,YACpB,KAAM,2DAA2D,EAAK,OAGvE"}