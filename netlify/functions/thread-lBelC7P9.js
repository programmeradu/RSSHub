import"./esm-shims-Dqvxr0BZ.js";import{config as e}from"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as t}from"./cache-kimkMTWJ.js";import{parseDate as n}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as r}from"./got-CdvI2yKX.js";import{generateNonce as i,getPost as a,sign as o,webBaseUrl as s}from"./utils-B841yQLJ.js";const c={path:`/bbs/profile/thread/:userId`,categories:[`bbs`],example:`/dxy/bbs/profile/thread/8335054`,parameters:{userId:`个人 ID，可在 URL 中找到`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`dxy.cn/bbs/newweb/pc/profile/:userId/threads`,`dxy.cn/bbs/newweb/pc/profile/:userId`]}],name:`个人帖子`,maintainers:[`TonyRL`],handler:l};async function l(c){let l=c.req.param(`userId`),{limit:u=`30`}=c.req.query(),d=await t.tryGet(`dxy:user-info:${l}`,async()=>{let e={userId:l,serverTimestamp:Date.now(),timestamp:Date.now(),noncestr:i(8,`number`)},{data:t}=await r(`${s}/bbs/newweb/personal-page/user-info`,{searchParams:{...e,sign:o(e)}});if(t.code!==`success`)throw Error(t.message);return t.data}),f=await t.tryGet(`dxy:user:post:${l}`,async()=>{let e={userId:l,type:`0`,pageNum:`1`,pageSize:u,serverTimestamp:Date.now(),timestamp:Date.now(),noncestr:i(8,`number`)},{data:t}=await r(`${s}/bbs/newweb/user/post/page`,{searchParams:{...e,sign:o(e)}});if(t.code!==`success`)throw Error(t.message);return t.data},e.cache.routeExpire,!1),p=f.result.map(e=>{let{postInfo:t,createdTime:r,entityId:i}=e;return{title:t.subject,description:t.simpleBody,pubDate:n(r,`x`),author:t.postUser.nickname,category:[t.boardInfo.title],link:`${s}/bbs/newweb/pc/post/${i}`,postId:i}}),m=await Promise.all(p.map(e=>a(e,t.tryGet)));return{title:`${d.nickname} 的个人主页 - 丁香园论坛 - 专业医生社区，医学、药学、生命科学、科研学术交流`,description:`${d.identificationTitle} ${d.signature}`,link:`${s}/bbs/newweb/pc/profile/${l}/threads`,image:d.avatar,item:m}}export{c as route};
//# sourceMappingURL=thread-lBelC7P9.js.map