import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{cache_default as e}from"./cache-kimkMTWJ.js";import{parseDate as t}from"./parse-date-Bgabdhlb.js";import{ofetch_default as n}from"./ofetch-Bzt0BXUH.js";import{ViewType as r}from"./types-A5bA50Mg.js";import{load as i}from"cheerio";const a=async r=>{let a=Number.parseInt(r.req.query(`limit`)??`30`,10),o=`https://kiro.dev`,s=new URL(`changelog/`,o).href,c=await n(s),l=i(c),u=l(`html`).attr(`lang`)??`en`,d=[];return d=l(`a.block`).slice(0,a).toArray().map(e=>{let n=l(e),r=`${n.parent().find(`span`).text()} ${n.find(`h3`).text()}`,i=n.parent().parent().find(`div.prose`).html()??void 0,a=n.parent().parent().parent().find(`time`).text(),s=n.attr(`href`),c=a,d={title:r,description:i,pubDate:a?t(a):void 0,link:s?new URL(s,o).href:void 0,content:{html:i,text:i},updated:c?t(c):void 0,language:u};return d}),d=await Promise.all(d.map(r=>r.link?e.tryGet(r.link,async()=>{let e=await n(r.link),a=i(e),o=`${a(`article span`).first().text()} ${a(`article h3`).text()}`,s=a(`div.prose`).html()??void 0,c=a(`time`).text(),l=a(`meta[property="og:image"]`).attr(`content`),d=c,f={title:o,description:s,pubDate:c?t(c):r.pubDate,content:{html:s,text:s},image:l,banner:l,updated:d?t(d):r.updated,language:u};return{...r,...f}}):r)),{title:l(`title`).text(),description:l(`meta[property="og:description"]`).attr(`content`),link:s,item:d,allowEmpty:!0,image:l(`meta[property="og:image"]`).attr(`content`),author:l(`meta[property="og:site_name"]`).attr(`content`),language:u,id:s}},o={path:`/changelog`,name:`Changelog`,url:`kiro.dev`,maintainers:[`nczitzk`],handler:a,example:`/kiro/changelog`,parameters:void 0,description:void 0,categories:[`program-update`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`kiro.dev`,`kiro.dev/changelog/`],target:`/changelog`}],view:r.Articles};export{a as handler,o as route};
//# sourceMappingURL=changelog-DswYMjDf.js.map