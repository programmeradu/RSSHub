{"version":3,"file":"utils-Dh7TLRXa.js","names":[],"sources":["../../lib/routes/caixin/utils.ts"],"sourcesContent":["import got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\nimport { art } from '@/utils/render';\r\nimport path from 'node:path';\r\n\r\nconst parseArticle = async (item) => {\r\n    if (/\\.blog\\.caixin\\.com$/.test(new URL(item.link).hostname)) {\r\n        return parseBlogArticle(item);\r\n    } else {\r\n        const { data: response } = await got(item.link);\r\n\r\n        const $ = load(response);\r\n\r\n        item.description = art(path.join(__dirname, 'templates/article.art'), {\r\n            item,\r\n            $,\r\n        });\r\n\r\n        if (item.audio) {\r\n            item.itunes_item_image = item.audio_image_url;\r\n            item.enclosure_url = item.audio;\r\n            item.enclosure_type = 'audio/mpeg';\r\n        }\r\n\r\n        return item;\r\n    }\r\n};\r\n\r\nconst parseBlogArticle = async (item) => {\r\n    const response = await got(item.link);\r\n    const $ = load(response.data);\r\n    const article = $('#the_content').removeAttr('style');\r\n    article.find('img').removeAttr('style');\r\n    article\r\n        .find('p')\r\n        // Non-breaking space U+00A0, `&nbsp;` in html\r\n        // element.children[0].data === $(element, article).text()\r\n        .filter((_, element) => element.children[0].data === String.fromCodePoint(160))\r\n        .remove();\r\n\r\n    item.description = article.html();\r\n\r\n    return item;\r\n};\r\n\r\nexport { parseArticle, parseBlogArticle };\r\n"],"mappings":"+NAKA,MAAM,EAAe,KAAO,IAAS,CACjC,GAAI,uBAAuB,KAAK,IAAI,IAAI,EAAK,MAAM,UAC/C,OAAO,EAAiB,GACrB,CACH,GAAM,CAAE,KAAM,GAAa,MAAM,EAAI,EAAK,MAEpC,EAAI,EAAK,GAaf,MAXA,GAAK,YAAc,EAAI,EAAA,KAAA,EAAA,kCAA+C,CAClE,OACA,MAGA,EAAK,QACL,EAAK,kBAAoB,EAAK,gBAC9B,EAAK,cAAgB,EAAK,MAC1B,EAAK,eAAiB,cAGnB,IAIT,EAAmB,KAAO,IAAS,CACrC,IAAM,EAAW,MAAM,EAAI,EAAK,MAC1B,EAAI,EAAK,EAAS,MAClB,EAAU,EAAE,gBAAgB,WAAW,SAW7C,OAVA,EAAQ,KAAK,OAAO,WAAW,SAC/B,EACK,KAAK,KAGL,QAAQ,EAAG,IAAY,EAAQ,SAAS,GAAG,OAAS,OAAO,cAAc,MACzE,SAEL,EAAK,YAAc,EAAQ,OAEpB"}