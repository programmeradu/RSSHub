{"version":3,"file":"utils-oK-DyWtL.js","names":["got"],"sources":["../../lib/routes/bsky/utils.ts"],"sourcesContent":["import got from '@/utils/got';\r\nimport { config } from '@/config';\r\n\r\n/**\r\n * docs: https://atproto.com/lexicons/app-bsky\r\n */\r\n\r\n// https://github.com/bluesky-social/atproto/blob/main/lexicons/com/atproto/identity/resolveHandle.json\r\nconst resolveHandle = (handle, tryGet) =>\r\n    tryGet(`bsky:${handle}`, async () => {\r\n        const { data } = await got('https://public.api.bsky.app/xrpc/com.atproto.identity.resolveHandle', {\r\n            searchParams: {\r\n                handle,\r\n            },\r\n        });\r\n        return data.did;\r\n    });\r\n\r\n// https://github.com/bluesky-social/atproto/blob/main/lexicons/app/bsky/actor/getProfile.json\r\nconst getProfile = (did, tryGet) =>\r\n    tryGet(`bsky:profile:${did}`, async () => {\r\n        const { data } = await got('https://public.api.bsky.app/xrpc/app.bsky.actor.getProfile', {\r\n            searchParams: {\r\n                actor: did,\r\n            },\r\n        });\r\n        return data;\r\n    });\r\n\r\n// https://github.com/bluesky-social/atproto/blob/main/lexicons/app/bsky/feed/getAuthorFeed.json\r\nconst getAuthorFeed = (did, filter, tryGet) =>\r\n    tryGet(\r\n        `bsky:authorFeed:${did}:${filter}`,\r\n        async () => {\r\n            const { data } = await got('https://public.api.bsky.app/xrpc/app.bsky.feed.getAuthorFeed', {\r\n                searchParams: {\r\n                    actor: did,\r\n                    filter,\r\n                    limit: 30,\r\n                },\r\n            });\r\n            return data;\r\n        },\r\n        config.cache.routeExpire,\r\n        false\r\n    );\r\n\r\n// https://github.com/bluesky-social/atproto/blob/main/lexicons/app/bsky/feed/getFeed.json\r\nconst getFeed = (uri, tryGet) =>\r\n    tryGet(\r\n        `bsky:feed:${uri}`,\r\n        async () => {\r\n            const { data } = await got('https://public.api.bsky.app/xrpc/app.bsky.feed.getFeed', {\r\n                searchParams: {\r\n                    feed: uri,\r\n                    limit: 30,\r\n                },\r\n            });\r\n            return data;\r\n        },\r\n        config.cache.routeExpire,\r\n        false\r\n    );\r\n\r\n// https://github.com/bluesky-social/atproto/blob/main/lexicons/app/bsky/feed/getFeedGenerator.json\r\nconst getFeedGenerator = (uri, tryGet) =>\r\n    tryGet(\r\n        `bsky:feedGenerator:${uri}`,\r\n        async () => {\r\n            const { data } = await got('https://public.api.bsky.app/xrpc/app.bsky.feed.getFeedGenerator', {\r\n                searchParams: {\r\n                    feed: uri,\r\n                },\r\n            });\r\n            return data;\r\n        },\r\n        config.cache.routeExpire,\r\n        false\r\n    );\r\n\r\nexport { resolveHandle, getProfile, getFeed, getAuthorFeed, getFeedGenerator };\r\n"],"mappings":"8FAQA,MAAM,GAAiB,EAAQ,IAC3B,EAAO,QAAQ,IAAU,SAAY,CACjC,GAAM,CAAE,QAAS,MAAMA,EAAI,sEAAuE,CAC9F,aAAc,CACV,YAGR,OAAO,EAAK,MAId,GAAc,EAAK,IACrB,EAAO,gBAAgB,IAAO,SAAY,CACtC,GAAM,CAAE,QAAS,MAAMA,EAAI,6DAA8D,CACrF,aAAc,CACV,MAAO,KAGf,OAAO,IAIT,GAAiB,EAAK,EAAQ,IAChC,EACI,mBAAmB,EAAI,GAAG,IAC1B,SAAY,CACR,GAAM,CAAE,QAAS,MAAMA,EAAI,+DAAgE,CACvF,aAAc,CACV,MAAO,EACP,SACA,MAAO,MAGf,OAAO,GAEX,EAAO,MAAM,YACb,IAIF,GAAW,EAAK,IAClB,EACI,aAAa,IACb,SAAY,CACR,GAAM,CAAE,QAAS,MAAMA,EAAI,yDAA0D,CACjF,aAAc,CACV,KAAM,EACN,MAAO,MAGf,OAAO,GAEX,EAAO,MAAM,YACb,IAIF,GAAoB,EAAK,IAC3B,EACI,sBAAsB,IACtB,SAAY,CACR,GAAM,CAAE,QAAS,MAAMA,EAAI,kEAAmE,CAC1F,aAAc,CACV,KAAM,KAGd,OAAO,GAEX,EAAO,MAAM,YACb"}