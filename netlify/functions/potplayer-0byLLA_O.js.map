{"version":3,"file":"potplayer-0byLLA_O.js","names":["limit: number","baseUrl: string","targetUrl: string","response: string","ofetch","items: DataItem[]","match: RegExpExecArray | null","headerLine: string | undefined","description: string | undefined","version: string","pubDateStr: string | undefined","guid: string","processedItem: DataItem","route: Route","urlObj: URL","lang: string | undefined"],"sources":["../../lib/routes/daum/potplayer.ts"],"sourcesContent":["import { type Data, type DataItem, type Route, ViewType } from '@/types';\r\n\r\nimport ofetch from '@/utils/ofetch';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport { type Context } from 'hono';\r\n\r\nexport const handler = async (ctx: Context): Promise<Data> => {\r\n    const { lang } = ctx.req.param();\r\n    const limit: number = Number.parseInt(ctx.req.query('limit') ?? '500', 10);\r\n\r\n    const baseUrl: string = 'https://t1.daumcdn.net';\r\n    const targetUrl: string = new URL(`potplayer/PotPlayer/v4/Update2/Update${lang ?? ''}.html`, baseUrl).href;\r\n\r\n    const response: string = await ofetch(targetUrl);\r\n\r\n    // Updated regex to capture blocks:\r\n    // Group 1: Leading hyphens (unused, but for context)\r\n    // Group 2: Version and optional date line (e.g., \"[1.4.20199]        2009/10/22\" or \"[250514]\")\r\n    // Group 3: Trailing hyphens (unused, but for context)\r\n    // Group 4: Update content\r\n    // Uses global and multiline flags for all matches and line start/end anchors\r\n    const updateRegex = /^(-+)\\s*\\n(.*?)\\s*\\n(-+)\\s*\\n([\\s\\S]*?)(?=\\n-{2,}|<\\/p>)/gm;\r\n\r\n    const items: DataItem[] = [];\r\n    let match: RegExpExecArray | null;\r\n\r\n    while ((match = updateRegex.exec(response)) !== null && items.length < limit) {\r\n        const headerLine: string | undefined = match[2].trim();\r\n        const description: string | undefined = match[4].trim()?.replace(/(\\s[+-])/g, '<br>$1');\r\n\r\n        let version: string = 'N/A';\r\n        let pubDateStr: string | undefined = undefined;\r\n\r\n        // Regex to extract version (e.g., [1.4.20199] or [250514])\r\n        const versionMatch = headerLine.match(/\\[([\\d.]+)\\]/);\r\n        if (versionMatch && versionMatch[1]) {\r\n            version = versionMatch[1];\r\n        }\r\n\r\n        // Regex to extract date (either YYYY/MM/DD or YYMMDD from the headerLine)\r\n        const specificDateMatch = headerLine.match(/(\\d{4}\\/\\d{1,2}\\/\\d{1,2})/); // YYYY/MM/DD format\r\n        const numericDateMatch = headerLine.match(/(\\d{6})/); // YYMMDD format\r\n\r\n        if (specificDateMatch && specificDateMatch[1]) {\r\n            // Found YYYY/MM/DD format\r\n            pubDateStr = specificDateMatch[1].replaceAll('/', '-'); // Format to YYYY-MM-DD\r\n        } else if (numericDateMatch && numericDateMatch[1]) {\r\n            const rawDate = numericDateMatch[1];\r\n            if (rawDate.length === 6 && (version === rawDate || !specificDateMatch)) {\r\n                const year = Number.parseInt(rawDate.slice(0, 2), 10);\r\n                const month = Number.parseInt(rawDate.slice(2, 4), 10);\r\n                const day = Number.parseInt(rawDate.slice(4, 6), 10);\r\n                const fullYear = year < 70 ? 2000 + year : 1900 + year;\r\n                pubDateStr = `${fullYear}-${month.toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;\r\n            }\r\n        }\r\n\r\n        const guid: string = `potplayer-${lang}-${version}`;\r\n\r\n        const processedItem: DataItem = {\r\n            title: version,\r\n            description,\r\n            pubDate: pubDateStr ? parseDate(pubDateStr) : undefined,\r\n            link: targetUrl,\r\n            guid,\r\n            id: guid,\r\n            content: {\r\n                html: description,\r\n                text: description,\r\n            },\r\n            updated: pubDateStr ? parseDate(pubDateStr) : undefined,\r\n        };\r\n\r\n        items.push(processedItem);\r\n    }\r\n\r\n    return {\r\n        title: 'PotPlayer Update History',\r\n        link: targetUrl,\r\n        item: items,\r\n        allowEmpty: true,\r\n        id: targetUrl,\r\n    };\r\n};\r\n\r\nexport const route: Route = {\r\n    path: '/potplayer/:lang?',\r\n    name: 'Potplayer Update History',\r\n    url: 'potplayer.daum.net',\r\n    maintainers: ['nczitzk'],\r\n    handler,\r\n    example: '/daum/potplayer',\r\n    parameters: {\r\n        lang: {\r\n            description: 'Language, Korean by default',\r\n            options: [\r\n                {\r\n                    label: '한국어',\r\n                    value: 'Kor',\r\n                },\r\n                {\r\n                    label: '中文(简体)',\r\n                    value: 'Chs',\r\n                },\r\n                {\r\n                    label: '中文(繁体)',\r\n                    value: 'Cht',\r\n                },\r\n                {\r\n                    label: 'English',\r\n                    value: 'Eng',\r\n                },\r\n                {\r\n                    label: 'Українська',\r\n                    value: 'Eng',\r\n                },\r\n                {\r\n                    label: 'Русский',\r\n                    value: 'Rus',\r\n                },\r\n                {\r\n                    label: 'Polski',\r\n                    value: 'Pol',\r\n                },\r\n            ],\r\n        },\r\n    },\r\n    description: `:::tip\r\nTo subscribe to [Potplayer Update History](https://t1.daumcdn.net/potplayer/PotPlayer/v4/Update2/UpdateEng.html), where the source URL is \\`https://t1.daumcdn.net/potplayer/PotPlayer/v4/Update2/UpdateEng.html\\`, extract the certain parts from this URL to be used as parameters, resulting in the route as [\\`/daum/potplayer/Eng\\`](https://rsshub.app/daum/potplayer/Eng).\r\n:::\r\n\r\n| Language                                                                           | Id                                           |\r\n| ---------------------------------------------------------------------------------- | -------------------------------------------- |\r\n| [한국어](https://t1.daumcdn.net/potplayer/PotPlayer/v4/Update2/Update.html)        |                                              |\r\n| [中文(简体)](https://t1.daumcdn.net/potplayer/PotPlayer/v4/Update2/UpdateChs.html) | [Chs](https://rsshub.app/daum/potplayer/Chs) |\r\n| [中文(繁体)](https://t1.daumcdn.net/potplayer/PotPlayer/v4/Update2/UpdateCht.html) | [Cht](https://rsshub.app/daum/potplayer/Cht) |\r\n| [ENGLISH](https://t1.daumcdn.net/potplayer/PotPlayer/v4/Update2/UpdateEng.html)    | [Eng](https://rsshub.app/daum/potplayer/Eng) |\r\n| [Українська](https://t1.daumcdn.net/potplayer/PotPlayer/v4/Update2/UpdateEng.html) | [Eng](https://rsshub.app/daum/potplayer/Eng) |\r\n| [РУССКИЙ](https://t1.daumcdn.net/potplayer/PotPlayer/v4/Update2/UpdateRus.html)    | [Eng](https://rsshub.app/daum/potplayer/Rus) |\r\n| [Polski](https://t1.daumcdn.net/potplayer/PotPlayer/v4/Update2/UpdatePol.html)     | [Eng](https://rsshub.app/daum/potplayer/Pol) |\r\n`,\r\n    categories: ['program-update'],\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportRadar: true,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['potplayer.daum.net'],\r\n            target: (_, url) => {\r\n                const urlObj: URL = new URL(url);\r\n                const lang: string | undefined = urlObj.searchParams.get('lang') ?? undefined;\r\n\r\n                return `/daum/potplayer${lang ? `/${lang}` : ''}`;\r\n            },\r\n        },\r\n        {\r\n            title: '한국어',\r\n            source: ['t1.daumcdn.net/potplayer/PotPlayer/v4/Update2/Update.html'],\r\n            target: '/potplayer',\r\n        },\r\n        {\r\n            title: '中文(简体)',\r\n            source: ['t1.daumcdn.net/potplayer/PotPlayer/v4/Update2/UpdateChs.html'],\r\n            target: '/potplayer/Chs',\r\n        },\r\n        {\r\n            title: '中文(繁体)',\r\n            source: ['t1.daumcdn.net/potplayer/PotPlayer/v4/Update2/UpdateCht.html'],\r\n            target: '/potplayer/Cht',\r\n        },\r\n        {\r\n            title: 'English',\r\n            source: ['t1.daumcdn.net/potplayer/PotPlayer/v4/Update2/UpdateEng.html'],\r\n            target: '/potplayer/Eng',\r\n        },\r\n        {\r\n            title: 'Українська',\r\n            source: ['t1.daumcdn.net/potplayer/PotPlayer/v4/Update2/UpdateEng.html'],\r\n            target: '/potplayer/Eng',\r\n        },\r\n        {\r\n            title: 'Русский',\r\n            source: ['t1.daumcdn.net/potplayer/PotPlayer/v4/Update2/UpdateRus.html'],\r\n            target: '/potplayer/Rus',\r\n        },\r\n        {\r\n            title: 'Polski',\r\n            source: ['t1.daumcdn.net/potplayer/PotPlayer/v4/Update2/UpdatePol.html'],\r\n            target: '/potplayer/Pol',\r\n        },\r\n    ],\r\n    view: ViewType.Articles,\r\n\r\n    zh: {\r\n        path: '/potplayer/:lang?',\r\n        name: 'PotPlayer 版本更新信息',\r\n        url: 'potplayer.daum.net',\r\n        maintainers: ['nczitzk'],\r\n        handler,\r\n        example: '/daum/potplayer/zh_CN',\r\n        parameters: {\r\n            lang: {\r\n                description: '语言，默认为韩语，可在对应页 URL 中找到',\r\n                options: [\r\n                    {\r\n                        label: '한국어',\r\n                        value: 'Kor',\r\n                    },\r\n                    {\r\n                        label: '中文(简体)',\r\n                        value: 'Chs',\r\n                    },\r\n                    {\r\n                        label: '中文(繁体)',\r\n                        value: 'Cht',\r\n                    },\r\n                    {\r\n                        label: 'English',\r\n                        value: 'Eng',\r\n                    },\r\n                    {\r\n                        label: 'Українська',\r\n                        value: 'Eng',\r\n                    },\r\n                    {\r\n                        label: 'Русский',\r\n                        value: 'Rus',\r\n                    },\r\n                    {\r\n                        label: 'Polski',\r\n                        value: 'Pol',\r\n                    },\r\n                ],\r\n            },\r\n        },\r\n        description: `:::tip\r\n若订阅 [Potplayer Update History](https://t1.daumcdn.net/potplayer/PotPlayer/v4/Update2/UpdateChs.html)，网址为 \\`https://t1.daumcdn.net/potplayer/PotPlayer/v4/Update2/UpdateChs.html\\`，请截取 \\`https://t1.daumcdn.net/potplayer/PotPlayer/v4/Update2/Update\\` 到末尾的部分 \\`Chs\\` 作为 \\`lang\\` 参数填入，此时目标路由为 [\\`/daum/potplayer/Chs\\`](https://rsshub.app/daum/potplayer/Chs)。\r\n:::\r\n\r\n| Language                                                                           | Id                                           |\r\n| ---------------------------------------------------------------------------------- | -------------------------------------------- |\r\n| [한국어](https://t1.daumcdn.net/potplayer/PotPlayer/v4/Update2/Update.html)        |                                              |\r\n| [中文(简体)](https://t1.daumcdn.net/potplayer/PotPlayer/v4/Update2/UpdateChs.html) | [Chs](https://rsshub.app/daum/potplayer/Chs) |\r\n| [中文(繁体)](https://t1.daumcdn.net/potplayer/PotPlayer/v4/Update2/UpdateCht.html) | [Cht](https://rsshub.app/daum/potplayer/Cht) |\r\n| [ENGLISH](https://t1.daumcdn.net/potplayer/PotPlayer/v4/Update2/UpdateEng.html)    | [Eng](https://rsshub.app/daum/potplayer/Eng) |\r\n| [Українська](https://t1.daumcdn.net/potplayer/PotPlayer/v4/Update2/UpdateEng.html) | [Eng](https://rsshub.app/daum/potplayer/Eng) |\r\n| [РУССКИЙ](https://t1.daumcdn.net/potplayer/PotPlayer/v4/Update2/UpdateRus.html)    | [Eng](https://rsshub.app/daum/potplayer/Rus) |\r\n| [Polski](https://t1.daumcdn.net/potplayer/PotPlayer/v4/Update2/UpdatePol.html)     | [Eng](https://rsshub.app/daum/potplayer/Pol) |\r\n`,\r\n    },\r\n};\r\n"],"mappings":"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"}