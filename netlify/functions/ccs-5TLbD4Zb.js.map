{"version":3,"file":"ccs-5TLbD4Zb.js","names":["route: Route","ofetch","url"],"sources":["../../lib/routes/sigsac/ccs.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport ofetch from '@/utils/ofetch';\r\nimport { load } from 'cheerio';\r\nconst url = 'https://www.sigsac.org/';\r\nimport { parseDate } from '@/utils/parse-date';\r\n// https://www.sigsac.org/ccs/CCS2022/program/accepted-papers.html\r\n\r\nexport const route: Route = {\r\n    path: '/ccs',\r\n    categories: ['journal'],\r\n    example: '/sigsac/ccs',\r\n    radar: [\r\n        {\r\n            source: ['sigsac.org/ccs.html', 'sigsac.org/'],\r\n        },\r\n    ],\r\n    name: 'The ACM Conference on Computer and Communications Security',\r\n    maintainers: ['ZeddYu'],\r\n    handler,\r\n    url: 'sigsac.org/ccs.html',\r\n    description: 'Return results from 2020',\r\n};\r\n\r\nasync function handler() {\r\n    const last = new Date().getFullYear() + 1;\r\n    const yearList = Array.from({ length: last - 2020 }, (_, v) => `${url}ccs/CCS${v + 2020}/`);\r\n    const yearResponses = await Promise.allSettled(yearList.map((url) => ofetch(url)));\r\n\r\n    const urlList = yearResponses\r\n        .map((response, i) => {\r\n            const $ = load(response.value);\r\n            const href = $('a:contains(\"Accepted Papers\")').attr('href');\r\n            return href && new URL($('a:contains(\"Accepted Papers\")').attr('href')!, yearList[i]).href;\r\n        })\r\n        .filter(Boolean);\r\n\r\n    const responses = await Promise.allSettled(urlList.map((url) => ofetch(url)));\r\n\r\n    const items = responses.flatMap((response, i) => {\r\n        const $ = load(response.value);\r\n        const link = urlList[i];\r\n        const paperSection = $('div.papers-item')\r\n            .toArray()\r\n            .map((item) => {\r\n                item = $(item);\r\n                const title = item.find('b').text().trim();\r\n                return {\r\n                    title,\r\n                    author: item.find('p').text().trim().replaceAll('\\n', '').replaceAll(/\\s+/g, ' '),\r\n                    link: `${link}#${title}`,\r\n                    pubDate: parseDate(link.match(/CCS(\\d{4})/)[1], 'YYYY'),\r\n                };\r\n            });\r\n        const paperTable = $('tbody tr')\r\n            .toArray()\r\n            .slice(1) // skip table header\r\n            .map((item) => {\r\n                item = $(item);\r\n                const title = item.find('td').eq(0).text().trim();\r\n                return {\r\n                    title,\r\n                    author: item.find('td').eq(1).text().trim().replaceAll('\\n', '').replaceAll(/\\s+/g, ' '),\r\n                    link: `${link}#${title}`,\r\n                    pubDate: parseDate(link.match(/CCS(\\d{4})/)[1], 'YYYY'),\r\n                };\r\n            });\r\n        return paperSection.length ? paperSection : paperTable;\r\n    });\r\n\r\n    return {\r\n        title: 'ACM CCS',\r\n        link: url,\r\n        description: 'The ACM Conference on Computer and Communications Security (CCS) Accepted Papers',\r\n        allowEmpty: true,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"+PAGA,MAAM,EAAM,0BAICA,EAAe,CACxB,KAAM,OACN,WAAY,CAAC,WACb,QAAS,cACT,MAAO,CACH,CACI,OAAQ,CAAC,sBAAuB,iBAGxC,KAAM,6DACN,YAAa,CAAC,UACd,UACA,IAAK,sBACL,YAAa,4BAGjB,eAAe,GAAU,CACrB,IAAM,EAAO,IAAI,OAAO,cAAgB,EAClC,EAAW,MAAM,KAAK,CAAE,OAAQ,EAAO,OAAS,EAAG,IAAM,GAAG,EAAI,SAAS,EAAI,KAAK,IAClF,EAAgB,MAAM,QAAQ,WAAW,EAAS,IAAK,GAAQC,EAAOC,KAEtE,EAAU,EACX,KAAK,EAAU,IAAM,CAClB,IAAM,EAAI,EAAK,EAAS,OAClB,EAAO,EAAE,iCAAiC,KAAK,QACrD,OAAO,GAAQ,IAAI,IAAI,EAAE,iCAAiC,KAAK,QAAU,EAAS,IAAI,OAEzF,OAAO,SAEN,EAAY,MAAM,QAAQ,WAAW,EAAQ,IAAK,GAAQD,EAAOC,KAEjE,EAAQ,EAAU,SAAS,EAAU,IAAM,CAC7C,IAAM,EAAI,EAAK,EAAS,OAClB,EAAO,EAAQ,GACf,EAAe,EAAE,mBAClB,UACA,IAAK,GAAS,CACX,EAAO,EAAE,GACT,IAAM,EAAQ,EAAK,KAAK,KAAK,OAAO,OACpC,MAAO,CACH,QACA,OAAQ,EAAK,KAAK,KAAK,OAAO,OAAO,WAAW;EAAM,IAAI,WAAW,OAAQ,KAC7E,KAAM,GAAG,EAAK,GAAG,IACjB,QAAS,EAAU,EAAK,MAAM,cAAc,GAAI,WAGtD,EAAa,EAAE,YAChB,UACA,MAAM,GACN,IAAK,GAAS,CACX,EAAO,EAAE,GACT,IAAM,EAAQ,EAAK,KAAK,MAAM,GAAG,GAAG,OAAO,OAC3C,MAAO,CACH,QACA,OAAQ,EAAK,KAAK,MAAM,GAAG,GAAG,OAAO,OAAO,WAAW;EAAM,IAAI,WAAW,OAAQ,KACpF,KAAM,GAAG,EAAK,GAAG,IACjB,QAAS,EAAU,EAAK,MAAM,cAAc,GAAI,WAG5D,OAAO,EAAa,OAAS,EAAe,IAGhD,MAAO,CACH,MAAO,UACP,KAAM,EACN,YAAa,mFACb,WAAY,GACZ,KAAM"}