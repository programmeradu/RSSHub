{"version":3,"file":"navigation-qZihMYw2.js","names":["route: Route","parser"],"sources":["../../lib/routes/chikubi/navigation.ts"],"sourcesContent":["import { Route, Data } from '@/types';\r\nimport { getBySlug, getPostsBy, processItems } from './utils';\r\nimport parser from '@/utils/rss-parser';\r\n\r\nexport const route: Route = {\r\n    path: '/:keyword',\r\n    categories: ['multimedia'],\r\n    example: '/chikubi',\r\n    parameters: { keyword: '導覽列，見下表，默認爲最新' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    name: 'Navigation',\r\n    maintainers: ['SnowAgar25'],\r\n    handler,\r\n    description: `| 殿堂 | 動畫 | VR | 漫畫 | 音聲 | CG・イラスト |\r\n| ---- | ----- | -- | ----- | ----- | -- |\r\n| best | video | vr | comic | voice | cg |`,\r\n};\r\n\r\nconst navigationItems = {\r\n    video: { url: '/nipple-video', title: '動畫' },\r\n    vr: { url: '/nipple-video-category/cat-nipple-video-vr', title: 'VR' },\r\n    comic: { url: '/comic', title: '漫畫' },\r\n    voice: { url: '/voice', title: '音聲' },\r\n    cg: { url: '/cg', title: 'CG' },\r\n};\r\n\r\nasync function handler(ctx): Promise<Data> {\r\n    const keyword = ctx.req.param('keyword') ?? '';\r\n    const baseUrl = 'https://chikubi.jp';\r\n\r\n    if (keyword === 'best') {\r\n        const { id } = await getBySlug('category', 'nipple-best');\r\n        const items = await getPostsBy('category', id);\r\n\r\n        return {\r\n            title: '殿堂 - chikubi.jp',\r\n            link: `${baseUrl}/best-nipple-article`,\r\n            item: items,\r\n        };\r\n    } else {\r\n        const { url, title } = navigationItems[keyword];\r\n\r\n        const feed = await parser.parseURL(`${baseUrl}${url}/feed`);\r\n\r\n        const list = feed.items.map((item) => ({\r\n            title: item.title,\r\n            link: item.link,\r\n        }));\r\n\r\n        // 獲取內文\r\n        const items = await processItems(list);\r\n\r\n        return {\r\n            title: `${title} - chikubi.jp`,\r\n            link: `${baseUrl}${url}`,\r\n            item: items,\r\n        };\r\n    }\r\n}\r\n"],"mappings":"uZAIA,MAAaA,EAAe,CACxB,KAAM,YACN,WAAY,CAAC,cACb,QAAS,WACT,WAAY,CAAE,QAAS,iBACvB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,KAAM,aACN,YAAa,CAAC,cACd,UACA,YAAa;;6CAKX,EAAkB,CACpB,MAAO,CAAE,IAAK,gBAAiB,MAAO,MACtC,GAAI,CAAE,IAAK,6CAA8C,MAAO,MAChE,MAAO,CAAE,IAAK,SAAU,MAAO,MAC/B,MAAO,CAAE,IAAK,SAAU,MAAO,MAC/B,GAAI,CAAE,IAAK,MAAO,MAAO,OAG7B,eAAe,EAAQ,EAAoB,CACvC,IAAM,EAAU,EAAI,IAAI,MAAM,YAAc,GACtC,EAAU,qBAEhB,GAAI,IAAY,OAAQ,CACpB,GAAM,CAAE,MAAO,MAAM,EAAU,WAAY,eACrC,EAAQ,MAAM,EAAW,WAAY,GAE3C,MAAO,CACH,MAAO,kBACP,KAAM,GAAG,EAAQ,sBACjB,KAAM,OAEP,CACH,GAAM,CAAE,MAAK,SAAU,EAAgB,GAEjC,EAAO,MAAMC,EAAO,SAAS,GAAG,IAAU,EAAI,QAE9C,EAAO,EAAK,MAAM,IAAK,IAAU,CACnC,MAAO,EAAK,MACZ,KAAM,EAAK,QAIT,EAAQ,MAAM,EAAa,GAEjC,MAAO,CACH,MAAO,GAAG,EAAM,eAChB,KAAM,GAAG,IAAU,IACnB,KAAM"}