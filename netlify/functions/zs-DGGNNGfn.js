import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{cache_default as e}from"./cache-kimkMTWJ.js";import{parseDate as t}from"./parse-date-Bgabdhlb.js";import{ofetch_default as n}from"./ofetch-Bzt0BXUH.js";import{timezone as r}from"./timezone-BrNu6iXe.js";import{ViewType as i}from"./types-A5bA50Mg.js";import{load as a}from"cheerio";const o=async i=>{let{category:o=`zsxx1/zskx`}=i.req.param(),s=Number.parseInt(i.req.query(`limit`)??`30`,10),c=new URL(`${o}.htm`,`https://zs.xjtu.edu.cn`).href,l=await n(c),u=a(l),d=u(`html`).attr(`lang`)??`zh`,f=[];f=u(`section.TextList ul li`).slice(0,s).toArray().map(e=>{let n=u(e),r=n.find(`a.flex`),i=r.text(),a=n.find(`b`).text(),o=r.attr(`href`),s=n.find(`i.zc`).toArray(),l=[...new Set(s.map(e=>u(e).text()).filter(Boolean))],f=a,p={title:i,pubDate:a?t(a):void 0,link:o?new URL(o,c).href:void 0,category:l,updated:f?t(f):void 0,language:d};return p}),f=(await Promise.all(f.map(i=>i.link?e.tryGet(i.link,async()=>{let e=await n(i.link),o=a(e),s=o(`div.show01 h5`).text(),c=o(`div.v_news_content`).html(),l=o(`div.show01 i`).text()?.match(/(\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2})/)?.[1],u=o(`div.mianbao a`).toArray().slice(1),f=[...new Set(u.map(e=>o(e).text()).filter(Boolean))],p=l,m={title:s,description:c,pubDate:l?r(t(l),8):i.pubDate,category:f,content:{html:c,text:c},updated:p?r(t(p),8):i.updated,language:d};return{...i,...m}}):i))).filter(e=>!0);let p=u(`title`).text();return{title:p,description:p.split(/-/)[0],link:c,item:f,allowEmpty:!0,image:u(`div.logoimg img`).attr(`src`),author:u(`META[Name="keywords"]`).attr(`Content`),language:d,id:c}},s={path:`/zs/:category{.+}?`,name:`本科招生网`,url:`zs.xjtu.edu.cn`,maintainers:[`nczitzk`],handler:o,example:`/xjtu/zs/zsxx1/zskx`,parameters:{category:{description:`分类，默认为 zsxx1/zskx，可在对应分类页 URL 中找到`,options:[{label:`招生快讯`,value:`zsxx1/zskx`},{label:`招生政策`,value:`zsxx1/zszc`},{label:`招生计划`,value:`zsxx1/zsjh`},{label:`阳光公告`,value:`zsxx1/yggg`},{label:`历年录取`,value:`zsxx1/lnlq`}]}},description:":::tip\n若订阅 [招生快讯](https://zs.xjtu.edu.cn/zsxx1/zskx.htm)，网址为 `https://zs.xjtu.edu.cn/zsxx1/zskx.htm`，请截取 `https://zs.xjtu.edu.cn/` 到末尾 `.htm` 的部分 `zsxx1/zskx` 作为 `category` 参数填入，此时目标路由为 [`/xjtu/zs/zsxx1/zskx`](https://rsshub.app/xjtu/zs/zsxx1/zskx)。\n:::\n\n| [招生快讯](https://zs.xjtu.edu.cn/zsxx1/zskx.htm)   | [招生政策](https://zs.xjtu.edu.cn/zsxx1/zszc.htm)   | [招生计划](https://zs.xjtu.edu.cn/zsxx1/zsjh.htm)   | [阳光公告](https://zs.xjtu.edu.cn/zsxx1/yggg.htm)   | [历年录取](https://zs.xjtu.edu.cn/zsxx1/lnlq.htm)   |\n| --------------------------------------------------- | --------------------------------------------------- | --------------------------------------------------- | --------------------------------------------------- | --------------------------------------------------- |\n| [zsxx1/zskx](https://rsshub.app/xjtu/zs/zsxx1/zskx) | [zsxx1/zszc](https://rsshub.app/xjtu/zs/zsxx1/zszc) | [zsxx1/zsjh](https://rsshub.app/xjtu/zs/zsxx1/zsjh) | [zsxx1/yggg](https://rsshub.app/xjtu/zs/zsxx1/yggg) | [zsxx1/lnlq](https://rsshub.app/xjtu/zs/zsxx1/lnlq) |\n",categories:[`university`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`zs.xjtu.edu.cn/:category`],target:e=>{let t=e.category;return`/xjtu/zs${t?`/${t}`:``}`}}],view:i.Articles};export{o as handler,s as route};
//# sourceMappingURL=zs-DGGNNGfn.js.map