import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{cache_default as e}from"./cache-kimkMTWJ.js";import{parseDate as t}from"./parse-date-Bgabdhlb.js";import{ofetch_default as n}from"./ofetch-Bzt0BXUH.js";const r={path:`/user/:username/articles`,categories:[`program-update`],example:`/civitai/user/Chenkin/articles`,parameters:{username:`Username`},radar:[{source:[`civitai.com/user/:username`,`civitai.com/user/:username/articles`]}],name:`User Article`,maintainers:[`TonyRL`],handler:i};async function i(r){let{username:i}=r.req.param(),a=await e.tryGet(`civitai:userProfile:${i}`,async()=>{let e=await n(`https://civitai.com/api/trpc/userProfile.get`,{query:{input:JSON.stringify({json:{username:i}})}});return e.result.data.json}),o=await n(`https://civitai.com/api/trpc/article.getInfinite`,{query:{input:JSON.stringify({json:{period:`AllTime`,periodMode:`published`,sort:`Newest`,username:i,includeDrafts:!1,pending:!0,browsingLevel:1,excludedTagIds:[415792,426772,5188,5249,130818,130820,133182],cursor:null},meta:{values:{cursor:[`undefined`]}}})}});if(!o.result.data.json.items.length)throw Error(`This user has no articles.`);let s=o.result.data.json.items.map(e=>({title:e.title,link:`https://civitai.com/articles/${e.id}`,id:e.id,pubDate:t(e.publishedAt),updated:t(e.publishedAt),author:e.user?.username,category:e.tags.map(e=>e.name),image:`https://image.civitai.com/xG1nkqKTMzGDvpLrqFT7WA/${e.coverImage.url}/${e.coverImage.name}`})),c=await Promise.all(s.map(t=>e.tryGet(t.link,async()=>{let e=await n(`https://civitai.com/api/trpc/article.getById`,{query:{input:JSON.stringify({json:{id:t.id}})}});return t.description=e.result.data.json.content,t})));return{title:`${i} Creator Profile | Civitai`,description:a.profile.message.replaceAll(`
`,` `)||a.profile.bio,link:`https://civitai.com/user/${i}/articles`,image:a.image,item:c}}export{r as route};
//# sourceMappingURL=user-W5dwqmKt.js.map