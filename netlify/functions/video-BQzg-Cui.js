import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{parseDate as e}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as t}from"./got-CdvI2yKX.js";import{timezone as n}from"./timezone-BrNu6iXe.js";import{load as r}from"cheerio";const i={path:`/video/:category?`,categories:[`finance`],example:`/cs/video/今日聚焦`,parameters:{category:`分类，见下表，默认为今日聚焦`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`中证视频`,description:`| 今日聚焦 | 传闻求证 | 高端访谈 | 投教课堂 | 直播汇 |
| -------- | -------- | -------- | -------- | ------ |`,maintainers:[`nczitzk`],handler:a};async function a(i){let{category:a=`今日聚焦`}=i.req.param(),o=i.req.query(`limit`)?Number.parseInt(i.req.query(`limit`),10):50,s=`https://video.cs.com.cn`,c=new URL(`web/api/getCategory`,s).href,l=new URL(`web/api/toSecondPage`,s).href,{data:{data:u}}=await t.post(c),d=u.map(e=>({id:e.id,title:e.categoryTitle,image:e.categoryImg,sortType:e.categorySortType})),f=d.find(e=>e.title===a||e.id===a),p=new URL(`list.html?title=${f.title}&id=${f.id}`,s).href,{data:{records:m}}=await t.post(l,{json:{categorySortType:f.sortType,id:f.id,pageNum:1,pageSize:o}}),h=m.slice(0,o).map(t=>({title:t.contentTitle,link:new URL(t.contentUrl,s).href,description:t.contentDetails,author:t.contentSource,pubDate:n(e(t.contentDatetime),8),updated:n(e(t.updateDate),8)})),{data:g}=await t(p),_=r(g),v=_(`title`).text(),y=f.image,b=new URL(_(`link[rel="icon"]`).prop(`href`),s).href;return{item:h,title:`${v} | ${f.title}`,link:p,description:_(`meta[name="Description"]`).prop(`content`),language:_(`html`).prop(`lang`),image:y,icon:b,logo:b,subtitle:_(`meta[name="Keywords"]`).prop(`content`),author:v.split(`-`).pop().trim(),allowEmpty:!0}}export{i as route};
//# sourceMappingURL=video-BQzg-Cui.js.map