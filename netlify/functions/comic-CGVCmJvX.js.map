{"version":3,"file":"comic-CGVCmJvX.js","names":["route: Route","got"],"sources":["../../lib/routes/qq/ac/comic.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\n\r\nimport { rootUrl, mobileRootUrl } from './utils';\r\n\r\nexport const route: Route = {\r\n    path: '/ac/comic/:id?',\r\n    radar: [\r\n        {\r\n            source: ['ac.qq.com/Comic/ComicInfo/id/:id', 'ac.qq.com/'],\r\n            target: '/ac/comic/:id',\r\n        },\r\n    ],\r\n    name: 'Unknown',\r\n    maintainers: [],\r\n    handler,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const id = ctx.req.param('id');\r\n\r\n    const currentUrl = `${rootUrl}/Comic/comicInfo/id/${id}`;\r\n    const mobileCurrentUrl = `${mobileRootUrl}/comic/index/id/${id}`;\r\n\r\n    const response = await got({\r\n        method: 'get',\r\n        url: mobileCurrentUrl,\r\n    });\r\n\r\n    const $ = load(response.data);\r\n\r\n    const author = $('.author-wr')\r\n        .toArray()\r\n        .map((a) => $(a).text().trim())\r\n        .join(', ');\r\n\r\n    const items = $('.reverse .bottom-chapter-item .chapter-link')\r\n        .toArray()\r\n        .map((item) => {\r\n            item = $(item);\r\n\r\n            return {\r\n                author,\r\n                title: item.text(),\r\n                description: `<img src=\"${item.find('.cover-image').attr('src')}\">`,\r\n                link: `${rootUrl}${item.attr('href').replace(/chapter/, 'ComicView')}`,\r\n            };\r\n        });\r\n\r\n    return {\r\n        title: `${$('h1').text()} - 腾讯动漫`,\r\n        link: currentUrl,\r\n        item: items,\r\n        description: `<p>${$('.head-info-desc').text()}</p>`,\r\n    };\r\n}\r\n"],"mappings":"yXAMA,MAAaA,EAAe,CACxB,KAAM,iBACN,MAAO,CACH,CACI,OAAQ,CAAC,mCAAoC,cAC7C,OAAQ,kBAGhB,KAAM,UACN,YAAa,GACb,WAGJ,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAK,EAAI,IAAI,MAAM,MAEnB,EAAa,GAAG,EAAQ,sBAAsB,IAC9C,EAAmB,GAAG,EAAc,kBAAkB,IAEtD,EAAW,MAAMC,EAAI,CACvB,OAAQ,MACR,IAAK,IAGH,EAAI,EAAK,EAAS,MAElB,EAAS,EAAE,cACZ,UACA,IAAK,GAAM,EAAE,GAAG,OAAO,QACvB,KAAK,MAEJ,EAAQ,EAAE,+CACX,UACA,IAAK,IACF,EAAO,EAAE,GAEF,CACH,SACA,MAAO,EAAK,OACZ,YAAa,aAAa,EAAK,KAAK,gBAAgB,KAAK,OAAO,IAChE,KAAM,GAAG,IAAU,EAAK,KAAK,QAAQ,QAAQ,UAAW,kBAIpE,MAAO,CACH,MAAO,GAAG,EAAE,MAAM,OAAO,SACzB,KAAM,EACN,KAAM,EACN,YAAa,MAAM,EAAE,mBAAmB,OAAO"}