{"version":3,"file":"app-bootstrap-C35_wkV9.js","names":["exporter","provider","out: { [key: string]: string }","middleware: MiddlewareHandler","path","routePath","middleware","middleware: MiddlewareHandler","cacheModule","RequestInProgressError","data: Data","middleware","middleware: MiddlewareHandler","cacheModule","data: Data","rss3","json","Atom","RSS","middleware","middleware: MiddlewareHandler","time","middleware","RejectError","middleware: MiddlewareHandler","middleware","debug: DebugInfo","middleware: MiddlewareHandler","debug","middleware","headers: Record<string, string>","middleware: MiddlewareHandler","data: Data","middleware","path","process","middleware: MiddlewareHandler","imageHotlinkTemplate: string | undefined","multimediaHotlinkTemplate: string | undefined","data: Data","middleware","ofetch","middleware: MiddlewareHandler","parsed_result: any","cache","description","title","brief: number","middleware","middleware: MiddlewareHandler","path","Layout: FC","gitDate: Date | undefined","Index: FC<{\r\n    requestPath: string;\r\n    message: string;\r\n    errorRoute: string;\r\n    nodeVersion: string;\r\n}>","Index","errorHandler: ErrorHandler","debug","Error","notFoundHandler: NotFoundHandler","NotFoundError","Index: FC<{ debugQuery: string | undefined }>","debug","route","path","handler: Handler","Index","handler","handler: Handler","handler","handler: Handler","handler","handler: Handler","handler","route","safe: NamespacesType","namespaces","modules: Record<string, { route: Route } | { namespace: Namespace }>","namespaces: NamespacesType","path","app","wrappedHandler: Handler","index","healthz","robotstxt","metrics","handler: RouteHandler<typeof route>","ParamsSchema","route","handler: RouteHandler<typeof route>","radar: {\r\n    [domain: string]: RadarDomain;\r\n}","path","radar","route","handler: RouteHandler<typeof route>","radar: {\r\n    [domain: string]: RadarDomain;\r\n}","path","ParamsSchema","route","handler: RouteHandler<typeof route>","categoryList: Record<string, typeof namespaces>","path","route","handler: RouteHandler<typeof route>","route","handler: RouteHandler<typeof route>","app","namespaceAllRoute","namespaceAllHandler","namespaceOneRoute","namespaceOneHandler","radarRulesAllRoute","radarRulesAllHandler","radarRulesOneRoute","radarRulesOneHandler","categoryOneRoute","categoryOneHandler","followConfigRoute","followConfigHandler","path","mLogger","trace","sentry","accessControl","debug","template","header","antiHotlink","parameter","cache","registry","api"],"sources":["../../lib/utils/otel/metric.ts","../../lib/utils/otel/trace.ts","../../lib/middleware/logger.ts","../../lib/middleware/cache.ts","../../lib/middleware/template.tsx","../../lib/middleware/sentry.ts","../../lib/middleware/access-control.ts","../../lib/utils/debug-info.ts","../../lib/middleware/debug.ts","../../lib/middleware/header.ts","../../lib/middleware/anti-hotlink.ts","../../lib/middleware/parameter.ts","../../lib/middleware/trace.ts","../../lib/views/layout.tsx","../../lib/utils/git-hash.ts","../../lib/views/error.tsx","../../lib/errors/index.tsx","../../lib/views/index.tsx","../../lib/routes/index.tsx","../../lib/routes/healthz.ts","../../lib/routes/robots.txt.ts","../../lib/routes/metrics.ts","../../lib/registry.ts","../../lib/api/namespace/all.ts","../../lib/api/namespace/one.ts","../../lib/api/radar/rules/all.ts","../../lib/api/radar/rules/one.ts","../../lib/api/category/one.ts","../../lib/api/follow/config.ts","../../lib/api/index.ts","../../lib/app-bootstrap.tsx"],"sourcesContent":["import { resourceFromAttributes } from '@opentelemetry/resources';\r\nimport { PrometheusExporter, PrometheusSerializer } from '@opentelemetry/exporter-prometheus';\r\nimport { ATTR_SERVICE_NAME } from '@opentelemetry/semantic-conventions';\r\nimport { MeterProvider } from '@opentelemetry/sdk-metrics';\r\nimport type { Attributes } from '@opentelemetry/api';\r\nimport { config } from '@/config';\r\n\r\ninterface IMetricAttributes extends Attributes {\r\n    method: string;\r\n    path: string;\r\n    status: number;\r\n}\r\n\r\ninterface IHistogramAttributes extends IMetricAttributes {\r\n    unit: string;\r\n}\r\n\r\nconst METRIC_PREFIX = 'rsshub';\r\n\r\nconst exporter = new PrometheusExporter({});\r\n\r\nconst provider = new MeterProvider({\r\n    resource: resourceFromAttributes({\r\n        [ATTR_SERVICE_NAME]: 'rsshub',\r\n    }),\r\n    readers: [exporter],\r\n});\r\n\r\nconst serializer = new PrometheusSerializer();\r\n\r\nconst meter = provider.getMeter('rsshub');\r\n\r\nconst requestTotal = meter.createCounter<IMetricAttributes>(`${METRIC_PREFIX}_request_total`);\r\nconst requestErrorTotal = meter.createCounter<IMetricAttributes>(`${METRIC_PREFIX}_request_error_total`);\r\nconst requestDurationSecondsBucket = meter.createHistogram<IHistogramAttributes>(`${METRIC_PREFIX}_request_duration_seconds_bucket`, {\r\n    advice: {\r\n        explicitBucketBoundaries: config.otel.seconds_bucket?.split(',').map(Number),\r\n    },\r\n});\r\nconst request_duration_milliseconds_bucket = meter.createHistogram<IHistogramAttributes>(`${METRIC_PREFIX}_request_duration_milliseconds_bucket`, {\r\n    advice: {\r\n        explicitBucketBoundaries: config.otel.milliseconds_bucket?.split(',').map(Number),\r\n    },\r\n});\r\n\r\nexport const requestMetric = {\r\n    success: (value: number, attributes: IMetricAttributes) => {\r\n        requestTotal.add(1, attributes);\r\n        request_duration_milliseconds_bucket.record(value, { unit: 'millisecond', ...attributes });\r\n        requestDurationSecondsBucket.record(value / 1000, { unit: 'second', ...attributes });\r\n    },\r\n    error: (attributes: IMetricAttributes) => {\r\n        requestErrorTotal.add(1, attributes);\r\n    },\r\n};\r\n\r\nexport const getContext = () =>\r\n    new Promise<string>((resolve, reject) => {\r\n        exporter\r\n            .collect()\r\n            .then((value) => {\r\n                resolve(serializer.serialize(value.resourceMetrics));\r\n            })\r\n            .finally(() => {\r\n                reject('');\r\n            });\r\n    });\r\n","import { resourceFromAttributes } from '@opentelemetry/resources';\r\nimport { BasicTracerProvider, BatchSpanProcessor } from '@opentelemetry/sdk-trace-base';\r\nimport { ATTR_SERVICE_NAME } from '@opentelemetry/semantic-conventions';\r\nimport { OTLPTraceExporter } from '@opentelemetry/exporter-trace-otlp-http';\r\nimport { trace } from '@opentelemetry/api';\r\n\r\nconst exporter = new OTLPTraceExporter({\r\n    // optional OTEL_EXPORTER_OTLP_ENDPOINT=https://localhost:4318\r\n});\r\n\r\nconst provider = new BasicTracerProvider({\r\n    resource: resourceFromAttributes({\r\n        [ATTR_SERVICE_NAME]: 'rsshub',\r\n    }),\r\n    spanProcessors: [\r\n        new BatchSpanProcessor(exporter, {\r\n            // The maximum queue size. After the size is reached spans are dropped.\r\n            maxQueueSize: 4096,\r\n            // The interval between two consecutive exports\r\n            scheduledDelayMillis: 30000,\r\n        }),\r\n    ],\r\n});\r\n\r\ntrace.setGlobalTracerProvider(provider);\r\n\r\nexport const tracer = provider.getTracer('rsshub');\r\nexport const mainSpan = tracer.startSpan('main');\r\n","import { requestMetric } from '@/utils/otel';\r\nimport { MiddlewareHandler } from 'hono';\r\nimport logger from '@/utils/logger';\r\nimport { getPath, time } from '@/utils/helpers';\r\n\r\nenum LogPrefix {\r\n    Outgoing = '-->',\r\n    Incoming = '<--',\r\n    Error = 'xxx',\r\n}\r\n\r\nconst colorStatus = (status: number) => {\r\n    const out: { [key: string]: string } = {\r\n        7: `\\u001B[35m${status}\\u001B[0m`,\r\n        5: `\\u001B[31m${status}\\u001B[0m`,\r\n        4: `\\u001B[33m${status}\\u001B[0m`,\r\n        3: `\\u001B[36m${status}\\u001B[0m`,\r\n        2: `\\u001B[32m${status}\\u001B[0m`,\r\n        1: `\\u001B[32m${status}\\u001B[0m`,\r\n        0: `\\u001B[33m${status}\\u001B[0m`,\r\n    };\r\n\r\n    const calculateStatus = Math.trunc(status / 100);\r\n\r\n    return out[calculateStatus];\r\n};\r\n\r\nconst middleware: MiddlewareHandler = async (ctx, next) => {\r\n    const { method, raw, routePath } = ctx.req;\r\n    const path = getPath(raw);\r\n\r\n    logger.info(`${LogPrefix.Incoming} ${method} ${path}`);\r\n\r\n    const start = Date.now();\r\n\r\n    await next();\r\n\r\n    const status = ctx.res.status;\r\n\r\n    logger.info(`${LogPrefix.Outgoing} ${method} ${path} ${colorStatus(status)} ${time(start)}`);\r\n    requestMetric.success(Date.now() - start, { path: routePath, method, status });\r\n};\r\n\r\nexport default middleware;\r\n","import xxhash from 'xxhash-wasm';\r\nimport type { MiddlewareHandler } from 'hono';\r\n\r\nimport { config } from '@/config';\r\nimport RequestInProgressError from '@/errors/types/request-in-progress';\r\nimport cacheModule from '@/utils/cache/index';\r\nimport { Data } from '@/types';\r\n\r\nconst bypassList = new Set(['/', '/robots.txt', '/logo.png', '/favicon.ico']);\r\n// only give cache string, as the `!` condition tricky\r\n// XXH64 is used to shrink key size\r\n// plz, write these tips in comments!\r\nconst middleware: MiddlewareHandler = async (ctx, next) => {\r\n    if (!cacheModule.status.available || bypassList.has(ctx.req.path)) {\r\n        await next();\r\n        return;\r\n    }\r\n\r\n    const requestPath = ctx.req.path;\r\n    const limit = ctx.req.query('limit') ? `:${ctx.req.query('limit')}` : '';\r\n    const { h64ToString } = await xxhash();\r\n    const key = 'rsshub:koa-redis-cache:' + h64ToString(requestPath + limit);\r\n    const controlKey = 'rsshub:path-requested:' + h64ToString(requestPath + limit);\r\n\r\n    const isRequesting = await cacheModule.globalCache.get(controlKey);\r\n\r\n    if (isRequesting === '1') {\r\n        let retryTimes = process.env.NODE_ENV === 'test' ? 1 : 10;\r\n        let bypass = false;\r\n        while (retryTimes > 0) {\r\n            // eslint-disable-next-line no-await-in-loop\r\n            await new Promise((resolve) => setTimeout(resolve, process.env.NODE_ENV === 'test' ? 3000 : 6000));\r\n            // eslint-disable-next-line no-await-in-loop\r\n            if ((await cacheModule.globalCache.get(controlKey)) !== '1') {\r\n                bypass = true;\r\n                break;\r\n            }\r\n            retryTimes--;\r\n        }\r\n        if (!bypass) {\r\n            throw new RequestInProgressError('This path is currently fetching, please come back later!');\r\n        }\r\n    }\r\n\r\n    const value = await cacheModule.globalCache.get(key);\r\n\r\n    if (value) {\r\n        ctx.status(200);\r\n        ctx.header('RSSHub-Cache-Status', 'HIT');\r\n        ctx.set('data', JSON.parse(value));\r\n        await next();\r\n        return;\r\n    }\r\n\r\n    // Doesn't hit the cache? We need to let others know!\r\n    await cacheModule.globalCache.set(controlKey, '1', config.cache.requestTimeout);\r\n\r\n    try {\r\n        await next();\r\n    } catch (error) {\r\n        await cacheModule.globalCache.set(controlKey, '0', config.cache.requestTimeout);\r\n        throw error;\r\n    }\r\n\r\n    const data: Data = ctx.get('data');\r\n    if (ctx.res.headers.get('Cache-Control') !== 'no-cache' && data) {\r\n        data.lastBuildDate = new Date().toUTCString();\r\n        ctx.set('data', data);\r\n        const body = JSON.stringify(data);\r\n        await cacheModule.globalCache.set(key, body, config.cache.routeExpire);\r\n    }\r\n\r\n    // We need to let it go, even no cache set.\r\n    // Wait to set cache so the next request could be handled correctly\r\n    await cacheModule.globalCache.set(controlKey, '0', config.cache.requestTimeout);\r\n};\r\n\r\nexport default middleware;\r\n","import { rss3, json, RSS, Atom } from '@/utils/render';\r\nimport { config } from '@/config';\r\nimport { collapseWhitespace, convertDateToISO8601 } from '@/utils/common-utils';\r\nimport type { MiddlewareHandler } from 'hono';\r\nimport { Data } from '@/types';\r\n\r\nimport cacheModule from '@/utils/cache/index';\r\n\r\nconst middleware: MiddlewareHandler = async (ctx, next) => {\r\n    // Set RSS <ttl> (minute) according to the availability of cache\r\n    // * available: max(config.cache.routeExpire / 60, 1)\r\n    // * unavailable: 1\r\n    // The minimum <ttl> is limited to 1 minute to prevent potential misuse\r\n    const ttl = (cacheModule.status.available && Math.trunc(config.cache.routeExpire / 60)) || 1;\r\n    await next();\r\n\r\n    const apiData = ctx.get('apiData');\r\n    if (apiData) {\r\n        return ctx.json(apiData);\r\n    }\r\n\r\n    const data: Data = ctx.get('data');\r\n    const outputType = ctx.req.query('format') || 'rss';\r\n\r\n    // only enable when debugInfo=true\r\n    if (config.debugInfo) {\r\n        if (outputType === 'debug.json') {\r\n            return ctx.json(ctx.get('json') || { message: 'plugin does not set debug json' });\r\n        }\r\n\r\n        if (/(\\d+)\\.debug\\.html$/.test(outputType)) {\r\n            const index = Number.parseInt(outputType.match(/(\\d+)\\.debug\\.html$/)?.[1] || '0');\r\n            return ctx.html(data?.item?.[index]?.description || `data.item[${index}].description not found`);\r\n        }\r\n    }\r\n\r\n    if (data) {\r\n        data.title = collapseWhitespace(data.title) || '';\r\n        data.description && (data.description = collapseWhitespace(data.description) || '');\r\n        data.author && (data.author = collapseWhitespace(data.author) || '');\r\n\r\n        if (data.item) {\r\n            for (const item of data.item) {\r\n                if (item.title) {\r\n                    item.title = collapseWhitespace(item.title) || '';\r\n                    // trim title length\r\n                    for (let length = 0, i = 0; i < item.title.length; i++) {\r\n                        length += Buffer.from(item.title[i]).length === 1 ? 1 : 2;\r\n                        if (length > config.titleLengthLimit) {\r\n                            item.title = `${item.title.slice(0, i)}...`;\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if (item.description) {\r\n                    // https://stackoverflow.com/questions/2507608/error-input-is-not-proper-utf-8-indicate-encoding-using-phps-simplexml-lo/40552083#40552083\r\n                    // https://stackoverflow.com/questions/1497885/remove-control-characters-from-php-string/1497928#1497928\r\n                    // remove unicode control characters\r\n                    // see #14940 #14943 #15262\r\n                    item.description = item.description.replaceAll(/[\\u0000-\\u0009\\u000B\\u000C\\u000E-\\u001F\\u007F\\u200B\\uFFFF]/g, '');\r\n                }\r\n\r\n                if (typeof item.author === 'string') {\r\n                    item.author = collapseWhitespace(item.author) || '';\r\n                } else if (typeof item.author === 'object' && item.author !== null) {\r\n                    for (const a of item.author) {\r\n                        a.name = collapseWhitespace(a.name) || '';\r\n                    }\r\n                    if (outputType !== 'json') {\r\n                        item.author = item.author.map((a: { name: string }) => a.name).join(', ');\r\n                    }\r\n                }\r\n\r\n                if (item.itunes_duration && ((typeof item.itunes_duration === 'string' && !item.itunes_duration.includes(':')) || (typeof item.itunes_duration === 'number' && !Number.isNaN(item.itunes_duration)))) {\r\n                    item.itunes_duration = +item.itunes_duration;\r\n                    item.itunes_duration =\r\n                        Math.floor(item.itunes_duration / 3600) + ':' + (Math.floor((item.itunes_duration % 3600) / 60) / 100).toFixed(2).slice(-2) + ':' + (((item.itunes_duration % 3600) % 60) / 100).toFixed(2).slice(-2);\r\n                }\r\n\r\n                if (outputType !== 'rss') {\r\n                    try {\r\n                        item.pubDate && (item.pubDate = convertDateToISO8601(item.pubDate) || '');\r\n                    } catch {\r\n                        item.pubDate = '';\r\n                    }\r\n                    try {\r\n                        item.updated && (item.updated = convertDateToISO8601(item.updated) || '');\r\n                    } catch {\r\n                        item.updated = '';\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    const currentDate = new Date();\r\n    const result = {\r\n        lastBuildDate: currentDate.toUTCString(),\r\n        updated: currentDate.toISOString(),\r\n        ttl,\r\n        atomlink: ctx.req.url,\r\n        ...data,\r\n    };\r\n\r\n    if (config.isPackage) {\r\n        return ctx.json(result);\r\n    }\r\n\r\n    if (ctx.get('redirect')) {\r\n        return ctx.redirect(ctx.get('redirect'), 301);\r\n    } else if (ctx.get('no-content')) {\r\n        return ctx.body(null);\r\n    } else {\r\n        // retain .ums for backward compatibility\r\n        switch (outputType) {\r\n            case 'ums':\r\n            case 'rss3':\r\n                return ctx.json(rss3(result));\r\n            case 'json':\r\n                ctx.header('Content-Type', 'application/feed+json; charset=UTF-8');\r\n                return ctx.body(json(result));\r\n            case 'atom':\r\n                return ctx.render(<Atom data={result} />);\r\n            default:\r\n                return ctx.render(<RSS data={result} />);\r\n        }\r\n    }\r\n};\r\n\r\nexport default middleware;\r\n","import { MiddlewareHandler } from 'hono';\r\nimport logger from '@/utils/logger';\r\nimport { config } from '@/config';\r\nimport * as Sentry from '@sentry/node';\r\nimport { getRouteNameFromPath } from '@/utils/helpers';\r\n\r\nif (config.sentry.dsn) {\r\n    Sentry.init({\r\n        dsn: config.sentry.dsn,\r\n    });\r\n    Sentry.getCurrentScope().setTag('node_name', config.nodeName);\r\n\r\n    logger.info('Sentry inited.');\r\n}\r\n\r\nconst middleware: MiddlewareHandler = async (ctx, next) => {\r\n    const time = Date.now();\r\n    await next();\r\n    if (config.sentry.dsn && Date.now() - time >= config.sentry.routeTimeout) {\r\n        Sentry.withScope((scope) => {\r\n            scope.setTag('name', getRouteNameFromPath(ctx.req.path));\r\n            Sentry.captureException(new Error('Route Timeout'));\r\n        });\r\n    }\r\n};\r\n\r\nexport default middleware;\r\n","import type { MiddlewareHandler } from 'hono';\r\nimport { config } from '@/config';\r\nimport md5 from '@/utils/md5';\r\nimport RejectError from '@/errors/types/reject';\r\n\r\nconst reject = (requestPath) => {\r\n    throw new RejectError(`Authentication failed. Access denied.\\n${requestPath}`);\r\n};\r\n\r\nconst middleware: MiddlewareHandler = async (ctx, next) => {\r\n    const requestPath = new URL(ctx.req.url).pathname;\r\n    const accessKey = ctx.req.query('key');\r\n    const accessCode = ctx.req.query('code');\r\n\r\n    if (requestPath === '/' || requestPath === '/robots.txt' || requestPath === '/favicon.ico' || requestPath === '/logo.png') {\r\n        await next();\r\n    } else {\r\n        if (config.accessKey && !(config.accessKey === accessKey || accessCode === md5(requestPath + config.accessKey))) {\r\n            return reject(requestPath);\r\n        }\r\n        await next();\r\n    }\r\n};\r\n\r\nexport default middleware;\r\n","type DebugInfo = {\r\n    hitCache: number;\r\n    request: number;\r\n    etag: number;\r\n    error: number;\r\n    paths: Record<string, number>;\r\n    routes: Record<string, number>;\r\n    errorPaths: Record<string, number>;\r\n    errorRoutes: Record<string, number>;\r\n};\r\n\r\nconst debug: DebugInfo = {\r\n    hitCache: 0,\r\n    request: 0,\r\n    etag: 0,\r\n    error: 0,\r\n    routes: {},\r\n    paths: {},\r\n    errorRoutes: {},\r\n    errorPaths: {},\r\n};\r\n\r\nexport const getDebugInfo = () => debug;\r\nexport const setDebugInfo = (info: typeof debug) => Object.assign(debug, info);\r\n","import { MiddlewareHandler } from 'hono';\r\nimport { routePath } from 'hono/route';\r\nimport { getDebugInfo, setDebugInfo } from '@/utils/debug-info';\r\n\r\nconst middleware: MiddlewareHandler = async (ctx, next) => {\r\n    {\r\n        const debug = getDebugInfo();\r\n        if (!debug.paths[ctx.req.path]) {\r\n            debug.paths[ctx.req.path] = 0;\r\n        }\r\n        debug.paths[ctx.req.path]++;\r\n\r\n        debug.request++;\r\n        setDebugInfo(debug);\r\n    }\r\n\r\n    await next();\r\n\r\n    {\r\n        const debug = getDebugInfo();\r\n        const rPath = routePath(ctx);\r\n        const hasMatchedRoute = rPath !== '/*';\r\n        if (!debug.routes[rPath] && hasMatchedRoute) {\r\n            debug.routes[rPath] = 0;\r\n        }\r\n        hasMatchedRoute && debug.routes[rPath]++;\r\n\r\n        if (ctx.res.headers.get('RSSHub-Cache-Status')) {\r\n            debug.hitCache++;\r\n        }\r\n\r\n        if (ctx.res.status === 304) {\r\n            debug.etag++;\r\n        }\r\n        setDebugInfo(debug);\r\n    }\r\n};\r\n\r\nexport default middleware;\r\n","import { MiddlewareHandler } from 'hono';\r\nimport { routePath } from 'hono/route';\r\nimport etagCalculate from 'etag';\r\nimport { config } from '@/config';\r\nimport { Data } from '@/types';\r\n\r\nconst headers: Record<string, string> = {\r\n    'Access-Control-Allow-Methods': 'GET',\r\n    'Content-Type': 'application/xml; charset=utf-8',\r\n    'Cache-Control': `public, max-age=${config.cache.routeExpire}`,\r\n    'X-Content-Type-Options': 'nosniff',\r\n};\r\nif (config.nodeName) {\r\n    headers['RSSHub-Node'] = config.nodeName;\r\n}\r\n\r\nfunction etagMatches(etag: string, ifNoneMatch: string | null) {\r\n    return ifNoneMatch !== null && ifNoneMatch.split(/,\\s*/).includes(etag);\r\n}\r\n\r\nconst middleware: MiddlewareHandler = async (ctx, next) => {\r\n    for (const key in headers) {\r\n        ctx.header(key, headers[key]);\r\n    }\r\n    ctx.header('Access-Control-Allow-Origin', config.allowOrigin || new URL(ctx.req.url).host);\r\n\r\n    await next();\r\n    const rPath = routePath(ctx);\r\n\r\n    if (rPath !== '/*') {\r\n        ctx.header('X-RSSHub-Route', rPath);\r\n    }\r\n\r\n    const data: Data = ctx.get('data');\r\n    if (!data || ctx.res.headers.get('ETag')) {\r\n        return;\r\n    }\r\n\r\n    const lastBuildDate = data.lastBuildDate;\r\n    delete data.lastBuildDate;\r\n    const etag = etagCalculate(JSON.stringify(data));\r\n\r\n    ctx.header('ETag', etag);\r\n\r\n    const ifNoneMatch = ctx.req.header('If-None-Match') ?? null;\r\n    if (etagMatches(etag, ifNoneMatch)) {\r\n        ctx.status(304);\r\n        ctx.set('no-content', true);\r\n    } else {\r\n        ctx.header('Last-Modified', lastBuildDate);\r\n    }\r\n};\r\n\r\nexport default middleware;\r\n","import { config } from '@/config';\r\nimport { load, type CheerioAPI } from 'cheerio';\r\nimport logger from '@/utils/logger';\r\nimport { type MiddlewareHandler } from 'hono';\r\nimport { Data } from '@/types';\r\n\r\nconst templateRegex = /\\${([^{}]+)}/g;\r\nconst allowedUrlProperties = new Set(['hash', 'host', 'hostname', 'href', 'origin', 'password', 'pathname', 'port', 'protocol', 'search', 'searchParams', 'username']);\r\n\r\n// match path or sub-path\r\nconst matchPath = (path: string, paths: string[]) => {\r\n    for (const p of paths) {\r\n        if (path.startsWith(p) && (path.length === p.length || path[p.length] === '/')) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n};\r\n\r\n// return true if the path needs to be processed\r\nconst filterPath = (path: string) => {\r\n    const include = config.hotlink.includePaths;\r\n    const exclude = config.hotlink.excludePaths;\r\n    return !(include && !matchPath(path, include)) && !(exclude && matchPath(path, exclude));\r\n};\r\n\r\nconst interpolate = (str: string, obj: Record<string, any>) =>\r\n    str.replaceAll(templateRegex, (_, prop) => {\r\n        let needEncode = false;\r\n        if (prop.endsWith('_ue')) {\r\n            // url encode\r\n            prop = prop.slice(0, -3);\r\n            needEncode = true;\r\n        }\r\n        return needEncode ? encodeURIComponent(obj[prop]) : obj[prop];\r\n    });\r\nconst parseUrl = (str: string) => {\r\n    let url;\r\n    try {\r\n        url = new URL(str);\r\n    } catch {\r\n        logger.error(`Failed to parse ${str}`);\r\n    }\r\n\r\n    return url;\r\n};\r\n\r\nconst replaceUrl = (template?: string, url?: string) => {\r\n    if (!template || !url) {\r\n        return url;\r\n    }\r\n    const oldUrl = parseUrl(url);\r\n    if (oldUrl && oldUrl.protocol !== 'data:') {\r\n        return interpolate(template, oldUrl);\r\n    }\r\n    return url;\r\n};\r\n\r\nconst replaceUrls = ($: CheerioAPI, selector: string, template: string, attribute = 'src') => {\r\n    $(selector).each(function () {\r\n        const oldSrc = $(this).attr(attribute);\r\n        if (oldSrc) {\r\n            const url = parseUrl(oldSrc);\r\n            if (url && url.protocol !== 'data:') {\r\n                // Cheerio will do the right thing to prohibit XSS.\r\n                $(this).attr(attribute, interpolate(template, url));\r\n            }\r\n        }\r\n    });\r\n};\r\n\r\nconst process = (html: string, image_hotlink_template?: string, multimedia_hotlink_template?: string) => {\r\n    const $ = load(html, undefined, false);\r\n    if (image_hotlink_template) {\r\n        replaceUrls($, 'img, picture > source', image_hotlink_template);\r\n        replaceUrls($, 'video[poster]', image_hotlink_template, 'poster');\r\n        replaceUrls($, '*[data-rsshub-image=\"href\"]', image_hotlink_template, 'href');\r\n    }\r\n    if (multimedia_hotlink_template) {\r\n        replaceUrls($, 'video, video > source, audio, audio > source', multimedia_hotlink_template);\r\n        if (!image_hotlink_template) {\r\n            replaceUrls($, 'video[poster]', multimedia_hotlink_template, 'poster');\r\n        }\r\n    }\r\n    return $.html();\r\n};\r\n\r\nconst validateTemplate = (template?: string) => {\r\n    if (!template) {\r\n        return;\r\n    }\r\n    for (const match of template.matchAll(templateRegex)) {\r\n        const prop = match[1].endsWith('_ue') ? match[1].slice(0, -3) : match[1];\r\n        if (!allowedUrlProperties.has(prop)) {\r\n            throw new Error(`Invalid URL property: ${prop}`);\r\n        }\r\n    }\r\n};\r\n\r\nconst middleware: MiddlewareHandler = async (ctx, next) => {\r\n    await next();\r\n\r\n    let imageHotlinkTemplate: string | undefined;\r\n    let multimediaHotlinkTemplate: string | undefined;\r\n\r\n    // Read params if enabled\r\n    if (config.feature.allow_user_hotlink_template) {\r\n        // By default, the config turns these features off. Set corresponding config to\r\n        // true to turn this feature on.\r\n        // A risk is that the media URLs will be replaced by user-supplied templates,\r\n        // so a user could literally take the control of \"where are the media from\",\r\n        // but only in their personal-use feed URL.\r\n        multimediaHotlinkTemplate = ctx.req.query('multimedia_hotlink_template');\r\n        imageHotlinkTemplate = ctx.req.query('image_hotlink_template');\r\n    }\r\n\r\n    // Force config hotlink template on conflict\r\n    if (config.hotlink.template) {\r\n        imageHotlinkTemplate = filterPath(ctx.req.path) ? config.hotlink.template : undefined;\r\n        multimediaHotlinkTemplate = filterPath(ctx.req.path) ? config.hotlink.template : undefined;\r\n    }\r\n\r\n    if (!imageHotlinkTemplate && !multimediaHotlinkTemplate) {\r\n        return;\r\n    }\r\n\r\n    validateTemplate(imageHotlinkTemplate);\r\n    validateTemplate(multimediaHotlinkTemplate);\r\n\r\n    // Assume that only description include image link\r\n    // and here we will only check them in description.\r\n    // Use Cheerio to load the description as html and filter all\r\n    // image link\r\n    const data: Data = ctx.get('data');\r\n    if (data) {\r\n        if (data.image) {\r\n            data.image = replaceUrl(imageHotlinkTemplate, data.image);\r\n        }\r\n        if (data.description) {\r\n            data.description = process(data.description, imageHotlinkTemplate, multimediaHotlinkTemplate);\r\n        }\r\n\r\n        if (data.item) {\r\n            for (const item of data.item) {\r\n                if (item.description) {\r\n                    item.description = process(item.description, imageHotlinkTemplate, multimediaHotlinkTemplate);\r\n                }\r\n                if (item.enclosure_url && item.enclosure_type) {\r\n                    if (item.enclosure_type.startsWith('image/')) {\r\n                        item.enclosure_url = replaceUrl(imageHotlinkTemplate, item.enclosure_url);\r\n                    } else if (/^(video|audio)\\//.test(item.enclosure_type)) {\r\n                        item.enclosure_url = replaceUrl(multimediaHotlinkTemplate, item.enclosure_url);\r\n                    }\r\n                }\r\n                if (item.image) {\r\n                    item.image = replaceUrl(imageHotlinkTemplate, item.image);\r\n                }\r\n                if (item.itunes_item_image) {\r\n                    item.itunes_item_image = replaceUrl(imageHotlinkTemplate, item.itunes_item_image);\r\n                }\r\n            }\r\n        }\r\n\r\n        ctx.set('data', data);\r\n    }\r\n};\r\n\r\nexport default middleware;\r\n","import * as entities from 'entities';\r\nimport { load, type CheerioAPI } from 'cheerio';\r\nimport type { Element } from 'domhandler';\r\nimport { simplecc } from 'simplecc-wasm';\r\nimport ofetch from '@/utils/ofetch';\r\nimport { config } from '@/config';\r\nimport { RE2JS } from 're2js';\r\nimport markdownit from 'markdown-it';\r\nimport { convert } from 'html-to-text';\r\nimport sanitizeHtml from 'sanitize-html';\r\nimport { MiddlewareHandler } from 'hono';\r\nimport cache from '@/utils/cache';\r\nimport Parser from '@postlight/parser';\r\nimport { Data, DataItem } from '@/types';\r\n\r\nconst md = markdownit({\r\n    html: true,\r\n});\r\n\r\nconst resolveRelativeLink = ($: CheerioAPI, elem: Element, attr: string, baseUrl?: string) => {\r\n    const $elem = $(elem);\r\n\r\n    if (baseUrl) {\r\n        try {\r\n            const oldAttr = $elem.attr(attr);\r\n            if (oldAttr) {\r\n                // e.g. <video><source src=\"https://example.com\"></video> should leave <video> unchanged\r\n                $elem.attr(attr, new URL(oldAttr, baseUrl).href);\r\n            }\r\n        } catch {\r\n            // no-empty\r\n        }\r\n    }\r\n};\r\n\r\nconst getAiCompletion = async (prompt: string, text: string) => {\r\n    const apiUrl = `${config.openai.endpoint}/chat/completions`;\r\n    const response = await ofetch(apiUrl, {\r\n        method: 'POST',\r\n        body: {\r\n            model: config.openai.model,\r\n            max_tokens: config.openai.maxTokens,\r\n            messages: [\r\n                { role: 'system', content: prompt },\r\n                { role: 'user', content: text },\r\n            ],\r\n            temperature: config.openai.temperature,\r\n        },\r\n        headers: {\r\n            Authorization: `Bearer ${config.openai.apiKey}`,\r\n        },\r\n    });\r\n\r\n    return response.choices[0].message.content;\r\n};\r\n\r\nconst getAuthorString = (item) => {\r\n    let author = '';\r\n    if (item.author) {\r\n        author = typeof item.author === 'string' ? item.author : item.author.map((i) => i.name).join(' ');\r\n    }\r\n    return author;\r\n};\r\n\r\nconst middleware: MiddlewareHandler = async (ctx, next) => {\r\n    await next();\r\n\r\n    const data = ctx.get('data') as Data;\r\n    if (data) {\r\n        if ((!data.item || data.item.length === 0) && !data.allowEmpty) {\r\n            throw new Error('this route is empty, please check the original site or <a href=\"https://github.com/DIYgod/RSSHub/issues/new/choose\">create an issue</a>');\r\n        }\r\n\r\n        // fix allowEmpty\r\n        data.item = data.item || [];\r\n\r\n        // decode HTML entities\r\n        data.title && (data.title = entities.decodeXML(data.title + ''));\r\n        data.description && (data.description = entities.decodeXML(data.description + ''));\r\n\r\n        // sort items\r\n        if (ctx.req.query('sorted') !== 'false') {\r\n            data.item = data.item.sort((a: DataItem, b: DataItem) => +new Date(b.pubDate || 0) - +new Date(a.pubDate || 0));\r\n        }\r\n\r\n        const handleItem = (item: DataItem) => {\r\n            item.title && (item.title = entities.decodeXML(item.title + ''));\r\n\r\n            // handle pubDate\r\n            if (item.pubDate) {\r\n                item.pubDate = new Date(item.pubDate).toUTCString();\r\n            }\r\n\r\n            // handle link\r\n            if (item.link) {\r\n                let baseUrl = data.link;\r\n                if (baseUrl && !/^https?:\\/\\//.test(baseUrl)) {\r\n                    baseUrl = /^\\/\\//.test(baseUrl) ? 'http:' + baseUrl : 'http://' + baseUrl;\r\n                }\r\n\r\n                item.link = new URL(item.link, baseUrl).href;\r\n            }\r\n\r\n            // handle description\r\n            if (item.description) {\r\n                const $ = load(item.description);\r\n                let baseUrl = item.link || data.link;\r\n\r\n                if (baseUrl && !/^https?:\\/\\//.test(baseUrl)) {\r\n                    baseUrl = /^\\/\\//.test(baseUrl) ? 'http:' + baseUrl : 'http://' + baseUrl;\r\n                }\r\n\r\n                $('script').remove();\r\n\r\n                $('img').each((_, ele) => {\r\n                    const $ele = $(ele);\r\n\r\n                    // fix lazyload\r\n                    if (!$ele.attr('src')) {\r\n                        const lazySrc = $ele.attr('data-src') || $ele.attr('data-original');\r\n                        if (lazySrc) {\r\n                            $ele.attr('src', lazySrc);\r\n                        } else {\r\n                            for (const key in ele.attribs) {\r\n                                const value = ele.attribs[key].trim();\r\n                                if (['.gif', '.png', '.jpg', '.webp'].some((suffix) => value.includes(suffix))) {\r\n                                    $ele.attr('src', value);\r\n                                    break;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    // redundant attributes\r\n                    for (const e of ['onclick', 'onerror', 'onload']) {\r\n                        $ele.removeAttr(e);\r\n                    }\r\n                });\r\n\r\n                // resolve relative link & fix referrer policy\r\n                // https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy\r\n                // https://www.w3schools.com/tags/att_href.asp\r\n                $('a, area').each((_, elem) => {\r\n                    resolveRelativeLink($, elem, 'href', baseUrl);\r\n                    // $(elem).attr('rel', 'noreferrer');  // currently no such a need\r\n                });\r\n                // https://www.w3schools.com/tags/att_src.asp\r\n                $('img, video, audio, source, iframe, embed, track').each((_, elem) => {\r\n                    resolveRelativeLink($, elem, 'src', baseUrl);\r\n                });\r\n                $('video[poster]').each((_, elem) => {\r\n                    resolveRelativeLink($, elem, 'poster', baseUrl);\r\n                });\r\n                $('img, iframe').each((_, elem) => {\r\n                    $(elem).attr('referrerpolicy', 'no-referrer');\r\n                });\r\n\r\n                item.description = $('body').html() + '' + (config.suffix || '');\r\n\r\n                if (item._extra?.links && $('.rsshub-quote').length) {\r\n                    item._extra?.links?.map((e) => {\r\n                        e.content_html = $.html($('.rsshub-quote'));\r\n                        return e;\r\n                    });\r\n                }\r\n            }\r\n\r\n            // handle category\r\n            if (item.category) {\r\n                // convert single string to array, and filter only string type category\r\n                Array.isArray(item.category) || (item.category = [item.category]);\r\n                item.category = item.category.filter((e) => typeof e === 'string');\r\n            }\r\n            return item;\r\n        };\r\n\r\n        data.item = await Promise.all(data.item.map((itm) => handleItem(itm)));\r\n\r\n        // filter\r\n        const engine = config.feature.filter_regex_engine;\r\n        const makeRegex = (str: string) => {\r\n            // default: case_senstivie = true\r\n            const insensitive = ctx.req.query('filter_case_sensitive') === 'false';\r\n            switch (engine) {\r\n                case 'regexp':\r\n                    return new RegExp(str, insensitive ? 'i' : '');\r\n                case 're2':\r\n                    return RE2JS.compile(str, insensitive ? RE2JS.CASE_INSENSITIVE : 0);\r\n                default:\r\n                    throw new Error(`Invalid Engine Value: ${engine}, please check your config.`);\r\n            }\r\n        };\r\n\r\n        if (ctx.req.query('filter')) {\r\n            const regex = makeRegex(ctx.req.query('filter')!);\r\n\r\n            data.item = data.item.filter((item) => {\r\n                const title = item.title || '';\r\n                const description = item.description || title;\r\n                const author = getAuthorString(item);\r\n                const category = item.category || [];\r\n                const isFilter =\r\n                    regex instanceof RE2JS\r\n                        ? regex.matcher(title).find() || regex.matcher(description).find() || regex.matcher(author).find() || category.some((c) => regex.matcher(c).find())\r\n                        : title.match(regex) || description.match(regex) || author.match(regex) || category.some((c) => c.match(regex));\r\n\r\n                return isFilter;\r\n            });\r\n        }\r\n\r\n        // 启用filter参数时，无效filter_title/description/author/category\r\n        if (!ctx.req.query('filter') && (ctx.req.query('filter_title') || ctx.req.query('filter_description') || ctx.req.query('filter_author') || ctx.req.query('filter_category'))) {\r\n            data.item = data.item.filter((item) => {\r\n                const title = item.title || '';\r\n                const description = item.description || title;\r\n                const author = getAuthorString(item);\r\n                const category = item.category || [];\r\n                let isFilter = true;\r\n\r\n                if (ctx.req.query('filter_title')) {\r\n                    const titleRegex = makeRegex(ctx.req.query('filter_title')!);\r\n                    isFilter = titleRegex instanceof RE2JS ? titleRegex.matcher(title).find() : !!titleRegex.test(title);\r\n                }\r\n                if (ctx.req.query('filter_description')) {\r\n                    const descriptionRegex = makeRegex(ctx.req.query('filter_description')!);\r\n                    isFilter = isFilter && (descriptionRegex instanceof RE2JS ? descriptionRegex.matcher(description).find() : !!descriptionRegex.test(description));\r\n                }\r\n                if (ctx.req.query('filter_author')) {\r\n                    const authorRegex = makeRegex(ctx.req.query('filter_author')!);\r\n                    isFilter = isFilter && (authorRegex instanceof RE2JS ? authorRegex.matcher(author).find() : !!authorRegex.test(author));\r\n                }\r\n                if (ctx.req.query('filter_category')) {\r\n                    const categoryRegex = makeRegex(ctx.req.query('filter_category')!);\r\n                    isFilter = isFilter && category.some((c) => (categoryRegex instanceof RE2JS ? categoryRegex.matcher(c).find() : c.match(categoryRegex)));\r\n                }\r\n\r\n                return isFilter;\r\n            });\r\n        }\r\n\r\n        if (ctx.req.query('filterout') || ctx.req.query('filterout_title') || ctx.req.query('filterout_description') || ctx.req.query('filterout_author') || ctx.req.query('filterout_category')) {\r\n            data.item = data.item.filter((item) => {\r\n                const title = item.title;\r\n                const description = item.description || title;\r\n                const author = getAuthorString(item);\r\n                const category = item.category || [];\r\n                let isFilter = true;\r\n\r\n                if (ctx.req.query('filterout') || ctx.req.query('filterout_title')) {\r\n                    const titleRegex = makeRegex(ctx.req.query('filterout_title') || ctx.req.query('filterout')!);\r\n                    isFilter = titleRegex instanceof RE2JS ? !titleRegex.matcher(title).find() : !titleRegex.test(title);\r\n                }\r\n                if (ctx.req.query('filterout') || ctx.req.query('filterout_description')) {\r\n                    const descriptionRegex = makeRegex(ctx.req.query('filterout_description') || ctx.req.query('filterout')!);\r\n                    isFilter = isFilter && (descriptionRegex instanceof RE2JS ? !descriptionRegex.matcher(description).find() : !descriptionRegex.test(description));\r\n                }\r\n                if (ctx.req.query('filterout_author')) {\r\n                    const authorRegex = makeRegex(ctx.req.query('filterout_author')!);\r\n                    isFilter = isFilter && (authorRegex instanceof RE2JS ? !authorRegex.matcher(author).find() : !authorRegex.test(author));\r\n                }\r\n                if (ctx.req.query('filterout_category')) {\r\n                    const categoryRegex = makeRegex(ctx.req.query('filterout_category')!);\r\n                    isFilter = isFilter && !category.some((c) => (categoryRegex instanceof RE2JS ? categoryRegex.matcher(c).find() : c.match(categoryRegex)));\r\n                }\r\n\r\n                return isFilter;\r\n            });\r\n        }\r\n\r\n        if (ctx.req.query('filter_time')) {\r\n            const now = Date.now();\r\n            data.item = data.item.filter(({ pubDate }) => {\r\n                let isFilter = true;\r\n                try {\r\n                    isFilter = !pubDate || now - new Date(pubDate).getTime() <= Number.parseInt(ctx.req.query('filter_time')!) * 1000;\r\n                } catch {\r\n                    // no-empty\r\n                }\r\n                return isFilter;\r\n            });\r\n        }\r\n\r\n        // limit\r\n        if (ctx.req.query('limit')) {\r\n            data.item = data.item.slice(0, Number.parseInt(ctx.req.query('limit')!));\r\n        }\r\n\r\n        // telegram instant view\r\n        if (ctx.req.query('tgiv')) {\r\n            data.item.map((item) => {\r\n                if (item.link) {\r\n                    const encodedlink = encodeURIComponent(item.link);\r\n                    item.link = `https://t.me/iv?url=${encodedlink}&rhash=${ctx.req.query('tgiv')}`;\r\n                    return item;\r\n                } else {\r\n                    return item;\r\n                }\r\n            });\r\n        }\r\n\r\n        // fulltext\r\n        if (ctx.req.query('mode')?.toLowerCase() === 'fulltext') {\r\n            const tasks = data.item.map(async (item) => {\r\n                const { link, author, description } = item;\r\n                const parsed_result: any = await cache.tryGet(`mercury-cache-${link}`, async () => {\r\n                    if (link) {\r\n                        // if parser failed, return default description and not report error\r\n                        try {\r\n                            const res = await ofetch(link);\r\n                            const $ = load(res);\r\n                            const result = await Parser.parse(link, {\r\n                                html: $.html(),\r\n                            });\r\n                            return result;\r\n                        } catch {\r\n                            // no-empty\r\n                        }\r\n                    }\r\n                });\r\n\r\n                item.author = author || parsed_result?.author;\r\n                item.description = parsed_result && parsed_result.content.length > 40 ? entities.decodeXML(parsed_result.content) : description;\r\n            });\r\n            await Promise.all(tasks);\r\n        }\r\n\r\n        // openai\r\n        if (ctx.req.query('chatgpt') && config.openai.apiKey) {\r\n            data.item = await Promise.all(\r\n                data.item.map(async (item) => {\r\n                    try {\r\n                        // handle description\r\n                        if (config.openai.inputOption === 'description' && item.description) {\r\n                            const description = await cache.tryGet(`openai:description:${item.link}`, async () => {\r\n                                const description = convert(item.description!);\r\n                                const descriptionMd = await getAiCompletion(config.openai.promptDescription, description);\r\n                                return md.render(descriptionMd);\r\n                            });\r\n                            // add it to the description\r\n                            if (description !== '') {\r\n                                item.description = description + '<hr/><br/>' + item.description;\r\n                            }\r\n                        }\r\n                        // handle title\r\n                        else if (config.openai.inputOption === 'title' && item.title) {\r\n                            const title = await cache.tryGet(`openai:title:${item.link}`, async () => {\r\n                                const title = convert(item.title!);\r\n                                return await getAiCompletion(config.openai.promptTitle, title);\r\n                            });\r\n                            // replace the title\r\n                            if (title !== '') {\r\n                                item.title = title + '';\r\n                            }\r\n                        }\r\n                        // handle both\r\n                        else if (config.openai.inputOption === 'both' && item.title && item.description) {\r\n                            const title = await cache.tryGet(`openai:title:${item.link}`, async () => {\r\n                                const title = convert(item.title!);\r\n                                return await getAiCompletion(config.openai.promptTitle, title);\r\n                            });\r\n                            // replace the title\r\n                            if (title !== '') {\r\n                                item.title = title + '';\r\n                            }\r\n\r\n                            const description = await cache.tryGet(`openai:description:${item.link}`, async () => {\r\n                                const description = convert(item.description!);\r\n                                const descriptionMd = await getAiCompletion(config.openai.promptDescription, description);\r\n                                return md.render(descriptionMd);\r\n                            });\r\n                            // add it to the description\r\n                            if (description !== '') {\r\n                                item.description = description + '<hr/><br/>' + item.description;\r\n                            }\r\n                        }\r\n                    } catch {\r\n                        // when openai failed, return default content and not write cache\r\n                    }\r\n                    return item;\r\n                })\r\n            );\r\n        }\r\n\r\n        // scihub\r\n        if (ctx.req.query('scihub')) {\r\n            data.item.map((item) => {\r\n                item.link = item.doi ? `${config.scihub.host}${item.doi}` : `${config.scihub.host}${item.link}`;\r\n                return item;\r\n            });\r\n        }\r\n\r\n        // opencc\r\n        if (ctx.req.query('opencc')) {\r\n            for (const item of data.item) {\r\n                item.title = simplecc(item.title ?? item.link, ctx.req.query('opencc')!);\r\n                item.description = simplecc(item.description ?? item.title ?? item.link, ctx.req.query('opencc')!);\r\n            }\r\n        }\r\n\r\n        // brief\r\n        if (ctx.req.query('brief')) {\r\n            const num = /[1-9]\\d{2,}/;\r\n            if (num.test(ctx.req.query('brief')!)) {\r\n                const brief: number = Number.parseInt(ctx.req.query('brief')!);\r\n                for (const item of data.item) {\r\n                    let text;\r\n                    if (item.description) {\r\n                        text = sanitizeHtml(item.description, { allowedTags: [], allowedAttributes: {} });\r\n                        item.description = text.length > brief ? `<p>${text.slice(0, brief)}…</p>` : `<p>${text}</p>`;\r\n                    }\r\n                }\r\n            } else {\r\n                throw new Error(`Invalid parameter brief. Please check the doc https://docs.rsshub.app/guide/parameters#shu-chu-jian-xun`);\r\n            }\r\n        }\r\n        // some parameters are processed in `anti-hotlink.js`\r\n\r\n        ctx.set('data', data);\r\n    } else {\r\n        // throw new Error('wrong path');\r\n    }\r\n};\r\n\r\nexport default middleware;\r\n","import { MiddlewareHandler } from 'hono';\r\nimport { getPath } from '@/utils/helpers';\r\nimport { config } from '@/config';\r\nimport { tracer } from '@/utils/otel';\r\n\r\nconst middleware: MiddlewareHandler = async (ctx, next) => {\r\n    if (config.debugInfo) {\r\n        // Only enable tracing in debug mode\r\n        const { method, raw } = ctx.req;\r\n        const path = getPath(raw);\r\n\r\n        const span = tracer.startSpan(`${method} ${path}`, {\r\n            kind: 1, // server\r\n            attributes: {},\r\n        });\r\n        span.addEvent('invoking handleRequest');\r\n        await next();\r\n        span.end();\r\n    } else {\r\n        // Skip\r\n        await next();\r\n    }\r\n};\r\n\r\nexport default middleware;\r\n","import type { FC } from 'hono/jsx';\r\n\r\nexport const Layout: FC = (props) => (\r\n    <html>\r\n        <head>\r\n            <title>Welcome to RSSHub!</title>\r\n            <script src=\"https://cdn.tailwindcss.com\"></script>\r\n            <style>\r\n                {`\r\n                details::-webkit-scrollbar {\r\n                    width: 0.25rem;\r\n                }\r\n                details::-webkit-scrollbar-thumb {\r\n                    border-radius: 0.125rem;\r\n                    background-color: #e4e4e7;\r\n                }\r\n                details::-webkit-scrollbar-thumb:hover {\r\n                    background-color: #a1a1aa;\r\n                }\r\n\r\n                @font-face {\r\n                    font-family: SN Pro;\r\n                    font-style: normal;\r\n                    font-display: swap;\r\n                    font-weight: 400;\r\n                    src: url(https://cdn.jsdelivr.net/fontsource/fonts/sn-pro@latest/latin-400-normal.woff2) format(woff2);\r\n                }\r\n                @font-face {\r\n                    font-family: SN Pro;\r\n                    font-style: normal;\r\n                    font-display: swap;\r\n                    font-weight: 500;\r\n                    src: url(https://cdn.jsdelivr.net/fontsource/fonts/sn-pro@latest/latin-500-normal.woff2) format(woff2);\r\n                }\r\n                @font-face {\r\n                    font-family: SN Pro;\r\n                    font-style: normal;\r\n                    font-display: swap;\r\n                    font-weight: 700;\r\n                    src: url(https://cdn.jsdelivr.net/fontsource/fonts/sn-pro@latest/latin-700-normal.woff2) format(woff2);\r\n                }\r\n                body {\r\n                    font-family: SN Pro, sans-serif;\r\n                }\r\n                `}\r\n            </style>\r\n        </head>\r\n        <body className=\"antialiased min-h-screen text-zinc-700 flex flex-col\">{props.children}</body>\r\n    </html>\r\n);\r\n","import { execSync } from 'node:child_process';\r\n\r\nlet gitHash = process.env.HEROKU_SLUG_COMMIT?.slice(0, 8) || process.env.VERCEL_GIT_COMMIT_SHA?.slice(0, 8);\r\nlet gitDate: Date | undefined;\r\nif (!gitHash) {\r\n    try {\r\n        gitHash = execSync('git rev-parse HEAD').toString().trim().slice(0, 8);\r\n        gitDate = new Date(execSync('git log -1 --format=%cd').toString().trim());\r\n    } catch {\r\n        gitHash = 'unknown';\r\n    }\r\n}\r\n\r\nexport { gitHash, gitDate };\r\n","import type { FC } from 'hono/jsx';\r\n\r\nimport { Layout } from '@/views/layout';\r\nimport { gitHash, gitDate } from '@/utils/git-hash';\r\n\r\nconst Index: FC<{\r\n    requestPath: string;\r\n    message: string;\r\n    errorRoute: string;\r\n    nodeVersion: string;\r\n}> = ({ requestPath, message, errorRoute, nodeVersion }) => (\r\n    <Layout>\r\n        <div\r\n            className=\"pointer-events-none absolute w-full min-h-screen\"\r\n            style={{\r\n                backgroundImage: `url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHZpZXdCb3g9JzAgMCAzMiAzMicgd2lkdGg9JzMyJyBoZWlnaHQ9JzMyJyBmaWxsPSdub25lJyBzdHJva2U9J3JnYigxNSAyMyA0MiAvIDAuMDQpJz48cGF0aCBkPSdNMCAuNUgzMS41VjMyJy8+PC9zdmc+')`,\r\n                maskImage: 'linear-gradient(transparent, black, transparent)',\r\n            }}\r\n        ></div>\r\n        <div className=\"w-full grow shrink-0 py-8 flex items-center justify-center flex-col space-y-4\">\r\n            <img className=\"grayscale\" src=\"/logo.png\" alt=\"RSSHub\" width=\"100\" loading=\"lazy\" />\r\n            <h1 className=\"text-4xl font-bold\">Looks like something went wrong</h1>\r\n            <div className=\"text-left w-[800px] space-y-6 !mt-10\">\r\n                <div className=\"space-y-2\">\r\n                    <p className=\"mb-2 font-bold\">Helpful Information</p>\r\n                    <p className=\"message\">\r\n                        Error Message:\r\n                        <br />\r\n                        <code className=\"mt-2 block max-h-28 overflow-auto bg-zinc-100 align-bottom w-fit details whitespace-pre-line\">{message}</code>\r\n                    </p>\r\n                    <p className=\"message\">\r\n                        Route: <code className=\"ml-2 bg-zinc-100\">{errorRoute}</code>\r\n                    </p>\r\n                    <p className=\"message\">\r\n                        Full Route: <code className=\"ml-2 bg-zinc-100\">{requestPath}</code>\r\n                    </p>\r\n                    <p className=\"message\">\r\n                        Node Version: <code className=\"ml-2 bg-zinc-100\">{nodeVersion}</code>\r\n                    </p>\r\n                    <p className=\"message\">\r\n                        Git Hash: <code className=\"ml-2 bg-zinc-100\">{gitHash}</code>\r\n                    </p>\r\n                    <p className=\"message\">\r\n                        Git Date: <code className=\"ml-2 bg-zinc-100\">{gitDate?.toUTCString()}</code>\r\n                    </p>\r\n                </div>\r\n                <div>\r\n                    <p className=\"mb-2 font-bold\">Report</p>\r\n                    <p>\r\n                        After carefully reading the{' '}\r\n                        <a className=\"text-[#F5712C]\" href=\"https://docs.rsshub.app/\" target=\"_blank\">\r\n                            document\r\n                        </a>\r\n                        , if you think this is a bug of RSSHub, please{' '}\r\n                        <a className=\"text-[#F5712C]\" href=\"https://github.com/DIYgod/RSSHub/issues/new?assignees=&labels=RSS+bug&template=bug_report_en.yml\" target=\"_blank\">\r\n                            submit an issue\r\n                        </a>{' '}\r\n                        on GitHub.\r\n                    </p>\r\n                    <p>\r\n                        在仔细阅读\r\n                        <a className=\"text-[#F5712C]\" href=\"https://docs.rsshub.app/zh/\" target=\"_blank\">\r\n                            文档\r\n                        </a>\r\n                        后，如果你认为这是 RSSHub 的 bug，请在 GitHub{' '}\r\n                        <a className=\"text-[#F5712C]\" href=\"https://github.com/DIYgod/RSSHub/issues/new?assignees=&labels=RSS+bug&template=bug_report_zh.yml\" target=\"_blank\">\r\n                            提交 issue\r\n                        </a>\r\n                        。\r\n                    </p>\r\n                </div>\r\n                <div>\r\n                    <p className=\"mb-2 font-bold\">Community</p>\r\n                    <p>\r\n                        You can also join our{' '}\r\n                        <a className=\"text-[#F5712C]\" target=\"_blank\" href=\"https://t.me/rsshub\">\r\n                            Telegram group\r\n                        </a>\r\n                        , or follow our{' '}\r\n                        <a className=\"text-[#F5712C]\" target=\"_blank\" href=\"https://t.me/awesomeRSSHub\">\r\n                            Telegram channel\r\n                        </a>{' '}\r\n                        and{' '}\r\n                        <a target=\"_blank\" href=\"https://x.com/intent/follow?screen_name=_RSSHub\" className=\"text-[#F5712C]\">\r\n                            Twitter\r\n                        </a>{' '}\r\n                        to get community support and news.\r\n                    </p>\r\n                    <p>\r\n                        你也可以加入我们的{' '}\r\n                        <a className=\"text-[#F5712C]\" target=\"_blank\" href=\"https://t.me/rsshub\">\r\n                            Telegram 群组\r\n                        </a>\r\n                        ，或关注我们的{' '}\r\n                        <a className=\"text-[#F5712C]\" target=\"_blank\" href=\"https://t.me/awesomeRSSHub\">\r\n                            Telegram 频道\r\n                        </a>\r\n                        和{' '}\r\n                        <a target=\"_blank\" href=\"https://x.com/intent/follow?screen_name=_RSSHub\" className=\"text-[#F5712C]\">\r\n                            Twitter\r\n                        </a>{' '}\r\n                        获取社区支持和新闻。\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div className=\"mt-4 pb-8 text-center w-full text-sm font-medium space-y-2\">\r\n            <p className=\"space-x-4\">\r\n                <a target=\"_blank\" href=\"https://github.com/DIYgod/RSSHub\">\r\n                    <img className=\"inline\" src=\"https://icons.ly/github/_/fff\" alt=\"github\" width=\"20\" height=\"20\" />\r\n                </a>\r\n                <a target=\"_blank\" href=\"https://t.me/rsshub\">\r\n                    <img className=\"inline\" src=\"https://icons.ly/telegram\" alt=\"telegram group\" width=\"20\" height=\"20\" />\r\n                </a>\r\n                <a target=\"_blank\" href=\"https://t.me/awesomeRSSHub\">\r\n                    <img className=\"inline\" src=\"https://icons.ly/telegram\" alt=\"telegram channel\" width=\"20\" height=\"20\" />\r\n                </a>\r\n                <a target=\"_blank\" href=\"https://x.com/intent/follow?screen_name=_RSSHub\" className=\"text-[#F5712C]\">\r\n                    <img className=\"inline\" src=\"https://icons.ly/x\" alt=\"X\" width=\"20\" height=\"20\" />\r\n                </a>\r\n            </p>\r\n            <p className=\"!mt-6\">\r\n                Please consider{' '}\r\n                <a target=\"_blank\" href=\"https://docs.rsshub.app/sponsor\" className=\"text-[#F5712C]\">\r\n                    sponsoring\r\n                </a>{' '}\r\n                to help keep this open source project alive.\r\n            </p>\r\n            <p>\r\n                Made with ❤️ by{' '}\r\n                <a target=\"_blank\" href=\"https://diygod.cc\" className=\"text-[#F5712C]\">\r\n                    DIYgod\r\n                </a>{' '}\r\n                and{' '}\r\n                <a target=\"_blank\" href=\"https://github.com/DIYgod/RSSHub/graphs/contributors\" className=\"text-[#F5712C]\">\r\n                    Contributors\r\n                </a>{' '}\r\n                under MIT License.\r\n            </p>\r\n        </div>\r\n    </Layout>\r\n);\r\n\r\nexport default Index;\r\n","import { type NotFoundHandler, type ErrorHandler } from 'hono';\r\nimport { routePath } from 'hono/route';\r\nimport { getDebugInfo, setDebugInfo } from '@/utils/debug-info';\r\nimport { config } from '@/config';\r\nimport * as Sentry from '@sentry/node';\r\nimport logger from '@/utils/logger';\r\nimport Error from '@/views/error';\r\n\r\nimport NotFoundError from './types/not-found';\r\n\r\nimport { requestMetric } from '@/utils/otel';\r\n\r\nexport const errorHandler: ErrorHandler = (error, ctx) => {\r\n    const requestPath = ctx.req.path;\r\n    const matchedRoute = routePath(ctx);\r\n    const hasMatchedRoute = matchedRoute !== '/*';\r\n\r\n    const debug = getDebugInfo();\r\n    try {\r\n        if (ctx.res.headers.get('RSSHub-Cache-Status')) {\r\n            debug.hitCache++;\r\n        }\r\n    } catch {\r\n        // ignore\r\n    }\r\n    debug.error++;\r\n\r\n    if (!debug.errorPaths[requestPath]) {\r\n        debug.errorPaths[requestPath] = 0;\r\n    }\r\n    debug.errorPaths[requestPath]++;\r\n\r\n    if (!debug.errorRoutes[matchedRoute] && hasMatchedRoute) {\r\n        debug.errorRoutes[matchedRoute] = 0;\r\n    }\r\n    hasMatchedRoute && debug.errorRoutes[matchedRoute]++;\r\n    setDebugInfo(debug);\r\n\r\n    if (config.sentry.dsn) {\r\n        Sentry.withScope((scope) => {\r\n            scope.setTag('name', requestPath.split('/')[1]);\r\n            Sentry.captureException(error);\r\n        });\r\n    }\r\n\r\n    let errorMessage = (process.env.NODE_ENV || process.env.VERCEL_ENV) === 'production' ? error.message : error.stack || error.message;\r\n    switch (error.constructor.name) {\r\n        case 'HTTPError':\r\n        case 'RequestError':\r\n        case 'FetchError':\r\n            ctx.status(503);\r\n            break;\r\n        case 'RequestInProgressError':\r\n            ctx.header('Cache-Control', `public, max-age=${config.requestTimeout / 1000}`);\r\n            ctx.status(503);\r\n            break;\r\n        case 'RejectError':\r\n            ctx.status(403);\r\n            break;\r\n        case 'NotFoundError':\r\n            ctx.status(404);\r\n            errorMessage += 'The route does not exist or has been deleted.';\r\n            break;\r\n        default:\r\n            ctx.status(503);\r\n            break;\r\n    }\r\n    const message = `${error.name}: ${errorMessage}`;\r\n\r\n    logger.error(`Error in ${requestPath}: ${message}`);\r\n    requestMetric.error({ path: matchedRoute, method: ctx.req.method, status: ctx.res.status });\r\n\r\n    return config.isPackage || ctx.req.query('format') === 'json'\r\n        ? ctx.json({\r\n              error: {\r\n                  message: error.message ?? error,\r\n              },\r\n          })\r\n        : ctx.html(<Error requestPath={requestPath} message={message} errorRoute={hasMatchedRoute ? matchedRoute : requestPath} nodeVersion={process.version} />);\r\n};\r\n\r\nexport const notFoundHandler: NotFoundHandler = (ctx) => errorHandler(new NotFoundError(), ctx);\r\n","import type { FC } from 'hono/jsx';\r\n\r\nimport { Layout } from '@/views/layout';\r\nimport { config } from '@/config';\r\nimport { gitHash, gitDate } from '@/utils/git-hash';\r\nimport { getDebugInfo } from '@/utils/debug-info';\r\n\r\nconst startTime = Date.now();\r\n\r\nconst Index: FC<{ debugQuery: string | undefined }> = ({ debugQuery }) => {\r\n    const debug = getDebugInfo();\r\n\r\n    const showDebug = !config.debugInfo || config.debugInfo === 'false' ? false : config.debugInfo === 'true' || config.debugInfo === debugQuery;\r\n    const { disallowRobot, nodeName, cache } = config;\r\n\r\n    const duration = Date.now() - startTime;\r\n\r\n    const info = {\r\n        showDebug,\r\n        disallowRobot,\r\n        debug: [\r\n            ...(nodeName\r\n                ? [\r\n                      {\r\n                          name: 'Node Name',\r\n                          value: nodeName,\r\n                      },\r\n                  ]\r\n                : []),\r\n            ...(gitHash\r\n                ? [\r\n                      {\r\n                          name: 'Git Hash',\r\n                          value: (\r\n                              <a className=\"underline\" href={`https://github.com/DIYgod/RSSHub/commit/${gitHash}`}>\r\n                                  {gitHash}\r\n                              </a>\r\n                          ),\r\n                      },\r\n                  ]\r\n                : []),\r\n            ...(gitDate\r\n                ? [\r\n                      {\r\n                          name: 'Git Date',\r\n                          value: gitDate.toUTCString(),\r\n                      },\r\n                  ]\r\n                : []),\r\n            {\r\n                name: 'Cache Duration',\r\n                value: cache.routeExpire + 's',\r\n            },\r\n            {\r\n                name: 'Request Amount',\r\n                value: debug.request,\r\n            },\r\n            {\r\n                name: 'Request Frequency',\r\n                value: ((debug.request / (duration / 1000)) * 60).toFixed(3) + ' times/minute',\r\n            },\r\n            {\r\n                name: 'Cache Hit Ratio',\r\n                value: debug.request ? ((debug.hitCache / debug.request) * 100).toFixed(2) + '%' : 0,\r\n            },\r\n            {\r\n                name: 'ETag Matched Ratio',\r\n                value: debug.request ? ((debug.etag / debug.request) * 100).toFixed(2) + '%' : 0,\r\n            },\r\n            {\r\n                name: 'Health',\r\n                value: debug.request ? ((1 - debug.error / debug.request) * 100).toFixed(2) + '%' : 0,\r\n            },\r\n            {\r\n                name: 'Uptime',\r\n                value: (duration / 3_600_000).toFixed(2) + ' hour(s)',\r\n            },\r\n            {\r\n                name: 'Hot Routes',\r\n                value: Object.keys(debug.routes)\r\n                    .sort((a, b) => debug.routes[b] - debug.routes[a])\r\n                    .slice(0, 30)\r\n                    .map((route) => (\r\n                        <>\r\n                            {debug.routes[route]} {route}\r\n                            <br />\r\n                        </>\r\n                    )),\r\n            },\r\n            {\r\n                name: 'Hot Paths',\r\n                value: Object.keys(debug.paths)\r\n                    .sort((a, b) => debug.paths[b] - debug.paths[a])\r\n                    .slice(0, 30)\r\n                    .map((path) => (\r\n                        <>\r\n                            {debug.paths[path]} {path}\r\n                            <br />\r\n                        </>\r\n                    )),\r\n            },\r\n            {\r\n                name: 'Hot Error Routes',\r\n                value: Object.keys(debug.errorRoutes)\r\n                    .sort((a, b) => debug.errorRoutes[b] - debug.errorRoutes[a])\r\n                    .slice(0, 30)\r\n                    .map((route) => (\r\n                        <>\r\n                            {debug.errorRoutes[route]} {route}\r\n                            <br />\r\n                        </>\r\n                    )),\r\n            },\r\n            {\r\n                name: 'Hot Error Paths',\r\n                value: Object.keys(debug.errorPaths)\r\n                    .sort((a, b) => debug.errorPaths[b] - debug.errorPaths[a])\r\n                    .slice(0, 30)\r\n                    .map((path) => (\r\n                        <>\r\n                            {debug.errorPaths[path]} {path}\r\n                            <br />\r\n                        </>\r\n                    )),\r\n            },\r\n        ],\r\n    };\r\n\r\n    return (\r\n        <Layout>\r\n            <div\r\n                className=\"pointer-events-none absolute w-full min-h-screen\"\r\n                style={{\r\n                    backgroundImage: `url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHZpZXdCb3g9JzAgMCAzMiAzMicgd2lkdGg9JzMyJyBoZWlnaHQ9JzMyJyBmaWxsPSdub25lJyBzdHJva2U9J3JnYigxNSAyMyA0MiAvIDAuMDQpJz48cGF0aCBkPSdNMCAuNUgzMS41VjMyJy8+PC9zdmc+')`,\r\n                    maskImage: 'linear-gradient(transparent, black, transparent)',\r\n                }}\r\n            ></div>\r\n            <div className=\"w-full grow shrink-0 py-8 flex items-center justify-center flex-col space-y-4\">\r\n                <img src=\"./logo.png\" alt=\"RSSHub\" width=\"100\" loading=\"lazy\" />\r\n                <h1 className=\"text-4xl font-bold\">\r\n                    Welcome to <span className=\"text-[#F5712C]\">RSSHub</span>!\r\n                </h1>\r\n                <p className=\"text-xl font-medium text-zinc-600\">The world's largest RSS Network.</p>\r\n                <p className=\"text-zinc-500\">If you see this page, the RSSHub is successfully installed and working.</p>\r\n                <div className=\"font-bold space-x-4 text-sm\">\r\n                    <a target=\"_blank\" href=\"https://docs.rsshub.app\">\r\n                        <button className=\"text-white bg-[#F5712C] hover:bg-[#DD4A15] py-2 px-4 rounded-full transition-colors\">Home</button>\r\n                    </a>\r\n                    <a target=\"_blank\" href=\"https://github.com/DIYgod/RSSHub\">\r\n                        <button className=\"bg-zinc-200 hover:bg-zinc-300 py-2 px-4 rounded-full transition-colors\">GitHub</button>\r\n                    </a>\r\n                </div>\r\n                {info.showDebug ? (\r\n                    <details className=\"text-xs w-96 !mt-8 max-h-[400px] overflow-auto\">\r\n                        <summary className=\"text-sm cursor-pointer\">Debug Info</summary>\r\n                        {info.debug.map((item) => (\r\n                            <div class=\"debug-item my-3 pl-8\">\r\n                                <span class=\"debug-key w-32 text-right inline-block mr-2\">{item.name}: </span>\r\n                                <span class=\"debug-value inline-block break-all align-top\">{item.value}</span>\r\n                            </div>\r\n                        ))}\r\n                    </details>\r\n                ) : null}\r\n            </div>\r\n\r\n            <div className=\"text-center pt-4 pb-8 w-full text-sm font-medium space-y-2\">\r\n                <p className=\"space-x-4\">\r\n                    <a target=\"_blank\" href=\"https://github.com/DIYgod/RSSHub\">\r\n                        <img className=\"inline\" src=\"https://icons.ly/github/_/fff\" alt=\"github\" width=\"20\" height=\"20\" />\r\n                    </a>\r\n                    <a target=\"_blank\" href=\"https://t.me/rsshub\">\r\n                        <img className=\"inline\" src=\"https://icons.ly/telegram\" alt=\"telegram group\" width=\"20\" height=\"20\" />\r\n                    </a>\r\n                    <a target=\"_blank\" href=\"https://t.me/awesomeRSSHub\">\r\n                        <img className=\"inline\" src=\"https://icons.ly/telegram\" alt=\"telegram channel\" width=\"20\" height=\"20\" />\r\n                    </a>\r\n                    <a target=\"_blank\" href=\"https://x.com/intent/follow?screen_name=_RSSHub\" className=\"text-[#F5712C]\">\r\n                        <img className=\"inline\" src=\"https://icons.ly/x\" alt=\"X\" width=\"20\" height=\"20\" />\r\n                    </a>\r\n                </p>\r\n                <p className=\"!mt-6\">\r\n                    Please consider{' '}\r\n                    <a target=\"_blank\" href=\"https://docs.rsshub.app/sponsor\" className=\"text-[#F5712C]\">\r\n                        sponsoring\r\n                    </a>{' '}\r\n                    to help keep this open source project alive.\r\n                </p>\r\n                <p>\r\n                    Made with ❤️ by{' '}\r\n                    <a target=\"_blank\" href=\"https://diygod.cc\" className=\"text-[#F5712C]\">\r\n                        DIYgod\r\n                    </a>{' '}\r\n                    and{' '}\r\n                    <a target=\"_blank\" href=\"https://github.com/DIYgod/RSSHub/graphs/contributors\" className=\"text-[#F5712C]\">\r\n                        Contributors\r\n                    </a>{' '}\r\n                    under MIT License.\r\n                </p>\r\n            </div>\r\n        </Layout>\r\n    );\r\n};\r\n\r\nexport default Index;\r\n","import type { Handler } from 'hono';\r\nimport Index from '@/views/index';\r\n\r\nconst handler: Handler = (ctx) => {\r\n    ctx.header('Cache-Control', 'no-cache');\r\n\r\n    return ctx.html(<Index debugQuery={ctx.req.query('debug')} />);\r\n};\r\n\r\nexport default handler;\r\n","import type { Handler } from 'hono';\r\n\r\nconst handler: Handler = (ctx) => {\r\n    ctx.header('Cache-Control', 'no-cache');\r\n    return ctx.text('ok');\r\n};\r\n\r\nexport default handler;\r\n","import type { Handler } from 'hono';\r\nimport { config } from '@/config';\r\n\r\nconst handler: Handler = (ctx) => {\r\n    if (config.disallowRobot) {\r\n        return ctx.text('User-agent: *\\nDisallow: /');\r\n    } else {\r\n        ctx.status(404);\r\n        return ctx.text('');\r\n    }\r\n};\r\n\r\nexport default handler;\r\n","import type { Handler } from 'hono';\r\nimport { getContext } from '@/utils/otel';\r\n\r\nconst handler: Handler = (ctx) =>\r\n    getContext()\r\n        .then((val) => ctx.text(val))\r\n        .catch((error) => {\r\n            ctx.status(500);\r\n            ctx.json({ error });\r\n        });\r\n\r\nexport default handler;\r\n","import type { APIRoute, Namespace, Route } from '@/types';\r\nimport { directoryImport } from 'directory-import';\r\nimport { Hono, type Handler } from 'hono';\r\nimport { routePath } from 'hono/route';\r\nimport path from 'node:path';\r\nimport { serveStatic } from '@hono/node-server/serve-static';\r\nimport { config } from '@/config';\r\n\r\nimport index from '@/routes/index';\r\nimport healthz from '@/routes/healthz';\r\nimport robotstxt from '@/routes/robots.txt';\r\nimport metrics from '@/routes/metrics';\r\nimport logger from '@/utils/logger';\r\n\r\nconst __dirname = import.meta.dirname;\r\n\r\nfunction isSafeRoutes(routes: RoutesType): boolean {\r\n    return Object.values(routes).every((route: Route) => !route.features?.nsfw);\r\n}\r\n\r\nfunction safeNamespaces(namespaces: NamespacesType): NamespacesType {\r\n    const safe: NamespacesType = {};\r\n\r\n    for (const [key, value] of Object.entries(namespaces)) {\r\n        if (value.routes === null || value.routes === undefined || isSafeRoutes(value.routes)) {\r\n            safe[key] = value;\r\n        }\r\n    }\r\n    return safe;\r\n}\r\n\r\nlet modules: Record<string, { route: Route } | { namespace: Namespace }> = {};\r\n\r\ntype RoutesType = Record<\r\n    string,\r\n    Route & {\r\n        location: string;\r\n    }\r\n>;\r\n\r\nexport type NamespacesType = Record<\r\n    string,\r\n    Namespace & {\r\n        routes: RoutesType;\r\n        apiRoutes: Record<\r\n            string,\r\n            APIRoute & {\r\n                location: string;\r\n            }\r\n        >;\r\n    }\r\n>;\r\n\r\nlet namespaces: NamespacesType = {};\r\n\r\nswitch (process.env.NODE_ENV || process.env.VERCEL_ENV) {\r\n    case 'production':\r\n        namespaces = (await import('../assets/build/routes.js')).default;\r\n        break;\r\n    case 'test':\r\n        // @ts-expect-error\r\n        namespaces = await import('../assets/build/routes.json');\r\n        if (namespaces.default) {\r\n            // @ts-ignore\r\n            namespaces = namespaces.default;\r\n        }\r\n        break;\r\n    default:\r\n        modules = directoryImport({\r\n            targetDirectoryPath: path.join(__dirname, './routes'),\r\n            importPattern: /\\.ts$/,\r\n        }) as typeof modules;\r\n}\r\n\r\nif (config.feature.disable_nsfw) {\r\n    namespaces = safeNamespaces(namespaces);\r\n}\r\n\r\nif (Object.keys(modules).length) {\r\n    for (const module in modules) {\r\n        const content = modules[module] as\r\n            | {\r\n                  route: Route;\r\n              }\r\n            | {\r\n                  namespace: Namespace;\r\n              }\r\n            | {\r\n                  apiRoute: APIRoute;\r\n              };\r\n        const namespace = module.split(/[/\\\\]/)[1];\r\n        if ('namespace' in content) {\r\n            namespaces[namespace] = Object.assign(\r\n                {\r\n                    routes: {},\r\n                },\r\n                namespaces[namespace],\r\n                content.namespace\r\n            );\r\n        } else if ('route' in content) {\r\n            if (!namespaces[namespace]) {\r\n                namespaces[namespace] = {\r\n                    name: namespace,\r\n                    routes: {},\r\n                    apiRoutes: {},\r\n                };\r\n            }\r\n            if (Array.isArray(content.route.path)) {\r\n                for (const path of content.route.path) {\r\n                    namespaces[namespace].routes[path] = {\r\n                        ...content.route,\r\n                        location: module.split(/[/\\\\]/).slice(2).join('/'),\r\n                    };\r\n                }\r\n            } else {\r\n                namespaces[namespace].routes[content.route.path] = {\r\n                    ...content.route,\r\n                    location: module.split(/[/\\\\]/).slice(2).join('/'),\r\n                };\r\n            }\r\n        } else if ('apiRoute' in content) {\r\n            if (!namespaces[namespace]) {\r\n                namespaces[namespace] = {\r\n                    name: namespace,\r\n                    routes: {},\r\n                    apiRoutes: {},\r\n                };\r\n            }\r\n            if (Array.isArray(content.apiRoute.path)) {\r\n                for (const path of content.apiRoute.path) {\r\n                    namespaces[namespace].apiRoutes[path] = {\r\n                        ...content.apiRoute,\r\n                        location: module.split(/[/\\\\]/).slice(2).join('/'),\r\n                    };\r\n                }\r\n            } else {\r\n                namespaces[namespace].apiRoutes[content.apiRoute.path] = {\r\n                    ...content.apiRoute,\r\n                    location: module.split(/[/\\\\]/).slice(2).join('/'),\r\n                };\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport { namespaces };\r\n\r\nconst app = new Hono();\r\nconst sortRoutes = (\r\n    routes: Record<\r\n        string,\r\n        Route & {\r\n            location: string;\r\n            module?: () => Promise<{ route: Route }>;\r\n        }\r\n    >\r\n) =>\r\n    Object.entries(routes).sort(([pathA], [pathB]) => {\r\n        const segmentsA = pathA.split('/');\r\n        const segmentsB = pathB.split('/');\r\n        const lenA = segmentsA.length;\r\n        const lenB = segmentsB.length;\r\n        const minLen = Math.min(lenA, lenB);\r\n\r\n        for (let i = 0; i < minLen; i++) {\r\n            const segmentA = segmentsA[i];\r\n            const segmentB = segmentsB[i];\r\n\r\n            // Literal segments have priority over parameter segments\r\n            if (segmentA.startsWith(':') !== segmentB.startsWith(':')) {\r\n                return segmentA.startsWith(':') ? 1 : -1;\r\n            }\r\n        }\r\n\r\n        return 0;\r\n    });\r\n\r\nfor (const namespace in namespaces) {\r\n    const subApp = app.basePath(`/${namespace}`);\r\n\r\n    const namespaceData = namespaces[namespace];\r\n    if (!namespaceData || !namespaceData.routes) {\r\n        continue;\r\n    }\r\n\r\n    const sortedRoutes = sortRoutes(namespaceData.routes);\r\n\r\n    for (const [path, routeData] of sortedRoutes) {\r\n        const wrappedHandler: Handler = async (ctx) => {\r\n            logger.debug(`Matched route: ${routePath(ctx)}`);\r\n            if (!ctx.get('data')) {\r\n                if (typeof routeData.handler !== 'function') {\r\n                    if (process.env.NODE_ENV === 'test') {\r\n                        const { route } = await import(`./routes/${namespace}/${routeData.location}`);\r\n                        routeData.handler = route.handler;\r\n                    } else if (routeData.module) {\r\n                        const { route } = await routeData.module();\r\n                        routeData.handler = route.handler;\r\n                    }\r\n                }\r\n                ctx.set('data', await routeData.handler(ctx));\r\n            }\r\n        };\r\n        subApp.get(path, wrappedHandler);\r\n    }\r\n}\r\n\r\nfor (const namespace in namespaces) {\r\n    const subApp = app.basePath(`/api/${namespace}`);\r\n\r\n    const namespaceData = namespaces[namespace];\r\n    if (!namespaceData || !namespaceData.apiRoutes) {\r\n        continue;\r\n    }\r\n\r\n    const sortedRoutes = Object.entries(namespaceData.apiRoutes) as [\r\n        string,\r\n        APIRoute & {\r\n            location: string;\r\n            module?: () => Promise<{ apiRoute: APIRoute }>;\r\n        },\r\n    ][];\r\n\r\n    for (const [path, routeData] of sortedRoutes) {\r\n        const wrappedHandler: Handler = async (ctx) => {\r\n            if (!ctx.get('apiData')) {\r\n                if (typeof routeData.handler !== 'function') {\r\n                    if (process.env.NODE_ENV === 'test') {\r\n                        const { apiRoute } = await import(`./routes/${namespace}/${routeData.location}`);\r\n                        routeData.handler = apiRoute.handler;\r\n                    } else if (routeData.module) {\r\n                        const { apiRoute } = await routeData.module();\r\n                        routeData.handler = apiRoute.handler;\r\n                    }\r\n                }\r\n                const data = await routeData.handler(ctx);\r\n                ctx.set('apiData', data);\r\n            }\r\n        };\r\n        subApp.get(path, wrappedHandler);\r\n    }\r\n}\r\n\r\napp.get('/', index);\r\napp.get('/healthz', healthz);\r\napp.get('/robots.txt', robotstxt);\r\nif (config.debugInfo) {\r\n    // Only enable tracing in debug mode\r\n    app.get('/metrics', metrics);\r\n}\r\napp.use(\r\n    '/*',\r\n    serveStatic({\r\n        root: path.join(__dirname, 'assets'),\r\n        rewriteRequestPath: (path) => (path === '/favicon.ico' ? '/favicon.png' : path),\r\n    })\r\n);\r\n\r\nexport default app;\r\n","import { namespaces } from '@/registry';\r\nimport { createRoute, RouteHandler } from '@hono/zod-openapi';\r\n\r\nconst route = createRoute({\r\n    method: 'get',\r\n    path: '/namespace',\r\n    tags: ['Namespace'],\r\n    responses: {\r\n        200: {\r\n            description: 'Information about all namespaces',\r\n        },\r\n    },\r\n});\r\n\r\nconst handler: RouteHandler<typeof route> = (ctx) => ctx.json(namespaces);\r\n\r\nexport { route, handler };\r\n","import { namespaces } from '@/registry';\r\nimport { z, createRoute, RouteHandler } from '@hono/zod-openapi';\r\n\r\nconst ParamsSchema = z.object({\r\n    namespace: z.string().openapi({\r\n        param: {\r\n            name: 'namespace',\r\n            in: 'path',\r\n        },\r\n        example: 'github',\r\n    }),\r\n});\r\n\r\nconst route = createRoute({\r\n    method: 'get',\r\n    path: '/namespace/{namespace}',\r\n    tags: ['Namespace'],\r\n    request: {\r\n        params: ParamsSchema,\r\n    },\r\n    responses: {\r\n        200: {\r\n            description: 'Information about a namespace',\r\n        },\r\n    },\r\n});\r\n\r\nconst handler: RouteHandler<typeof route> = (ctx) => {\r\n    const { namespace } = ctx.req.valid('param');\r\n    return ctx.json(namespaces[namespace]);\r\n};\r\n\r\nexport { route, handler };\r\n","import { namespaces } from '@/registry';\r\nimport { parse } from 'tldts';\r\nimport { RadarDomain } from '@/types';\r\nimport { createRoute, RouteHandler } from '@hono/zod-openapi';\r\n\r\nconst radar: {\r\n    [domain: string]: RadarDomain;\r\n} = {};\r\n\r\nfor (const namespace in namespaces) {\r\n    for (const path in namespaces[namespace].routes) {\r\n        const realPath = `/${namespace}${path}`;\r\n        const data = namespaces[namespace].routes[path];\r\n        if (data.radar?.length) {\r\n            for (const radarItem of data.radar) {\r\n                const parsedDomain = parse(new URL('https://' + radarItem.source[0]).hostname);\r\n                const subdomain = parsedDomain.subdomain || '.';\r\n                const domain = parsedDomain.domain;\r\n                if (domain) {\r\n                    if (!radar[domain]) {\r\n                        radar[domain] = {\r\n                            _name: namespaces[namespace].name,\r\n                        } as RadarDomain;\r\n                    }\r\n                    if (!radar[domain][subdomain]) {\r\n                        radar[domain][subdomain] = [];\r\n                    }\r\n                    radar[domain][subdomain].push({\r\n                        title: radarItem.title || data.name,\r\n                        docs: `https://docs.rsshub.app/routes/${data.categories?.[0] || 'other'}`,\r\n                        source: radarItem.source.map((source) => {\r\n                            const sourceURL = new URL('https://' + source);\r\n                            return sourceURL.pathname + sourceURL.search + sourceURL.hash;\r\n                        }),\r\n                        target: radarItem.target ? `/${namespace}${radarItem.target}` : realPath,\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nconst route = createRoute({\r\n    method: 'get',\r\n    path: '/radar/rules',\r\n    tags: ['Radar'],\r\n    responses: {\r\n        200: {\r\n            description: 'All Radar rules',\r\n        },\r\n    },\r\n});\r\n\r\nconst handler: RouteHandler<typeof route> = (ctx) => ctx.json(radar);\r\n\r\nexport { route, handler };\r\n","import { namespaces } from '@/registry';\r\nimport { parse } from 'tldts';\r\nimport { RadarDomain } from '@/types';\r\nimport { z, createRoute, RouteHandler } from '@hono/zod-openapi';\r\n\r\nconst radar: {\r\n    [domain: string]: RadarDomain;\r\n} = {};\r\n\r\nfor (const namespace in namespaces) {\r\n    for (const path in namespaces[namespace].routes) {\r\n        const realPath = `/${namespace}${path}`;\r\n        const data = namespaces[namespace].routes[path];\r\n        if (data.radar?.length) {\r\n            for (const radarItem of data.radar) {\r\n                const parsedDomain = parse(new URL('https://' + radarItem.source[0]).hostname);\r\n                const subdomain = parsedDomain.subdomain || '.';\r\n                const domain = parsedDomain.domain;\r\n                if (domain) {\r\n                    if (!radar[domain]) {\r\n                        radar[domain] = {\r\n                            _name: namespaces[namespace].name,\r\n                        } as RadarDomain;\r\n                    }\r\n                    if (!radar[domain][subdomain]) {\r\n                        radar[domain][subdomain] = [];\r\n                    }\r\n                    radar[domain][subdomain].push({\r\n                        title: radarItem.title || data.name,\r\n                        docs: `https://docs.rsshub.app/routes/${data.categories?.[0] || 'other'}`,\r\n                        source: radarItem.source.map((source) => {\r\n                            const sourceURL = new URL('https://' + source);\r\n                            return sourceURL.pathname + sourceURL.search + sourceURL.hash;\r\n                        }),\r\n                        target: radarItem.target ? `/${namespace}${radarItem.target}` : realPath,\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nconst ParamsSchema = z.object({\r\n    domain: z.string().openapi({\r\n        param: {\r\n            name: 'domain',\r\n            in: 'path',\r\n        },\r\n        example: 'github.com',\r\n    }),\r\n});\r\n\r\nconst route = createRoute({\r\n    method: 'get',\r\n    path: '/radar/rules/{domain}',\r\n    tags: ['Radar'],\r\n    request: {\r\n        params: ParamsSchema,\r\n    },\r\n    responses: {\r\n        200: {\r\n            description: 'Radar rules for a domain name (does not support subdomains)',\r\n        },\r\n    },\r\n});\r\n\r\nconst handler: RouteHandler<typeof route> = (ctx) => {\r\n    const { domain } = ctx.req.valid('param');\r\n    return ctx.json(radar[domain]);\r\n};\r\n\r\nexport { route, handler };\r\n","import { namespaces } from '@/registry';\r\nimport { z, createRoute, RouteHandler } from '@hono/zod-openapi';\r\n\r\nconst categoryList: Record<string, typeof namespaces> = {};\r\n\r\nfor (const namespace in namespaces) {\r\n    for (const path in namespaces[namespace].routes) {\r\n        if (namespaces[namespace].routes[path].categories?.length) {\r\n            for (const category of namespaces[namespace].routes[path].categories!) {\r\n                if (!categoryList[category]) {\r\n                    categoryList[category] = {};\r\n                }\r\n                if (!categoryList[category][namespace]) {\r\n                    categoryList[category][namespace] = {\r\n                        ...namespaces[namespace],\r\n                        routes: {},\r\n                    };\r\n                }\r\n                categoryList[category][namespace].routes[path] = namespaces[namespace].routes[path];\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nconst ParamsSchema = z.object({\r\n    category: z.string().openapi({\r\n        param: {\r\n            name: 'category',\r\n            in: 'path',\r\n        },\r\n        example: 'popular',\r\n    }),\r\n});\r\n\r\nconst QuerySchema = z.object({\r\n    categories: z\r\n        .string()\r\n        .transform((val) => val.split(','))\r\n        .optional(),\r\n    lang: z.string().optional(),\r\n});\r\n\r\nconst route = createRoute({\r\n    method: 'get',\r\n    path: '/category/{category}',\r\n    tags: ['Category'],\r\n    request: {\r\n        query: QuerySchema,\r\n        params: ParamsSchema,\r\n    },\r\n    responses: {\r\n        200: {\r\n            description: 'Namespace list by categories and language',\r\n        },\r\n    },\r\n});\r\n\r\nconst handler: RouteHandler<typeof route> = (ctx) => {\r\n    const { categories, lang } = ctx.req.valid('query');\r\n    const { category } = ctx.req.valid('param');\r\n\r\n    let allCategories = [category];\r\n    if (categories && categories.length > 0) {\r\n        allCategories = [...allCategories, ...categories];\r\n    }\r\n\r\n    // Get namespaces that exist in all requested categories\r\n    const commonNamespaces = Object.keys(categoryList[category] || {}).filter((namespace) => allCategories.every((cat) => categoryList[cat]?.[namespace]));\r\n\r\n    // Create result directly from common namespaces\r\n    let result = Object.fromEntries(commonNamespaces.map((namespace) => [namespace, categoryList[category][namespace]]));\r\n\r\n    // Filter by language if provided\r\n    if (lang) {\r\n        result = Object.fromEntries(Object.entries(result).filter(([, value]) => value.lang === lang));\r\n    }\r\n\r\n    return ctx.json(result);\r\n};\r\n\r\nexport { route, handler };\r\n","import { config } from '@/config';\r\nimport { createRoute, RouteHandler } from '@hono/zod-openapi';\r\nimport { gitHash, gitDate } from '@/utils/git-hash';\r\n\r\nconst route = createRoute({\r\n    method: 'get',\r\n    path: '/follow/config',\r\n    tags: ['Follow'],\r\n    responses: {\r\n        200: {\r\n            description: 'Follow config',\r\n        },\r\n    },\r\n});\r\n\r\nconst handler: RouteHandler<typeof route> = (ctx) =>\r\n    ctx.json({\r\n        ownerUserId: config.follow.ownerUserId,\r\n        description: config.follow.description,\r\n        price: config.follow.price,\r\n        userLimit: config.follow.userLimit,\r\n        cacheTime: config.cache.routeExpire,\r\n        gitHash,\r\n        gitDate: gitDate?.getTime(),\r\n    });\r\n\r\nexport { route, handler };\r\n","// import { route as rulesRoute, handler as rulesHandler } from '@/api/radar/rules';\r\nimport { route as namespaceAllRoute, handler as namespaceAllHandler } from '@/api/namespace/all';\r\nimport { route as namespaceOneRoute, handler as namespaceOneHandler } from '@/api/namespace/one';\r\nimport { route as radarRulesAllRoute, handler as radarRulesAllHandler } from '@/api/radar/rules/all';\r\nimport { route as radarRulesOneRoute, handler as radarRulesOneHandler } from '@/api/radar/rules/one';\r\nimport { route as categoryOneRoute, handler as categoryOneHandler } from '@/api/category/one';\r\nimport { route as followConfigRoute, handler as followConfigHandler } from '@/api/follow/config';\r\nimport { OpenAPIHono } from '@hono/zod-openapi';\r\nimport { Scalar } from '@scalar/hono-api-reference';\r\n\r\nconst app = new OpenAPIHono();\r\n\r\napp.openapi(namespaceAllRoute, namespaceAllHandler);\r\napp.openapi(namespaceOneRoute, namespaceOneHandler);\r\napp.openapi(radarRulesAllRoute, radarRulesAllHandler);\r\napp.openapi(radarRulesOneRoute, radarRulesOneHandler);\r\napp.openapi(categoryOneRoute, categoryOneHandler);\r\napp.openapi(followConfigRoute, followConfigHandler);\r\n\r\nconst docs = app.getOpenAPI31Document({\r\n    openapi: '3.1.0',\r\n    info: {\r\n        version: '0.0.1',\r\n        title: 'RSSHub API',\r\n    },\r\n});\r\nfor (const path in docs.paths) {\r\n    docs.paths[`/api${path}`] = docs.paths[path];\r\n    delete docs.paths[path];\r\n}\r\napp.get('/openapi.json', (ctx) => ctx.json(docs));\r\napp.get('/reference', Scalar({ content: docs }));\r\n\r\nexport default app;\r\n","import { Hono } from 'hono';\r\n\r\nimport { compress } from 'hono/compress';\r\nimport mLogger from '@/middleware/logger';\r\nimport cache from '@/middleware/cache';\r\nimport template from '@/middleware/template';\r\nimport sentry from '@/middleware/sentry';\r\nimport accessControl from '@/middleware/access-control';\r\nimport debug from '@/middleware/debug';\r\nimport header from '@/middleware/header';\r\nimport antiHotlink from '@/middleware/anti-hotlink';\r\nimport parameter from '@/middleware/parameter';\r\nimport trace from '@/middleware/trace';\r\nimport { jsxRenderer } from 'hono/jsx-renderer';\r\nimport { trimTrailingSlash } from 'hono/trailing-slash';\r\n\r\nimport logger from '@/utils/logger';\r\n\r\nimport { notFoundHandler, errorHandler } from '@/errors';\r\nimport registry from '@/registry';\r\nimport api from '@/api';\r\n\r\nprocess.on('uncaughtException', (e) => {\r\n    logger.error('uncaughtException: ' + e);\r\n});\r\n\r\nconst app = new Hono();\r\n\r\napp.use(trimTrailingSlash());\r\napp.use(compress());\r\n\r\napp.use(\r\n    jsxRenderer(({ children }) => <>{children}</>, {\r\n        docType: '<?xml version=\"1.0\" encoding=\"UTF-8\"?>',\r\n        stream: {},\r\n    })\r\n);\r\napp.use(mLogger);\r\napp.use(trace);\r\napp.use(sentry);\r\napp.use(accessControl);\r\napp.use(debug);\r\napp.use(template);\r\napp.use(header);\r\napp.use(antiHotlink);\r\napp.use(parameter);\r\napp.use(cache);\r\n\r\napp.route('/', registry);\r\napp.route('/api', api);\r\n\r\napp.notFound(notFoundHandler);\r\napp.onError(errorHandler);\r\n\r\nexport default app;\r\n"],"mappings":"svEAiBA,MAAM,EAAgB,SAEhBA,EAAW,IAAI,GAAmB,IAElCC,GAAW,IAAI,GAAc,CAC/B,SAAU,EAAuB,EAC5B,IAAoB,WAEzB,QAAS,CAACD,KAGR,GAAa,IAAI,GAEjB,EAAQC,GAAS,SAAS,UAE1B,GAAe,EAAM,cAAiC,GAAG,EAAc,iBACvE,GAAoB,EAAM,cAAiC,GAAG,EAAc,uBAC5E,GAA+B,EAAM,gBAAsC,GAAG,EAAc,kCAAmC,CACjI,OAAQ,CACJ,yBAA0B,EAAO,KAAK,gBAAgB,MAAM,KAAK,IAAI,WAGvE,GAAuC,EAAM,gBAAsC,GAAG,EAAc,uCAAwC,CAC9I,OAAQ,CACJ,yBAA0B,EAAO,KAAK,qBAAqB,MAAM,KAAK,IAAI,WAIrE,GAAgB,CACzB,SAAU,EAAe,IAAkC,CACvD,GAAa,IAAI,EAAG,GACpB,GAAqC,OAAO,EAAO,CAAE,KAAM,cAAe,GAAG,IAC7E,GAA6B,OAAO,EAAQ,IAAM,CAAE,KAAM,SAAU,GAAG,KAE3E,MAAQ,GAAkC,CACtC,GAAkB,IAAI,EAAG,KAIpB,OACT,IAAI,SAAiB,EAAS,IAAW,CACrC,EACK,UACA,KAAM,GAAU,CACb,EAAQ,GAAW,UAAU,EAAM,oBAEtC,YAAc,CACX,EAAO,QC1DjB,GAAW,IAAI,GAAkB,IAIjC,GAAW,IAAI,GAAoB,CACrC,SAAU,EAAuB,EAC5B,IAAoB,WAEzB,eAAgB,CACZ,IAAI,GAAmB,GAAU,CAE7B,aAAc,KAEd,qBAAsB,SAKlC,GAAM,wBAAwB,IAE9B,MAAa,GAAS,GAAS,UAAU,UACjB,GAAO,UAAU,QCtBzC,IAAK,EAAA,SAAA,EAAL,OACI,GAAA,SAAA,MACA,EAAA,SAAA,MACA,EAAA,MAAA,SAHC,GAAA,IAML,MAAM,GAAe,GAAmB,CACpC,IAAMC,EAAiC,CACnC,EAAG,aAAa,EAAO,WACvB,EAAG,aAAa,EAAO,WACvB,EAAG,aAAa,EAAO,WACvB,EAAG,aAAa,EAAO,WACvB,EAAG,aAAa,EAAO,WACvB,EAAG,aAAa,EAAO,WACvB,EAAG,aAAa,EAAO,YAGrB,EAAkB,KAAK,MAAM,EAAS,KAE5C,OAAO,EAAI,IAGT+C,GAAgC,MAAO,EAAK,IAAS,CACvD,GAAM,CAAE,SAAQ,MAAK,UAAA,GAAc,EAAI,IACjCqE,EAAO,EAAQ,GAErB,EAAO,KAAK,GAAG,EAAU,SAAS,GAAG,EAAO,GAAGA,KAE/C,IAAM,EAAQ,KAAK,MAEnB,MAAM,IAEN,IAAM,EAAS,EAAI,IAAI,OAEvB,EAAO,KAAK,GAAG,EAAU,SAAS,GAAG,EAAO,GAAGA,EAAK,GAAG,GAAY,GAAQ,GAAG,EAAK,MACnF,GAAc,QAAQ,KAAK,MAAQ,EAAO,CAAE,KAAMjH,EAAW,SAAQ,YAGzE,IAAA,GAAe2C,GCnCf,MAAM,GAAa,IAAI,IAAI,CAAC,IAAK,cAAe,YAAa,iBAIvDC,GAAgC,MAAO,EAAK,IAAS,CACvD,GAAI,CAACpC,EAAY,OAAO,WAAa,GAAW,IAAI,EAAI,IAAI,MAAO,CAC/D,MAAM,IACN,OAGJ,IAAM,EAAc,EAAI,IAAI,KACtB,EAAQ,EAAI,IAAI,MAAM,SAAW,IAAI,EAAI,IAAI,MAAM,WAAa,GAChE,CAAE,eAAgB,MAAM,KACxB,EAAM,0BAA4B,EAAY,EAAc,GAC5D,EAAa,yBAA2B,EAAY,EAAc,GAElE,EAAe,MAAMA,EAAY,YAAY,IAAI,GAEvD,GAAI,IAAiB,IAAK,CACtB,IAAI,EAAmD,GACnD,EAAS,GACb,KAAO,EAAa,GAAG,CAInB,GAFA,MAAM,IAAI,QAAS,GAAY,WAAW,EAAkD,MAEvF,MAAMA,EAAY,YAAY,IAAI,KAAiB,IAAK,CACzD,EAAS,GACT,MAEJ,IAEJ,GAAI,CAAC,EACD,MAAM,IAAIJ,EAAuB,4DAIzC,IAAM,EAAQ,MAAMI,EAAY,YAAY,IAAI,GAEhD,GAAI,EAAO,CACP,EAAI,OAAO,KACX,EAAI,OAAO,sBAAuB,OAClC,EAAI,IAAI,OAAQ,KAAK,MAAM,IAC3B,MAAM,IACN,OAIJ,MAAMA,EAAY,YAAY,IAAI,EAAY,IAAK,EAAO,MAAM,gBAEhE,GAAI,CACA,MAAM,UACD,EAAO,CAEZ,MADA,MAAMA,EAAY,YAAY,IAAI,EAAY,IAAK,EAAO,MAAM,gBAC1D,EAGV,IAAM0B,EAAa,EAAI,IAAI,QAC3B,GAAI,EAAI,IAAI,QAAQ,IAAI,mBAAqB,YAAc,EAAM,CAC7D,EAAK,cAAgB,IAAI,OAAO,cAChC,EAAI,IAAI,OAAQ,GAChB,IAAM,EAAO,KAAK,UAAU,GAC5B,MAAM1B,EAAY,YAAY,IAAI,EAAK,EAAM,EAAO,MAAM,aAK9D,MAAMA,EAAY,YAAY,IAAI,EAAY,IAAK,EAAO,MAAM,iBAGpE,IAAA,GAAemC,GCrEf,MAAMC,GAAgC,MAAO,EAAK,IAAS,CAKvD,IAAM,EAAOpC,EAAY,OAAO,WAAa,KAAK,MAAM,EAAO,MAAM,YAAc,KAAQ,EAC3F,MAAM,IAEN,IAAM,EAAU,EAAI,IAAI,WACxB,GAAI,EACA,OAAO,EAAI,KAAK,GAGpB,IAAM0B,EAAa,EAAI,IAAI,QACrB,EAAa,EAAI,IAAI,MAAM,WAAa,MAG9C,GAAI,EAAO,UAAW,CAClB,GAAI,IAAe,aACf,OAAO,EAAI,KAAK,EAAI,IAAI,SAAW,CAAE,QAAS,mCAGlD,GAAI,sBAAsB,KAAK,GAAa,CACxC,IAAM,EAAQ,OAAO,SAAS,EAAW,MAAM,yBAAyB,IAAM,KAC9E,OAAO,EAAI,KAAK,GAAM,OAAO,IAAQ,aAAe,aAAa,EAAM,2BAI/E,GAAI,IACA,EAAK,MAAQ,EAAmB,EAAK,QAAU,GAC/C,EAAK,cAAgB,EAAK,YAAc,EAAmB,EAAK,cAAgB,IAChF,EAAK,SAAW,EAAK,OAAS,EAAmB,EAAK,SAAW,IAE7D,EAAK,MACL,IAAK,IAAM,KAAQ,EAAK,KAAM,CAC1B,GAAI,EAAK,MAAO,CACZ,EAAK,MAAQ,EAAmB,EAAK,QAAU,GAE/C,IAAK,IAAI,EAAS,EAAG,EAAI,EAAG,EAAI,EAAK,MAAM,OAAQ,IAE/C,GADA,GAAU,OAAO,KAAK,EAAK,MAAM,IAAI,SAAW,EAAI,EAAI,EACpD,EAAS,EAAO,iBAAkB,CAClC,EAAK,MAAQ,GAAG,EAAK,MAAM,MAAM,EAAG,GAAG,KACvC,OAaZ,GARI,EAAK,cAKL,EAAK,YAAc,EAAK,YAAY,WAAW,8DAA+D,KAG9G,OAAO,EAAK,QAAW,SACvB,EAAK,OAAS,EAAmB,EAAK,SAAW,WAC1C,OAAO,EAAK,QAAW,UAAY,EAAK,SAAW,KAAM,CAChE,IAAK,IAAM,KAAK,EAAK,OACjB,EAAE,KAAO,EAAmB,EAAE,OAAS,GAEvC,IAAe,SACf,EAAK,OAAS,EAAK,OAAO,IAAK,GAAwB,EAAE,MAAM,KAAK,OAU5E,GANI,EAAK,kBAAqB,OAAO,EAAK,iBAAoB,UAAY,CAAC,EAAK,gBAAgB,SAAS,MAAU,OAAO,EAAK,iBAAoB,UAAY,CAAC,OAAO,MAAM,EAAK,oBAC9K,EAAK,gBAAkB,CAAC,EAAK,gBAC7B,EAAK,gBACD,KAAK,MAAM,EAAK,gBAAkB,MAAQ,KAAO,KAAK,MAAO,EAAK,gBAAkB,KAAQ,IAAM,KAAK,QAAQ,GAAG,MAAM,IAAM,KAAS,EAAK,gBAAkB,KAAQ,GAAM,KAAK,QAAQ,GAAG,MAAM,KAGtM,IAAe,MAAO,CACtB,GAAI,CACA,EAAK,UAAY,EAAK,QAAU,EAAqB,EAAK,UAAY,SAClE,CACJ,EAAK,QAAU,GAEnB,GAAI,CACA,EAAK,UAAY,EAAK,QAAU,EAAqB,EAAK,UAAY,SAClE,CACJ,EAAK,QAAU,KAOnC,IAAM,EAAc,IAAI,KAClB,EAAS,CACX,cAAe,EAAY,cAC3B,QAAS,EAAY,cACrB,MACA,SAAU,EAAI,IAAI,IAClB,GAAG,GAGP,GAAI,EAAO,UACP,OAAO,EAAI,KAAK,GAGpB,GAAI,EAAI,IAAI,YACR,OAAO,EAAI,SAAS,EAAI,IAAI,YAAa,QAClC,EAAI,IAAI,cACf,OAAO,EAAI,KAAK,MAGhB,OAAQ,EAAR,CACI,IAAK,MACL,IAAK,OACD,OAAO,EAAI,KAAKxB,EAAK,IACzB,IAAK,OAED,OADA,EAAI,OAAO,eAAgB,wCACpB,EAAI,KAAKC,EAAK,IACzB,IAAK,OACD,OAAO,EAAI,OAAO,EAACC,EAAAA,CAAK,KAAM,KAClC,QACI,OAAO,EAAI,OAAO,EAACC,EAAAA,CAAI,KAAM,OAK7C,IAAA,GAAe8B,GC5HX,EAAO,OAAO,MACd,EAAO,KAAK,CACR,IAAK,EAAO,OAAO,MAEvB,EAAO,kBAAkB,OAAO,YAAa,EAAO,UAEpD,EAAO,KAAK,mBAGhB,MAAMC,GAAgC,MAAO,EAAK,IAAS,CACvD,IAAM5B,EAAO,KAAK,MAClB,MAAM,IACF,EAAO,OAAO,KAAO,KAAK,MAAQA,GAAQ,EAAO,OAAO,cACxD,EAAO,UAAW,GAAU,CACxB,EAAM,OAAO,OAAQ,EAAqB,EAAI,IAAI,OAClD,EAAO,iBAAqB,MAAM,qBAK9C,IAAA,GAAe2B,GCrBf,MAAM,GAAU,GAAgB,CAC5B,MAAM,IAAIzB,EAAY,0CAA0C,MAG9D0B,GAAgC,MAAO,EAAK,IAAS,CACvD,IAAM,EAAc,IAAI,IAAI,EAAI,IAAI,KAAK,SACnC,EAAY,EAAI,IAAI,MAAM,OAC1B,EAAa,EAAI,IAAI,MAAM,QAEjC,GAAI,IAAgB,KAAO,IAAgB,eAAiB,IAAgB,gBAAkB,IAAgB,YAC1G,MAAM,QACH,CACH,GAAI,EAAO,WAAa,EAAE,EAAO,YAAc,GAAa,IAAe,EAAI,EAAc,EAAO,YAChG,OAAO,GAAO,GAElB,MAAM,MAId,IAAA,GAAeD,GCbf,MAAMtB,GAAmB,CACrB,SAAU,EACV,QAAS,EACT,KAAM,EACN,MAAO,EACP,OAAQ,GACR,MAAO,GACP,YAAa,GACb,WAAY,IAGH,MAAqB,GACrB,EAAgB,GAAuB,OAAO,OAAO,GAAO,GCnBnEuB,GAAgC,MAAO,EAAK,IAAS,CACvD,CACI,IAAM0E,EAAQ,IACTA,EAAM,MAAM,EAAI,IAAI,QACrB,EAAM,MAAM,EAAI,IAAI,MAAQ,GAEhC,EAAM,MAAM,EAAI,IAAI,QAEpB,EAAM,UACN,EAAaA,GAGjB,MAAM,IAEN,CACI,IAAMA,EAAQ,IACR,EAAQ,EAAU,GAClB,EAAkB,IAAU,KAC9B,CAACA,EAAM,OAAO,IAAU,IACxB,EAAM,OAAO,GAAS,GAE1B,GAAmB,EAAM,OAAO,KAE5B,EAAI,IAAI,QAAQ,IAAI,wBACpB,EAAM,WAGN,EAAI,IAAI,SAAW,KACnB,EAAM,OAEV,EAAaA,KAIrB,IAAA,GAAe3E,GChCf,MAAMlB,EAAkC,CACpC,+BAAgC,MAChC,eAAgB,iCAChB,gBAAiB,mBAAmB,EAAO,MAAM,cACjD,yBAA0B,WAE1B,EAAO,WACP,EAAQ,eAAiB,EAAO,UAGpC,SAAS,GAAY,EAAc,EAA4B,CAC3D,OAAO,IAAgB,MAAQ,EAAY,MAAM,QAAQ,SAAS,GAGtE,MAAMmB,GAAgC,MAAO,EAAK,IAAS,CACvD,IAAK,IAAM,KAAO,EACd,EAAI,OAAO,EAAK,EAAQ,IAE5B,EAAI,OAAO,8BAA+B,EAAO,aAAe,IAAI,IAAI,EAAI,IAAI,KAAK,MAErF,MAAM,IACN,IAAM,EAAQ,EAAU,GAEpB,IAAU,MACV,EAAI,OAAO,iBAAkB,GAGjC,IAAMV,EAAa,EAAI,IAAI,QAC3B,GAAI,CAAC,GAAQ,EAAI,IAAI,QAAQ,IAAI,QAC7B,OAGJ,IAAM,EAAgB,EAAK,cAC3B,OAAO,EAAK,cACZ,IAAM,EAAO,GAAc,KAAK,UAAU,IAE1C,EAAI,OAAO,OAAQ,GAEnB,IAAM,EAAc,EAAI,IAAI,OAAO,kBAAoB,KACnD,GAAY,EAAM,IAClB,EAAI,OAAO,KACX,EAAI,IAAI,aAAc,KAEtB,EAAI,OAAO,gBAAiB,IAIpC,IAAA,GAAeS,GC/Cf,MAAM,GAAgB,gBAChB,GAAuB,IAAI,IAAI,CAAC,OAAQ,OAAQ,WAAY,OAAQ,SAAU,WAAY,WAAY,OAAQ,WAAY,SAAU,eAAgB,aAGpJ,IAAa,EAAc,IAAoB,CACjD,IAAK,IAAM,KAAK,EACZ,GAAIsE,EAAK,WAAW,KAAOA,EAAK,SAAW,EAAE,QAAUA,EAAK,EAAE,UAAY,KACtE,MAAO,GAGf,MAAO,IAIL,GAAc,GAAiB,CACjC,IAAM,EAAU,EAAO,QAAQ,aACzB,EAAU,EAAO,QAAQ,aAC/B,MAAO,EAAE,GAAW,CAAC,GAAUA,EAAM,KAAa,EAAE,GAAW,GAAUA,EAAM,KAG7E,IAAe,EAAa,IAC9B,EAAI,WAAW,IAAgB,EAAG,IAAS,CACvC,IAAI,EAAa,GAMjB,OALI,EAAK,SAAS,SAEd,EAAO,EAAK,MAAM,EAAG,IACrB,EAAa,IAEV,EAAa,mBAAmB,EAAI,IAAS,EAAI,KAE1D,GAAY,GAAgB,CAC9B,IAAI,EACJ,GAAI,CACA,EAAM,IAAI,IAAI,QACV,CACJ,EAAO,MAAM,mBAAmB,KAGpC,OAAO,GAGL,GAAc,EAAmB,IAAiB,CACpD,GAAI,CAAC,GAAY,CAAC,EACd,OAAO,EAEX,IAAM,EAAS,GAAS,GAIxB,OAHI,GAAU,EAAO,WAAa,QACvB,GAAY,EAAU,GAE1B,GAGL,GAAe,EAAe,EAAkB,EAAkB,EAAY,QAAU,CAC1F,EAAE,GAAU,KAAK,UAAY,CACzB,IAAM,EAAS,EAAE,MAAM,KAAK,GAC5B,GAAI,EAAQ,CACR,IAAM,EAAM,GAAS,GACjB,GAAO,EAAI,WAAa,SAExB,EAAE,MAAM,KAAK,EAAW,GAAY,EAAU,QAMxDnF,GAAW,EAAc,EAAiC,IAAyC,CACrG,IAAM,EAAI,EAAK,EAAM,IAAA,GAAW,IAYhC,OAXI,IACA,EAAY,EAAG,wBAAyB,GACxC,EAAY,EAAG,gBAAiB,EAAwB,UACxD,EAAY,EAAG,8BAA+B,EAAwB,SAEtE,IACA,EAAY,EAAG,+CAAgD,GAC1D,GACD,EAAY,EAAG,gBAAiB,EAA6B,WAG9D,EAAE,QAGP,EAAoB,GAAsB,CACvC,KAGL,IAAK,IAAM,KAAS,EAAS,SAAS,IAAgB,CAClD,IAAM,EAAO,EAAM,GAAG,SAAS,OAAS,EAAM,GAAG,MAAM,EAAG,IAAM,EAAM,GACtE,GAAI,CAAC,GAAqB,IAAI,GAC1B,MAAU,MAAM,yBAAyB,OAK/Cc,GAAgC,MAAO,EAAK,IAAS,CACvD,MAAM,IAEN,IAAIZ,EACAC,EAmBJ,GAhBI,EAAO,QAAQ,8BAMf,EAA4B,EAAI,IAAI,MAAM,+BAC1C,EAAuB,EAAI,IAAI,MAAM,2BAIrC,EAAO,QAAQ,WACf,EAAuB,GAAW,EAAI,IAAI,MAAQ,EAAO,QAAQ,SAAW,IAAA,GAC5E,EAA4B,GAAW,EAAI,IAAI,MAAQ,EAAO,QAAQ,SAAW,IAAA,IAGjF,CAAC,GAAwB,CAAC,EAC1B,OAGJ,EAAiB,GACjB,EAAiB,GAMjB,IAAMC,EAAa,EAAI,IAAI,QAC3B,GAAI,EAAM,CAQN,GAPI,EAAK,QACL,EAAK,MAAQ,EAAW,EAAsB,EAAK,QAEnD,EAAK,cACL,EAAK,YAAcJ,EAAQ,EAAK,YAAa,EAAsB,IAGnE,EAAK,KACL,IAAK,IAAM,KAAQ,EAAK,KAChB,EAAK,cACL,EAAK,YAAcA,EAAQ,EAAK,YAAa,EAAsB,IAEnE,EAAK,eAAiB,EAAK,iBACvB,EAAK,eAAe,WAAW,UAC/B,EAAK,cAAgB,EAAW,EAAsB,EAAK,eACpD,mBAAmB,KAAK,EAAK,kBACpC,EAAK,cAAgB,EAAW,EAA2B,EAAK,iBAGpE,EAAK,QACL,EAAK,MAAQ,EAAW,EAAsB,EAAK,QAEnD,EAAK,oBACL,EAAK,kBAAoB,EAAW,EAAsB,EAAK,oBAK3E,EAAI,IAAI,OAAQ,KAIxB,IAAA,GAAea,GCxJf,MAAM,EAAK,GAAW,CAClB,KAAM,KAGJ,GAAuB,EAAe,EAAe,EAAc,IAAqB,CAC1F,IAAM,EAAQ,EAAE,GAEhB,GAAI,EACA,GAAI,CACA,IAAM,EAAU,EAAM,KAAK,GACvB,GAEA,EAAM,KAAK,EAAM,IAAI,IAAI,EAAS,GAAS,WAE3C,IAMV,EAAkB,MAAO,EAAgB,IAAiB,CAC5D,IAAM,EAAS,GAAG,EAAO,OAAO,SAAS,mBACnC,EAAW,MAAMP,EAAO,EAAQ,CAClC,OAAQ,OACR,KAAM,CACF,MAAO,EAAO,OAAO,MACrB,WAAY,EAAO,OAAO,UAC1B,SAAU,CACN,CAAE,KAAM,SAAU,QAAS,GAC3B,CAAE,KAAM,OAAQ,QAAS,IAE7B,YAAa,EAAO,OAAO,aAE/B,QAAS,CACL,cAAe,UAAU,EAAO,OAAO,YAI/C,OAAO,EAAS,QAAQ,GAAG,QAAQ,SAGjC,EAAmB,GAAS,CAC9B,IAAI,EAAS,GAIb,OAHI,EAAK,SACL,EAAS,OAAO,EAAK,QAAW,SAAW,EAAK,OAAS,EAAK,OAAO,IAAK,GAAM,EAAE,MAAM,KAAK,MAE1F,GAGLQ,GAAgC,MAAO,EAAK,IAAS,CACvD,MAAM,IAEN,IAAM,EAAO,EAAI,IAAI,QACrB,GAAI,EAAM,CACN,IAAK,CAAC,EAAK,MAAQ,EAAK,KAAK,SAAW,IAAM,CAAC,EAAK,WAChD,MAAU,MAAM,2IAIpB,EAAK,KAAO,EAAK,MAAQ,GAGzB,EAAK,QAAU,EAAK,MAAQ,EAAS,UAAU,EAAK,MAAQ,KAC5D,EAAK,cAAgB,EAAK,YAAc,EAAS,UAAU,EAAK,YAAc,KAG1E,EAAI,IAAI,MAAM,YAAc,UAC5B,EAAK,KAAO,EAAK,KAAK,MAAM,EAAa,IAAiB,IAAI,KAAK,EAAE,SAAW,GAAK,CAAC,IAAI,KAAK,EAAE,SAAW,KAGhH,IAAM,EAAc,GAAmB,CASnC,GARA,EAAK,QAAU,EAAK,MAAQ,EAAS,UAAU,EAAK,MAAQ,KAGxD,EAAK,UACL,EAAK,QAAU,IAAI,KAAK,EAAK,SAAS,eAItC,EAAK,KAAM,CACX,IAAI,EAAU,EAAK,KACf,GAAW,CAAC,eAAe,KAAK,KAChC,EAAU,QAAQ,KAAK,GAAW,QAAU,EAAU,UAAY,GAGtE,EAAK,KAAO,IAAI,IAAI,EAAK,KAAM,GAAS,KAI5C,GAAI,EAAK,YAAa,CAClB,IAAM,EAAI,EAAK,EAAK,aAChB,EAAU,EAAK,MAAQ,EAAK,KAE5B,GAAW,CAAC,eAAe,KAAK,KAChC,EAAU,QAAQ,KAAK,GAAW,QAAU,EAAU,UAAY,GAGtE,EAAE,UAAU,SAEZ,EAAE,OAAO,MAAM,EAAG,IAAQ,CACtB,IAAM,EAAO,EAAE,GAGf,GAAI,CAAC,EAAK,KAAK,OAAQ,CACnB,IAAM,EAAU,EAAK,KAAK,aAAe,EAAK,KAAK,iBACnD,GAAI,EACA,EAAK,KAAK,MAAO,QAEjB,IAAK,IAAM,KAAO,EAAI,QAAS,CAC3B,IAAM,EAAQ,EAAI,QAAQ,GAAK,OAC/B,GAAI,CAAC,OAAQ,OAAQ,OAAQ,SAAS,KAAM,GAAW,EAAM,SAAS,IAAU,CAC5E,EAAK,KAAK,MAAO,GACjB,QAOhB,IAAK,IAAM,IAAK,CAAC,UAAW,UAAW,UACnC,EAAK,WAAW,KAOxB,EAAE,WAAW,MAAM,EAAG,IAAS,CAC3B,EAAoB,EAAG,EAAM,OAAQ,KAIzC,EAAE,mDAAmD,MAAM,EAAG,IAAS,CACnE,EAAoB,EAAG,EAAM,MAAO,KAExC,EAAE,iBAAiB,MAAM,EAAG,IAAS,CACjC,EAAoB,EAAG,EAAM,SAAU,KAE3C,EAAE,eAAe,MAAM,EAAG,IAAS,CAC/B,EAAE,GAAM,KAAK,iBAAkB,iBAGnC,EAAK,YAAc,EAAE,QAAQ,OAAS,IAAM,EAAO,QAAU,IAEzD,EAAK,QAAQ,OAAS,EAAE,iBAAiB,QACzC,EAAK,QAAQ,OAAO,IAAK,IACrB,EAAE,aAAe,EAAE,KAAK,EAAE,kBACnB,IAWnB,OALI,EAAK,WAEL,MAAM,QAAQ,EAAK,YAAc,EAAK,SAAW,CAAC,EAAK,WACvD,EAAK,SAAW,EAAK,SAAS,OAAQ,GAAM,OAAO,GAAM,WAEtD,GAGX,EAAK,KAAO,MAAM,QAAQ,IAAI,EAAK,KAAK,IAAK,GAAQ,EAAW,KAGhE,IAAM,EAAS,EAAO,QAAQ,oBACxB,EAAa,GAAgB,CAE/B,IAAM,EAAc,EAAI,IAAI,MAAM,2BAA6B,QAC/D,OAAQ,EAAR,CACI,IAAK,SACD,OAAO,IAAI,OAAO,EAAK,EAAc,IAAM,IAC/C,IAAK,MACD,OAAO,EAAM,QAAQ,EAAK,EAAc,EAAM,iBAAmB,GACrE,QACI,MAAU,MAAM,yBAAyB,EAAO,gCAI5D,GAAI,EAAI,IAAI,MAAM,UAAW,CACzB,IAAM,EAAQ,EAAU,EAAI,IAAI,MAAM,WAEtC,EAAK,KAAO,EAAK,KAAK,OAAQ,GAAS,CACnC,IAAM,EAAQ,EAAK,OAAS,GACtB,EAAc,EAAK,aAAe,EAClC,EAAS,EAAgB,GACzB,EAAW,EAAK,UAAY,GAC5B,EACF,aAAiB,EACX,EAAM,QAAQ,GAAO,QAAU,EAAM,QAAQ,GAAa,QAAU,EAAM,QAAQ,GAAQ,QAAU,EAAS,KAAM,GAAM,EAAM,QAAQ,GAAG,QAC1I,EAAM,MAAM,IAAU,EAAY,MAAM,IAAU,EAAO,MAAM,IAAU,EAAS,KAAM,GAAM,EAAE,MAAM,IAEhH,OAAO,IA+Df,GA1DI,CAAC,EAAI,IAAI,MAAM,YAAc,EAAI,IAAI,MAAM,iBAAmB,EAAI,IAAI,MAAM,uBAAyB,EAAI,IAAI,MAAM,kBAAoB,EAAI,IAAI,MAAM,sBACrJ,EAAK,KAAO,EAAK,KAAK,OAAQ,GAAS,CACnC,IAAM,EAAQ,EAAK,OAAS,GACtB,EAAc,EAAK,aAAe,EAClC,EAAS,EAAgB,GACzB,EAAW,EAAK,UAAY,GAC9B,EAAW,GAEf,GAAI,EAAI,IAAI,MAAM,gBAAiB,CAC/B,IAAM,EAAa,EAAU,EAAI,IAAI,MAAM,iBAC3C,EAAW,aAAsB,EAAQ,EAAW,QAAQ,GAAO,OAAS,CAAC,CAAC,EAAW,KAAK,GAElG,GAAI,EAAI,IAAI,MAAM,sBAAuB,CACrC,IAAM,EAAmB,EAAU,EAAI,IAAI,MAAM,uBACjD,EAAW,IAAa,aAA4B,EAAQ,EAAiB,QAAQ,GAAa,OAAS,CAAC,CAAC,EAAiB,KAAK,IAEvI,GAAI,EAAI,IAAI,MAAM,iBAAkB,CAChC,IAAM,EAAc,EAAU,EAAI,IAAI,MAAM,kBAC5C,EAAW,IAAa,aAAuB,EAAQ,EAAY,QAAQ,GAAQ,OAAS,CAAC,CAAC,EAAY,KAAK,IAEnH,GAAI,EAAI,IAAI,MAAM,mBAAoB,CAClC,IAAM,EAAgB,EAAU,EAAI,IAAI,MAAM,oBAC9C,EAAW,GAAY,EAAS,KAAM,GAAO,aAAyB,EAAQ,EAAc,QAAQ,GAAG,OAAS,EAAE,MAAM,IAG5H,OAAO,MAIX,EAAI,IAAI,MAAM,cAAgB,EAAI,IAAI,MAAM,oBAAsB,EAAI,IAAI,MAAM,0BAA4B,EAAI,IAAI,MAAM,qBAAuB,EAAI,IAAI,MAAM,yBAC/J,EAAK,KAAO,EAAK,KAAK,OAAQ,GAAS,CACnC,IAAM,EAAQ,EAAK,MACb,EAAc,EAAK,aAAe,EAClC,EAAS,EAAgB,GACzB,EAAW,EAAK,UAAY,GAC9B,EAAW,GAEf,GAAI,EAAI,IAAI,MAAM,cAAgB,EAAI,IAAI,MAAM,mBAAoB,CAChE,IAAM,EAAa,EAAU,EAAI,IAAI,MAAM,oBAAsB,EAAI,IAAI,MAAM,cAC/E,EAAW,aAAsB,EAAQ,CAAC,EAAW,QAAQ,GAAO,OAAS,CAAC,EAAW,KAAK,GAElG,GAAI,EAAI,IAAI,MAAM,cAAgB,EAAI,IAAI,MAAM,yBAA0B,CACtE,IAAM,EAAmB,EAAU,EAAI,IAAI,MAAM,0BAA4B,EAAI,IAAI,MAAM,cAC3F,EAAW,IAAa,aAA4B,EAAQ,CAAC,EAAiB,QAAQ,GAAa,OAAS,CAAC,EAAiB,KAAK,IAEvI,GAAI,EAAI,IAAI,MAAM,oBAAqB,CACnC,IAAM,EAAc,EAAU,EAAI,IAAI,MAAM,qBAC5C,EAAW,IAAa,aAAuB,EAAQ,CAAC,EAAY,QAAQ,GAAQ,OAAS,CAAC,EAAY,KAAK,IAEnH,GAAI,EAAI,IAAI,MAAM,sBAAuB,CACrC,IAAM,EAAgB,EAAU,EAAI,IAAI,MAAM,uBAC9C,EAAW,GAAY,CAAC,EAAS,KAAM,GAAO,aAAyB,EAAQ,EAAc,QAAQ,GAAG,OAAS,EAAE,MAAM,IAG7H,OAAO,KAIX,EAAI,IAAI,MAAM,eAAgB,CAC9B,IAAM,EAAM,KAAK,MACjB,EAAK,KAAO,EAAK,KAAK,QAAQ,CAAE,aAAc,CAC1C,IAAI,EAAW,GACf,GAAI,CACA,EAAW,CAAC,GAAW,EAAM,IAAI,KAAK,GAAS,WAAa,OAAO,SAAS,EAAI,IAAI,MAAM,gBAAmB,SACzG,EAGR,OAAO,IAuBf,GAlBI,EAAI,IAAI,MAAM,WACd,EAAK,KAAO,EAAK,KAAK,MAAM,EAAG,OAAO,SAAS,EAAI,IAAI,MAAM,YAI7D,EAAI,IAAI,MAAM,SACd,EAAK,KAAK,IAAK,GAAS,CACpB,GAAI,EAAK,KAAM,CACX,IAAM,EAAc,mBAAmB,EAAK,MAE5C,MADA,GAAK,KAAO,uBAAuB,EAAY,SAAS,EAAI,IAAI,MAAM,UAC/D,OAEP,OAAO,IAMf,EAAI,IAAI,MAAM,SAAS,gBAAkB,WAAY,CACrD,IAAM,EAAQ,EAAK,KAAK,IAAI,KAAO,IAAS,CACxC,GAAM,CAAE,OAAM,SAAQ,eAAgB,EAChCN,EAAqB,MAAMqF,EAAM,OAAO,iBAAiB,IAAQ,SAAY,CAC/E,GAAI,EAEA,GAAI,CACA,IAAM,EAAM,MAAMvF,EAAO,GACnB,EAAI,EAAK,GACT,EAAS,MAAM,GAAO,MAAM,EAAM,CACpC,KAAM,EAAE,SAEZ,OAAO,OACH,KAMhB,EAAK,OAAS,GAAU,GAAe,OACvC,EAAK,YAAc,GAAiB,EAAc,QAAQ,OAAS,GAAK,EAAS,UAAU,EAAc,SAAW,IAExH,MAAM,QAAQ,IAAI,GAqEtB,GAjEI,EAAI,IAAI,MAAM,YAAc,EAAO,OAAO,SAC1C,EAAK,KAAO,MAAM,QAAQ,IACtB,EAAK,KAAK,IAAI,KAAO,IAAS,CAC1B,GAAI,CAEA,GAAI,EAAO,OAAO,cAAgB,eAAiB,EAAK,YAAa,CACjE,IAAM,EAAc,MAAMuF,EAAM,OAAO,sBAAsB,EAAK,OAAQ,SAAY,CAClF,IAAMnF,EAAc,EAAQ,EAAK,aAC3B,EAAgB,MAAM,EAAgB,EAAO,OAAO,kBAAmBA,GAC7E,OAAO,EAAG,OAAO,KAGjB,IAAgB,KAChB,EAAK,YAAc,EAAc,aAAe,EAAK,qBAIpD,EAAO,OAAO,cAAgB,SAAW,EAAK,MAAO,CAC1D,IAAM,EAAQ,MAAMmF,EAAM,OAAO,gBAAgB,EAAK,OAAQ,SAAY,CACtE,IAAMlF,EAAQ,EAAQ,EAAK,OAC3B,OAAO,MAAM,EAAgB,EAAO,OAAO,YAAaA,KAGxD,IAAU,KACV,EAAK,MAAQ,EAAQ,YAIpB,EAAO,OAAO,cAAgB,QAAU,EAAK,OAAS,EAAK,YAAa,CAC7E,IAAM,EAAQ,MAAMkF,EAAM,OAAO,gBAAgB,EAAK,OAAQ,SAAY,CACtE,IAAMlF,EAAQ,EAAQ,EAAK,OAC3B,OAAO,MAAM,EAAgB,EAAO,OAAO,YAAaA,KAGxD,IAAU,KACV,EAAK,MAAQ,EAAQ,IAGzB,IAAM,EAAc,MAAMkF,EAAM,OAAO,sBAAsB,EAAK,OAAQ,SAAY,CAClF,IAAMnF,EAAc,EAAQ,EAAK,aAC3B,EAAgB,MAAM,EAAgB,EAAO,OAAO,kBAAmBA,GAC7E,OAAO,EAAG,OAAO,KAGjB,IAAgB,KAChB,EAAK,YAAc,EAAc,aAAe,EAAK,mBAGzD,EAGR,OAAO,MAMf,EAAI,IAAI,MAAM,WACd,EAAK,KAAK,IAAK,IACX,EAAK,KAAO,EAAK,IAAM,GAAG,EAAO,OAAO,OAAO,EAAK,MAAQ,GAAG,EAAO,OAAO,OAAO,EAAK,OAClF,IAKX,EAAI,IAAI,MAAM,UACd,IAAK,IAAM,KAAQ,EAAK,KACpB,EAAK,MAAQ,GAAS,EAAK,OAAS,EAAK,KAAM,EAAI,IAAI,MAAM,WAC7D,EAAK,YAAc,GAAS,EAAK,aAAe,EAAK,OAAS,EAAK,KAAM,EAAI,IAAI,MAAM,WAK/F,GAAI,EAAI,IAAI,MAAM,SAAU,CACxB,IAAM,EAAM,cACZ,GAAI,EAAI,KAAK,EAAI,IAAI,MAAM,UAAY,CACnC,IAAME,EAAgB,OAAO,SAAS,EAAI,IAAI,MAAM,UACpD,IAAK,IAAM,KAAQ,EAAK,KAAM,CAC1B,IAAI,EACA,EAAK,cACL,EAAO,GAAa,EAAK,YAAa,CAAE,YAAa,GAAI,kBAAmB,KAC5E,EAAK,YAAc,EAAK,OAAS,EAAQ,MAAM,EAAK,MAAM,EAAG,GAAO,OAAS,MAAM,EAAK,aAIhG,MAAU,MAAM,2GAKxB,EAAI,IAAI,OAAQ,KAMxB,IAAA,GAAeC,GClaf,MAAMC,GAAgC,MAAO,EAAK,IAAS,CACvD,GAAI,EAAO,UAAW,CAElB,GAAM,CAAE,SAAQ,OAAQ,EAAI,IACtBqE,EAAO,EAAQ,GAEf,EAAO,GAAO,UAAU,GAAG,EAAO,GAAGA,IAAQ,CAC/C,KAAM,EACN,WAAY,KAEhB,EAAK,SAAS,0BACd,MAAM,IACN,EAAK,WAGL,MAAM,KAId,IAAA,GAAe,GCtBf,MAAanE,GAAc,GACvB,EAAC,OAAA,CAAA,SAAA,CACG,EAAC,OAAA,CAAA,SAAA,CACG,EAAC,QAAA,CAAA,SAAM,uBACP,EAAC,SAAA,CAAO,IAAI,gCACZ,EAAC,QAAA,CAAA,SACI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;uBAuCT,EAAC,OAAA,CAAK,UAAU,gEAAwD,EAAM,cC7CtF,IAAI,EAAU,QAAQ,IAAI,oBAAoB,MAAM,EAAG,IAAM,QAAQ,IAAI,uBAAuB,MAAM,EAAG,GACrGC,EACJ,GAAI,CAAC,EACD,GAAI,CACA,EAAU,GAAS,sBAAsB,WAAW,OAAO,MAAM,EAAG,GACpE,EAAU,IAAI,KAAK,GAAS,2BAA2B,WAAW,aAC9D,CACJ,EAAU,UCJlB,MAAMC,IAKA,CAAE,cAAa,UAAS,aAAY,iBACtC,EAAC,GAAA,CAAA,SAAA,CACG,EAAC,MAAA,CACG,UAAU,mDACV,MAAO,CACH,gBAAiB,oPACjB,UAAW,sDAGnB,EAAC,MAAA,CAAI,UAAU,0FACX,EAAC,MAAA,CAAI,UAAU,YAAY,IAAI,YAAY,IAAI,SAAS,MAAM,MAAM,QAAQ,SAC5E,EAAC,KAAA,CAAG,UAAU,8BAAqB,oCACnC,EAAC,MAAA,CAAI,UAAU,iDACX,EAAC,MAAA,CAAI,UAAU,sBACX,EAAC,IAAA,CAAE,UAAU,0BAAiB,wBAC9B,EAAC,IAAA,CAAE,UAAU,oBAAU,iBAEnB,EAAC,KAAA,IACD,EAAC,OAAA,CAAK,UAAU,wGAAgG,OAEpH,EAAC,IAAA,CAAE,UAAU,oBAAU,UACZ,EAAC,OAAA,CAAK,UAAU,4BAAoB,OAE/C,EAAC,IAAA,CAAE,UAAU,oBAAU,eACP,EAAC,OAAA,CAAK,UAAU,4BAAoB,OAEpD,EAAC,IAAA,CAAE,UAAU,oBAAU,iBACL,EAAC,OAAA,CAAK,UAAU,4BAAoB,OAEtD,EAAC,IAAA,CAAE,UAAU,oBAAU,aACT,EAAC,OAAA,CAAK,UAAU,4BAAoB,OAElD,EAAC,IAAA,CAAE,UAAU,oBAAU,aACT,EAAC,OAAA,CAAK,UAAU,4BAAoB,GAAS,sBAG/D,EAAC,MAAA,CAAA,SAAA,CACG,EAAC,IAAA,CAAE,UAAU,0BAAiB,WAC9B,EAAC,IAAA,CAAA,SAAA,CAAE,8BAC6B,IAC5B,EAAC,IAAA,CAAE,UAAU,iBAAiB,KAAK,2BAA2B,OAAO,kBAAS,aAE1E,iDAC2C,IAC/C,EAAC,IAAA,CAAE,UAAU,iBAAiB,KAAK,mGAAmG,OAAO,kBAAS,oBAEjJ,IAAI,gBAGb,EAAC,IAAA,CAAA,SAAA,CAAE,QAEC,EAAC,IAAA,CAAE,UAAU,iBAAiB,KAAK,8BAA8B,OAAO,kBAAS,OAE7E,mCAC6B,IACjC,EAAC,IAAA,CAAE,UAAU,iBAAiB,KAAK,mGAAmG,OAAO,kBAAS,aAElJ,UAIZ,EAAC,MAAA,CAAA,SAAA,CACG,EAAC,IAAA,CAAE,UAAU,0BAAiB,cAC9B,EAAC,IAAA,CAAA,SAAA,CAAE,wBACuB,IACtB,EAAC,IAAA,CAAE,UAAU,iBAAiB,OAAO,SAAS,KAAK,+BAAsB,mBAErE,kBACY,IAChB,EAAC,IAAA,CAAE,UAAU,iBAAiB,OAAO,SAAS,KAAK,sCAA6B,qBAE3E,IAAI,MACL,IACJ,EAAC,IAAA,CAAE,OAAO,SAAS,KAAK,kDAAkD,UAAU,0BAAiB,YAEhG,IAAI,wCAGb,EAAC,IAAA,CAAA,SAAA,CAAE,YACW,IACV,EAAC,IAAA,CAAE,UAAU,iBAAiB,OAAO,SAAS,KAAK,+BAAsB,gBAErE,UACI,IACR,EAAC,IAAA,CAAE,UAAU,iBAAiB,OAAO,SAAS,KAAK,sCAA6B,gBAE5E,IACF,IACF,EAAC,IAAA,CAAE,OAAO,SAAS,KAAK,kDAAkD,UAAU,0BAAiB,YAEhG,IAAI,yBAMzB,EAAC,MAAA,CAAI,UAAU,uEACX,EAAC,IAAA,CAAE,UAAU,sBACT,EAAC,IAAA,CAAE,OAAO,SAAS,KAAK,4CACpB,EAAC,MAAA,CAAI,UAAU,SAAS,IAAI,gCAAgC,IAAI,SAAS,MAAM,KAAK,OAAO,SAE/F,EAAC,IAAA,CAAE,OAAO,SAAS,KAAK,+BACpB,EAAC,MAAA,CAAI,UAAU,SAAS,IAAI,4BAA4B,IAAI,iBAAiB,MAAM,KAAK,OAAO,SAEnG,EAAC,IAAA,CAAE,OAAO,SAAS,KAAK,sCACpB,EAAC,MAAA,CAAI,UAAU,SAAS,IAAI,4BAA4B,IAAI,mBAAmB,MAAM,KAAK,OAAO,SAErG,EAAC,IAAA,CAAE,OAAO,SAAS,KAAK,kDAAkD,UAAU,0BAChF,EAAC,MAAA,CAAI,UAAU,SAAS,IAAI,qBAAqB,IAAI,IAAI,MAAM,KAAK,OAAO,YAGnF,EAAC,IAAA,CAAE,UAAU,kBAAQ,kBACD,IAChB,EAAC,IAAA,CAAE,OAAO,SAAS,KAAK,kCAAkC,UAAU,0BAAiB,eAEhF,IAAI,kDAGb,EAAC,IAAA,CAAA,SAAA,CAAE,kBACiB,IAChB,EAAC,IAAA,CAAE,OAAO,SAAS,KAAK,oBAAoB,UAAU,0BAAiB,WAElE,IAAI,MACL,IACJ,EAAC,IAAA,CAAE,OAAO,SAAS,KAAK,uDAAuD,UAAU,0BAAiB,iBAErG,IAAI,8BAOzB,IAAA,GAAeY,GCnIf,MAAaV,IAA8B,EAAO,IAAQ,CACtD,IAAM,EAAc,EAAI,IAAI,KACtB,EAAe,EAAU,GACzB,EAAkB,IAAiB,KAEnCoE,EAAQ,IACd,GAAI,CACI,EAAI,IAAI,QAAQ,IAAI,wBACpB,EAAM,gBAEN,EAGR,EAAM,QAEDA,EAAM,WAAW,KAClB,EAAM,WAAW,GAAe,GAEpC,EAAM,WAAW,KAEb,CAACA,EAAM,YAAY,IAAiB,IACpC,EAAM,YAAY,GAAgB,GAEtC,GAAmB,EAAM,YAAY,KACrC,EAAaA,GAET,EAAO,OAAO,KACd,EAAO,UAAW,GAAU,CACxB,EAAM,OAAO,OAAQ,EAAY,MAAM,KAAK,IAC5C,EAAO,iBAAiB,KAIhC,IAAI,EAAmF,EAAM,QAC7F,OAAQ,EAAM,YAAY,KAA1B,CACI,IAAK,YACL,IAAK,eACL,IAAK,aACD,EAAI,OAAO,KACX,MACJ,IAAK,yBACD,EAAI,OAAO,gBAAiB,mBAAmB,EAAO,eAAiB,OACvE,EAAI,OAAO,KACX,MACJ,IAAK,cACD,EAAI,OAAO,KACX,MACJ,IAAK,gBACD,EAAI,OAAO,KACX,GAAgB,gDAChB,MACJ,QACI,EAAI,OAAO,KACX,MAER,IAAM,EAAU,GAAG,EAAM,KAAK,IAAI,IAKlC,OAHA,EAAO,MAAM,YAAY,EAAY,IAAI,KACzC,GAAc,MAAM,CAAE,KAAM,EAAc,OAAQ,EAAI,IAAI,OAAQ,OAAQ,EAAI,IAAI,SAE3E,EAAO,WAAa,EAAI,IAAI,MAAM,YAAc,OACjD,EAAI,KAAK,CACL,MAAO,CACH,QAAS,EAAM,SAAW,KAGlC,EAAI,KAAK,EAAClE,GAAAA,CAAmB,cAAsB,UAAS,WAAY,EAAkB,EAAe,EAAa,YAAa,QAAQ,YAGxIC,GAAoC,GAAQ,GAAa,IAAIC,GAAiB,GC1ErF,GAAY,KAAK,MAEjBC,IAAiD,CAAE,gBAAiB,CACtE,IAAM+D,EAAQ,IAER,EAAY,CAAC,EAAO,WAAa,EAAO,YAAc,QAAU,GAAQ,EAAO,YAAc,QAAU,EAAO,YAAc,EAC5H,CAAE,gBAAe,WAAU,SAAU,EAErC,EAAW,KAAK,MAAQ,GAExB,EAAO,CACT,YACA,gBACA,MAAO,CACH,GAAI,EACE,CACI,CACI,KAAM,YACN,MAAO,IAGf,GACN,GAAI,EACE,CACI,CACI,KAAM,WACN,MACI,EAAC,IAAA,CAAE,UAAU,YAAY,KAAM,2CAA2C,aACrE,MAKjB,GACN,GAAI,EACE,CACI,CACI,KAAM,WACN,MAAO,EAAQ,gBAGvB,GACN,CACI,KAAM,iBACN,MAAO,EAAM,YAAc,KAE/B,CACI,KAAM,iBACN,MAAOA,EAAM,SAEjB,CACI,KAAM,oBACN,OAASA,EAAM,SAAW,EAAW,KAAS,IAAI,QAAQ,GAAK,iBAEnE,CACI,KAAM,kBACN,MAAOA,EAAM,SAAYA,EAAM,SAAWA,EAAM,QAAW,KAAK,QAAQ,GAAK,IAAM,GAEvF,CACI,KAAM,qBACN,MAAOA,EAAM,SAAYA,EAAM,KAAOA,EAAM,QAAW,KAAK,QAAQ,GAAK,IAAM,GAEnF,CACI,KAAM,SACN,MAAOA,EAAM,UAAY,EAAIA,EAAM,MAAQA,EAAM,SAAW,KAAK,QAAQ,GAAK,IAAM,GAExF,CACI,KAAM,SACN,OAAQ,EAAW,MAAW,QAAQ,GAAK,YAE/C,CACI,KAAM,aACN,MAAO,OAAO,KAAKA,EAAM,QACpB,MAAM,EAAG,IAAMA,EAAM,OAAO,GAAKA,EAAM,OAAO,IAC9C,MAAM,EAAG,IACT,IAAK,GACF,EAAA,EAAA,CAAA,SAAA,CACKA,EAAM,OAAOpB,GAAO,IAAEA,EACvB,EAAC,KAAA,SAIjB,CACI,KAAM,YACN,MAAO,OAAO,KAAKoB,EAAM,OACpB,MAAM,EAAG,IAAMA,EAAM,MAAM,GAAKA,EAAM,MAAM,IAC5C,MAAM,EAAG,IACT,IAAK,GACF,EAAA,EAAA,CAAA,SAAA,CACKA,EAAM,MAAML,GAAM,IAAEA,EACrB,EAAC,KAAA,SAIjB,CACI,KAAM,mBACN,MAAO,OAAO,KAAKK,EAAM,aACpB,MAAM,EAAG,IAAMA,EAAM,YAAY,GAAKA,EAAM,YAAY,IACxD,MAAM,EAAG,IACT,IAAK,GACF,EAAA,EAAA,CAAA,SAAA,CACKA,EAAM,YAAYpB,GAAO,IAAEA,EAC5B,EAAC,KAAA,SAIjB,CACI,KAAM,kBACN,MAAO,OAAO,KAAKoB,EAAM,YACpB,MAAM,EAAG,IAAMA,EAAM,WAAW,GAAKA,EAAM,WAAW,IACtD,MAAM,EAAG,IACT,IAAK,GACF,EAAA,EAAA,CAAA,SAAA,CACKA,EAAM,WAAWL,GAAM,IAAEA,EAC1B,EAAC,KAAA,WAOzB,OACI,EAAC,GAAA,CAAA,SAAA,CACG,EAAC,MAAA,CACG,UAAU,mDACV,MAAO,CACH,gBAAiB,oPACjB,UAAW,sDAGnB,EAAC,MAAA,CAAI,UAAU,0FACX,EAAC,MAAA,CAAI,IAAI,aAAa,IAAI,SAAS,MAAM,MAAM,QAAQ,SACvD,EAAC,KAAA,CAAG,UAAU,+BAAqB,cACpB,EAAC,OAAA,CAAK,UAAU,0BAAiB,WAAa,OAE7D,EAAC,IAAA,CAAE,UAAU,6CAAoC,qCACjD,EAAC,IAAA,CAAE,UAAU,yBAAgB,4EAC7B,EAAC,MAAA,CAAI,UAAU,wCACX,EAAC,IAAA,CAAE,OAAO,SAAS,KAAK,mCACpB,EAAC,SAAA,CAAO,UAAU,+FAAsF,WAE5G,EAAC,IAAA,CAAE,OAAO,SAAS,KAAK,4CACpB,EAAC,SAAA,CAAO,UAAU,kFAAyE,gBAGlG,EAAK,UACF,EAAC,UAAA,CAAQ,UAAU,2DACf,EAAC,UAAA,CAAQ,UAAU,kCAAyB,eAC3C,EAAK,MAAM,IAAK,GACb,EAAC,MAAA,CAAI,MAAM,iCACP,EAAC,OAAA,CAAK,MAAM,wDAA+C,EAAK,KAAK,QACrE,EAAC,OAAA,CAAK,MAAM,wDAAgD,EAAK,eAI7E,QAGR,EAAC,MAAA,CAAI,UAAU,uEACX,EAAC,IAAA,CAAE,UAAU,sBACT,EAAC,IAAA,CAAE,OAAO,SAAS,KAAK,4CACpB,EAAC,MAAA,CAAI,UAAU,SAAS,IAAI,gCAAgC,IAAI,SAAS,MAAM,KAAK,OAAO,SAE/F,EAAC,IAAA,CAAE,OAAO,SAAS,KAAK,+BACpB,EAAC,MAAA,CAAI,UAAU,SAAS,IAAI,4BAA4B,IAAI,iBAAiB,MAAM,KAAK,OAAO,SAEnG,EAAC,IAAA,CAAE,OAAO,SAAS,KAAK,sCACpB,EAAC,MAAA,CAAI,UAAU,SAAS,IAAI,4BAA4B,IAAI,mBAAmB,MAAM,KAAK,OAAO,SAErG,EAAC,IAAA,CAAE,OAAO,SAAS,KAAK,kDAAkD,UAAU,0BAChF,EAAC,MAAA,CAAI,UAAU,SAAS,IAAI,qBAAqB,IAAI,IAAI,MAAM,KAAK,OAAO,YAGnF,EAAC,IAAA,CAAE,UAAU,kBAAQ,kBACD,IAChB,EAAC,IAAA,CAAE,OAAO,SAAS,KAAK,kCAAkC,UAAU,0BAAiB,eAEhF,IAAI,kDAGb,EAAC,IAAA,CAAA,SAAA,CAAE,kBACiB,IAChB,EAAC,IAAA,CAAE,OAAO,SAAS,KAAK,oBAAoB,UAAU,0BAAiB,WAElE,IAAI,MACL,IACJ,EAAC,IAAA,CAAE,OAAO,SAAS,KAAK,uDAAuD,UAAU,0BAAiB,iBAErG,IAAI,+BAQ7B,IAAA,GAAe,GCxMf,MAAM/C,GAAoB,IACtB,EAAI,OAAO,gBAAiB,YAErB,EAAI,KAAK,EAACN,GAAAA,CAAM,WAAY,EAAI,IAAI,MAAM,aAGrD,IAAA,GAAeO,GCPf,MAAMD,GAAoB,IACtB,EAAI,OAAO,gBAAiB,YACrB,EAAI,KAAK,OAGpB,IAAA,GAAeC,GCJf,MAAMD,GAAoB,GAClB,EAAO,cACA,EAAI,KAAK;eAEhB,EAAI,OAAO,KACJ,EAAI,KAAK,KAIxB,IAAA,GAAeC,GCTf,MAAMD,GAAoB,GACtB,KACK,KAAM,GAAQ,EAAI,KAAK,IACvB,MAAO,GAAU,CACd,EAAI,OAAO,KACX,EAAI,KAAK,CAAE,YAGvB,IAAA,GAAeC,GCGf,MAAM,GAAY,OAAO,KAAK,QAE9B,SAAS,GAAa,EAA6B,CAC/C,OAAO,OAAO,OAAO,GAAQ,MAAO,GAAiB,CAAC+B,EAAM,UAAU,MAG1E,SAAS,GAAe,EAA4C,CAChE,IAAM7B,EAAuB,GAE7B,IAAK,GAAM,CAAC,EAAK,KAAU,OAAO,QAAQC,IAClC,EAAM,SAAW,MAAQ,EAAM,SAAW,IAAA,IAAa,GAAa,EAAM,WAC1E,EAAK,GAAO,GAGpB,OAAO,EAGX,IAAIC,EAAuE,GAsBvEC,EAA6B,GAEjC,OAAA,aAAA,CACI,IAAK,aACD,GAAc,MAAM,OAAO,yBAA8B,QACzD,MACJ,IAAK,OAED,EAAa,MAAM,OAAO,wBACtB,EAAW,UAEX,EAAa,EAAW,SAE5B,MACJ,QACI,EAAU,GAAgB,CACtB,oBAAqB,GAAK,KAAK,GAAW,YAC1C,cAAe,UAQ3B,GAJI,EAAO,QAAQ,eACf,EAAa,GAAe,IAG5B,OAAO,KAAK,GAAS,OACrB,IAAK,IAAM,KAAU,EAAS,CAC1B,IAAM,EAAU,EAAQ,GAUlB,EAAY,EAAO,MAAM,SAAS,GACxC,GAAI,cAAe,EACf,EAAW,GAAa,OAAO,OAC3B,CACI,OAAQ,IAEZ,EAAW,GACX,EAAQ,mBAEL,UAAW,EAQlB,GAPK,EAAW,KACZ,EAAW,GAAa,CACpB,KAAM,EACN,OAAQ,GACR,UAAW,KAGf,MAAM,QAAQ,EAAQ,MAAM,MAC5B,IAAK,IAAMyC,KAAQ,EAAQ,MAAM,KAC7B,EAAW,GAAW,OAAOA,GAAQ,CACjC,GAAG,EAAQ,MACX,SAAU,EAAO,MAAM,SAAS,MAAM,GAAG,KAAK,WAItD,EAAW,GAAW,OAAO,EAAQ,MAAM,MAAQ,CAC/C,GAAG,EAAQ,MACX,SAAU,EAAO,MAAM,SAAS,MAAM,GAAG,KAAK,cAG/C,aAAc,EAQrB,GAPK,EAAW,KACZ,EAAW,GAAa,CACpB,KAAM,EACN,OAAQ,GACR,UAAW,KAGf,MAAM,QAAQ,EAAQ,SAAS,MAC/B,IAAK,IAAMA,KAAQ,EAAQ,SAAS,KAChC,EAAW,GAAW,UAAUA,GAAQ,CACpC,GAAG,EAAQ,SACX,SAAU,EAAO,MAAM,SAAS,MAAM,GAAG,KAAK,WAItD,EAAW,GAAW,UAAU,EAAQ,SAAS,MAAQ,CACrD,GAAG,EAAQ,SACX,SAAU,EAAO,MAAM,SAAS,MAAM,GAAG,KAAK,MASlE,MAAMb,EAAM,IAAI,GACV,GACF,GAQA,OAAO,QAAQ,GAAQ,MAAM,CAAC,GAAQ,CAAC,KAAW,CAC9C,IAAM,EAAY,EAAM,MAAM,KACxB,EAAY,EAAM,MAAM,KACxB,EAAO,EAAU,OACjB,EAAO,EAAU,OACjB,EAAS,KAAK,IAAI,EAAM,GAE9B,IAAK,IAAI,EAAI,EAAG,EAAI,EAAQ,IAAK,CAC7B,IAAM,EAAW,EAAU,GACrB,EAAW,EAAU,GAG3B,GAAI,EAAS,WAAW,OAAS,EAAS,WAAW,KACjD,OAAO,EAAS,WAAW,KAAO,EAAI,GAI9C,MAAO,KAGf,IAAK,IAAM,KAAa,EAAY,CAChC,IAAM,EAASA,EAAI,SAAS,IAAI,KAE1B,EAAgB,EAAW,GACjC,GAAI,CAAC,GAAiB,CAAC,EAAc,OACjC,SAGJ,IAAM,EAAe,GAAW,EAAc,QAE9C,IAAK,GAAM,CAACa,EAAM,KAAc,EAAc,CAC1C,IAAMtC,EAA0B,KAAO,IAAQ,CAE3C,GADA,EAAO,MAAM,kBAAkB,EAAU,MACrC,CAAC,EAAI,IAAI,QAAS,CAClB,GAAI,OAAO,EAAU,SAAY,YAIlB,EAAU,OAAQ,CACzB,GAAM,CAAE,MAAA,GAAU,MAAM,EAAU,SAClC,EAAU,QAAUuB,EAAM,QAGlC,EAAI,IAAI,OAAQ,MAAM,EAAU,QAAQ,MAGhD,EAAO,IAAIe,EAAM,IAIzB,IAAK,IAAM,KAAa,EAAY,CAChC,IAAM,EAASb,EAAI,SAAS,QAAQ,KAE9B,EAAgB,EAAW,GACjC,GAAI,CAAC,GAAiB,CAAC,EAAc,UACjC,SAGJ,IAAM,EAAe,OAAO,QAAQ,EAAc,WAQlD,IAAK,GAAM,CAACa,EAAM,KAAc,EAAc,CAC1C,IAAMtC,EAA0B,KAAO,IAAQ,CAC3C,GAAI,CAAC,EAAI,IAAI,WAAY,CACrB,GAAI,OAAO,EAAU,SAAY,YAIlB,EAAU,OAAQ,CACzB,GAAM,CAAE,YAAa,MAAM,EAAU,SACrC,EAAU,QAAU,EAAS,QAGrC,IAAM,EAAO,MAAM,EAAU,QAAQ,GACrC,EAAI,IAAI,UAAW,KAG3B,EAAO,IAAIsC,EAAM,IAIzBb,EAAI,IAAI,IAAKxB,IACbwB,EAAI,IAAI,WAAYvB,IACpBuB,EAAI,IAAI,cAAetB,IACnB,EAAO,WAEP,EAAI,IAAI,WAAYC,IAExBqB,EAAI,IACA,KACA,GAAY,CACR,KAAM,GAAK,KAAK,GAAW,UAC3B,mBAAqB,GAAUa,IAAS,eAAiB,eAAiBA,KAIlF,IAAA,GAAeb,EC/Pf,MAAM,GAAQ,EAAY,CACtB,OAAQ,MACR,KAAM,aACN,KAAM,CAAC,aACP,UAAW,CACP,IAAK,CACD,YAAa,uCAKnBD,GAAuC,GAAQ,EAAI,KAAK,GCXxDR,GAAe,EAAE,OAAO,CAC1B,UAAW,EAAE,SAAS,QAAQ,CAC1B,MAAO,CACH,KAAM,YACN,GAAI,QAER,QAAS,aAIXO,GAAQ,EAAY,CACtB,OAAQ,MACR,KAAM,yBACN,KAAM,CAAC,aACP,QAAS,CACL,OAAQP,IAEZ,UAAW,CACP,IAAK,CACD,YAAa,oCAKnBQ,GAAuC,GAAQ,CACjD,GAAM,CAAE,aAAc,EAAI,IAAI,MAAM,SACpC,OAAO,EAAI,KAAK,EAAW,KCxBzBV,EAEF,GAEJ,IAAK,IAAM,KAAa,EACpB,IAAK,IAAMwB,KAAQ,EAAW,GAAW,OAAQ,CAC7C,IAAM,EAAW,IAAI,IAAYA,IAC3B,EAAO,EAAW,GAAW,OAAOA,GAC1C,GAAI,EAAK,OAAO,OACZ,IAAK,IAAM,KAAa,EAAK,MAAO,CAChC,IAAM,EAAe,GAAM,IAAI,IAAI,WAAa,EAAU,OAAO,IAAI,UAC/D,EAAY,EAAa,WAAa,IACtC,EAAS,EAAa,OACxB,IACK3B,EAAM,KACP,EAAM,GAAU,CACZ,MAAO,EAAW,GAAW,OAGhCA,EAAM,GAAQ,KACf,EAAM,GAAQ,GAAa,IAE/B,EAAM,GAAQ,GAAW,KAAK,CAC1B,MAAO,EAAU,OAAS,EAAK,KAC/B,KAAM,kCAAkC,EAAK,aAAa,IAAM,UAChE,OAAQ,EAAU,OAAO,IAAK,GAAW,CACrC,IAAM,EAAY,IAAI,IAAI,WAAa,GACvC,OAAO,EAAU,SAAW,EAAU,OAAS,EAAU,OAE7D,OAAQ,EAAU,OAAS,IAAI,IAAY,EAAU,SAAW,MAQxF,MAAMY,GAAQ,EAAY,CACtB,OAAQ,MACR,KAAM,eACN,KAAM,CAAC,SACP,UAAW,CACP,IAAK,CACD,YAAa,sBAKnBC,GAAuC,GAAQ,EAAI,KAAKb,GChDxDG,EAEF,GAEJ,IAAK,IAAM,KAAa,EACpB,IAAK,IAAMwB,KAAQ,EAAW,GAAW,OAAQ,CAC7C,IAAM,EAAW,IAAI,IAAYA,IAC3B,EAAO,EAAW,GAAW,OAAOA,GAC1C,GAAI,EAAK,OAAO,OACZ,IAAK,IAAM,KAAa,EAAK,MAAO,CAChC,IAAM,EAAe,GAAM,IAAI,IAAI,WAAa,EAAU,OAAO,IAAI,UAC/D,EAAY,EAAa,WAAa,IACtC,EAAS,EAAa,OACxB,IACK,EAAM,KACP,EAAM,GAAU,CACZ,MAAO,EAAW,GAAW,OAGhC,EAAM,GAAQ,KACf,EAAM,GAAQ,GAAa,IAE/B,EAAM,GAAQ,GAAW,KAAK,CAC1B,MAAO,EAAU,OAAS,EAAK,KAC/B,KAAM,kCAAkC,EAAK,aAAa,IAAM,UAChE,OAAQ,EAAU,OAAO,IAAK,GAAW,CACrC,IAAM,EAAY,IAAI,IAAI,WAAa,GACvC,OAAO,EAAU,SAAW,EAAU,OAAS,EAAU,OAE7D,OAAQ,EAAU,OAAS,IAAI,IAAY,EAAU,SAAW,MAQxF,MAAMtB,GAAe,EAAE,OAAO,CAC1B,OAAQ,EAAE,SAAS,QAAQ,CACvB,MAAO,CACH,KAAM,SACN,GAAI,QAER,QAAS,iBAIXO,GAAQ,EAAY,CACtB,OAAQ,MACR,KAAM,wBACN,KAAM,CAAC,SACP,QAAS,CACL,OAAQP,IAEZ,UAAW,CACP,IAAK,CACD,YAAa,kEAKnBQ,GAAuC,GAAQ,CACjD,GAAM,CAAE,UAAW,EAAI,IAAI,MAAM,SACjC,OAAO,EAAI,KAAK,EAAM,KCjEpBL,EAAkD,GAExD,IAAK,IAAM,KAAa,EACpB,IAAK,IAAMmB,KAAQ,EAAW,GAAW,OACrC,GAAI,EAAW,GAAW,OAAOA,GAAM,YAAY,OAC/C,IAAK,IAAM,KAAY,EAAW,GAAW,OAAOA,GAAM,WACjD,EAAa,KACd,EAAa,GAAY,IAExB,EAAa,GAAU,KACxB,EAAa,GAAU,GAAa,CAChC,GAAG,EAAW,GACd,OAAQ,KAGhB,EAAa,GAAU,GAAW,OAAOA,GAAQ,EAAW,GAAW,OAAOA,GAM9F,MAAM,GAAe,EAAE,OAAO,CAC1B,SAAU,EAAE,SAAS,QAAQ,CACzB,MAAO,CACH,KAAM,WACN,GAAI,QAER,QAAS,cAIX,GAAc,EAAE,OAAO,CACzB,WAAY,EACP,SACA,UAAW,GAAQ,EAAI,MAAM,MAC7B,WACL,KAAM,EAAE,SAAS,aAGff,GAAQ,EAAY,CACtB,OAAQ,MACR,KAAM,uBACN,KAAM,CAAC,YACP,QAAS,CACL,MAAO,GACP,OAAQ,IAEZ,UAAW,CACP,IAAK,CACD,YAAa,gDAKnBC,GAAuC,GAAQ,CACjD,GAAM,CAAE,aAAY,QAAS,EAAI,IAAI,MAAM,SACrC,CAAE,YAAa,EAAI,IAAI,MAAM,SAE/B,EAAgB,CAAC,GACjB,GAAc,EAAW,OAAS,IAClC,EAAgB,CAAC,GAAG,EAAe,GAAG,IAI1C,IAAM,EAAmB,OAAO,KAAK,EAAa,IAAa,IAAI,OAAQ,GAAc,EAAc,MAAO,GAAQ,EAAa,KAAO,KAGtI,EAAS,OAAO,YAAY,EAAiB,IAAK,GAAc,CAAC,EAAW,EAAa,GAAU,MAOvG,OAJI,IACA,EAAS,OAAO,YAAY,OAAO,QAAQ,GAAQ,QAAQ,EAAG,KAAW,EAAM,OAAS,KAGrF,EAAI,KAAK,ICzEdD,GAAQ,EAAY,CACtB,OAAQ,MACR,KAAM,iBACN,KAAM,CAAC,UACP,UAAW,CACP,IAAK,CACD,YAAa,oBAKnBC,GAAuC,GACzC,EAAI,KAAK,CACL,YAAa,EAAO,OAAO,YAC3B,YAAa,EAAO,OAAO,YAC3B,MAAO,EAAO,OAAO,MACrB,UAAW,EAAO,OAAO,UACzB,UAAW,EAAO,MAAM,YACxB,UACA,QAAS,GAAS,YCbpBC,EAAM,IAAI,GAEhBA,EAAI,QAAQC,GAAmBC,IAC/BF,EAAI,QAAQG,GAAmBC,IAC/BJ,EAAI,QAAQK,GAAoBC,IAChCN,EAAI,QAAQO,GAAoBC,IAChCR,EAAI,QAAQS,GAAkBC,IAC9BV,EAAI,QAAQW,GAAmBC,IAE/B,MAAM,EAAOZ,EAAI,qBAAqB,CAClC,QAAS,QACT,KAAM,CACF,QAAS,QACT,MAAO,gBAGf,IAAK,IAAMa,KAAQ,EAAK,MACpB,EAAK,MAAM,OAAOA,KAAU,EAAK,MAAMA,GACvC,OAAO,EAAK,MAAMA,GAEtBb,EAAI,IAAI,gBAAkB,GAAQ,EAAI,KAAK,IAC3CA,EAAI,IAAI,aAAc,GAAO,CAAE,QAAS,KAExC,IAAA,GAAeA,ECXf,QAAQ,GAAG,oBAAsB,GAAM,CACnC,EAAO,MAAM,sBAAwB,KAGzC,MAAM,EAAM,IAAI,GAEhB,EAAI,IAAI,MACR,EAAI,IAAI,MAER,EAAI,IACA,IAAa,CAAE,cAAe,EAAA,EAAA,CAAG,aAAc,CAC3C,QAAS,yCACT,OAAQ,MAGhB,EAAI,IAAIc,IACR,EAAI,IAAIC,IACR,EAAI,IAAIC,IACR,EAAI,IAAIC,IACR,EAAI,IAAIC,IACR,EAAI,IAAIC,IACR,EAAI,IAAIC,IACR,EAAI,IAAIC,IACR,EAAI,IAAIC,IACR,EAAI,IAAIC,IAER,EAAI,MAAM,IAAKC,IACf,EAAI,MAAM,OAAQC,IAElB,EAAI,SAAS,IACb,EAAI,QAAQ,IAEZ,IAAA,GAAe"}