{"version":3,"file":"niaogebiji-J9mF29Xr.js","names":["route: Route","got","cache","response"],"sources":["../../lib/routes/niaogebiji/index.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport cache from '@/utils/cache';\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\nimport { parseDate } from '@/utils/parse-date';\r\n\r\nexport const route: Route = {\r\n    path: '/',\r\n    radar: [\r\n        {\r\n            source: ['niaogebiji.com/', 'niaogebiji.com/bulletin'],\r\n            target: '',\r\n        },\r\n    ],\r\n    name: 'Unknown',\r\n    maintainers: ['WenryXu'],\r\n    handler,\r\n    url: 'niaogebiji.com/',\r\n};\r\n\r\nasync function handler() {\r\n    const baseUrl = 'https://www.niaogebiji.com';\r\n    const { data: response } = await got(`${baseUrl}/pc/index/getMoreArticle`);\r\n\r\n    if (response.return_code !== '200') {\r\n        throw new Error(response.return_msg);\r\n    }\r\n\r\n    const postList = response.return_data.map((item) => ({\r\n        title: item.title,\r\n        description: item.summary,\r\n        author: item.author,\r\n        pubDate: parseDate(item.published_at, 'X'),\r\n        updated: parseDate(item.updated_at, 'X'),\r\n        category: [item.catname, ...item.tag_list],\r\n        link: new URL(item.link, baseUrl).href,\r\n    }));\r\n\r\n    const result = await Promise.all(\r\n        postList.map((item) =>\r\n            cache.tryGet(item.link, async () => {\r\n                const { data: response } = await got(item.link);\r\n                const $ = load(response);\r\n\r\n                item.description = $('.pc_content').html();\r\n\r\n                return item;\r\n            })\r\n        )\r\n    );\r\n\r\n    return {\r\n        title: '鸟哥笔记',\r\n        link: baseUrl,\r\n        item: result,\r\n    };\r\n}\r\n"],"mappings":"wWAMA,MAAaA,EAAe,CACxB,KAAM,IACN,MAAO,CACH,CACI,OAAQ,CAAC,kBAAmB,2BAC5B,OAAQ,KAGhB,KAAM,UACN,YAAa,CAAC,WACd,UACA,IAAK,mBAGT,eAAe,GAAU,CACrB,IAAM,EAAU,6BACV,CAAE,KAAM,GAAa,MAAMC,EAAI,GAAG,EAAQ,2BAEhD,GAAI,EAAS,cAAgB,MACzB,MAAU,MAAM,EAAS,YAG7B,IAAM,EAAW,EAAS,YAAY,IAAK,IAAU,CACjD,MAAO,EAAK,MACZ,YAAa,EAAK,QAClB,OAAQ,EAAK,OACb,QAAS,EAAU,EAAK,aAAc,KACtC,QAAS,EAAU,EAAK,WAAY,KACpC,SAAU,CAAC,EAAK,QAAS,GAAG,EAAK,UACjC,KAAM,IAAI,IAAI,EAAK,KAAM,GAAS,QAGhC,EAAS,MAAM,QAAQ,IACzB,EAAS,IAAK,GACVC,EAAM,OAAO,EAAK,KAAM,SAAY,CAChC,GAAM,CAAE,KAAMC,GAAa,MAAMF,EAAI,EAAK,MACpC,EAAI,EAAKE,GAIf,MAFA,GAAK,YAAc,EAAE,eAAe,OAE7B,MAKnB,MAAO,CACH,MAAO,OACP,KAAM,EACN,KAAM"}