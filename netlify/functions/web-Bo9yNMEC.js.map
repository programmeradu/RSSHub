{"version":3,"file":"web-Bo9yNMEC.js","names":[],"sources":["../../lib/routes/oeeee/web.ts"],"sourcesContent":["import { Route } from '@/types';\r\n\r\nimport cache from '@/utils/cache';\r\nimport got from '@/utils/got';\r\nimport timezone from '@/utils/timezone';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport { parseArticle } from './utils';\r\nimport { art } from '@/utils/render';\r\nimport path from 'node:path';\r\n\r\nexport const route: Route = {\r\n    path: '/web/:channel',\r\n    categories: ['traditional-media'],\r\n    example: '/oeeee/web/170',\r\n    parameters: { channel: '频道 ID' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    name: '奥一网',\r\n    maintainers: ['TimWu007'],\r\n    handler,\r\n    description: `-   若在桌面端打开奥一网栏目页（如 \\`https://www.oeeee.com/api/channel.php?s=/index/index/channel/gz\\`），可查看该页源代码，搜索 \\`OECID\\`。\r\n  -   若在移动端打开奥一网栏目页（格式例：\\`https://m.oeeee.com/m.php?s=/m2/channel&channel_id=169\\`），即可从 url 中获取。需注意的是，如果该栏目页的 url 格式为 \\`https://m.oeeee.com/detailChannel_indexData.html?channel_id=266\\` ，则 \\`266\\` 并非为本路由可用的频道 ID，建议从桌面端获取。`,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const channel = ctx.req.param('channel') ?? 0;\r\n    const currentUrl = `https://www.oeeee.com/api/channel.php?m=Js4channelNews&a=newLatest&cid=${channel}`;\r\n\r\n    const { data: response } = await got(currentUrl);\r\n\r\n    const list = response.data.map((item) => ({\r\n        title: '【' + item.channel_name + '】' + item.title,\r\n        description: art(path.join(__dirname, 'templates/description.art'), {\r\n            thumb: item.img,\r\n            description: item.summary,\r\n        }),\r\n        pubDate: timezone(parseDate(item.datetime), +8),\r\n        link: item.linkurl,\r\n        author: item.author,\r\n        // channelName: item.channel_name,\r\n        channelEname: item.channel_ename,\r\n    }));\r\n\r\n    const channelEname = list[1] ? list[1].channelEname : '';\r\n\r\n    const items = await Promise.all(list.map((item) => parseArticle(item, cache.tryGet)));\r\n\r\n    return {\r\n        title: `南方都市报奥一网`,\r\n        link: `https://www.oeeee.com/api/channel.php?s=/index/index/channel/${channelEname}`,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"8hBAUA,MAAa,EAAe,CACxB,KAAM,gBACN,WAAY,CAAC,qBACb,QAAS,iBACT,WAAY,CAAE,QAAS,SACvB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,KAAM,MACN,YAAa,CAAC,YACd,UACA,YAAa,wUAIjB,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAU,EAAI,IAAI,MAAM,YAAc,EACtC,EAAa,0EAA0E,IAEvF,CAAE,KAAM,GAAa,MAAM,EAAI,GAE/B,EAAO,EAAS,KAAK,IAAK,IAAU,CACtC,MAAO,IAAM,EAAK,aAAe,IAAM,EAAK,MAC5C,YAAa,EAAI,EAAA,KAAA,EAAA,sCAAmD,CAChE,MAAO,EAAK,IACZ,YAAa,EAAK,UAEtB,QAAS,EAAS,EAAU,EAAK,UAAW,GAC5C,KAAM,EAAK,QACX,OAAQ,EAAK,OAEb,aAAc,EAAK,iBAGjB,EAAe,EAAK,GAAK,EAAK,GAAG,aAAe,GAEhD,EAAQ,MAAM,QAAQ,IAAI,EAAK,IAAK,GAAS,EAAa,EAAM,EAAM,UAE5E,MAAO,CACH,MAAO,WACP,KAAM,gEAAgE,IACtE,KAAM"}