{"version":3,"file":"utils-BLKTjCrD.js","names":["cache","ofetch"],"sources":["../../lib/routes/baai/utils.ts"],"sourcesContent":["import ofetch from '@/utils/ofetch';\r\nimport { destr } from 'destr';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport timezone from '@/utils/timezone';\r\nimport cache from '@/utils/cache';\r\n\r\nconst baseUrl = 'https://hub.baai.ac.cn';\r\nconst eventUrl = 'https://event.baai.ac.cn';\r\nconst apiHost = 'https://hub-api.baai.ac.cn';\r\n\r\nconst getTagsData = () =>\r\n    cache.tryGet('baai:tags', async () => {\r\n        const { data } = await ofetch(`${apiHost}/api/v1/tags`);\r\n        return data.map((item) => ({\r\n            id: item.id,\r\n            title: item.title,\r\n            description: item.description,\r\n            brief: item.brief,\r\n            iconUrl: item.icon_url,\r\n        }));\r\n    });\r\n\r\nconst parseItem = (item) => ({\r\n    link: item.is_event ? `${eventUrl}/activities/${item.event_info.id}` : `${baseUrl}/view/${item.story_id}`,\r\n    title: item.is_event ? item.event_info.name : item.story_info.title,\r\n    pubDate: timezone(parseDate(item.is_event ? item.event_info.time_desc : item.story_info.created_at.replace('发布', '').replace('分享', '')), 8),\r\n    author: item.is_event ? item.event_info.company : item.story_info.user_name,\r\n    category: item.is_event ? null : item.story_info.tag_names.map((tag) => tag.title),\r\n    eventId: item.is_event ? item.event_info.id : null,\r\n});\r\n\r\nconst parseEventDetail = async (item) => {\r\n    const data = await ofetch(`${eventUrl}/api/api/Activity/IntroductionTypes`, {\r\n        query: {\r\n            activityId: item.eventId,\r\n        },\r\n        parseResponse: (txt) => destr(txt),\r\n    });\r\n    return data.data.ac_desc + data.data.ac_desc_two;\r\n};\r\n\r\nexport { baseUrl, eventUrl, apiHost, getTagsData, parseItem, parseEventDetail };\r\n"],"mappings":"+OAMA,MAAM,EAAU,yBACV,EAAW,2BACX,EAAU,6BAEV,MACFA,EAAM,OAAO,YAAa,SAAY,CAClC,GAAM,CAAE,QAAS,MAAMC,EAAO,GAAG,EAAQ,eACzC,OAAO,EAAK,IAAK,IAAU,CACvB,GAAI,EAAK,GACT,MAAO,EAAK,MACZ,YAAa,EAAK,YAClB,MAAO,EAAK,MACZ,QAAS,EAAK,cAIpB,EAAa,IAAU,CACzB,KAAM,EAAK,SAAW,GAAG,EAAS,cAAc,EAAK,WAAW,KAAO,GAAG,EAAQ,QAAQ,EAAK,WAC/F,MAAO,EAAK,SAAW,EAAK,WAAW,KAAO,EAAK,WAAW,MAC9D,QAAS,EAAS,EAAU,EAAK,SAAW,EAAK,WAAW,UAAY,EAAK,WAAW,WAAW,QAAQ,KAAM,IAAI,QAAQ,KAAM,KAAM,GACzI,OAAQ,EAAK,SAAW,EAAK,WAAW,QAAU,EAAK,WAAW,UAClE,SAAU,EAAK,SAAW,KAAO,EAAK,WAAW,UAAU,IAAK,GAAQ,EAAI,OAC5E,QAAS,EAAK,SAAW,EAAK,WAAW,GAAK,OAG5C,EAAmB,KAAO,IAAS,CACrC,IAAM,EAAO,MAAMA,EAAO,GAAG,EAAS,qCAAsC,CACxE,MAAO,CACH,WAAY,EAAK,SAErB,cAAgB,GAAQ,EAAM,KAElC,OAAO,EAAK,KAAK,QAAU,EAAK,KAAK"}