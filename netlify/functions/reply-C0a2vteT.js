import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{parseDate as e}from"./parse-date-Bgabdhlb.js";import{ofetch_default as t}from"./ofetch-Bzt0BXUH.js";import{timezone as n}from"./timezone-BrNu6iXe.js";import{load as r}from"cheerio";const i={path:`/topic/:id`,categories:[`anime`],example:`/bangumi.tv/topic/367032`,parameters:{id:`话题 id, 在话题页面地址栏查看`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`bgm.tv/group/topic/:id`]}],name:`小组话题的新回复`,maintainers:[`ylc395`],handler:a};async function a(i){let a=i.req.param(`id`),o=`https://bgm.tv/group/topic/${a}`,s=await t(o),c=r(s),l=c(`#pageHeader h1`).text(),u=c(`.row_reply`).toArray().map(e=>{let t=c(e);return{id:t.attr(`id`),author:t.find(`.userInfo .l`).text(),content:t.find(`.reply_content .message`).html(),date:t.children().first().find(`small`).children().remove().end().text().slice(3)}}),d=c(`.sub_reply_bg`).toArray().map(e=>{let t=c(e);return{id:t.attr(`id`),author:t.find(`.userName .l`).text(),content:t.find(`.cmt_sub_content`).html(),date:t.children().first().find(`small`).children().remove().end().text().slice(3)}}),f=[...u,...d].sort((e,t)=>e.id<t.id?1:-1),p={title:l,description:c(`.postTopic .topic_content`).html(),author:c(`.postTopic .inner strong a`).first().text(),pubDate:n(e(c(`.postTopic .re_info small`).text().trim().slice(5)),8),link:o};return{title:`${l}的最新回复`,link:o,item:[...f.map(t=>({title:`${t.author} 回复了小组话题《${l}》`,description:t.content,pubDate:n(e(t.date),8),author:t.author,link:`${o}#${t.id}`})),p]}}export{i as route};
//# sourceMappingURL=reply-C0a2vteT.js.map