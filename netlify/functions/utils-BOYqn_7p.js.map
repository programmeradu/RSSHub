{"version":3,"file":"utils-BOYqn_7p.js","names":["c","e","ConfigNotFoundError"],"sources":["../../lib/routes/domp4/utils.ts"],"sourcesContent":["import { config } from '@/config';\r\nimport ConfigNotFoundError from '@/errors/types/config-not-found';\r\n\r\nconst defaultDomain = 'www.xlmp4.com';\r\n\r\nconst allowedDomains = new Set(['www.xlmp4.com']);\r\n\r\n/**\r\n * trackers from https://www.domp4.cc/Style/2020/js/base.js?v=2\r\n */\r\nconst magnetTrackers = [\r\n    'https://tracker.iriseden.fr:443/announce',\r\n    'https://tr.highstar.shop:443/announce',\r\n    'https://tr.fuckbitcoin.xyz:443/announce',\r\n    'https://tr.doogh.club:443/announce',\r\n    'https://tr.burnabyhighstar.com:443/announce',\r\n    'https://t.btcland.xyz:443/announce',\r\n    'http://vps02.net.orel.ru:80/announce',\r\n    'https://tracker.kuroy.me:443/announce',\r\n    'http://tr.cili001.com:8070/announce',\r\n    'http://t.overflow.biz:6969/announce',\r\n    'http://t.nyaatracker.com:80/announce',\r\n    'http://open.acgnxtracker.com:80/announce',\r\n    'http://nyaa.tracker.wf:7777/announce',\r\n    'http://home.yxgz.vip:6969/announce',\r\n    'http://buny.uk:6969/announce',\r\n    'https://tracker.tamersunion.org:443/announce',\r\n    'https://tracker.nanoha.org:443/announce',\r\n    'https://tracker.loligirl.cn:443/announce',\r\n    'udp://bubu.mapfactor.com:6969/announce',\r\n    'http://share.camoe.cn:8080/announce',\r\n    'udp://movies.zsw.ca:6969/announce',\r\n    'udp://ipv4.tracker.harry.lu:80/announce',\r\n    'udp://tracker.sylphix.com:6969/announce',\r\n    'http://95.216.22.207:9001/announce',\r\n];\r\n\r\n/**\r\n * compose magnet url with trackers\r\n */\r\nfunction composeMagnetUrl(magnet, trackers = magnetTrackers) {\r\n    return `${magnet}&tr=${trackers.join('&tr=')}`;\r\n}\r\n\r\n/**\r\n * method for download url type\r\n */\r\nfunction getUrlType(url) {\r\n    if (url.startsWith('magnet:')) {\r\n        return 'magnet';\r\n    }\r\n    if (url.startsWith('ed2k:')) {\r\n        return 'ed2k';\r\n    }\r\n    return '';\r\n}\r\n\r\n/**\r\n * method for generating magnet url\r\n * from the detail page source\r\n */\r\nfunction decodeCipherText(p, a, c, k, e, d) {\r\n    e = function (c) {\r\n        return (c < a ? '' : e(Number.parseInt((c / a).toString()))) + ((c = c % a) > 35 ? String.fromCharCode(c + 29) : c.toString(36));\r\n    };\r\n    if (!''.replace(/^/, String)) {\r\n        while (c--) {\r\n            d[e(c.toString())] = k[c] || e(c.toString());\r\n        }\r\n        k = [\r\n            function (e) {\r\n                return d[e];\r\n            },\r\n        ];\r\n        e = function () {\r\n            return String.raw`\\w+`;\r\n        };\r\n        c = 1;\r\n    }\r\n    while (c--) {\r\n        if (k[c]) {\r\n            p = p.replaceAll(new RegExp(String.raw`\\b` + e(c.toString()) + String.raw`\\b`, 'g'), k[c]);\r\n        }\r\n    }\r\n    return p;\r\n}\r\n\r\nfunction ensureDomain(ctx, domain = defaultDomain) {\r\n    const origin = `https://${domain}`;\r\n    if (!config.feature.allow_user_supply_unsafe_domain && !allowedDomains.has(new URL(origin).hostname)) {\r\n        throw new ConfigNotFoundError(`This RSS is disabled unless 'ALLOW_USER_SUPPLY_UNSAFE_DOMAIN' is set to 'true'.`);\r\n    }\r\n    return origin;\r\n}\r\n\r\nexport { defaultDomain, magnetTrackers, getUrlType, composeMagnetUrl, decodeCipherText, ensureDomain };\r\n"],"mappings":"wHAGA,MAEM,EAAiB,IAAI,IAAI,CAAC,kBAK1B,EAAiB,CACnB,2CACA,wCACA,0CACA,qCACA,8CACA,qCACA,uCACA,wCACA,sCACA,sCACA,uCACA,2CACA,uCACA,qCACA,+BACA,+CACA,0CACA,2CACA,yCACA,sCACA,oCACA,0CACA,0CACA,sCAMJ,SAAS,EAAiB,EAAQ,EAAW,EAAgB,CACzD,MAAO,GAAG,EAAO,MAAM,EAAS,KAAK,UAMzC,SAAS,EAAW,EAAK,CAOrB,OANI,EAAI,WAAW,WACR,SAEP,EAAI,WAAW,SACR,OAEJ,GAOX,SAAS,EAAiB,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,CAIxC,GAHA,EAAI,SAAU,EAAG,CACb,OAAQA,EAAI,EAAI,GAAK,EAAE,OAAO,UAAUA,EAAI,GAAG,gBAAkB,GAAQ,GAAK,GAAK,OAAO,aAAaA,EAAI,IAAMA,EAAE,SAAS,MAE5H,CAAC,GAAG,QAAQ,IAAK,QAAS,CAC1B,KAAO,KACH,EAAE,EAAE,EAAE,aAAe,EAAE,IAAM,EAAE,EAAE,YAErC,EAAI,CACA,SAAU,EAAG,CACT,OAAO,EAAEC,KAGjB,EAAI,UAAY,CACZ,MAAO,QAAO,GAAG,OAErB,EAAI,EAER,KAAO,KACC,EAAE,KACF,EAAI,EAAE,WAAW,IAAI,OAAO,OAAO,GAAG,KAAO,EAAE,EAAE,YAAc,OAAO,GAAG,KAAM,KAAM,EAAE,KAG/F,OAAO,EAGX,SAAS,EAAa,EAAK,EAAS,gBAAe,CAC/C,IAAM,EAAS,WAAW,IAC1B,GAAI,CAAC,EAAO,QAAQ,iCAAmC,CAAC,EAAe,IAAI,IAAI,IAAI,GAAQ,UACvF,MAAM,IAAIC,EAAoB,mFAElC,OAAO"}