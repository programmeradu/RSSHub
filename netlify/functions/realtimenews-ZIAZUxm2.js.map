{"version":3,"file":"realtimenews-ZIAZUxm2.js","names":["got","title","image","route: Route"],"sources":["../../lib/routes/10jqka/realtimenews.ts"],"sourcesContent":["import { Route } from '@/types';\r\n\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\nimport iconv from 'iconv-lite';\r\nimport { parseDate } from '@/utils/parse-date';\r\n\r\nexport const handler = async (ctx) => {\r\n    const { tag } = ctx.req.param();\r\n    const limit = ctx.req.query('limit') ? Number.parseInt(ctx.req.query('limit'), 10) : 20;\r\n\r\n    const rootUrl = 'https://news.10jqka.com.cn';\r\n    const apiUrl = new URL('tapp/news/push/stock', rootUrl).href;\r\n    const currentUrl = new URL('realtimenews.html', rootUrl).href;\r\n\r\n    const { data: currentResponse } = await got(currentUrl, {\r\n        responseType: 'buffer',\r\n    });\r\n\r\n    const $ = load(iconv.decode(currentResponse, 'gbk'));\r\n\r\n    const language = $('html').prop('lang');\r\n\r\n    const { data: response } = await got(apiUrl, {\r\n        searchParams: {\r\n            page: 1,\r\n            tag: tag ?? '',\r\n        },\r\n    });\r\n\r\n    const items =\r\n        response.data?.list.slice(0, limit).map((item) => {\r\n            const title = item.title;\r\n            const description = item.digest;\r\n            const guid = `10jqka-${item.seq}`;\r\n            const image = item.picUrl;\r\n\r\n            return {\r\n                title,\r\n                description,\r\n                pubDate: parseDate(item.ctime, 'X'),\r\n                link: item.url,\r\n                category: [...new Set([item.color === '2' ? '重要' : undefined, ...item.tags.map((c) => c.name), ...item.tagInfo.map((c) => c.name)])].filter(Boolean),\r\n                author: item.source,\r\n                guid,\r\n                id: guid,\r\n                content: {\r\n                    html: description,\r\n                    text: description,\r\n                },\r\n                image,\r\n                banner: item.picUrl,\r\n                updated: parseDate(item.rtime, 'X'),\r\n                language,\r\n            };\r\n        }) ?? [];\r\n\r\n    const title = $('title').text();\r\n    const image = $('h1 a img').prop('src');\r\n\r\n    return {\r\n        title,\r\n        description: title.split(/_/).pop(),\r\n        link: currentUrl,\r\n        item: items,\r\n        allowEmpty: true,\r\n        image,\r\n        author: $('meta[property=\"og:site_name\"]').prop('content'),\r\n        language,\r\n    };\r\n};\r\n\r\nexport const route: Route = {\r\n    path: '/realtimenews/:tag?',\r\n    name: '7×24小时要闻直播',\r\n    url: 'news.10jqka.com.cn',\r\n    maintainers: ['nczitzk'],\r\n    handler,\r\n    example: '/10jqka/realtimenews',\r\n    parameters: { tag: '标签，默认为全部' },\r\n    description: `::: tip\r\n  若订阅 [7×24小时要闻直播](https://news.10jqka.com.cn/realtimenews.html) 的 \\`公告\\` 标签。将 \\`公告\\` 作为标签参数填入，此时路由为 [\\`/10jqka/realtimenews/公告\\`](https://rsshub.app/10jqka/realtimenews/公告)。\r\n  \r\n  若订阅 [7×24小时要闻直播](https://news.10jqka.com.cn/realtimenews.html) 的 \\`公告\\` 和 \\`A股\\` 标签。将 \\`公告,A股\\` 作为标签参数填入，此时路由为 [\\`/10jqka/realtimenews/公告,A股\\`](https://rsshub.app/10jqka/realtimenews/公告,A股)。\r\n:::\r\n\r\n| 全部 | 重要 | A股 | 港股 | 美股 | 机会 | 异动 | 公告 |\r\n| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |\r\n    `,\r\n    categories: ['finance'],\r\n\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportRadar: true,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            title: '全部',\r\n            source: ['news.10jqka.com.cn/realtimenews.html'],\r\n            target: '/realtimenews/全部',\r\n        },\r\n        {\r\n            title: '重要',\r\n            source: ['news.10jqka.com.cn/realtimenews.html'],\r\n            target: '/realtimenews/重要',\r\n        },\r\n        {\r\n            title: 'A股',\r\n            source: ['news.10jqka.com.cn/realtimenews.html'],\r\n            target: '/realtimenews/A股',\r\n        },\r\n        {\r\n            title: '港股',\r\n            source: ['news.10jqka.com.cn/realtimenews.html'],\r\n            target: '/realtimenews/港股',\r\n        },\r\n        {\r\n            title: '美股',\r\n            source: ['news.10jqka.com.cn/realtimenews.html'],\r\n            target: '/realtimenews/美股',\r\n        },\r\n        {\r\n            title: '机会',\r\n            source: ['news.10jqka.com.cn/realtimenews.html'],\r\n            target: '/realtimenews/机会',\r\n        },\r\n        {\r\n            title: '异动',\r\n            source: ['news.10jqka.com.cn/realtimenews.html'],\r\n            target: '/realtimenews/异动',\r\n        },\r\n        {\r\n            title: '公告',\r\n            source: ['news.10jqka.com.cn/realtimenews.html'],\r\n            target: '/realtimenews/公告',\r\n        },\r\n    ],\r\n};\r\n"],"mappings":"8UAOA,MAAa,EAAU,KAAO,IAAQ,CAClC,GAAM,CAAE,OAAQ,EAAI,IAAI,QAClB,EAAQ,EAAI,IAAI,MAAM,SAAW,OAAO,SAAS,EAAI,IAAI,MAAM,SAAU,IAAM,GAE/E,EAAU,6BACV,EAAS,IAAI,IAAI,uBAAwB,GAAS,KAClD,EAAa,IAAI,IAAI,oBAAqB,GAAS,KAEnD,CAAE,KAAM,GAAoB,MAAMA,EAAI,EAAY,CACpD,aAAc,WAGZ,EAAI,EAAK,EAAM,OAAO,EAAiB,QAEvC,EAAW,EAAE,QAAQ,KAAK,QAE1B,CAAE,KAAM,GAAa,MAAMA,EAAI,EAAQ,CACzC,aAAc,CACV,KAAM,EACN,IAAK,GAAO,MAId,EACF,EAAS,MAAM,KAAK,MAAM,EAAG,GAAO,IAAK,GAAS,CAC9C,IAAMC,EAAQ,EAAK,MACb,EAAc,EAAK,OACnB,EAAO,UAAU,EAAK,MACtBC,EAAQ,EAAK,OAEnB,MAAO,CACH,MAAA,EACA,cACA,QAAS,EAAU,EAAK,MAAO,KAC/B,KAAM,EAAK,IACX,SAAU,CAAC,GAAG,IAAI,IAAI,CAAC,EAAK,QAAU,IAAM,KAAO,IAAA,GAAW,GAAG,EAAK,KAAK,IAAK,GAAM,EAAE,MAAO,GAAG,EAAK,QAAQ,IAAK,GAAM,EAAE,SAAS,OAAO,SAC5I,OAAQ,EAAK,OACb,OACA,GAAI,EACJ,QAAS,CACL,KAAM,EACN,KAAM,GAEV,MAAA,EACA,OAAQ,EAAK,OACb,QAAS,EAAU,EAAK,MAAO,KAC/B,eAEF,GAEJ,EAAQ,EAAE,SAAS,OACnB,EAAQ,EAAE,YAAY,KAAK,OAEjC,MAAO,CACH,QACA,YAAa,EAAM,MAAM,KAAK,MAC9B,KAAM,EACN,KAAM,EACN,WAAY,GACZ,QACA,OAAQ,EAAE,iCAAiC,KAAK,WAChD,aAIKC,EAAe,CACxB,KAAM,sBACN,KAAM,aACN,IAAK,qBACL,YAAa,CAAC,WACd,UACA,QAAS,uBACT,WAAY,CAAE,IAAK,YACnB,YAAa,qeASb,WAAY,CAAC,WAEb,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,aAAc,GACd,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,MAAO,KACP,OAAQ,CAAC,wCACT,OAAQ,oBAEZ,CACI,MAAO,KACP,OAAQ,CAAC,wCACT,OAAQ,oBAEZ,CACI,MAAO,KACP,OAAQ,CAAC,wCACT,OAAQ,oBAEZ,CACI,MAAO,KACP,OAAQ,CAAC,wCACT,OAAQ,oBAEZ,CACI,MAAO,KACP,OAAQ,CAAC,wCACT,OAAQ,oBAEZ,CACI,MAAO,KACP,OAAQ,CAAC,wCACT,OAAQ,oBAEZ,CACI,MAAO,KACP,OAAQ,CAAC,wCACT,OAAQ,oBAEZ,CACI,MAAO,KACP,OAAQ,CAAC,wCACT,OAAQ"}