{"version":3,"file":"maccms-CbEmbLp4.js","names":[],"sources":["../../lib/routes/maccms/index.ts"],"sourcesContent":["import { Result, Vod } from '@/routes/maccms/type';\r\nimport { DataItem, Route } from '@/types';\r\nimport ofetch from '@/utils/ofetch';\r\nimport path from 'node:path';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport { art } from '@/utils/render';\r\nimport timezone from '@/utils/timezone';\r\n\r\nconst render = (vod: Vod, link: string) => art(path.join(__dirname, 'templates/vod.art'), { vod, link });\r\n\r\nexport const route: Route = {\r\n    path: '/:domain/:type?/:size?',\r\n    categories: ['multimedia'],\r\n    example: '/maccms/moduzy.net/2',\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    parameters: {\r\n        domain: '采集站域名，可选值如下表',\r\n        type: '类别ID，不同采集站点有不同的类别规则和ID，默认为 0，代表全部类别',\r\n        size: '每次获取的数据条数，上限 100 条，默认 30 条',\r\n    },\r\n    name: '最新资源',\r\n    maintainers: ['hualiong'],\r\n    description: `\r\n::: tip\r\n每个采集站提供的影视类别ID是不同的，即参数中的 \\`type\\` 是不同的。**可以先访问一次站点提供的采集接口，然后从返回结果中的 \\`class\\` 字段中的 \\`type_id\\`获取相应的类别ID**\r\n:::\r\n\r\n| 站名                | 域名                                             | 站名             | 域名                                               | 站名           | 域名                                            |\r\n| ------------------- | ------------------------------------------------ | ---------------- | -------------------------------------------------- | -------------- | ----------------------------------------------- |\r\n| 魔都资源网          | [moduzy.net](https://moduzy.net)                 | 华为吧影视资源站 | [hw8.live](https://hw8.live)                       | 360 资源站     | [360zy.com](https://360zy.com)                  |\r\n| jkun 爱坤联盟资源网 | [ikunzyapi.com](https://ikunzyapi.com)           | 奥斯卡资源站     | [aosikazy.com](https://aosikazy.com)               | 飞速资源采集网 | [www.feisuzyapi.com](http://www.feisuzyapi.com) |\r\n| 森林资源网          | [slapibf.com](https://slapibf.com)               | 天空资源采集网   | [api.tiankongapi.com](https://api.tiankongapi.com) | 百度云资源     | [api.apibdzy.com](https://api.apibdzy.com)      |\r\n| 红牛资源站          | [www.hongniuzy2.com](https://www.hongniuzy2.com) | 乐视资源网       | [leshiapi.com](https://leshiapi.com)               | 暴风资源       | [bfzyapi.com](https://bfzyapi.com)              |`,\r\n    handler: async (ctx) => {\r\n        const { domain, type = '0', size = '30' } = ctx.req.param();\r\n        if (!list.has(domain)) {\r\n            throw new Error('非法域名！');\r\n        }\r\n\r\n        const res = await ofetch<Result>(`https://${domain}/api.php/provide/vod`, {\r\n            parseResponse: JSON.parse,\r\n            query: { ac: 'detail', t: type, pagesize: Number.parseInt(size) > 100 ? 100 : size },\r\n        });\r\n\r\n        const items: DataItem[] = res.list.map((each) => ({\r\n            title: each.vod_name,\r\n            image: each.vod_pic,\r\n            link: `https://${domain}/vod/${each.vod_id}/`,\r\n            guid: each.vod_play_url?.match(/https:\\/\\/.+?\\.m3u8/g)?.slice(-1)[0],\r\n            pubDate: timezone(parseDate(each.vod_time, 'YYYY-MM-DD HH:mm:ss'), +8),\r\n            category: [each.type_name, ...each.vod_class!.split(',')],\r\n            description: render(each, `https://${domain}/vod/${each.vod_id}/`) + each.vod_content,\r\n        }));\r\n\r\n        return {\r\n            title: `最新${type !== '0' && items.length ? items[0].category![0] : '资源'} - ${domain}`,\r\n            link: `https://${domain}`,\r\n            allowEmpty: true,\r\n            item: items,\r\n        };\r\n    },\r\n};\r\n\r\nconst list = new Set(['moduzy.net', 'hw8.live', '360zy.com', 'ikunzyapi.com', 'aosikazy.com', 'www.feisuzyapi.com', 'slapibf.com', 'api.tiankongapi.com', 'api.apibdzy.com', 'www.hongniuzy2.com', 'leshiapi.com', 'bfzyapi.com']);\r\n"],"mappings":"kYAQA,MAAM,GAAU,EAAU,IAAiB,EAAI,EAAA,KAAA,EAAA,8BAA2C,CAAE,MAAK,SAEpF,EAAe,CACxB,KAAM,yBACN,WAAY,CAAC,cACb,QAAS,uBACT,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,WAAY,CACR,OAAQ,eACR,KAAM,sCACN,KAAM,8BAEV,KAAM,OACN,YAAa,CAAC,YACd,YAAa;;;;;;;;;;yMAWb,QAAS,KAAO,IAAQ,CACpB,GAAM,CAAE,SAAQ,OAAO,IAAK,OAAO,MAAS,EAAI,IAAI,QACpD,GAAI,CAAC,EAAK,IAAI,GACV,MAAU,MAAM,SAGpB,IAAM,EAAM,MAAM,EAAe,WAAW,EAAO,sBAAuB,CACtE,cAAe,KAAK,MACpB,MAAO,CAAE,GAAI,SAAU,EAAG,EAAM,SAAU,OAAO,SAAS,GAAQ,IAAM,IAAM,KAG5E,EAAoB,EAAI,KAAK,IAAK,IAAU,CAC9C,MAAO,EAAK,SACZ,MAAO,EAAK,QACZ,KAAM,WAAW,EAAO,OAAO,EAAK,OAAO,GAC3C,KAAM,EAAK,cAAc,MAAM,yBAAyB,MAAM,IAAI,GAClE,QAAS,EAAS,EAAU,EAAK,SAAU,uBAAwB,GACnE,SAAU,CAAC,EAAK,UAAW,GAAG,EAAK,UAAW,MAAM,MACpD,YAAa,EAAO,EAAM,WAAW,EAAO,OAAO,EAAK,OAAO,IAAM,EAAK,eAG9E,MAAO,CACH,MAAO,KAAK,IAAS,KAAO,EAAM,OAAS,EAAM,GAAG,SAAU,GAAK,KAAK,KAAK,IAC7E,KAAM,WAAW,IACjB,WAAY,GACZ,KAAM,KAKZ,EAAO,IAAI,IAAI,CAAC,aAAc,WAAY,YAAa,gBAAiB,eAAgB,qBAAsB,cAAe,sBAAuB,kBAAmB,qBAAsB,eAAgB"}