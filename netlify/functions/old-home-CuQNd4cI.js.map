{"version":3,"file":"old-home-CuQNd4cI.js","names":["route: Route","got","cache"],"sources":["../../lib/routes/lfsyd/old-home.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport cache from '@/utils/cache';\r\nimport got from '@/utils/got';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport { ProcessFeed } from './utils';\r\n\r\nexport const route: Route = {\r\n    path: '/old_home',\r\n    categories: ['game'],\r\n    example: '/lfsyd/old_home',\r\n    parameters: {},\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['www.iyingdi.com/'],\r\n        },\r\n    ],\r\n    name: '首页（旧版）',\r\n    maintainers: ['auto-bot-ty'],\r\n    handler,\r\n    url: 'www.iyingdi.com/',\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const limit = ctx.req.query('limit') ?? 10;\r\n    const rootUrl = 'https://www.iyingdi.com';\r\n    const url = `${rootUrl}/feed/list/user/v3?feedIdUp=0&feedIdDown=0&hotfeed=1&system=web`;\r\n    const { data } = await got(url);\r\n\r\n    const articleList = data.feeds\r\n        .slice(0, limit)\r\n        .map((element) => ({\r\n            title: element.feed.title,\r\n            pubDate: parseDate(element.feed.created * 1000),\r\n            link: `${rootUrl}/tz/post/${element.feed.sourceID}`,\r\n            guid: element.feed.title,\r\n            postId: element.feed.sourceID,\r\n        }))\r\n        .filter((item) => item.title !== undefined);\r\n\r\n    const items = await ProcessFeed(cache, articleList);\r\n\r\n    return {\r\n        title: '旅法师营地 - 首页资讯（旧版）',\r\n        link: rootUrl,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"kbAMA,MAAaA,EAAe,CACxB,KAAM,YACN,WAAY,CAAC,QACb,QAAS,kBACT,WAAY,GACZ,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,sBAGjB,KAAM,SACN,YAAa,CAAC,eACd,UACA,IAAK,oBAGT,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAQ,EAAI,IAAI,MAAM,UAAY,GAClC,EAAU,0BACV,EAAM,GAAG,EAAQ,iEACjB,CAAE,QAAS,MAAMC,EAAI,GAErB,EAAc,EAAK,MACpB,MAAM,EAAG,GACT,IAAK,IAAa,CACf,MAAO,EAAQ,KAAK,MACpB,QAAS,EAAU,EAAQ,KAAK,QAAU,KAC1C,KAAM,GAAG,EAAQ,WAAW,EAAQ,KAAK,WACzC,KAAM,EAAQ,KAAK,MACnB,OAAQ,EAAQ,KAAK,YAExB,OAAQ,GAAS,EAAK,QAAU,IAAA,IAE/B,EAAQ,MAAM,EAAYC,EAAO,GAEvC,MAAO,CACH,MAAO,mBACP,KAAM,EACN,KAAM"}