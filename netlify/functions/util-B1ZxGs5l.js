import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import{art as n}from"./render-CxhTJIsl.js";import{parseDate as r}from"./parse-date-Bgabdhlb.js";import{got_default as i}from"./got-CdvI2yKX.js";import a from"node:path";import o from"dayjs";t();const s=`readhub.cn`,c=`https://${s}`,l=`https://api.${s}`,u=new URL(`topic/list`,l).href,d=(e,t)=>o(e).format(t),f=e=>new URL(`topic/${e}`,c).href;n.defaults.imports={...n.defaults.imports,formatDate:d,toTopicUrl:f};const p=async(t,o)=>await Promise.all(t.map(t=>o(t.link,async()=>{try{if(!t.link.startsWith(c))throw Error(`"${t.link}" is an external URL`);let{data:o}=await i(t.link),s=JSON.parse(o.match(/{\\"topic\\":(.*?)}]\\n"]\)<\/script>/)[1].replaceAll(String.raw`\"`,`"`));t.title=s.title,t.link=s.url??new URL(`topic/${s.uid}`,c).href,t.description=n(a.join(e,`templates/description-a89345b3.art`),{description:s.summary,news:s.newsAggList,timeline:s.timeline}),t.author=s.siteNameDisplay,t.category=[...s.entityList.map(e=>e.name)??[],...s.tagList.map(e=>e.name)??[]],t.guid=`readhub-${s.uid}`,t.pubDate=r(s.publishDate.replaceAll(/\s/g,``))}catch{t.guid=`readhub-${t.guid}`}return t})));export{l as apiRootUrl,u as apiTopicUrl,p as processItems,c as rootUrl};
//# sourceMappingURL=util-B1ZxGs5l.js.map