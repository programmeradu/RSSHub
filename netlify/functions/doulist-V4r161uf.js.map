{"version":3,"file":"doulist-V4r161uf.js","names":["route: Route","got","title","description"],"sources":["../../lib/routes/douban/other/doulist.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\n\r\nexport const route: Route = {\r\n    path: '/doulist/:id',\r\n    categories: ['social-media'],\r\n    example: '/douban/doulist/37716774',\r\n    parameters: { id: '豆列id' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    name: '豆瓣豆列',\r\n    maintainers: ['LogicJake', 'honue'],\r\n    handler,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const id = ctx.req.param('id');\r\n\r\n    const url = `https://www.douban.com/doulist/${id}`;\r\n    const response = await got({\r\n        method: 'get',\r\n        url,\r\n        headers: {\r\n            Referer: `https://www.douban.com/doulist/${id}`,\r\n        },\r\n    });\r\n    const $ = load(response.data);\r\n\r\n    const title = $('#content h1').text().trim();\r\n    const description = $('div.doulist-about').text().trim();\r\n    const out = $('div.doulist-item')\r\n        .toArray()\r\n        .map((item) => {\r\n            const type = $(item).find('div.source').text().trim();\r\n\r\n            let title = $(item).find('div.bd.doulist-note div.title a').text().trim();\r\n            let link = $(item).find('div.bd.doulist-note div.title a').attr('href');\r\n            let description = $(item).find('div.bd.doulist-note  div.abstract').text().trim();\r\n\r\n            if (type === '来自：豆瓣广播') {\r\n                title = $(item).find('p.status-content > a').text().trim();\r\n                link = $(item).find('p.status-content a').attr('href');\r\n\r\n                description = $(item).find('span.status-recommend-text').text().trim();\r\n            }\r\n\r\n            if (type === '来自：豆瓣电影' || type === '来自：豆瓣' || type === '来自：豆瓣读书' || type === '来自：豆瓣音乐') {\r\n                title = $(item).find('div.bd.doulist-subject div.title a').text().trim();\r\n                link = $(item).find('div.bd.doulist-subject div.title a').attr('href');\r\n\r\n                description = $(item).find('div.bd.doulist-subject div.abstract').text().trim();\r\n\r\n                const ft = $(item).find('div.ft div.comment-item.content').text().trim();\r\n\r\n                const img = $(item).find('div.post a img').attr('src');\r\n\r\n                description = '<div><img width=\"100\" src=\"' + img + '\"></div>' + description + '<blockquote>' + ft + '</blockquote>';\r\n            }\r\n\r\n            const date = $(item).find('div.ft div.actions time span').attr('title');\r\n\r\n            const single = {\r\n                title,\r\n                link,\r\n                description,\r\n                pubDate: new Date(date).toUTCString(),\r\n            };\r\n            return single;\r\n        });\r\n\r\n    return {\r\n        title,\r\n        link: url,\r\n        description,\r\n        item: out,\r\n    };\r\n}\r\n"],"mappings":"+PAIA,MAAaA,EAAe,CACxB,KAAM,eACN,WAAY,CAAC,gBACb,QAAS,2BACT,WAAY,CAAE,GAAI,QAClB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,KAAM,OACN,YAAa,CAAC,YAAa,SAC3B,WAGJ,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAK,EAAI,IAAI,MAAM,MAEnB,EAAM,kCAAkC,IACxC,EAAW,MAAMC,EAAI,CACvB,OAAQ,MACR,MACA,QAAS,CACL,QAAS,kCAAkC,OAG7C,EAAI,EAAK,EAAS,MAElB,EAAQ,EAAE,eAAe,OAAO,OAChC,EAAc,EAAE,qBAAqB,OAAO,OAC5C,EAAM,EAAE,oBACT,UACA,IAAK,GAAS,CACX,IAAM,EAAO,EAAE,GAAM,KAAK,cAAc,OAAO,OAE3CC,EAAQ,EAAE,GAAM,KAAK,mCAAmC,OAAO,OAC/D,EAAO,EAAE,GAAM,KAAK,mCAAmC,KAAK,QAC5DC,EAAc,EAAE,GAAM,KAAK,qCAAqC,OAAO,OAS3E,GAPI,IAAS,YACT,EAAQ,EAAE,GAAM,KAAK,wBAAwB,OAAO,OACpD,EAAO,EAAE,GAAM,KAAK,sBAAsB,KAAK,QAE/C,EAAc,EAAE,GAAM,KAAK,8BAA8B,OAAO,QAGhE,IAAS,WAAa,IAAS,SAAW,IAAS,WAAa,IAAS,UAAW,CACpF,EAAQ,EAAE,GAAM,KAAK,sCAAsC,OAAO,OAClE,EAAO,EAAE,GAAM,KAAK,sCAAsC,KAAK,QAE/D,EAAc,EAAE,GAAM,KAAK,uCAAuC,OAAO,OAEzE,IAAM,EAAK,EAAE,GAAM,KAAK,mCAAmC,OAAO,OAE5D,EAAM,EAAE,GAAM,KAAK,kBAAkB,KAAK,OAEhD,EAAc,8BAAgC,EAAM,WAAaA,EAAc,eAAiB,EAAK,gBAGzG,IAAM,EAAO,EAAE,GAAM,KAAK,gCAAgC,KAAK,SAEzD,EAAS,CACX,MAAA,EACA,OACA,YAAA,EACA,QAAS,IAAI,KAAK,GAAM,eAE5B,OAAO,IAGf,MAAO,CACH,QACA,KAAM,EACN,cACA,KAAM"}