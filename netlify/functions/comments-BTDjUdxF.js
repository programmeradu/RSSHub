import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{parseDate as e}from"./parse-date-Bgabdhlb.js";import{ofetch_default as t}from"./ofetch-Bzt0BXUH.js";import n from"markdown-it";const r=n({html:!0}),i=`https://youtrack.jetbrains.com`,a=`${i}/api`,o={path:`/youtrack/comments/:issueId`,categories:[`programming`],example:`/jetbrains/youtrack/comments/IJPL-174543`,parameters:{issueId:`Issue ID (e.g., IJPL-174543)`},radar:[{source:[`youtrack.jetbrains.com/issue/:issueId`],target:`/youtrack/comments/:issueId`}],name:`YouTrack Issue Comments`,maintainers:[`NekoAria`],handler:u};function s(t,n){let a=r.render(t.issue.description);return{title:`${t.author.name} created issue ${n}`,author:t.author.name,pubDate:e(t.timestamp),link:`${i}/issue/${n}#focus=Comments-${t.id}`,description:a,guid:`${n}-comment-${t.id}`}}function c(t,n){let a=t.added[0],o=a.author||t.author,s=a.usesMarkdown?r.render(a.text):a.text;return{title:`${o.name} commented on ${n}`,author:o.name,pubDate:e(a.created||t.timestamp),link:`${i}/issue/${n}#focus=Comments-${t.id}`,description:s,guid:`${n}-comment-${t.id}`}}function l(e,t){switch(e.category.id){case`IssueCreatedCategory`:return s(e,t);case`CommentsCategory`:return c(e,t);default:return null}}async function u(e){let n=e.req.param(`issueId`),r=e.req.query(`limit`)?Number.parseInt(e.req.query(`limit`)):100,o=await t(`${a}/issues/${n}`,{query:{fields:`summary`}}),s=await t(`${a}/issues/${n}/activitiesPage`,{query:{categories:`IssueCreatedCategory,CommentsCategory`,fields:`activities(author(name),category(id),id,issue(description),timestamp,added(author(name),created,id,text,usesMarkdown))`}}),c=s.activities.map(e=>l(e,n)).filter(e=>e!==null).sort((e,t)=>new Date(t.pubDate).getTime()-new Date(e.pubDate).getTime()).slice(0,r);return{title:`YouTrack ${n} - ${o.summary}`,link:`${i}/issue/${n}`,description:`Comments and activities for YouTrack issue ${n}`,item:c}}export{o as route};
//# sourceMappingURL=comments-BTDjUdxF.js.map