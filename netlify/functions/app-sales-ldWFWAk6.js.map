{"version":3,"file":"app-sales-ldWFWAk6.js","names":["limit: number","targetUrl: string","ofetch","$: CheerioAPI","selector: string","items: DataItem[]","title: string","route: Route","category: string"],"sources":["../../lib/routes/app-sales/index.ts"],"sourcesContent":["import { type Data, type DataItem, type Route, ViewType } from '@/types';\r\n\r\nimport ofetch from '@/utils/ofetch';\r\n\r\nimport { type CheerioAPI, load } from 'cheerio';\r\nimport { type Context } from 'hono';\r\n\r\nimport { baseUrl, fetchItems } from './util';\r\n\r\nexport const handler = async (ctx: Context): Promise<Data> => {\r\n    const { category = 'highlights', country = 'us' } = ctx.req.param();\r\n    const limit: number = Number.parseInt(ctx.req.query('limit') ?? '100', 10);\r\n\r\n    const targetUrl: string = new URL(category.endsWith('/') ? category : `${category}/`, baseUrl).href;\r\n\r\n    const response = await ofetch(targetUrl, {\r\n        headers: {\r\n            Cookie: `countryId=${country};`,\r\n        },\r\n    });\r\n    const $: CheerioAPI = load(response);\r\n    const language = $('html').attr('lang') ?? 'en';\r\n    const selector: string = 'div.card-panel';\r\n\r\n    const items: DataItem[] = await fetchItems($, selector, targetUrl, country, limit);\r\n\r\n    const title: string = $('title').text();\r\n\r\n    return {\r\n        title,\r\n        description: $('meta[name=\"description\"]').attr('content'),\r\n        link: targetUrl,\r\n        item: items,\r\n        allowEmpty: true,\r\n        image: $('a.brand-logo img').attr('src') ? new URL($('a.brand-logo img').attr('src') as string, baseUrl).href : undefined,\r\n        author: title.split(/\\|/).pop(),\r\n        language,\r\n        id: targetUrl,\r\n    };\r\n};\r\n\r\nexport const route: Route = {\r\n    path: '/:category?/:country?',\r\n    name: 'Category',\r\n    url: 'app-sales.net',\r\n    maintainers: ['nczitzk'],\r\n    handler,\r\n    example: '/app-sales/highlights',\r\n    parameters: {\r\n        category: {\r\n            description: 'Category, `highlights` as Highlights by default',\r\n            options: [\r\n                {\r\n                    label: 'Highlights',\r\n                    value: 'highlights',\r\n                },\r\n                {\r\n                    label: 'Active Sales',\r\n                    value: 'activesales',\r\n                },\r\n                {\r\n                    label: 'Now Free',\r\n                    value: 'nowfree',\r\n                },\r\n            ],\r\n        },\r\n        country: {\r\n            description: 'Country ID, `us` as United States by default',\r\n            options: [\r\n                {\r\n                    label: 'United States',\r\n                    value: 'us',\r\n                },\r\n                {\r\n                    label: 'Austria',\r\n                    value: 'at',\r\n                },\r\n                {\r\n                    label: 'Australia',\r\n                    value: 'au',\r\n                },\r\n                {\r\n                    label: 'Brazil',\r\n                    value: 'br',\r\n                },\r\n                {\r\n                    label: 'Canada',\r\n                    value: 'ca',\r\n                },\r\n                {\r\n                    label: 'France',\r\n                    value: 'fr',\r\n                },\r\n                {\r\n                    label: 'Germany',\r\n                    value: 'de',\r\n                },\r\n                {\r\n                    label: 'India',\r\n                    value: 'in',\r\n                },\r\n                {\r\n                    label: 'Italy',\r\n                    value: 'it',\r\n                },\r\n                {\r\n                    label: 'Netherlands',\r\n                    value: 'nl',\r\n                },\r\n                {\r\n                    label: 'Poland',\r\n                    value: 'pl',\r\n                },\r\n                {\r\n                    label: 'Russia',\r\n                    value: 'ru',\r\n                },\r\n                {\r\n                    label: 'Spain',\r\n                    value: 'es',\r\n                },\r\n                {\r\n                    label: 'Sweden',\r\n                    value: 'se',\r\n                },\r\n                {\r\n                    label: 'Great Britain',\r\n                    value: 'gb',\r\n                },\r\n            ],\r\n        },\r\n    },\r\n    description: `:::tip\r\nTo subscribe to [Highlights](https://www.app-sales.net/highlights/), where the source URL is \\`https://www.app-sales.net/highlights/\\`, extract the certain parts from this URL to be used as parameters, resulting in the route as [\\`/app-sales/highlights\\`](https://rsshub.app/app-sales/highlights).\r\n:::\r\n\r\n| Highlights | Active Sales | Now Free |\r\n| ---------- | ------------ | -------- |\r\n| highlights | activesales  | nowfree  |\r\n\r\n<details>\r\n  <summary>More countries</summary>\r\n\r\n| Currency | Country       | ID  |\r\n| -------- | ------------- | --- |\r\n| USD      | United States | us  |\r\n| EUR      | Austria       | at  |\r\n| AUD      | Australia     | au  |\r\n| BRL      | Brazil        | br  |\r\n| CAD      | Canada        | ca  |\r\n| EUR      | France        | fr  |\r\n| EUR      | Germany       | de  |\r\n| INR      | India         | in  |\r\n| EUR      | Italy         | it  |\r\n| EUR      | Netherlands   | nl  |\r\n| PLN      | Poland        | pl  |\r\n| RUB      | Russia        | ru  |\r\n| EUR      | Spain         | es  |\r\n| SEK      | Sweden        | se  |\r\n| GBP      | Great Britain | gb  |\r\n\r\n</details>\r\n`,\r\n    categories: ['program-update'],\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportRadar: true,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['app-sales.net/:category'],\r\n            target: (params) => {\r\n                const category: string = params.category;\r\n\r\n                return `/app-sales${category ? `/${category}` : ''}`;\r\n            },\r\n        },\r\n        {\r\n            title: 'Highlights',\r\n            source: ['app-sales.net/highlights'],\r\n            target: '/highlights',\r\n        },\r\n        {\r\n            title: 'Active Sales',\r\n            source: ['app-sales.net/activesales'],\r\n            target: '/activesales',\r\n        },\r\n        {\r\n            title: 'Now Free',\r\n            source: ['app-sales.net/nowfree'],\r\n            target: '/nowfree',\r\n        },\r\n    ],\r\n    view: ViewType.Articles,\r\n};\r\n"],"mappings":"mVASA,MAAa,EAAU,KAAO,IAAgC,CAC1D,GAAM,CAAE,WAAW,aAAc,UAAU,MAAS,EAAI,IAAI,QACtDA,EAAgB,OAAO,SAAS,EAAI,IAAI,MAAM,UAAY,MAAO,IAEjEC,EAAoB,IAAI,IAAI,EAAS,SAAS,KAAO,EAAW,GAAG,EAAS,GAAI,GAAS,KAEzF,EAAW,MAAMC,EAAO,EAAW,CACrC,QAAS,CACL,OAAQ,aAAa,EAAQ,MAG/BC,EAAgB,EAAK,GACrB,EAAW,EAAE,QAAQ,KAAK,SAAW,KAGrCE,EAAoB,MAAM,EAAW,EAAG,iBAAU,EAAW,EAAS,GAEtEC,EAAgB,EAAE,SAAS,OAEjC,MAAO,CACH,QACA,YAAa,EAAE,4BAA4B,KAAK,WAChD,KAAM,EACN,KAAM,EACN,WAAY,GACZ,MAAO,EAAE,oBAAoB,KAAK,OAAS,IAAI,IAAI,EAAE,oBAAoB,KAAK,OAAkB,GAAS,KAAO,IAAA,GAChH,OAAQ,EAAM,MAAM,MAAM,MAC1B,WACA,GAAI,IAICC,EAAe,CACxB,KAAM,wBACN,KAAM,WACN,IAAK,gBACL,YAAa,CAAC,WACd,UACA,QAAS,wBACT,WAAY,CACR,SAAU,CACN,YAAa,kDACb,QAAS,CACL,CACI,MAAO,aACP,MAAO,cAEX,CACI,MAAO,eACP,MAAO,eAEX,CACI,MAAO,WACP,MAAO,aAInB,QAAS,CACL,YAAa,+CACb,QAAS,CACL,CACI,MAAO,gBACP,MAAO,MAEX,CACI,MAAO,UACP,MAAO,MAEX,CACI,MAAO,YACP,MAAO,MAEX,CACI,MAAO,SACP,MAAO,MAEX,CACI,MAAO,SACP,MAAO,MAEX,CACI,MAAO,SACP,MAAO,MAEX,CACI,MAAO,UACP,MAAO,MAEX,CACI,MAAO,QACP,MAAO,MAEX,CACI,MAAO,QACP,MAAO,MAEX,CACI,MAAO,cACP,MAAO,MAEX,CACI,MAAO,SACP,MAAO,MAEX,CACI,MAAO,SACP,MAAO,MAEX,CACI,MAAO,QACP,MAAO,MAEX,CACI,MAAO,SACP,MAAO,MAEX,CACI,MAAO,gBACP,MAAO,SAKvB,YAAa;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EA+Bb,WAAY,CAAC,kBACb,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,aAAc,GACd,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,2BACT,OAAS,GAAW,CAChB,IAAMC,EAAmB,EAAO,SAEhC,MAAO,aAAa,EAAW,IAAI,IAAa,OAGxD,CACI,MAAO,aACP,OAAQ,CAAC,4BACT,OAAQ,eAEZ,CACI,MAAO,eACP,OAAQ,CAAC,6BACT,OAAQ,gBAEZ,CACI,MAAO,WACP,OAAQ,CAAC,yBACT,OAAQ,aAGhB,KAAM,EAAS"}