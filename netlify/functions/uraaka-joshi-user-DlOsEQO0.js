import{config as e}from"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./proxy-D7ccvALx.js";import{cache_default as t}from"./cache-kimkMTWJ.js";import{parseDate as n}from"./parse-date-Bgabdhlb.js";import{puppeteer_default as r}from"./puppeteer-f0D6AISB.js";import{load as i}from"cheerio";const a={path:`/:id`,categories:[`other`],example:`/uraaka-joshi/_rrwq`,parameters:{id:`User ID`},features:{requireConfig:!1,requirePuppeteer:!0,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`uraaka-joshi.com/:id`]}],name:`User`,maintainers:[`SettingDust`,`Halcao`],handler:o,url:`uraaka-joshi.com/`};async function o(a){let o=a.req.param(`id`),s=`https://www.uraaka-joshi.com/user/${o}`,c=await t.tryGet(s,async()=>{let e=await r(),t=await e.newPage();await t.setRequestInterception(!0),t.on(`request`,e=>{e.resourceType()===`document`||e.resourceType()===`script`||e.resourceType()===`fetch`?e.continue():e.abort()}),t.on(`requestfinished`,async e=>{e.url()===s&&e.response().status()===403&&await t.close()});let n=``;try{await t.goto(s,{waitUntil:`domcontentloaded`}),await t.waitForSelector(`#pickup03 .grid-cell`),await t.waitForSelector(`#pickup04 .grid-cell`),await t.waitForSelector(`#main-block .grid-cell`),n=await t.evaluate(()=>document.documentElement.innerHTML)}catch{throw Error(`Access denied (403)`)}return await e.close(),n},e.cache.routeExpire,!1),l=i(c),u=l(`#main-block .grid .grid-cell`).toArray().map(e=>{e=l(e),e.find(`*`).removeAttr(`onclick`),e.find(`*`).removeAttr(`onerror`),e.find(`*`).removeAttr(`style`);let t=e.find(`.account-group-link-row`);t.html(t.text()),e.find(`.plyr--video`).each((e,t)=>{t=l(t);let n=t.find(`video`);t.replaceWith(n),n.attr(`poster`,`https:`+n.attr(`data-poster`)),n.find(`source`).attr(`src`,`https:`+n.find(`source`).attr(`src`))}),e.find(`img`).each((e,t)=>{t=l(t),t.attr(`src`,`https:`+t.attr(`data-src`).split(`?resize`)[0]),t.removeAttr(`data-src`)});let r=e.find(`.account-group`).text(),i=e.find(`.hashtag-item .hashtag`).toArray().map(e=>l(e).text().trim()),a=e.find(`.account-group-link-row`).attr(`href`),o=n(e.find(`.profile-char`).attr(`datetime`)),s=e.find(`a.tap-image`).attr(`data-tweet-id`)||e.find(`video[class^="js-player-"]`).attr(`data-tweet-id`);return e.find(`.grow-room`).remove(),e.find(`div.profile-group.mt10.prl2`).eq(1).remove(),{title:e.find(`.profile-text`).text(),description:e.html(),link:a,pubDate:o,guid:s,category:i,author:r}});return{title:l(`title`).text(),description:l(`meta[name="description"]`).attr(`content`),link:s,item:u}}export{a as route};
//# sourceMappingURL=uraaka-joshi-user-DlOsEQO0.js.map