{"version":3,"file":"custom-CrWmA2Or.js","names":["got","route: Route","id"],"sources":["../../lib/routes/zju/cst/custom.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\nimport { parseDate } from '@/utils/parse-date';\r\n\r\nasync function getPage(id) {\r\n    const res = await got({\r\n        method: 'get',\r\n        url: `http://www.cst.zju.edu.cn/${id}/list.htm`,\r\n    });\r\n    const $ = load(res.data);\r\n    const content = $('.lm_new ul li');\r\n\r\n    return content.toArray().map((item) => {\r\n        item = $(item);\r\n\r\n        const title = item.find('a').text();\r\n        const pubDate = parseDate(item.find('.fr').text());\r\n        const link = item.find('a').attr('href');\r\n\r\n        return {\r\n            title,\r\n            pubDate,\r\n            link,\r\n        };\r\n    });\r\n}\r\n\r\nexport const route: Route = {\r\n    path: '/cst/custom/:id',\r\n    categories: ['university'],\r\n    example: '/zju/cst/custom/36194+36241+36246',\r\n    parameters: { id: '提取出通知页面中的 `ID`，如 `http://www.cst.zju.edu.cn/36246/list.htm` 中的 `36246`，可将你想获取通知的多个页面，通过 `+` 符号来聚合。' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    name: '软件学院',\r\n    maintainers: ['zwithz'],\r\n    handler,\r\n    description: `| 全部通知 | 招生信息 | 教务管理 | 论文管理 | 思政工作 | 评奖评优 | 实习就业 | 国际实习 | 国内合作科研 | 国际合作科研 | 校园服务 |\r\n| -------- | -------- | -------- | -------- | -------- | -------- | -------- | -------- | ------------ | ------------ | -------- |\r\n| 0        | 1        | 2        | 3        | 4        | 5        | 6        | 7        | 8            | 9            | 10       |\r\n\r\n#### 自定义聚合通知 {#zhe-jiang-da-xue-ruan-jian-xue-yuan-zi-ding-yi-ju-he-tong-zhi}`,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const id = ctx.req.param('id').split('+');\r\n    const tasks = id.map((id) => getPage(id));\r\n    const results = await Promise.all(tasks);\r\n    let items = [];\r\n    for (const result of results) {\r\n        items = [...items, ...result];\r\n    }\r\n\r\n    return {\r\n        title: '浙江大学软件学院通知',\r\n        link: 'http://www.cst.zju.edu.cn/',\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"oTAKA,eAAe,EAAQ,EAAI,CACvB,IAAM,EAAM,MAAMA,EAAI,CAClB,OAAQ,MACR,IAAK,6BAA6B,EAAG,aAEnC,EAAI,EAAK,EAAI,MACb,EAAU,EAAE,iBAElB,OAAO,EAAQ,UAAU,IAAK,GAAS,CACnC,EAAO,EAAE,GAET,IAAM,EAAQ,EAAK,KAAK,KAAK,OACvB,EAAU,EAAU,EAAK,KAAK,OAAO,QACrC,EAAO,EAAK,KAAK,KAAK,KAAK,QAEjC,MAAO,CACH,QACA,UACA,UAKZ,MAAaC,EAAe,CACxB,KAAM,kBACN,WAAY,CAAC,cACb,QAAS,oCACT,WAAY,CAAE,GAAI,sGAClB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,KAAM,OACN,YAAa,CAAC,UACd,UACA,YAAa;;;;gFAOjB,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAK,EAAI,IAAI,MAAM,MAAM,MAAM,KAC/B,EAAQ,EAAG,IAAK,GAAO,EAAQC,IAC/B,EAAU,MAAM,QAAQ,IAAI,GAC9B,EAAQ,GACZ,IAAK,IAAM,KAAU,EACjB,EAAQ,CAAC,GAAG,EAAO,GAAG,GAG1B,MAAO,CACH,MAAO,aACP,KAAM,6BACN,KAAM"}