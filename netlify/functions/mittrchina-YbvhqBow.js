import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as n}from"./cache-kimkMTWJ.js";import{art as r}from"./render-CxhTJIsl.js";import{parseDate as i}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as a}from"./got-CdvI2yKX.js";import o from"node:path";t();const s={path:`/:type?`,categories:[`new-media`],example:`/mittrchina/index`,parameters:{type:`类型，见下表，默认为首页资讯`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`首页`,maintainers:[`EsuRt`,`queensferryme`],handler:c,description:`| 快讯     | 本周热文 | 首页资讯 | 视频  |
| -------- | -------- | -------- | ----- |
| breaking | hot      | index    | video |`};async function c(t){let s={breaking:{title:`快讯`,apiPath:`/flash`},hot:{title:`本周热榜`,apiPath:`/information/hot`},index:{title:`首页资讯`,apiPath:`/information/index`},video:{title:`视频`,apiPath:`/movie/index`}},{type:c=`index`}=t.req.param(),l=t.req.query(`limit`)?Number.parseInt(t.req.query(`limit`),10):10,u=`https://apii.web.mittrchina.com${s[c].apiPath}`,{data:d}=c===`breaking`?await a.post(u,{form:{page:1,size:l}}):await a(u,{searchParams:{limit:l}}),f=c===`hot`?d.data:d.data.items,p=f.map(t=>({title:t.name||t.title,author:(t.authors||t.author||[]).map(e=>e.username).join(`, `),category:t.typeName,description:c===`video`?r(o.join(e,`templates/movie-63764619.art`),{poster:t.img,video:{address:t.address,type:t.address.split(`.`).pop()}}):c===`breaking`?t.content:t.summary,pubDate:t.start_time?i(t.start_time,`X`):t.push_time?i(t.push_time,`X`):void 0,id:t.id,link:`https://www.mittrchina.com/news/detail/${t.id}`})),m=p;return c!==`video`&&c!==`breaking`&&(m=await Promise.all(p.map(e=>n.tryGet(e.link,async()=>{let{data:{data:t}}=await a(`https://apii.web.mittrchina.com/information/details?id=${e.id}`);return e.description=t.content,e.author||(e.author=t.authors.map(e=>e.username).join(`, `)),e.pubDate||(e.pubDate=i(t.start_time,`X`)),t.cover&&(e.enclosure_url=t.cover,e.enclosure_type=`image/${t.cover.split(`.`).pop()}`),e})))),{title:`MIT 科技评论 - ${s[c].title}`,link:`https://www.mittrchina.com/${c}`,item:m}}export{s as route};
//# sourceMappingURL=mittrchina-YbvhqBow.js.map