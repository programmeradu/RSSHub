{"version":3,"file":"zjgtjy-CIYhEtz3.js","names":["route: Route","ofetch","cache","desc"],"sources":["../../lib/routes/zjgtjy/index.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport cache from '@/utils/cache';\r\nimport ofetch from '@/utils/ofetch';\r\n\r\nexport const route: Route = {\r\n    path: '/:type?',\r\n    name: 'Unknown',\r\n    maintainers: ['Fatpandac'],\r\n    handler,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const type = ctx.req.param('type') === 'all' ? '' : ctx.req.param('type').toUpperCase();\r\n    const host = `https://td.zjgtjy.cn:8553/devops/noticeInfo/queryNoticeInfoList?pageSize=10&pageNumber=1&noticeType=${type}&sort=DESC`;\r\n\r\n    const response = await ofetch(host);\r\n    const data = response.data;\r\n\r\n    const items = await Promise.all(\r\n        data.map(async (item) => {\r\n            const pageUrl = `https://td.zjgtjy.cn:8553/devops/noticeInfo/queryNoticeLandContentDetails?noticeId=${item.GGID}&transactionMode=${item.JYFS}`;\r\n            const pageLink = `https://td.zjgtjy.cn/view/trade/announcement/detail?id=${item.GGID}&category=${item.ZYLB}&type=${item.JYFS}`;\r\n\r\n            const desc = await cache.tryGet(pageUrl, async () => {\r\n                let desc = await ofetch(pageUrl);\r\n                desc = desc.queryNoticeContent.GGNR;\r\n\r\n                desc = desc.replaceAll('&lt;', '<').replaceAll('&gt;', '>').replaceAll('&quot;', '\"');\r\n                return desc;\r\n            });\r\n\r\n            return {\r\n                title: item.GGMC,\r\n                description: desc,\r\n                link: pageLink,\r\n                pubDate: item.GGFBSJ,\r\n            };\r\n        })\r\n    );\r\n\r\n    return {\r\n        title: '浙江土地使用权挂牌公告',\r\n        link: host,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"+NAIA,MAAaA,EAAe,CACxB,KAAM,UACN,KAAM,UACN,YAAa,CAAC,aACd,WAGJ,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAO,EAAI,IAAI,MAAM,UAAY,MAAQ,GAAK,EAAI,IAAI,MAAM,QAAQ,cACpE,EAAO,uGAAuG,EAAK,YAEnH,EAAW,MAAMC,EAAO,GACxB,EAAO,EAAS,KAEhB,EAAQ,MAAM,QAAQ,IACxB,EAAK,IAAI,KAAO,IAAS,CACrB,IAAM,EAAU,sFAAsF,EAAK,KAAK,mBAAmB,EAAK,OAClI,EAAW,0DAA0D,EAAK,KAAK,YAAY,EAAK,KAAK,QAAQ,EAAK,OAElH,EAAO,MAAMC,EAAM,OAAO,EAAS,SAAY,CACjD,IAAIC,EAAO,MAAMF,EAAO,GAIxB,MAHA,GAAOE,EAAK,mBAAmB,KAE/B,EAAOA,EAAK,WAAW,OAAQ,KAAK,WAAW,OAAQ,KAAK,WAAW,SAAU,KAC1EA,IAGX,MAAO,CACH,MAAO,EAAK,KACZ,YAAa,EACb,KAAM,EACN,QAAS,EAAK,WAK1B,MAAO,CACH,MAAO,cACP,KAAM,EACN,KAAM"}