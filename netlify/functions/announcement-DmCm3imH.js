import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{cache_default as e}from"./cache-kimkMTWJ.js";import{parseDate as t}from"./parse-date-Bgabdhlb.js";import{ofetch_default as n}from"./ofetch-Bzt0BXUH.js";import{ViewType as r}from"./types-A5bA50Mg.js";import*as i from"cheerio";const a={"new-cryptocurrency-listing":48,"latest-binance-news":49,"latest-activities":93,"new-fiat-listings":50,"api-updates":51,"crypto-airdrop":128,"wallet-maintenance-updates":157,delisting:161};function o(e){return!(!e||typeof e!=`object`||!(`reactRoot`in e)||!Array.isArray(e.reactRoot)||e.reactRoot?.[0]?.id!==`Fragment`)}function s(e){return!(!e||typeof e!=`object`||!(`config`in e)||!(`list`in e.config))}const c=async r=>{let c=`https://www.binance.com`,l=`${c}/support/announcement`,{type:u}=r.req.param(),d=r.req.header(`Accept-Language`),f={Referer:c,"Accept-Language":d??`en-US,en;q=0.9`},p=await e.tryGet(`binance:announcements:${d}`,async()=>{let e=await n(l,{headers:f}),t=i.load(e),r=JSON.parse(t(`#__APP_DATA`).text()),a=Object.values(r.appState.loader.dataByRouteId).find(e=>`playlist`in e);if(!o(a.playlist))throw Error(`Get announcement config failed`);let c=a.playlist.reactRoot[0].children.find(e=>e.id===`TopicCardList`)?.props;if(!s(c))throw Error(`Can't get announcement config list`);return c.config.list}),m=a[u];if(!m)throw Error(`${u} is not supported`);let h=p.find(e=>e.url.includes(`c-${m}`));if(!h)throw Error(`Unexpected announcements config`);let g=new URL(h.url,c).toString(),_=await n(g,{headers:f}),v=i.load(_),y=JSON.parse(v(`#__APP_DATA`).text()),b=Object.values(y.appState.loader.dataByRouteId),x=b.find(e=>`catalogs`in e),S=x.catalogs.find(e=>e.catalogId===m),C=await Promise.all(S.articles.map(r=>{let a=`${l}/${r.code}`,o={title:r.title,link:a,description:r.title,pubDate:t(r.releaseDate)};return e.tryGet(`binance:announcement:${r.code}:${d}`,async()=>{let e=await n(a,{headers:f}),t=i.load(e),r=t(`#support_article > div`).first();return r.find(`style`).remove(),o.description=r.html()??``,o})}));return{title:h.title,link:g,description:h.description,item:C}},l={path:`/announcement/:type`,categories:[`finance`],view:r.Articles,example:`/binance/announcement/new-cryptocurrency-listing`,parameters:{type:{description:`Binance Announcement type`,default:`new-cryptocurrency-listing`,options:[{value:`new-cryptocurrency-listing`,label:`New Cryptocurrency Listing`},{value:`latest-binance-news`,label:`Latest Binance News`},{value:`latest-activities`,label:`Latest Activities`},{value:`new-fiat-listings`,label:`New Fiat Listings`},{value:`api-updates`,label:`API Updates`},{value:`crypto-airdrop`,label:`Crypto Airdrop`},{value:`wallet-maintenance-updates`,label:`Wallet Maintenance Updates`},{value:`delisting`,label:`Delisting`}]}},name:`Announcement`,description:`
Type category

 - new-cryptocurrency-listing => New Cryptocurrency Listing
 - latest-binance-news        => Latest Binance News
 - latest-activities          => Latest Activities
 - new-fiat-listings          => New Fiat Listings
 - api-updates                => API Updates
 - crypto-airdrop             => Crypto Airdrop
 - wallet-maintenance-updates => Wallet Maintenance Updates
 - delisting                  => Delisting
`,maintainers:[`enpitsulin`],handler:c};export{l as route};
//# sourceMappingURL=announcement-DmCm3imH.js.map