import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{cache_default as n}from"./cache-kimkMTWJ.js";import{art as r}from"./render-CxhTJIsl.js";import{parseDate as i}from"./parse-date-Bgabdhlb.js";import{ofetch_default as a}from"./ofetch-Bzt0BXUH.js";import{ViewType as o}from"./types-A5bA50Mg.js";import s from"node:path";import{load as c}from"cheerio";t();const l=async t=>{let{category:o}=t.req.param(),l=Number.parseInt(t.req.query(`limit`)??`1`,10),u=`https://www.ali213.net`,d=new URL(`/news/zl/${o?o.endsWith(`/`)?o:`${o}/`:``}`,u).href,f=new URL(`ajax/newslist`,`https://mp.ali213.net`).href,p=await a(f,{query:{type:`new`}}),m=await a(d),h=c(m),g=h(`html`).prop(`lang`)??`zh`,_=JSON.parse(p.replace(/^\((.*)\)$/,`$1`)).data.slice(0,l).map(t=>{let n=t.Title,a=r(s.join(e,`templates/description-b958bde9.art`),{intro:t.GuideRead??``}),o=`ali213-zl-${t.ID}`,c=t.PicPath?`https:${t.PicPath}`:void 0,l=t.xiaobian;return{title:n,description:a,pubDate:i(t.addtime*1e3),link:t.url?`https:${t.url}`:void 0,author:l,guid:o,id:o,content:{html:a,text:t.GuideRead??``},image:c,banner:c,language:g}});_=(await Promise.all(_.map(t=>!t.link&&typeof t.link!=`string`?t:n.tryGet(t.link,async()=>{let n=await a(t.link),i=c(n),o=i(`h1.newstit`).text(),l=i(`div#Content`).html()??``,u=[];i(`a.currpage`).parent().find(`a:not(.currpage)`).each((e,t)=>{let n=i(t).attr(`href`);n&&u.push(n)});let d=await Promise.all(u.map(async e=>{let n=await a(new URL(e,t.link).href),r=c(n);return r(`div#Content`).html()??``}));l+=d.join(``),l=r(s.join(e,`templates/description-b958bde9.art`),{description:l});let f=i(`div.extend_read a`).toArray().map(e=>{let t=i(e);return{url:t.prop(`href`),type:`related`,content_html:t.text()}}).filter(e=>!0);return{title:o,description:l,pubDate:t.pubDate,category:i(`.category`).toArray().map(e=>i(e).text()),author:t.author,doi:i(`meta[name="citation_doi"]`).prop(`content`)||void 0,guid:t.guid,id:t.guid,content:{html:l,text:l},image:t.image,banner:t.image,language:g,_extra:{links:f.length>0?f:void 0}}})))).filter(e=>!0);let v=h(`title`).text(),y=new URL(`news/images/dxhlogo.png`,u).href;return{title:v,description:h(`meta[name="description"]`).prop(`content`),link:d,item:_,allowEmpty:!0,image:y,author:v.split(/_/).pop(),language:g,id:d}},u={path:`/zl/:category?`,name:`大侠号`,url:`www.ali213.net`,maintainers:[`nczitzk`],handler:l,example:`/ali213/zl`,parameters:{category:`分类，默认为首页，可在对应分类页 URL 中找到`},description:"::: tip\n若订阅 [游戏](https://www.ali213.net/news/zl/game/)，网址为 `https://www.ali213.net/news/zl/game/`，请截取 `https://www.ali213.net/news/zl/` 到末尾 `/` 的部分 `game` 作为 `category` 参数填入，此时目标路由为 [`/ali213/zl/game`](https://rsshub.app/ali213/zl/game)。\n:::\n\n| 首页                                     | 游戏                                         | 动漫                                           | 影视                                           | 娱乐                                           |\n| ---------------------------------------- | -------------------------------------------- | ---------------------------------------------- | ---------------------------------------------- | ---------------------------------------------- |\n| [index](https://www.ali213.net/news/zl/) | [game](https://www.ali213.net/news/zl/game/) | [comic](https://www.ali213.net/news/zl/comic/) | [movie](https://www.ali213.net/news/zl/movie/) | [amuse](https://www.ali213.net/news/zl/amuse/) |\n",categories:[`game`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.ali213.net/news/zl/:category`],target:e=>{let t=e.category;return`/ali213/zl${t?`/${t}`:``}`}},{title:`首页`,source:[`www.ali213.net/news/zl/`],target:`/zl`},{title:`游戏`,source:[`www.ali213.net/news/zl/game/`],target:`/zl/game`},{title:`动漫`,source:[`www.ali213.net/news/zl/comic/`],target:`/zl/comic`},{title:`影视`,source:[`www.ali213.net/news/zl/movie/`],target:`/zl/movie`},{title:`娱乐`,source:[`www.ali213.net/news/zl/amuse/`],target:`/zl/amuse`}],view:o.Articles};export{l as handler,u as route};
//# sourceMappingURL=zl-BY4QHPGy.js.map