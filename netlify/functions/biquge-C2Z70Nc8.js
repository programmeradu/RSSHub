import"./esm-shims-Dqvxr0BZ.js";import{config as e}from"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as t}from"./cache-kimkMTWJ.js";import{parseDate as n}from"./parse-date-Bgabdhlb.js";import{getSubPath as r}from"./common-utils-CvkwbCD5.js";import"./ofetch-Bzt0BXUH.js";import{got_default as i}from"./got-CdvI2yKX.js";import{timezone as a}from"./timezone-BrNu6iXe.js";import{config_not_found_default as o}from"./config-not-found-BVqhRP9D.js";import{load as s}from"cheerio";import c from"iconv-lite";const l=new Set([`www.xbiquwx.la`,`www.biqu5200.net`,`www.xbiquge.so`,`www.biqugeu.net`,`www.b520.cc`,`www.ahfgb.com`,`www.ibiquge.la`,`www.biquge.tv`,`www.bswtan.com`,`www.biquge.co`,`www.bqzhh.com`,`www.biqugse.com`,`www.ibiquge.info`,`www.ishuquge.com`,`www.mayiwxw.com`]),u={path:`*`,name:`Unknown`,maintainers:[],handler:d};async function d(u){let d=r(u).split(`/`).slice(1,4).join(`/`),f=r(u).slice(1);if(!e.feature.allow_user_supply_unsafe_domain&&!l.has(new URL(d).hostname))throw new o(`This RSS is disabled unless 'ALLOW_USER_SUPPLY_UNSAFE_DOMAIN' is set to 'true'.`);let p=await i({method:`get`,url:f,responseType:`buffer`,https:{rejectUnauthorized:!1}}),m=/charset="?'?gb/i.test(p.data.toString()),h=m?`gbk`:`utf-8`,g=s(c.decode(p.data,h)),_=g(`meta[property="og:novel:author"]`).attr(`content`),v=a(n(g(`meta[property="og:novel:update_time"]`).attr(`content`)),8),y=g(`dl dd a`).toArray().toReversed().slice(0,u.req.query(`limit`)?Number.parseInt(u.req.query(`limit`)):1).map(e=>{e=g(e);let t=``,n=e.attr(`href`);return t=n.startsWith(`http`)?n:/^\//.test(n)?`${d}${n}`:`${f}/${n}`,{title:e.text(),link:t,author:_,pubDate:v}});return y=await Promise.all(y.map(e=>t.tryGet(e.link,async()=>{let t=await i({method:`get`,url:e.link,responseType:`buffer`,https:{rejectUnauthorized:!1}}),n=s(c.decode(t.data,h));return e.description=n(`#content`).html(),e}))),{title:`${g(`meta[property="og:title"]`).attr(`content`)} - 笔趣阁`,link:f,item:y}}export{u as route};
//# sourceMappingURL=biquge-C2Z70Nc8.js.map