{"version":3,"file":"channel-D1lggAdG.js","names":[],"sources":["../../lib/routes/oeeee/app/channel.ts"],"sourcesContent":["import { Route } from '@/types';\r\n\r\nimport cache from '@/utils/cache';\r\nimport got from '@/utils/got';\r\nimport timezone from '@/utils/timezone';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport { parseArticle } from '../utils';\r\nimport { art } from '@/utils/render';\r\nimport path from 'node:path';\r\n\r\nexport const route: Route = {\r\n    path: '/app/channel/:id',\r\n    name: 'Unknown',\r\n    maintainers: ['TimWu007'],\r\n    handler,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const id = ctx.req.param('id') ?? 50;\r\n    const currentUrl = `https://api-ndapp.oeeee.com/friends.php?m=Zone&a=SpaceDoclist&uid=${id}&type=doc`;\r\n\r\n    const { data: response } = await got(currentUrl);\r\n\r\n    const list = response.data\r\n        .filter((i) => i.url) // Remove banner and sticky articles.\r\n        .map((item) => ({\r\n            title: item.title,\r\n            description: art(path.join(__dirname, '../templates/description.art'), {\r\n                thumb: item.titleimg.replaceAll(/\\?x-oss-process=.*/g, ''),\r\n                description: item.summary,\r\n            }),\r\n            pubDate: timezone(parseDate(item.ptime * 1000), +8),\r\n            link: item.url,\r\n            channel: item.author,\r\n        }));\r\n\r\n    const channel = list[1] ? list[1].channel : '';\r\n\r\n    const items = await Promise.all(list.map((item) => parseArticle(item, cache.tryGet)));\r\n\r\n    return {\r\n        title: `南方都市报客户端 - ${channel}`,\r\n        link: `https://m.mp.oeeee.com/u/${id}.html`,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"8hBAUA,MAAa,EAAe,CACxB,KAAM,mBACN,KAAM,UACN,YAAa,CAAC,YACd,WAGJ,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAK,EAAI,IAAI,MAAM,OAAS,GAC5B,EAAa,qEAAqE,EAAG,WAErF,CAAE,KAAM,GAAa,MAAM,EAAI,GAE/B,EAAO,EAAS,KACjB,OAAQ,GAAM,EAAE,KAChB,IAAK,IAAU,CACZ,MAAO,EAAK,MACZ,YAAa,EAAI,EAAA,KAAA,EAAA,sCAAsD,CACnE,MAAO,EAAK,SAAS,WAAW,sBAAuB,IACvD,YAAa,EAAK,UAEtB,QAAS,EAAS,EAAU,EAAK,MAAQ,KAAO,GAChD,KAAM,EAAK,IACX,QAAS,EAAK,UAGhB,EAAU,EAAK,GAAK,EAAK,GAAG,QAAU,GAEtC,EAAQ,MAAM,QAAQ,IAAI,EAAK,IAAK,GAAS,EAAa,EAAM,EAAM,UAE5E,MAAO,CACH,MAAO,cAAc,IACrB,KAAM,4BAA4B,EAAG,OACrC,KAAM"}