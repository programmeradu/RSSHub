import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{cache_default as e}from"./cache-kimkMTWJ.js";import{parseDate as t}from"./parse-date-Bgabdhlb.js";import{ofetch_default as n}from"./ofetch-Bzt0BXUH.js";import{timezone as r}from"./timezone-BrNu6iXe.js";import{ViewType as i}from"./types-A5bA50Mg.js";import{load as a}from"cheerio";import o from"iconv-lite";const s=async i=>{let{category:s=23}=i.req.param(),c=Number.parseInt(i.req.query(`limit`)??`30`,10),l=`https://lol.qq.com`,u=`https://apps.game.qq.com`,d=new URL(`news/index.shtml`,l).href,f=new URL(`cmc/zmMcnTargetContentList`,u).href,p=new URL(`cmc/zmMcnContentInfo`,u).href,m=await n(f,{query:{page:1,num:c,target:s}}),h=await n(d,{responseType:`arrayBuffer`}),g=a(o.decode(Buffer.from(h),`gbk`)),_=g(`html`).attr(`lang`)??`zh-CN`,v=[];return v=m.data.result.slice(0,c).map(e=>{let n=e.sTitle,i=e.sCreated,a=e.iDocID?`${e.iVideoId?`v/v2`:`news`}/detail.shtml?docid=${e.iDocID}`:void 0,o=e.sAuthor?[{name:e.sAuthor,avatar:e.sCreaterHeader}]:void 0,s=e.iDocID,c=e.sIMG?e.sIMG.startsWith(`http`)?e.sIMG:`https:${e.sIMG}`:void 0,u=e.updated??i,d={title:n,pubDate:i?r(t(i),8):void 0,link:a?new URL(a,l).href:void 0,author:o,guid:s,id:s,image:c,banner:c,updated:u?r(t(u),8):void 0,language:_};return d}),v=(await Promise.all(v.map(i=>i.link?e.tryGet(i.link,async()=>{let e=await n(p,{query:{type:0,docid:i.guid}}),a=e?.data?.result??void 0;if(!a)return i;let o=a.sTitle,s=a.sContent,c=a.sCreated,u=a.iDocID?`${a.iVideoId?`v/v2`:`news`}/detail.shtml?docid=${a.iDocID}`:void 0,d=a.sAuthor?[{name:a.sAuthor,avatar:a.sCreaterHeader}]:void 0,f=`qq-lol-${a.iDocID}`,m=a.sIMG?a.sIMG.startsWith(`http`)?a.sIMG:`https:${a.sIMG}`:void 0,h=a.sIdxTime??c,g={title:o,description:s,pubDate:c?r(t(c),8):void 0,link:u?new URL(u,l).href:void 0,author:d,guid:f,id:f,content:{html:s,text:s},image:m,banner:m,updated:h?r(t(h),8):void 0,language:_};return{...i,...g}}):i))).filter(e=>!0),{title:`${g(`div.website-path a`).toArray().map(e=>g(e).text()).join(``)} - ${g(`li[data-newsId="${s}"]`).text()}`,description:g(`meta[name="Description"]`).attr(`content`),link:d,item:v,allowEmpty:!0,image:`https:${g(`a.logo img`).attr(`src`)}`,author:g(`meta[name="author"]`).attr(`content`),language:_,id:d}},c={path:`/lol/news/:category?`,name:`英雄联盟新闻`,url:`lol.qq.com`,maintainers:[`nczitzk`],handler:s,example:`/qq/lol/news`,parameters:{category:"分类，默认为 `23`，即综合，见下表"},description:":::tip\n若订阅 [英雄联盟首页新闻列表 - 公告](https://lol.qq.com/news/index.shtml)，网址为 `https://lol.qq.com/news/index.shtml`，请选择 `24` 作为 `category` 参数填入，此时目标路由为 [`/qq/lol/news/24`](https://rsshub.app/qq/lol/news/24)。\n:::\n\n| 综合 | 公告 | 赛事 | 攻略 | 社区 |\n| ---- | ---- | ---- | ---- | ---- |\n| 23   | 24   | 25   | 27   | 28   |\n",categories:[`game`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{title:`综合`,source:[`lol.qq.com/news/index.shtml`],target:`/lol/news/23`},{title:`公告`,source:[`lol.qq.com/news/index.shtml`],target:`/lol/news/24`},{title:`赛事`,source:[`lol.qq.com/news/index.shtml`],target:`/lol/news/25`},{title:`攻略`,source:[`lol.qq.com/news/index.shtml`],target:`/lol/news/27`},{title:`社区`,source:[`lol.qq.com/news/index.shtml`],target:`/lol/news/28`}],view:i.Articles};export{s as handler,c as route};
//# sourceMappingURL=news-uRqQgLHb.js.map