{"version":3,"file":"appcommunityfeed-DRfqNUlQ.js","names":[],"sources":["../../lib/routes/steam/appcommunityfeed.ts"],"sourcesContent":["import { Route } from '@/types';\r\n\r\nimport ofetch from '@/utils/ofetch';\r\nimport { art } from '@/utils/render';\r\nimport path from 'node:path';\r\n\r\nconst workshopFileTypes = {\r\n    0: 'Community',\r\n    1: 'Microtransaction',\r\n    2: 'Collection',\r\n    3: 'Art',\r\n    4: 'Video',\r\n    5: 'Screenshot',\r\n    6: 'Game',\r\n    7: 'Software',\r\n    8: 'Concept',\r\n    9: 'WebGuide',\r\n    10: 'IntegratedGuide',\r\n    11: 'Merch',\r\n    12: 'ControllerBinding',\r\n    13: 'SteamworksAccessInvite',\r\n    14: 'SteamVideo',\r\n    15: 'GameManagedItem',\r\n};\r\n\r\nexport const route: Route = {\r\n    path: '/appcommunityfeed/:appid/:routeParams?',\r\n    categories: ['game'],\r\n    example: '/steam/appcommunityfeed/730',\r\n    parameters: {\r\n        appid: 'Steam appid, can be found on the community hub page or store page URL.',\r\n        routeParams: 'Query parameters.',\r\n    },\r\n    radar: [\r\n        {\r\n            title: 'Community Hub',\r\n            source: ['steamcommunity.com/app/:appid'],\r\n            target: '/appcommunityfeed/:appid',\r\n        },\r\n        {\r\n            title: 'Community Hub',\r\n            source: ['store.steampowered.com/app/:appid/*/'],\r\n            target: '/appcommunityfeed/:appid',\r\n        },\r\n    ],\r\n    description: `Query Parameters:\r\n\r\n| Name                   | Type   | Description             |\r\n| ---------------------- | ------ | ----------------------- |\r\n| p                      | string | p                       |\r\n| rgSections[]           | string | rgSections              |\r\n| filterLanguage         | string | Filter Language         |\r\n| languageTag            | string | Language Tag            |\r\n| nMaxInappropriateScore | string | Max Inappropriate Score |\r\n\r\nExample:\r\n- \\`/appcommunityfeed/730/p=1&rgSections[]=2&rgSections[]=4&filterLanguage=english&languageTag=english&nMaxInappropriateScore=1\\` for CS2 Screenshot and Artwork contents.\r\n- \\`/appcommunityfeed/730/rgSections[]=6\\` for CS2 Workshop contents only.\r\n- \\`/appcommunityfeed/570/rgSections[]=3&rgSections[]=9\\` for Dota2 Video and Guides contents.\r\n\r\n::: tip\r\nIt can also access community hub contents that require a logged-in account.\r\n:::\r\n`,\r\n    name: 'Steam Community Hub Feeds',\r\n    maintainers: ['NyaaaDoge'],\r\n\r\n    handler: async (ctx) => {\r\n        const { appid = 730, routeParams } = ctx.req.param();\r\n\r\n        const baseUrl = 'https://steamcommunity.com';\r\n        const apiUrl = `${baseUrl}/library/appcommunityfeed/${appid}${routeParams ? `?${routeParams}` : ''}`;\r\n        const response = await ofetch(apiUrl);\r\n\r\n        return {\r\n            title: `${appid} Steam Community Hub`,\r\n            link: `https://steamcommunity.com/app/${appid}`,\r\n            item: response.hub.map((item) => ({\r\n                title: item.title === '' ? workshopFileTypes[item.type] : item.title,\r\n                link: `https://steamcommunity.com/sharedfiles/filedetails/?id=${item.published_file_id}`,\r\n                description: art(path.join(__dirname, 'templates/appcommunityfeed-description.art'), {\r\n                    image: item.full_image_url,\r\n                    description: item.description,\r\n                }),\r\n                author: item.creator.name,\r\n                category: workshopFileTypes[item.type],\r\n            })),\r\n        };\r\n    },\r\n};\r\n"],"mappings":"2RAMA,MAAM,EAAoB,CACtB,EAAG,YACH,EAAG,mBACH,EAAG,aACH,EAAG,MACH,EAAG,QACH,EAAG,aACH,EAAG,OACH,EAAG,WACH,EAAG,UACH,EAAG,WACH,GAAI,kBACJ,GAAI,QACJ,GAAI,oBACJ,GAAI,yBACJ,GAAI,aACJ,GAAI,mBAGK,EAAe,CACxB,KAAM,yCACN,WAAY,CAAC,QACb,QAAS,8BACT,WAAY,CACR,MAAO,yEACP,YAAa,qBAEjB,MAAO,CACH,CACI,MAAO,gBACP,OAAQ,CAAC,iCACT,OAAQ,4BAEZ,CACI,MAAO,gBACP,OAAQ,CAAC,wCACT,OAAQ,6BAGhB,YAAa;;;;;;;;;;;;;;;;;;EAmBb,KAAM,4BACN,YAAa,CAAC,aAEd,QAAS,KAAO,IAAQ,CACpB,GAAM,CAAE,QAAQ,IAAK,eAAgB,EAAI,IAAI,QAGvC,EAAS,uDAAuC,IAAQ,EAAc,IAAI,IAAgB,KAC1F,EAAW,MAAM,EAAO,GAE9B,MAAO,CACH,MAAO,GAAG,EAAM,sBAChB,KAAM,kCAAkC,IACxC,KAAM,EAAS,IAAI,IAAK,IAAU,CAC9B,MAAO,EAAK,QAAU,GAAK,EAAkB,EAAK,MAAQ,EAAK,MAC/D,KAAM,0DAA0D,EAAK,oBACrE,YAAa,EAAI,EAAA,KAAA,EAAA,uDAAoE,CACjF,MAAO,EAAK,eACZ,YAAa,EAAK,cAEtB,OAAQ,EAAK,QAAQ,KACrB,SAAU,EAAkB,EAAK"}