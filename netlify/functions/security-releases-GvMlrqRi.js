import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{cache_default as n}from"./cache-kimkMTWJ.js";import{art as r}from"./render-CxhTJIsl.js";import{parseDate as i}from"./parse-date-Bgabdhlb.js";import{ofetch_default as a}from"./ofetch-Bzt0BXUH.js";import{ViewType as o}from"./types-A5bA50Mg.js";import s from"node:path";import{load as c}from"cheerio";t();const l=async t=>{let{language:o=`en-us`}=t.req.param(),l=Number.parseInt(t.req.query(`limit`)??`30`,10),u=`https://support.apple.com`,d=new URL(`${o}/100100`,u).href,f=await a(d),p=c(f),m=p(`table.gb-table tbody tr`),h=m.find(`th`).toArray().map(e=>p(e).text()),g=[];return g=m.slice(1,l).toArray().map(t=>{let n=p(t),a=n.find(`td`).first(),c=a.contents().first().text(),l=r(s.join(e,`templates/security-releases-c177efe3.art`),{headers:h,infos:n.find(`td`).toArray().map(e=>p(e).html()??``)}),d=n.find(`td`).last().text(),f=a.find(`a.gb-anchor`).attr(`href`),m=n.find(`meta[property="og:site_name"]`).attr(`content`),g=d,_={title:c,description:l,pubDate:d?i(d,[`DD MMM YYYY`,`YYYY 年 MM 月 DD 日`]):void 0,link:f?new URL(f,u).href:void 0,author:m,content:{html:l,text:l},updated:g?i(g,[`DD MMM YYYY`,`YYYY 年 MM 月 DD 日`]):void 0,language:o};return _}),g=await Promise.all(g.map(t=>t.link?n.tryGet(t.link,async()=>{let n=await a(t.link),l=c(n),u=t.title??l(`h1.gb-header`).text();l(`h1.gb-header`).remove();let d=t.description+r(s.join(e,`templates/security-releases-c177efe3.art`),{description:l(`div#sections`).html()}),f=n.match(/publish_date:\s"(\d{8})",/,``)?.[1],p=l(`meta[property="og:site_name"]`).attr(`content`),m=l(`.time`).text()||f,h={title:u,description:d,pubDate:f?i(f,`MMDDYYYY`):t.pubDate,author:p,content:{html:d,text:d},updated:m?i(m,`MMDDYYYY`):t.updated,language:o};return{...t,...h}}):t)),{title:p(`title`).text(),description:p(`meta[property="og:description"]`).attr(`content`),link:d,item:g,allowEmpty:!0,author:p(`meta[property="og:site_name"]`).attr(`content`),language:o,id:d}},u={path:`/security-releases/:language?`,name:`Security releases`,url:`support.apple.com`,maintainers:[`nczitzk`],handler:l,example:`/apple/security-releases`,parameters:{language:{description:"Language, `en-us` by default"}},description:":::tip\nTo subscribe to [Apple security releases](https://support.apple.com/en-us/100100), where the source URL is `https://support.apple.com/en-us/100100`, extract the certain parts from this URL to be used as parameters, resulting in the route as [`/apple/security-releases/en-us`](https://rsshub.app/apple/security-releases/en-us).\n:::\n",categories:[`program-update`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`support.apple.com/:language/100100`],target:e=>{let t=e.language;return`/apple/security-releases${t?`/${t}`:``}`}}],view:o.Articles,zh:{path:`/security-releases/:language?`,name:`安全性发布`,url:`support.apple.com`,maintainers:[`nczitzk`],handler:l,example:`/apple/security-releases`,parameters:{language:{description:"语言，默认为 `en-us`，可在对应页 URL 中找到"}},description:":::tip\n若订阅 [Apple 安全性发布](https://support.apple.com/zh-cn/100100)，网址为 `https://support.apple.com/zh-cn/100100`，请截取 `https://support.apple.com/` 到末尾 `/100100` 的部分 `zh-cn` 作为 `language` 参数填入，此时目标路由为 [`/apple/security-releases/zh-cn`](https://rsshub.app/apple/security-releases/zh-cn)。\n:::\n"}};export{l as handler,u as route};
//# sourceMappingURL=security-releases-GvMlrqRi.js.map