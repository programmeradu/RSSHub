{"version":3,"file":"utils-BBg-_kt3.js","names":[],"sources":["../../lib/routes/163/utils.ts"],"sourcesContent":["import got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\nimport { art } from '@/utils/render';\r\nimport path from 'node:path';\r\n\r\nconst parseDyArticle = (item, tryGet) =>\r\n    tryGet(item.link, async () => {\r\n        const response = await got(item.link, {\r\n            responseType: 'buffer',\r\n        });\r\n\r\n        const $ = load(response.data);\r\n\r\n        $('.post_main img').each((_, i) => {\r\n            if (!i.attribs.src) {\r\n                return;\r\n            }\r\n            const url = new URL(i.attribs.src);\r\n            if (url.host === 'nimg.ws.126.net') {\r\n                i.attribs.src = url.searchParams.get('url');\r\n            }\r\n        });\r\n\r\n        const imgsrc = item.imgsrc ? new URL(item.imgsrc).searchParams.get('url') : false;\r\n        item.description = art(path.join(__dirname, 'templates/dy.art'), {\r\n            imgsrc,\r\n            postBody: $('.post_body').html(),\r\n        });\r\n\r\n        item.feedLink = $('.post_wemedia_name a').attr('href');\r\n        item.feedDescription = $('.post_wemedia_title').text();\r\n        item.feedImage = $('.post_wemedia_avatar img').attr('src');\r\n\r\n        return item;\r\n    });\r\n\r\nexport { parseDyArticle };\r\n"],"mappings":"+NAKA,MAAM,GAAkB,EAAM,IAC1B,EAAO,EAAK,KAAM,SAAY,CAC1B,IAAM,EAAW,MAAM,EAAI,EAAK,KAAM,CAClC,aAAc,WAGZ,EAAI,EAAK,EAAS,MAExB,EAAE,kBAAkB,MAAM,EAAG,IAAM,CAC/B,GAAI,CAAC,EAAE,QAAQ,IACX,OAEJ,IAAM,EAAM,IAAI,IAAI,EAAE,QAAQ,KAC1B,EAAI,OAAS,oBACb,EAAE,QAAQ,IAAM,EAAI,aAAa,IAAI,UAI7C,IAAM,EAAS,EAAK,OAAS,IAAI,IAAI,EAAK,QAAQ,aAAa,IAAI,OAAS,GAU5E,MATA,GAAK,YAAc,EAAI,EAAA,KAAA,EAAA,6BAA0C,CAC7D,SACA,SAAU,EAAE,cAAc,SAG9B,EAAK,SAAW,EAAE,wBAAwB,KAAK,QAC/C,EAAK,gBAAkB,EAAE,uBAAuB,OAChD,EAAK,UAAY,EAAE,4BAA4B,KAAK,OAE7C"}