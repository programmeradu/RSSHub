{"version":3,"file":"fonts-D_n0Hqu6.js","names":[],"sources":["../../lib/routes/google/fonts.ts"],"sourcesContent":["import { Route } from '@/types';\r\n\r\nimport got from '@/utils/got';\r\nimport { config } from '@/config';\r\nimport { art } from '@/utils/render';\r\nimport path from 'node:path';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport ConfigNotFoundError from '@/errors/types/config-not-found';\r\n\r\nconst titleMap = {\r\n    date: 'Newest',\r\n    popularity: 'Most Popular',\r\n    trending: 'Trending',\r\n    alpha: 'Name',\r\n    style: 'Number of styles',\r\n};\r\n\r\nexport const route: Route = {\r\n    path: '/fonts/:sort?',\r\n    categories: ['design'],\r\n    example: '/google/fonts/date',\r\n    parameters: { sort: 'Sorting type, see below, default to `date`' },\r\n    features: {\r\n        requireConfig: [\r\n            {\r\n                name: 'GOOGLE_FONTS_API_KEY',\r\n                description: '',\r\n            },\r\n        ],\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    name: 'Google Fonts',\r\n    maintainers: ['Fatpandac'],\r\n    handler,\r\n    description: `| Newest | Trending | Most popular |  Name | Number of styles |\r\n| :----: | :------: | :----------: | :---: | :--------------: |\r\n|  date  | trending |  popularity  | alpha |       style      |\r\n\r\n::: warning\r\n  This route requires API key, therefore it's only available when self-hosting, refer to the [Deploy Guide](https://docs.rsshub.app/deploy/config#route-specific-configurations) for route-specific configurations.\r\n:::`,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const sort = ctx.req.param('sort') ?? 'date';\r\n    const limit = ctx.req.param('limit') ?? 25;\r\n\r\n    const API_KEY = config.google.fontsApiKey;\r\n    if (!API_KEY) {\r\n        throw new ConfigNotFoundError('Google Fonts API key is required.');\r\n    }\r\n\r\n    const googleFontsAPI = `https://www.googleapis.com/webfonts/v1/webfonts?sort=${sort}&key=${API_KEY}`;\r\n\r\n    const response = await got.get(googleFontsAPI);\r\n    const data = response.data.items.slice(0, limit);\r\n\r\n    return {\r\n        title: `Google Fonts - ${titleMap[sort]}`,\r\n        link: 'https://fonts.google.com',\r\n        item:\r\n            data &&\r\n            data.map((item) => ({\r\n                title: item.family,\r\n                description: art(path.join(__dirname, './templates/fonts.art'), {\r\n                    item,\r\n                }),\r\n                link: `https://fonts.google.com/specimen/${item.family.replaceAll(/\\s/g, '+')}`,\r\n                pubDate: parseDate(item.lastModified, 'YYYY-MM-DD'),\r\n            })),\r\n    };\r\n}\r\n"],"mappings":"geASA,MAAM,EAAW,CACb,KAAM,SACN,WAAY,eACZ,SAAU,WACV,MAAO,OACP,MAAO,oBAGE,EAAe,CACxB,KAAM,gBACN,WAAY,CAAC,UACb,QAAS,qBACT,WAAY,CAAE,KAAM,8CACpB,SAAU,CACN,cAAe,CACX,CACI,KAAM,uBACN,YAAa,KAGrB,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,KAAM,eACN,YAAa,CAAC,aACd,UACA,YAAa;;;;;;MASjB,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAO,EAAI,IAAI,MAAM,SAAW,OAChC,EAAQ,EAAI,IAAI,MAAM,UAAY,GAElC,EAAU,EAAO,OAAO,YAC9B,GAAI,CAAC,EACD,MAAM,IAAI,EAAoB,qCAGlC,IAAM,EAAiB,wDAAwD,EAAK,OAAO,IAErF,EAAW,MAAM,EAAI,IAAI,GACzB,EAAO,EAAS,KAAK,MAAM,MAAM,EAAG,GAE1C,MAAO,CACH,MAAO,kBAAkB,EAAS,KAClC,KAAM,2BACN,KACI,GACA,EAAK,IAAK,IAAU,CAChB,MAAO,EAAK,OACZ,YAAa,EAAI,EAAA,KAAA,EAAA,gCAA+C,CAC5D,SAEJ,KAAM,qCAAqC,EAAK,OAAO,WAAW,MAAO,OACzE,QAAS,EAAU,EAAK,aAAc"}