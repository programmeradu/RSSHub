{"version":3,"file":"kuaidi100-CYJ_o51z.js","names":["route: Route","utils"],"sources":["../../lib/routes/kuaidi100/index.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport utils from './utils';\r\n\r\nexport const route: Route = {\r\n    path: '/track/:number/:id/:phone?',\r\n    categories: ['other'],\r\n    example: '/kuaidi100/track/shunfeng/SF1007896781640/0383',\r\n    parameters: { number: '快递公司代号', id: '订单号', phone: '手机号后四位（仅顺丰）' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    name: '快递订单追踪',\r\n    maintainers: ['NeverBehave'],\r\n    handler,\r\n    description: `快递公司代号如果不能确定，可通过下方快递列表获得。\r\n\r\n::: warning\r\n  1.  构造链接前请确认所有参数正确：错误\\`快递公司 - 订单号\\`组合将会缓存信息一小段时间防止产生无用查询\r\n  2.  正常查询的订单在未签收状态下不会被缓存：请控制查询频率\r\n  3.  订单完成后请尽快取消订阅，避免资源浪费\r\n:::`,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    // number is shorthand for company\r\n    // id is ticket number\r\n    // phone for shunfeng :)\r\n    const { number, id, phone } = ctx.req.param();\r\n\r\n    // I am doing these to avoid invaild request.\r\n    // First, check if code is vaild\r\n    const { status, message, company } = await utils.checkCode(number, id, phone);\r\n\r\n    let data;\r\n    let query;\r\n    const time = new Date().toString();\r\n\r\n    if (status) {\r\n        query = await utils.getQuery(number, id, phone);\r\n        data =\r\n            query.status === '200'\r\n                ? query.data\r\n                : [\r\n                      {\r\n                          context: query.message,\r\n                          time,\r\n                      },\r\n                  ];\r\n    } else {\r\n        throw new Error(`[本地]信息有误，请检查后重试：${message}`);\r\n    }\r\n\r\n    // Maybe we can look into isCheck, condition, and state :)\r\n    // But I just want to make it work for now.\r\n    return {\r\n        title: `快递 ${company.name}-${id}`,\r\n        link: 'https://www.kuaidi100.com',\r\n        description: `快递 ${company.name}-${id}`,\r\n        item: data.map((item) => ({\r\n            title: item.context,\r\n            description: item.context,\r\n            guid: new Date(item.time || item.ftime).toUTCString(),\r\n            pubDate: new Date(item.time || item.ftime).toUTCString(),\r\n            link: 'https://www.kuaidi100.com',\r\n        })),\r\n    };\r\n}\r\n"],"mappings":"0RAGA,MAAaA,EAAe,CACxB,KAAM,6BACN,WAAY,CAAC,SACb,QAAS,iDACT,WAAY,CAAE,OAAQ,SAAU,GAAI,MAAO,MAAO,eAClD,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,KAAM,SACN,YAAa,CAAC,eACd,UACA,YAAa;;;;;;MASjB,eAAe,EAAQ,EAAK,CAIxB,GAAM,CAAE,SAAQ,KAAI,SAAU,EAAI,IAAI,QAIhC,CAAE,SAAQ,UAAS,WAAY,MAAMC,EAAM,UAAU,EAAQ,EAAI,GAEnE,EACA,EACE,EAAO,IAAI,OAAO,WAExB,GAAI,EACA,EAAQ,MAAMA,EAAM,SAAS,EAAQ,EAAI,GACzC,EACI,EAAM,SAAW,MACX,EAAM,KACN,CACI,CACI,QAAS,EAAM,QACf,cAIlB,MAAU,MAAM,mBAAmB,KAKvC,MAAO,CACH,MAAO,MAAM,EAAQ,KAAK,GAAG,IAC7B,KAAM,4BACN,YAAa,MAAM,EAAQ,KAAK,GAAG,IACnC,KAAM,EAAK,IAAK,IAAU,CACtB,MAAO,EAAK,QACZ,YAAa,EAAK,QAClB,KAAM,IAAI,KAAK,EAAK,MAAQ,EAAK,OAAO,cACxC,QAAS,IAAI,KAAK,EAAK,MAAQ,EAAK,OAAO,cAC3C,KAAM"}