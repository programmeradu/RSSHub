{"version":3,"file":"gr-BgPJn85P.js","names":["route: Route","got","cache"],"sources":["../../lib/routes/xidian/gr.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport cache from '@/utils/cache';\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\nimport { parseDate } from '@/utils/parse-date';\r\n\r\nconst baseUrl = 'https://gr.xidian.edu.cn';\r\n\r\nconst struct = {\r\n    home_zxdt: {\r\n        selector: {\r\n            list: '.main-right-list ul li',\r\n        },\r\n        name: '主页-最新动态',\r\n        path: '/zxdt',\r\n    },\r\n    home_tzgg1: {\r\n        selector: {\r\n            list: '.main-right-list ul li',\r\n        },\r\n        name: '主页-通知公告',\r\n        path: '/tzgg1',\r\n    },\r\n    home_jzbg: {\r\n        selector: {\r\n            list: '.jzbg-list ul li',\r\n        },\r\n        name: '主页-讲座报告',\r\n        path: '/jzbg',\r\n    },\r\n    yyjs_jbqk: {\r\n        name: '研院介绍-基本情况',\r\n        path: '/yyjs/jbqk',\r\n    },\r\n    yyjs_jbqk1: {\r\n        name: '研院介绍-机构设置',\r\n        path: '/yyjs/jbqk1',\r\n    },\r\n    yyjs_jbqk2: {\r\n        name: '研院介绍-部门领导',\r\n        path: '/yyjs/jbqk2',\r\n    },\r\n    yyjs_jbqk3: {\r\n        selector: {\r\n            list: '.main-right-list ul li',\r\n        },\r\n        name: '研院介绍-服务指南',\r\n        path: '/yyjs/jbqk3',\r\n    },\r\n    yyjs_jbqk4: {\r\n        name: '研院介绍-学院联系方式',\r\n        path: '/yyjs/jbqk4',\r\n    },\r\n    yjsy: {\r\n        selector: {\r\n            list: '.main-right-list ul li',\r\n        },\r\n        name: '招生信息',\r\n        path: '/yjsy',\r\n    },\r\n    yjsy_yjszs: {\r\n        selector: {\r\n            list: '.main-right-list ul li',\r\n        },\r\n        name: '招生信息-硕士研究生招生',\r\n        path: '/yjsy/yjszs',\r\n    },\r\n    yjsy_bsyjszs: {\r\n        selector: {\r\n            list: '.main-right-list ul li',\r\n        },\r\n        name: '招生信息-博士研究生招生',\r\n        path: '/yjsy/bsyjszs',\r\n    },\r\n    yjsy_qtlxzs: {\r\n        selector: {\r\n            list: '.main-right-list ul li',\r\n        },\r\n        name: '招生信息-其他类型招生',\r\n        path: '/yjsy/qtlxzs',\r\n    },\r\n    pygl: {\r\n        selector: {\r\n            list: '.main-right-list ul li',\r\n        },\r\n        name: '培养管理',\r\n        path: '/pygl',\r\n    },\r\n    pygl_xsxw: {\r\n        selector: {\r\n            list: '.main-right-list ul li',\r\n        },\r\n        name: '培养管理-学术学位',\r\n        path: 'pygl/pyfa1/xsxw1',\r\n    },\r\n    pygl_zyxw: {\r\n        selector: {\r\n            list: '.main-right-list ul li',\r\n        },\r\n        name: '培养管理-专业学位',\r\n        path: '/pygl/pyfa1/zyxw1',\r\n    },\r\n    pygl_jxgl: {\r\n        selector: {\r\n            list: '.main-right-list ul li',\r\n        },\r\n        name: '培养管理-教学管理',\r\n        path: '/pygl/jxgl',\r\n    },\r\n    pygl_jxgl1: {\r\n        selector: {\r\n            list: '.main-right-list ul li',\r\n        },\r\n        name: '培养管理-课程建设',\r\n        path: '/pygl/jxgl1',\r\n    },\r\n    pygl_jxgl2: {\r\n        selector: {\r\n            list: '.main-right-list ul li',\r\n        },\r\n        name: '培养管理-管理规定',\r\n        path: '/pygl/jxgl2',\r\n    },\r\n    pygl_jxgl3: {\r\n        selector: {\r\n            list: '.main-right-list ul li',\r\n        },\r\n        name: '培养管理-国际交流',\r\n        path: '/pygl/jxgl3',\r\n    },\r\n    pygl_bslc: {\r\n        selector: {\r\n            list: '.main-right-list ul li',\r\n        },\r\n        name: '培养管理-办事流程',\r\n        path: '/pygl/bslc',\r\n    },\r\n    xwsy: {\r\n        selector: {\r\n            list: '.main-right-list ul li',\r\n        },\r\n        name: '学位授予',\r\n        path: '/xwsy',\r\n    },\r\n    xwsy_tzgg: {\r\n        selector: {\r\n            list: '.main-right-list ul li',\r\n        },\r\n        name: '学位授予-通知公告',\r\n        path: '/xwsy/tzgg',\r\n    },\r\n    xwsy_gzzd: {\r\n        selector: {\r\n            list: '.main-right-list ul li',\r\n        },\r\n        name: '学位授予-规章制度',\r\n        path: '/xwsy/gzzd',\r\n    },\r\n    xwsy_swmd: {\r\n        selector: {\r\n            list: '.main-right-list ul li',\r\n        },\r\n        name: '学位授予-授位名单',\r\n        path: '/xwsy/swmd',\r\n    },\r\n    xwsy_zlxz: {\r\n        selector: {\r\n            list: '.main-right-list ul li',\r\n        },\r\n        name: '学位授予-资料下载',\r\n        path: '/xwsy/zlxz',\r\n    },\r\n};\r\n\r\nexport const route: Route = {\r\n    path: '/gr/:category?',\r\n    categories: ['university'],\r\n    example: '/xidian/gr/home_tzgg1',\r\n    parameters: { category: '通知类别，默认为主页-通知公告' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    name: '研究生院/卓越工程师学院',\r\n    url: 'gr.xidian.edu.cn',\r\n    maintainers: ['ZiHao256'],\r\n    handler,\r\n    description: `| 文章来源          | 参数           |\r\n| ------------- | ------------ |\r\n| ✅主页-最新动态      | home_zxdt    |\r\n| ✅主页-通知公告      | home_tzgg1   |\r\n| ✅主页-讲座报告      | home_jzbg    |\r\n| ✅研院介绍-基本情况    | yyjs_jbqk    |\r\n| ✅研院介绍-机构设置    | yyjs_jbqk1   |\r\n| ✅研院介绍-部门领导    | yyjs_jbqk2   |\r\n| ✅研院介绍-服务指南    | yyjs_jbqk3   |\r\n| ✅研院介绍-学院联系方式  | yyjs_jbqk4   |\r\n| ✅招生信息         | yjsy         |\r\n| ✅招生信息-硕士研究生招生 | yjsy_yjszs   |\r\n| ✅招生信息-博士研究生招生 | yjsy_bsyjszs |\r\n| ✅招生信息-其他类型招生  | yjsy_qtlxzs  |\r\n| ✅培养管理         | pygl         |\r\n| ✅培养管理-学术学位    | pygl_xsxw    |\r\n| ✅培养管理-专业学位    | pygl_zyxw    |\r\n| ✅培养管理-教学管理    | pygl_jxgl    |\r\n| ✅培养管理-课程建设    | pygl_jxgl1   |\r\n| ✅培养管理-管理规定    | pygl_jxgl2   |\r\n| ✅培养管理-国际交流    | pygl_jxgl3   |\r\n| ✅培养管理-办事流程    | pygl_bslc    |\r\n| ✅学位授予         | xwsy         |\r\n| ✅学位授予-通知公告    | xwsy_tzgg    |\r\n| ✅学位授予-规章制度    | xwsy_gzzd    |\r\n| ✅学位授予-授位名单    | xwsy_swmd    |\r\n| ✅学位授予-资料下载    | xwsy_zlxz    |`,\r\n    radar: [\r\n        {\r\n            source: ['gr.xidian.edu.cn/'],\r\n        },\r\n    ],\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const { category = 'home_tzgg1' } = ctx.req.param();\r\n    const url = `${baseUrl}/${struct[category].path}.htm`;\r\n    const response = await got(url, {\r\n        headers: {\r\n            referer: baseUrl,\r\n        },\r\n        https: {\r\n            rejectUnauthorized: false,\r\n        },\r\n    });\r\n\r\n    const $ = load(response.data);\r\n\r\n    if (category === 'yyjs_jbqk' || category === 'yyjs_jbqk1' || category === 'yyjs_jbqk2' || category === 'yyjs_jbqk4') {\r\n        return {\r\n            title: $('.right-bt-left').text(),\r\n            link: url,\r\n            item: [\r\n                {\r\n                    title: $('.right-bt-left').text(),\r\n                    link: url,\r\n                    description: $('.main-right').html(),\r\n                },\r\n            ],\r\n        };\r\n    } else {\r\n        let items = $(struct[category].selector.list)\r\n            .toArray()\r\n            .map((item) => {\r\n                item = $(item);\r\n                return {\r\n                    title: item.find('a').text(),\r\n                    link: new URL(item.find('a').attr('href'), baseUrl).href,\r\n                    pubDate: parseDate(item.find('span').text()),\r\n                };\r\n            });\r\n\r\n        items = await Promise.all(\r\n            items.map((item) =>\r\n                cache.tryGet(item.link, async () => {\r\n                    const detailResponse = await got(item.link, {\r\n                        headers: {\r\n                            referer: url,\r\n                        },\r\n                        https: {\r\n                            rejectUnauthorized: false,\r\n                        },\r\n                    });\r\n                    const content = load(detailResponse.data);\r\n                    content('.content-sxt').remove();\r\n                    item.description = content('[name=\"_newscontent_fromname\"]').html();\r\n                    return item;\r\n                })\r\n            )\r\n        );\r\n\r\n        return {\r\n            title: $('title').text(),\r\n            link: url,\r\n            item: items,\r\n        };\r\n    }\r\n}\r\n"],"mappings":"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"}