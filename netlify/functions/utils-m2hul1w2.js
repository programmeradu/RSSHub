import{cache_default as e}from"./cache-kimkMTWJ.js";import{ofetch_default as t}from"./ofetch-Bzt0BXUH.js";import{load as n}from"cheerio";const r=`https://www.capitalmind.in`;async function i(i){let a=`${r}/${i}/page/1`,o=await t(a),s=n(o),c=s(`.article-wrapper a.article-card-wrapper`).toArray().map(async i=>{let a=s(i),o=r+a.attr(`href`);return await e.tryGet(o,async()=>{let e=a.find(`h3`).text().trim(),i=a.find(String.raw`div.text-[16px]`).text().trim(),s=a.find(`img`).attr(`src`),c=s?.startsWith(`/_next/image`)?s.split(`url=`)[1].split(`&`)[0]:s,l=c?decodeURIComponent(c):``,u=await t(o),d=n(u),f=d(`article`).clone(),p=f.find(`footer div`).toArray().map(e=>{let t=d(e);t.find(`.sr-only`).remove();let n=t.text().trim();return n}).filter(Boolean),m=``,h=f.find(`header`),g=h.find(`time`);g.length&&(m=g.attr(`datetime`)||g.text().trim());let _=f.find(`section[aria-label="Post content"]`).clone();_.find(`footer`).remove();let v={},y=_.find(`iframe[src*="libsyn.com/embed/episode/id/"]`);if(y.length){let e=y.attr(`src`);if(e){let n=e.match(/\/id\/(\d+)\//);if(n&&n[1]){let e=n[1];try{let n=await t(`https://html5-player.libsyn.com/api/episode/id/${e}`);n&&n._item&&n._item._primary_content&&(v={mediaUrl:n._item._primary_content._download_url,image:`https://assets.libsyn.com/item/${e}`,itunes_duration:n._item._primary_content.duration})}catch{logger.info(`Failed to fetch podcast data for episode ID ${e}`)}}}}return _.find(`figure img`).each((e,t)=>{let n=d(t),i=n.attr(`src`);if(n.removeAttr(`srcset`),i&&i.startsWith(`/_next/image`)){let e=i.match(/url=([^&]+)/);if(e&&e[1]){let t=decodeURIComponent(e[1]);n.attr(`src`,t)}else i.startsWith(`/`)&&n.attr(`src`,r+i)}}),{title:e,link:o,author:i,description:_.html()||`<p><img src="${l}" alt="${e}"></p><p>Author: ${i}</p>`,guid:o,itunes_item_image:v?.image||l,category:p,pubDate:m,enclosure_url:v?.mediaUrl||null,itunes_duration:v?.itunes_duration||null,enclosure_type:v?.mediaUrl?`audio/mpeg`:null}})});return Promise.all(c)}export{r as baseUrl,i as fetchArticles};
//# sourceMappingURL=utils-m2hul1w2.js.map