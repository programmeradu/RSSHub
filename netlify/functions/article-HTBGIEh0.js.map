{"version":3,"file":"article-HTBGIEh0.js","names":["got"],"sources":["../../lib/routes/baobua/const.ts","../../lib/routes/baobua/article.ts"],"sourcesContent":["const SUB_NAME_PREFIX = 'BaoBua';\r\nconst SUB_URL = 'https://baobua.com/';\r\n\r\nexport { SUB_NAME_PREFIX, SUB_URL };\r\n","import { load } from 'cheerio';\r\nimport got from '@/utils/got';\r\nimport { parseDate } from '@/utils/parse-date';\r\n\r\nasync function loadArticle(link) {\r\n    const resp = await got(link);\r\n    const article = load(resp.body);\r\n\r\n    const title = article('title')\r\n        .text()\r\n        .replace('BaoBua.Com:', '')\r\n        .replace(/\\| Page \\d+\\/\\d+/, '')\r\n        .trim();\r\n    const totalPagesRegex = /Page \\d+\\/(\\d+)/;\r\n    const totalPagesMatch = totalPagesRegex.exec(article('title').text());\r\n    const totalPages = totalPagesMatch ? Number.parseInt(totalPagesMatch[1]) : 1;\r\n\r\n    let pubDate;\r\n    const blogPostingScript = article('script:contains(\"BlogPosting\")').first();\r\n    if (blogPostingScript) {\r\n        const jsonData = JSON.parse(blogPostingScript.text());\r\n        pubDate = parseDate(jsonData.datePublished);\r\n    }\r\n\r\n    const contentDiv = article('.contentme2');\r\n    let description = contentDiv.html() ?? '';\r\n\r\n    if (totalPages > 1) {\r\n        const additionalContents = await Promise.all(\r\n            Array.from({ length: totalPages - 1 }, async (_, i) => {\r\n                try {\r\n                    const response = await got(`${link}?page=${i + 2}`);\r\n                    const pageDom = load(response.body);\r\n                    return pageDom('.contentme2').html() ?? '';\r\n                } catch {\r\n                    return '';\r\n                }\r\n            })\r\n        );\r\n        description += additionalContents.join('');\r\n    }\r\n\r\n    return {\r\n        title,\r\n        description,\r\n        pubDate,\r\n        link,\r\n    };\r\n}\r\n\r\nexport default loadArticle;\r\n"],"mappings":"oIAAA,MAAM,EAAkB,SAClB,EAAU,sBCGhB,eAAe,EAAY,EAAM,CAC7B,IAAM,EAAO,MAAMA,EAAI,GACjB,EAAU,EAAK,EAAK,MAEpB,EAAQ,EAAQ,SACjB,OACA,QAAQ,cAAe,IACvB,QAAQ,mBAAoB,IAC5B,OACC,EAAkB,kBAClB,EAAkB,EAAgB,KAAK,EAAQ,SAAS,QACxD,EAAa,EAAkB,OAAO,SAAS,EAAgB,IAAM,EAEvE,EACE,EAAoB,EAAQ,kCAAkC,QACpE,GAAI,EAAmB,CACnB,IAAM,EAAW,KAAK,MAAM,EAAkB,QAC9C,EAAU,EAAU,EAAS,eAGjC,IAAM,EAAa,EAAQ,eACvB,EAAc,EAAW,QAAU,GAEvC,GAAI,EAAa,EAAG,CAChB,IAAM,EAAqB,MAAM,QAAQ,IACrC,MAAM,KAAK,CAAE,OAAQ,EAAa,GAAK,MAAO,EAAG,IAAM,CACnD,GAAI,CACA,IAAM,EAAW,MAAMA,EAAI,GAAG,EAAK,QAAQ,EAAI,KACzC,EAAU,EAAK,EAAS,MAC9B,OAAO,EAAQ,eAAe,QAAU,QACpC,CACJ,MAAO,OAInB,GAAe,EAAmB,KAAK,IAG3C,MAAO,CACH,QACA,cACA,UACA,QAIR,IAAA,EAAe"}