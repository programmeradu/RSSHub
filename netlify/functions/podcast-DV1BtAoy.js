import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{cache_default as n}from"./cache-kimkMTWJ.js";import{art as r}from"./render-CxhTJIsl.js";import{parseDate as i}from"./parse-date-Bgabdhlb.js";import{ofetch_default as a}from"./ofetch-Bzt0BXUH.js";import{timezone as o}from"./timezone-BrNu6iXe.js";import{ViewType as s}from"./types-A5bA50Mg.js";import c from"node:path";import{load as l}from"cheerio";t();const u=async t=>{let{id:s}=t.req.param(),u=Number.parseInt(t.req.query(`limit`)??`12`,10),d=`https://www.scientificamerican.com`,f=new URL(`podcast${s?`/${s}`:`s`}/`,d).href,p=await a(f),m=l(p),h=m(`html`).attr(`lang`)??`en`,g=p.match(/window\.__DATA__=JSON\.parse\(`(.*?)`\)/)?.[1],_=g?JSON.parse(g.replaceAll(`\\\\`,`\\`)):void 0,v=[];return v=_?_.initialData.props.results.slice(0,u).map(t=>{let n=t.title,a=t.image_url,s=r(c.join(e,`templates/description-9c686990.art`),{images:a?[{src:a,alt:t.image_alt_text||n,width:t.image_width,height:t.image_height}]:void 0,intro:t.summary}),l=t.date_published,u=t.url,f=[...new Set([t.category,t.subtype,t.column,t.digital_column].filter(Boolean))],p=t.authors.map(e=>({name:e.name,url:e.url?new URL(e.url,d).href:void 0,avatar:e.picture_file})),m=`-${t.id}`,g=t.release_date??l,_={title:n,description:s,pubDate:l?o(i(l),8):void 0,link:u?new URL(u,d).href:void 0,category:f,author:p,doi:t.article_doi,guid:m,id:m,content:{html:s,text:t.summary??s},image:a,banner:a,updated:g?o(i(g),8):void 0,language:h},v=t.media_url;if(v){let e=`audio/${v.replace(/\?.*$/,``).split(/\./).pop()}`;_={..._,enclosure_url:v,enclosure_type:e,enclosure_title:n,itunes_item_image:a}}return _}):[],v=(await Promise.all(v.map(t=>t.link?n.tryGet(t.link,async()=>{let n=await a(t.link),s=n.match(/window\.__DATA__=JSON\.parse\(`(.*?)`\)/)?.[1],l=s?JSON.parse(s.replaceAll(`\\\\`,`\\`)):void 0;if(!l)return t;let u=l.initialData.article,f=u.title,p=u.image_url,m=r(c.join(e,`templates/description-9c686990.art`),{images:p?[{src:p,alt:u.image_alt_text||f,width:u.image_width,height:u.image_height}]:void 0,intro:u.summary,content:u.content}),g=u.published_at_date_time,_=[...new Set([u.display_category,u.primary_category,u.subcategory,...u.categories??[],u.podcast_series_name])],v=u.authors.map(e=>({name:e.name,url:e.url?new URL(e.url,d).href:void 0,avatar:e.picture_file})),y=`scientificamerican-${u.id}`,b=u.updated_at_date_time??g,x={title:f,description:m,pubDate:g?o(i(g),8):void 0,category:_,author:v,doi:u.article_doi,guid:y,id:y,content:{html:m,text:u.summary??m},image:p,banner:p,updated:b?o(i(b),8):void 0,language:h},S=u.media_url;if(S){let e=`audio/${S.replace(/\?.*$/,``).split(/\./).pop()}`;x={...x,enclosure_url:S,enclosure_type:e,enclosure_title:f,itunes_item_image:p}}return{...t,...x}}):t))).filter(e=>!0),{title:m(`title`).text(),description:m(`meta[name="description"]`).attr(`content`),link:f,item:v,allowEmpty:!0,image:m(`meta[property="og:image"]`).attr(`content`),author:m(`meta[property="og:site_name"]`).attr(`content`),language:h,feedLink:m(`link[type="application/rss+xml"]`).attr(`href`),itunes_author:m(`meta[property="og:site_name"]`).attr(`content`),itunes_category:`Science`,id:m(`meta[property="og:url"]`).attr(`content`)}},d={path:`/podcast/:id?`,name:`Podcasts`,url:`www.scientificamerican.com`,maintainers:[`nczitzk`],handler:u,example:`/scientificamerican/podcast`,parameters:{id:`ID, see below`},description:":::tip\nIf you subscribe to [Science Quickly](https://www.scientificamerican.com/podcast/science-quickly/)，where the URL is `https://www.scientificamerican.com/podcast/science-quickly/`, extract the part `https://www.scientificamerican.com/podcast/` to the end, which is `science-quickly`, and use it as the parameter to fill in. Therefore, the route will be [`/scientificamerican/podcast/science-quickly`](https://rsshub.app/scientificamerican/podcast/science-quickly).\n:::\n\n| All | Science Quickly | Uncertain    |\n| --- | --------------- | ------------ |\n|     | science-quickly | science-talk |\n",categories:[`new-media`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.scientificamerican.com/podcasts/`,`www.scientificamerican.com/podcast/:id`],target:e=>{let t=e.id;return`/scientificamerican/podcast${t?`/${t}`:``}`}},{title:`Science Quickly`,source:[`www.scientificamerican.com/podcast/science-quickly/`],target:`/podcast/science-quickly`},{title:`Uncertain`,source:[`www.scientificamerican.com/podcast/science-talk/`],target:`/podcast/science-talk`}],view:s.Articles,zh:{path:`/podcast/:id?`,name:`Podcasts`,url:`www.scientificamerican.com`,maintainers:[`nczitzk`],handler:u,example:`/scientificamerican/podcast`,parameters:{id:`ID，见下表`},description:":::tip\n若订阅 [Science Quickly](https://www.scientificamerican.com/podcast/science-quickly/)，网址为 `https://www.scientificamerican.com/podcast/science-quickly/`，请截取 `https://www.scientificamerican.com/podcast/` 到末尾 `/` 的部分 `science-quickly` 作为 `id` 参数填入，此时目标路由为 [`/scientificamerican/podcast/science-quickly`](https://rsshub.app/scientificamerican/podcast/science-quickly)。\n:::\n\n| 全部 | Science Quickly | Uncertain    |\n| ---- | --------------- | ------------ |\n|      | science-quickly | science-talk |\n"}};export{u as handler,d as route};
//# sourceMappingURL=podcast-DV1BtAoy.js.map