{"version":3,"file":"ai-CB4nLKSI.js","names":["route: Route","ofetch","cache","response","$"],"sources":["../../lib/routes/ruc/ai.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport ofetch from '@/utils/ofetch';\r\nimport { load } from 'cheerio';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport timezone from '@/utils/timezone';\r\nimport cache from '@/utils/cache';\r\n\r\nexport const route: Route = {\r\n    path: '/ai/:category?',\r\n    categories: ['university'],\r\n    example: '/ruc/ai',\r\n    parameters: { category: '分类，见下方说明，默认为首页公告' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['ai.ruc.edu.cn/'],\r\n        },\r\n    ],\r\n    name: '高瓴人工智能学院',\r\n    maintainers: ['yinhanyan'],\r\n    handler: async (ctx) => {\r\n        const category = ctx.req.param('category')?.replace(/-/g, '/') ?? 'newslist/notice';\r\n        const baseURL = `http://ai.ruc.edu.cn/${category}/`;\r\n        const indexUrl = baseURL + 'index.htm';\r\n        const response = await ofetch(indexUrl);\r\n        const $ = load(response);\r\n        const pageTitle = $('title').text();\r\n        const list = $('div.fr li')\r\n            .toArray()\r\n            .map((item) => {\r\n                item = $(item);\r\n                const a = item.find('a').first();\r\n                const link = baseURL + a.attr('href');\r\n                return {\r\n                    link,\r\n                };\r\n            });\r\n\r\n        const items = await Promise.all(\r\n            list.map((item) =>\r\n                cache.tryGet(item.link, async () => {\r\n                    try {\r\n                        const response = await ofetch(item.link);\r\n                        const $ = load(response);\r\n                        const title = $('title').text();\r\n                        item.title = title;\r\n                        const titleDiv = $('div.tit');\r\n                        const date = titleDiv.find('span').first().text();\r\n                        item.pubDate = timezone(parseDate(/\\d+-\\d+-\\d+/.exec(date)[0]), +8);\r\n                        const frame = $('div.fr');\r\n                        item.description = frame\r\n                            .children()\r\n                            .slice(3)\r\n                            .toArray()\r\n                            .map((el) => $.html(el))\r\n                            .join('');\r\n                    } catch {\r\n                        item.description = '';\r\n                    }\r\n\r\n                    return item;\r\n                })\r\n            )\r\n        );\r\n\r\n        return {\r\n            title: pageTitle,\r\n            link: indexUrl,\r\n            icon: 'https://www.ruc.edu.cn/favicon.ico',\r\n            logo: 'http://ai.ruc.edu.cn/images/cn_ruc_logo.png',\r\n            item: items,\r\n        };\r\n    },\r\n    url: 'ai.ruc.edu.cn/',\r\n    description: `::: tip\r\n  分类字段处填写的是对应中国人民大学高瓴人工智能学院分类页网址中介于 **\\`http://ai.ruc.edu.cn/\\`** 和 **/index.htm** 中间的一段，并将其中的 \\`/\\` 修改为 \\`-\\`。\r\n\r\n  如 [中国人民大学高瓴人工智能学院 - 新闻公告 - 学院新闻](http://ai.ruc.edu.cn/newslist/newsdetail/index.htm) 的网址为 \\`http://ai.ruc.edu.cn/newslist/newsdetail/index.htm\\` 其中介于 **\\`http://ai.ruc.edu.cn/\\`** 和 **/index.htm** 中间的一段为 \\`newslist/newsdetail\\`。随后，并将其中的 \\`/\\` 修改为 \\`-\\`，可以得到 \\`newslist-newsdetail\\`。所以最终我们的路由为 [\\`/ruc/ai/newslist-newsdetail\\`](https://rsshub.app/ruc/ai/newslist-newsdetail)\r\n:::`,\r\n};\r\n"],"mappings":"qWAOA,MAAaA,EAAe,CACxB,KAAM,iBACN,WAAY,CAAC,cACb,QAAS,UACT,WAAY,CAAE,SAAU,oBACxB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,oBAGjB,KAAM,WACN,YAAa,CAAC,aACd,QAAS,KAAO,IAAQ,CACpB,IAAM,EAAW,EAAI,IAAI,MAAM,aAAa,QAAQ,KAAM,MAAQ,kBAC5D,EAAU,wBAAwB,EAAS,GAC3C,EAAW,EAAU,YACrB,EAAW,MAAMC,EAAO,GACxB,EAAI,EAAK,GACT,EAAY,EAAE,SAAS,OACvB,EAAO,EAAE,aACV,UACA,IAAK,GAAS,CACX,EAAO,EAAE,GACT,IAAM,EAAI,EAAK,KAAK,KAAK,QACnB,EAAO,EAAU,EAAE,KAAK,QAC9B,MAAO,CACH,UAIN,EAAQ,MAAM,QAAQ,IACxB,EAAK,IAAK,GACNC,EAAM,OAAO,EAAK,KAAM,SAAY,CAChC,GAAI,CACA,IAAMC,EAAW,MAAMF,EAAO,EAAK,MAC7BG,EAAI,EAAKD,GACT,EAAQC,EAAE,SAAS,OACzB,EAAK,MAAQ,EACb,IAAM,EAAWA,EAAE,WACb,EAAO,EAAS,KAAK,QAAQ,QAAQ,OAC3C,EAAK,QAAU,EAAS,EAAU,cAAc,KAAK,GAAM,IAAK,GAChE,IAAM,EAAQA,EAAE,UAChB,EAAK,YAAc,EACd,WACA,MAAM,GACN,UACA,IAAK,GAAOA,EAAE,KAAK,IACnB,KAAK,SACN,CACJ,EAAK,YAAc,GAGvB,OAAO,MAKnB,MAAO,CACH,MAAO,EACP,KAAM,EACN,KAAM,qCACN,KAAM,8CACN,KAAM,IAGd,IAAK,iBACL,YAAa"}