import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import{art as n}from"./render-CxhTJIsl.js";import{parseDate as r}from"./parse-date-Bgabdhlb.js";import{got_default as i}from"./got-CdvI2yKX.js";import a from"node:path";import{load as o}from"cheerio";t();const s=`xinpianchang.com`,c=`https://www.${s}`,l=`https://mod-api.${s}`,u=(e,t)=>t(e,async()=>{let{data:t}=await i(e),n=o(t),r=new URL(`favicon.ico`,c).href,a=n(`meta[property="og:site_name"]`).prop(`content`);return{data:{title:n(`span.bg-clip-text`).text()||`${a}Â·${n(`meta[property="og:title"]`).prop(`content`).split(`-`)[0]}`,link:e,description:n(`meta[property="og:description"]`).prop(`content`),language:n(`html`).prop(`lang`),image:n(`meta[property="og:image"]`).prop(`content`),icon:r,logo:r,subtitle:n(`meta[property="og:description"]`).prop(`content`),author:a,itunes_author:a,itunes_category:`TV &amp Film`,allowEmpty:!0},response:t}}),d=async(t,o)=>(t=t.map(e=>({title:e.title,link:e.web_url,description:e.content,author:e.author.userinfo.username,category:e.categories.flatMap(e=>[e.category_name,e.sub?.category_name]).filter(Boolean),guid:`xinpianchang-${e.id}`,pubDate:r(e.publish_time*1e3),itunes_item_image:e.cover,itunes_duration:e.duration,enclosure_url:e.video_library_id,upvotes:e.count.count_liked??e.count.count_like,comments:e.count.count_comment??0})),await Promise.all(t.map(t=>o(t.guid,async()=>{let r=new URL(`mod/api/v2/media/${t.enclosure_url}?appKey=61a2f329348b3bf77`,l).href,{data:o}=await i(r),s=o.data,c=s.resource?.progressive?s.resource.progressive[0]:void 0;return t.title=s.title??t.title,t.description=n(a.join(e,`templates/description-2b5f0576.art`),{content:t.description,cover:s.cover??t.itunes_item_image,enclousure:c}),t.author=s.owner.username??t.author,t.category=[...new Set([...t.category,...s.categories??[],...s.keywords??[]])],t.itunes_item_image=s.cover??t.itunes_item_image,t.itunes_duration=s.duration??t.itunes_duration,c&&(t.enclosure_url=c.url??c.backupUrl,t.enclosure_length=c.filesize,t.enclosure_type=c.mime),t}))));export{u as getData,d as processItems,c as rootUrl};
//# sourceMappingURL=util-IzpZM47K.js.map