{"version":3,"file":"util-da0H4bKD.js","names":["cache","got","item"],"sources":["../../lib/routes/taoguba/util.ts"],"sourcesContent":["import cache from '@/utils/cache';\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\nimport timezone from '@/utils/timezone';\r\nimport { parseDate } from '@/utils/parse-date';\r\n\r\nconst rootUrl = 'https://www.tgb.cn';\r\n\r\nconst renderPostDetail = async (item) =>\r\n    await cache.tryGet(item.link, async () => {\r\n        const detailResponse = await got({\r\n            method: 'get',\r\n            url: item.link,\r\n        });\r\n\r\n        const content = load(detailResponse.data);\r\n\r\n        content('#videoImg').remove();\r\n        content('img').each((_, img) => {\r\n            if (img.attribs.src2) {\r\n                img.attribs.src = img.attribs.src2;\r\n                delete img.attribs.src2;\r\n                delete img.attribs['data-original'];\r\n            }\r\n        });\r\n\r\n        item.description = content('#first').html();\r\n        if (detailResponse.url?.startsWith('https://www.tgb.cn/topic/transfer') || content('.login-view-button').length !== 0) {\r\n            item.description += '<br>登录后可查看完整文章';\r\n        }\r\n\r\n        item.pubDate = timezone(\r\n            parseDate(\r\n                content('.article-data > span:nth-child(2)')\r\n                    .text()\r\n                    .match(/\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}/)[0]\r\n            ),\r\n            +8\r\n        );\r\n\r\n        item.category = content('.classify')\r\n            .toArray()\r\n            .map((item) => content(item).text().trim());\r\n\r\n        return item;\r\n    });\r\n\r\nexport { rootUrl, renderPostDetail };\r\n"],"mappings":"0OAMA,MAAM,EAAU,qBAEV,EAAmB,KAAO,IAC5B,MAAMA,EAAM,OAAO,EAAK,KAAM,SAAY,CACtC,IAAM,EAAiB,MAAMC,EAAI,CAC7B,OAAQ,MACR,IAAK,EAAK,OAGR,EAAU,EAAK,EAAe,MA6BpC,OA3BA,EAAQ,aAAa,SACrB,EAAQ,OAAO,MAAM,EAAG,IAAQ,CACxB,EAAI,QAAQ,OACZ,EAAI,QAAQ,IAAM,EAAI,QAAQ,KAC9B,OAAO,EAAI,QAAQ,KACnB,OAAO,EAAI,QAAQ,oBAI3B,EAAK,YAAc,EAAQ,UAAU,QACjC,EAAe,KAAK,WAAW,sCAAwC,EAAQ,sBAAsB,SAAW,KAChH,EAAK,aAAe,kBAGxB,EAAK,QAAU,EACX,EACI,EAAQ,qCACH,OACA,MAAM,iCAAiC,IAEhD,GAGJ,EAAK,SAAW,EAAQ,aACnB,UACA,IAAK,GAAS,EAAQC,GAAM,OAAO,QAEjC"}