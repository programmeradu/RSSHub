{"version":3,"file":"routes-DTcIw1iL.js","names":["route: Route","ofetch"],"sources":["../../lib/routes/rsshub/routes.ts"],"sourcesContent":["import { Route, ViewType } from '@/types';\r\nimport ofetch from '@/utils/ofetch';\r\nimport * as cheerio from 'cheerio';\r\n\r\nexport const route: Route = {\r\n    path: '/routes/:lang?',\r\n    categories: ['program-update'],\r\n    view: ViewType.Notifications,\r\n    example: '/rsshub/routes/en',\r\n    parameters: {\r\n        lang: {\r\n            description: 'Language',\r\n            options: [\r\n                {\r\n                    label: 'Chinese',\r\n                    value: 'zh',\r\n                },\r\n                {\r\n                    label: 'English',\r\n                    value: 'en',\r\n                },\r\n            ],\r\n            default: 'en',\r\n        },\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['docs.rsshub.app/*'],\r\n            target: '/routes',\r\n        },\r\n    ],\r\n    name: 'New routes',\r\n    maintainers: ['DIYgod'],\r\n    handler,\r\n    url: 'docs.rsshub.app/*',\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const isEnglish = ctx.req.param('lang') !== 'zh';\r\n\r\n    const lang = isEnglish ? '' : 'zh/';\r\n    const types = [\r\n        'social-media',\r\n        'new-media',\r\n        'traditional-media',\r\n        'bbs',\r\n        'blog',\r\n        'programming',\r\n        'design',\r\n        'live',\r\n        'multimedia',\r\n        'picture',\r\n        'anime',\r\n        'program-update',\r\n        'university',\r\n        'forecast',\r\n        'travel',\r\n        'shopping',\r\n        'game',\r\n        'reading',\r\n        'government',\r\n        'study',\r\n        'journal',\r\n        'finance',\r\n        'other',\r\n    ];\r\n    const all = await Promise.all(\r\n        types.map(async (type) => {\r\n            const response = await ofetch(`https://docs.rsshub.app/${lang}routes/${type}`);\r\n\r\n            const $ = cheerio.load(response);\r\n            const page = $('.page').toArray();\r\n            const item = $('.routeBlock').toArray();\r\n            return { page, item, type };\r\n        })\r\n    );\r\n    const list = all.flatMap(({ page, item, type }) => item.map((item) => ({ page, item, type })));\r\n\r\n    return {\r\n        title: isEnglish ? 'RSSHub has new routes' : 'RSSHub 有新路由啦',\r\n        link: 'https://docs.rsshub.app',\r\n        description: isEnglish ? 'Everything is RSSible' : '万物皆可 RSS',\r\n        language: isEnglish ? 'en-us' : 'zh-cn',\r\n        item: list.map(({ page, item, type }) => {\r\n            const $ = cheerio.load(page);\r\n            const $item = $(item);\r\n            const h2Title = $item.prevAll('h2').eq(0);\r\n            const h3Title = $item.prevAll('h3').eq(0);\r\n\r\n            $item.find('.VPBadge').each((_, ele) => {\r\n                const $ele = $(ele);\r\n                if ($ele.text().includes('Test')) {\r\n                    $ele.remove();\r\n                }\r\n            });\r\n\r\n            return {\r\n                title: `${h2Title.text().trim()} - ${h3Title.text().trim()}`,\r\n                description: $item.html()?.replaceAll(/<!--.*?-->/g, ''),\r\n                link: `https://docs.rsshub.app/${lang}routes/${type}#${encodeURIComponent(h2Title.find('.header-anchor').attr('href') && h3Title.find('.header-anchor').attr('href')?.slice(1))}`,\r\n                guid: $item.attr('id'),\r\n            };\r\n        }),\r\n    };\r\n}\r\n"],"mappings":"oPAIA,MAAaA,EAAe,CACxB,KAAM,iBACN,WAAY,CAAC,kBACb,KAAM,EAAS,cACf,QAAS,oBACT,WAAY,CACR,KAAM,CACF,YAAa,WACb,QAAS,CACL,CACI,MAAO,UACP,MAAO,MAEX,CACI,MAAO,UACP,MAAO,OAGf,QAAS,OAGjB,MAAO,CACH,CACI,OAAQ,CAAC,qBACT,OAAQ,YAGhB,KAAM,aACN,YAAa,CAAC,UACd,UACA,IAAK,qBAGT,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAY,EAAI,IAAI,MAAM,UAAY,KAEtC,EAAO,EAAY,GAAK,MACxB,EAAQ,CACV,eACA,YACA,oBACA,MACA,OACA,cACA,SACA,OACA,aACA,UACA,QACA,iBACA,aACA,WACA,SACA,WACA,OACA,UACA,aACA,QACA,UACA,UACA,SAEE,EAAM,MAAM,QAAQ,IACtB,EAAM,IAAI,KAAO,IAAS,CACtB,IAAM,EAAW,MAAMC,EAAO,2BAA2B,EAAK,SAAS,KAEjE,EAAI,EAAQ,KAAK,GACjB,EAAO,EAAE,SAAS,UAClB,EAAO,EAAE,eAAe,UAC9B,MAAO,CAAE,OAAM,OAAM,WAGvB,EAAO,EAAI,SAAS,CAAE,OAAM,OAAM,UAAW,EAAK,IAAK,IAAU,CAAE,OAAM,KAAA,EAAM,WAErF,MAAO,CACH,MAAO,EAAY,wBAA0B,eAC7C,KAAM,0BACN,YAAa,EAAY,wBAA0B,WACnD,SAAU,EAAY,QAAU,QAChC,KAAM,EAAK,KAAK,CAAE,OAAM,OAAM,UAAW,CACrC,IAAM,EAAI,EAAQ,KAAK,GACjB,EAAQ,EAAE,GACV,EAAU,EAAM,QAAQ,MAAM,GAAG,GACjC,EAAU,EAAM,QAAQ,MAAM,GAAG,GASvC,OAPA,EAAM,KAAK,YAAY,MAAM,EAAG,IAAQ,CACpC,IAAM,EAAO,EAAE,GACX,EAAK,OAAO,SAAS,SACrB,EAAK,WAIN,CACH,MAAO,GAAG,EAAQ,OAAO,OAAO,KAAK,EAAQ,OAAO,SACpD,YAAa,EAAM,QAAQ,WAAW,cAAe,IACrD,KAAM,2BAA2B,EAAK,SAAS,EAAK,GAAG,mBAAmB,EAAQ,KAAK,kBAAkB,KAAK,SAAW,EAAQ,KAAK,kBAAkB,KAAK,SAAS,MAAM,MAC5K,KAAM,EAAM,KAAK"}