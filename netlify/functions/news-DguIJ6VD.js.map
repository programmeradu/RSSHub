{"version":3,"file":"news-DguIJ6VD.js","names":["ofetch","cache","items: DataItem[]","route: Route"],"sources":["../../lib/routes/deepseek/news.ts"],"sourcesContent":["import { Route, Data, DataItem } from '@/types';\r\nimport ofetch from '@/utils/ofetch';\r\nimport * as cheerio from 'cheerio';\r\nimport cache from '@/utils/cache';\r\n\r\nconst ROOT_URL = 'https://api-docs.deepseek.com/zh-cn';\r\n\r\nconst NEWS_LIST_SELECTOR = 'ul.menu__list > li:nth-child(2) ul > li.theme-doc-sidebar-item-link';\r\nconst ARTICLE_CONTENT_SELECTOR = '.theme-doc-markdown > div > div';\r\nconst ARTICLE_TITLE_SELECTOR = ARTICLE_CONTENT_SELECTOR + ' > h1';\r\n\r\n// 获取消息列表 / get article list\r\nconst fetchPageContent = async (url: string) => {\r\n    const response = await ofetch(url);\r\n    return cheerio.load(response);\r\n};\r\n\r\n// 提取正文内容 / extract article content\r\nconst extractArticleInfo = ($article: cheerio.Root, pageURL: string) => {\r\n    const contentElement = $article(ARTICLE_CONTENT_SELECTOR);\r\n    const title = $article(ARTICLE_TITLE_SELECTOR).text();\r\n    $article(ARTICLE_TITLE_SELECTOR).remove(); // 移除标题，避免重复 / remove title to avoid duplication\r\n    const content = contentElement.html();\r\n    return { title, content, pageURL };\r\n};\r\n\r\nconst parseDateString = (dateString: string) => {\r\n    const pubDate = new Date(dateString);\r\n    return pubDate.toUTCString();\r\n};\r\n\r\n// 创建消息 / create article\r\nconst createDataItem = (item: cheerio.Element, $: cheerio.Root): Promise<DataItem> => {\r\n    const $item = $(item);\r\n    const link = $item.find('a').attr('href');\r\n    const dateString = $item.find('a').text().split(' ').at(-1);\r\n    const pageURL = new URL(link || '', ROOT_URL).href;\r\n\r\n    return cache.tryGet(pageURL, async () => {\r\n        const $article = await fetchPageContent(pageURL);\r\n        const { title, content } = extractArticleInfo($article, pageURL);\r\n        const pubDate = parseDateString(dateString);\r\n\r\n        return {\r\n            title,\r\n            link: pageURL,\r\n            pubDate,\r\n            description: content || undefined,\r\n        };\r\n    });\r\n};\r\n\r\nconst handler = async (): Promise<Data> => {\r\n    const $ = await fetchPageContent(ROOT_URL);\r\n    const newsList = $(NEWS_LIST_SELECTOR);\r\n\r\n    const items: DataItem[] = await Promise.all(newsList.toArray().map((li) => createDataItem(li, $)));\r\n\r\n    return {\r\n        title: 'DeepSeek 新闻',\r\n        link: ROOT_URL,\r\n        item: items,\r\n        allowEmpty: true,\r\n    };\r\n};\r\n\r\nexport const route: Route = {\r\n    path: '/news',\r\n    categories: ['programming'],\r\n    example: '/deepseek/news',\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['api-docs.deepseek.com'],\r\n            target: '/news',\r\n        },\r\n    ],\r\n    name: '新闻',\r\n    maintainers: ['1837634311'],\r\n    handler,\r\n};\r\n"],"mappings":"yPAKA,MAAM,EAAW,sCAGX,EAA2B,kCAC3B,EAAyB,EAA2B,QAGpD,EAAmB,KAAO,IAAgB,CAC5C,IAAM,EAAW,MAAMA,EAAO,GAC9B,OAAO,EAAQ,KAAK,IAIlB,GAAsB,EAAwB,IAAoB,CACpE,IAAM,EAAiB,EAAS,GAC1B,EAAQ,EAAS,GAAwB,OAC/C,EAAS,GAAwB,SACjC,IAAM,EAAU,EAAe,OAC/B,MAAO,CAAE,QAAO,UAAS,YAGvB,EAAmB,GAAuB,CAC5C,IAAM,EAAU,IAAI,KAAK,GACzB,OAAO,EAAQ,eAIb,GAAkB,EAAuB,IAAuC,CAClF,IAAM,EAAQ,EAAE,GACV,EAAO,EAAM,KAAK,KAAK,KAAK,QAC5B,EAAa,EAAM,KAAK,KAAK,OAAO,MAAM,KAAK,GAAG,IAClD,EAAU,IAAI,IAAI,GAAQ,GAAI,GAAU,KAE9C,OAAOC,EAAM,OAAO,EAAS,SAAY,CACrC,IAAM,EAAW,MAAM,EAAiB,GAClC,CAAE,QAAO,WAAY,EAAmB,EAAU,GAClD,EAAU,EAAgB,GAEhC,MAAO,CACH,QACA,KAAM,EACN,UACA,YAAa,GAAW,IAAA,OAK9B,EAAU,SAA2B,CACvC,IAAM,EAAI,MAAM,EAAiB,GAC3B,EAAW,EAAE,uEAEbC,EAAoB,MAAM,QAAQ,IAAI,EAAS,UAAU,IAAK,GAAO,EAAe,EAAI,KAE9F,MAAO,CACH,MAAO,cACP,KAAM,EACN,KAAM,EACN,WAAY,KAIPC,EAAe,CACxB,KAAM,QACN,WAAY,CAAC,eACb,QAAS,iBACT,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,yBACT,OAAQ,UAGhB,KAAM,KACN,YAAa,CAAC,cACd"}