{"version":3,"file":"common-utils-lQ4FwDQy.js","names":[],"sources":["../../lib/routes/instagram/common-utils.ts"],"sourcesContent":["import { parseDate } from '@/utils/parse-date';\r\nimport { art } from '@/utils/render';\r\nimport path from 'node:path';\r\n\r\nconst renderItems = (items) =>\r\n    items.map((item) => {\r\n        const productType = item.product_type; // carousel_container, feed, clips, igtv\r\n        // Content\r\n        const summary = item.caption?.text ?? '';\r\n\r\n        let description = '';\r\n        switch (productType) {\r\n            case 'carousel_container': {\r\n                const images = item.carousel_media.map((i) => ({\r\n                    ...i.image_versions2.candidates.sort((a, b) => b.width - a.width)[0],\r\n                    alt: item.accessibility_caption,\r\n                }));\r\n                description = art(path.join(__dirname, 'templates/images.art'), {\r\n                    summary,\r\n                    images,\r\n                });\r\n                break;\r\n            }\r\n            case 'clips':\r\n            case 'igtv':\r\n                description = art(path.join(__dirname, 'templates/video.art'), {\r\n                    summary,\r\n                    image: item.image_versions2.candidates.sort((a, b) => b.width - a.width)[0],\r\n                    video: item.video_versions[0],\r\n                });\r\n                break;\r\n            case 'feed': {\r\n                const images = [{ ...item.image_versions2.candidates.sort((a, b) => b.width - a.width)[0], alt: item.accessibility_caption }];\r\n                description = art(path.join(__dirname, 'templates/images.art'), {\r\n                    summary,\r\n                    images,\r\n                });\r\n                break;\r\n            }\r\n            default:\r\n                throw new Error(`Instagram: Unhandled feed type: ${productType}`);\r\n        }\r\n\r\n        // Metadata\r\n        const url = `https://www.instagram.com/p/${item.code}/`;\r\n        const pubDate = parseDate(item.caption?.created_at_utc || item.taken_at, 'X');\r\n        const title = summary.split('\\n')[0];\r\n\r\n        return {\r\n            title,\r\n            id: item.pk,\r\n            pubDate,\r\n            author: item.user.username,\r\n            link: url,\r\n            summary,\r\n            description,\r\n        };\r\n    });\r\n\r\nexport { renderItems };\r\n"],"mappings":"qMAIA,MAAM,EAAe,GACjB,EAAM,IAAK,GAAS,CAChB,IAAM,EAAc,EAAK,aAEnB,EAAU,EAAK,SAAS,MAAQ,GAElC,EAAc,GAClB,OAAQ,EAAR,CACI,IAAK,qBAAsB,CACvB,IAAM,EAAS,EAAK,eAAe,IAAK,IAAO,CAC3C,GAAG,EAAE,gBAAgB,WAAW,MAAM,EAAG,IAAM,EAAE,MAAQ,EAAE,OAAO,GAClE,IAAK,EAAK,yBAEd,EAAc,EAAI,EAAA,KAAA,EAAA,iCAA8C,CAC5D,UACA,WAEJ,MAEJ,IAAK,QACL,IAAK,OACD,EAAc,EAAI,EAAA,KAAA,EAAA,gCAA6C,CAC3D,UACA,MAAO,EAAK,gBAAgB,WAAW,MAAM,EAAG,IAAM,EAAE,MAAQ,EAAE,OAAO,GACzE,MAAO,EAAK,eAAe,KAE/B,MACJ,IAAK,OAAQ,CACT,IAAM,EAAS,CAAC,CAAE,GAAG,EAAK,gBAAgB,WAAW,MAAM,EAAG,IAAM,EAAE,MAAQ,EAAE,OAAO,GAAI,IAAK,EAAK,wBACrG,EAAc,EAAI,EAAA,KAAA,EAAA,iCAA8C,CAC5D,UACA,WAEJ,MAEJ,QACI,MAAU,MAAM,mCAAmC,KAI3D,IAAM,EAAM,+BAA+B,EAAK,KAAK,GAC/C,EAAU,EAAU,EAAK,SAAS,gBAAkB,EAAK,SAAU,KACnE,EAAQ,EAAQ,MAAM;GAAM,GAElC,MAAO,CACH,QACA,GAAI,EAAK,GACT,UACA,OAAQ,EAAK,KAAK,SAClB,KAAM,EACN,UACA"}