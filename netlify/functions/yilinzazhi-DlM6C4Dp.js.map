{"version":3,"file":"yilinzazhi-DlM6C4Dp.js","names":["route: Route","got","contents: DataItem[]","cache"],"sources":["../../lib/routes/yilinzazhi/index.ts"],"sourcesContent":["import { Data, DataItem, Route, ViewType } from '@/types';\r\nimport cache from '@/utils/cache';\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\n\r\nexport const route: Route = {\r\n    path: '/',\r\n    categories: ['reading'],\r\n    view: ViewType.Articles,\r\n    example: '/yilinzazhi',\r\n    radar: [\r\n        {\r\n            source: ['www.yilinzazhi.com'],\r\n            target: '/',\r\n        },\r\n    ],\r\n    name: '文章列表',\r\n    maintainers: ['g0ngjie'],\r\n    handler,\r\n    url: 'www.yilinzazhi.com',\r\n};\r\n\r\nasync function handler(): Promise<Data> {\r\n    const baseUrl = 'https://www.yilinzazhi.com/';\r\n    const response = await got(baseUrl);\r\n    const $ = load(response.data);\r\n    const contents: DataItem[] = $('section.content')\r\n        .find('li')\r\n        .toArray()\r\n        .map((target) => {\r\n            const li = $(target);\r\n\r\n            const aTag = li.find('a');\r\n            const title = aTag.text();\r\n            const link = baseUrl + aTag.attr('href');\r\n\r\n            return {\r\n                title,\r\n                link,\r\n                description: '',\r\n            };\r\n        });\r\n\r\n    const items = (await Promise.all(\r\n        contents.map((content) =>\r\n            cache.tryGet(content.link!, async () => {\r\n                const childRes = await got(content.link);\r\n                const $$ = load(childRes.data);\r\n                content.description = $$('.maglistbox').html()!;\r\n                return content;\r\n            })\r\n        )\r\n    )) as DataItem[];\r\n    return {\r\n        title: '意林杂志网',\r\n        link: baseUrl,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"kWAKA,MAAaA,EAAe,CACxB,KAAM,IACN,WAAY,CAAC,WACb,KAAM,EAAS,SACf,QAAS,cACT,MAAO,CACH,CACI,OAAQ,CAAC,sBACT,OAAQ,MAGhB,KAAM,OACN,YAAa,CAAC,WACd,UACA,IAAK,sBAGT,eAAe,GAAyB,CACpC,IAAM,EAAU,8BACV,EAAW,MAAMC,EAAI,GACrB,EAAI,EAAK,EAAS,MAClBC,EAAuB,EAAE,mBAC1B,KAAK,MACL,UACA,IAAK,GAAW,CACb,IAAM,EAAK,EAAE,GAEP,EAAO,EAAG,KAAK,KACf,EAAQ,EAAK,OACb,EAAO,EAAU,EAAK,KAAK,QAEjC,MAAO,CACH,QACA,OACA,YAAa,MAInB,EAAS,MAAM,QAAQ,IACzB,EAAS,IAAK,GACVC,EAAM,OAAO,EAAQ,KAAO,SAAY,CACpC,IAAM,EAAW,MAAMF,EAAI,EAAQ,MAC7B,EAAK,EAAK,EAAS,MAEzB,MADA,GAAQ,YAAc,EAAG,eAAe,OACjC,MAInB,MAAO,CACH,MAAO,QACP,KAAM,EACN,KAAM"}