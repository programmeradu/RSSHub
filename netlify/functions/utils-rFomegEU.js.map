{"version":3,"file":"utils-rFomegEU.js","names":["got","cache"],"sources":["../../lib/routes/web/utils.ts"],"sourcesContent":["import type { DataItem } from '@/types';\r\nimport cache from '@/utils/cache';\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\n\r\ntype ArticleData = [\r\n    string,\r\n    string,\r\n    unknown,\r\n    string,\r\n    string,\r\n    number[],\r\n    string,\r\n    string,\r\n    unknown,\r\n    unknown,\r\n    string[],\r\n    string,\r\n    string[],\r\n    string,\r\n    string,\r\n    unknown,\r\n    string[],\r\n    string,\r\n    string,\r\n    number,\r\n    string[],\r\n    unknown,\r\n    number,\r\n    string[],\r\n    number,\r\n    number,\r\n];\r\n\r\nexport async function fetchItems(queryParam: string): Promise<DataItem[]> {\r\n    const res = await got<string>('https://web.dev/_d/dynamic_content', {\r\n        body: `[null,null,null, \"${queryParam}\",null,null,null,null,31,null,null,null,2]`,\r\n        method: 'post',\r\n    });\r\n    const data = JSON.parse(res.data.replace(/^[^[]*/, '')) as [ArticleData[], number];\r\n    const items = await Promise.all(\r\n        data[0].map((item) => {\r\n            const link = item[6];\r\n            return cache.tryGet(link, async () => {\r\n                const { data: articleHtml } = await got.get<string>(link);\r\n                const $ = load(articleHtml);\r\n                const articleBody = $('.devsite-article-body');\r\n                articleBody.find('.wd-authors').remove();\r\n\r\n                return {\r\n                    title: item[0],\r\n                    pubDate: new Date(item[5][0] * 1e3),\r\n                    description: articleBody.html(),\r\n                    link,\r\n                };\r\n            }) as unknown as DataItem;\r\n        })\r\n    );\r\n\r\n    return items;\r\n}\r\n\r\nexport function hyphen2Pascal(value: string) {\r\n    return value\r\n        .split('-')\r\n        .map((word) => word.charAt(0).toUpperCase() + word.slice(1))\r\n        .join('');\r\n}\r\n"],"mappings":"mIAkCA,eAAsB,EAAW,EAAyC,CACtE,IAAM,EAAM,MAAMA,EAAY,qCAAsC,CAChE,KAAM,qBAAqB,EAAW,4CACtC,OAAQ,SAEN,EAAO,KAAK,MAAM,EAAI,KAAK,QAAQ,SAAU,KAC7C,EAAQ,MAAM,QAAQ,IACxB,EAAK,GAAG,IAAK,GAAS,CAClB,IAAM,EAAO,EAAK,GAClB,OAAOC,EAAM,OAAO,EAAM,SAAY,CAClC,GAAM,CAAE,KAAM,GAAgB,MAAMD,EAAI,IAAY,GAC9C,EAAI,EAAK,GACT,EAAc,EAAE,yBAGtB,OAFA,EAAY,KAAK,eAAe,SAEzB,CACH,MAAO,EAAK,GACZ,QAAS,IAAI,KAAK,EAAK,GAAG,GAAK,KAC/B,YAAa,EAAY,OACzB,aAMhB,OAAO,EAGX,SAAgB,EAAc,EAAe,CACzC,OAAO,EACF,MAAM,KACN,IAAK,GAAS,EAAK,OAAO,GAAG,cAAgB,EAAK,MAAM,IACxD,KAAK"}