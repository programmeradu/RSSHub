import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as n}from"./cache-kimkMTWJ.js";import{art as r}from"./render-CxhTJIsl.js";import{parseDate as i}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as a}from"./got-CdvI2yKX.js";import o from"node:path";import{load as s}from"cheerio";t();const c=async t=>{let{conference:c}=t.req.param(),l=t.req.query(`limit`)?Number.parseInt(t.req.query(`limit`),10):12,u=`https://www.infoq.com`,d=new URL(`${c?`${c}/`:``}presentations/`,u).href,{data:f}=await a(d),p=s(f),m=p(`html`).prop(`lang`),h=p(`ul[data-tax="presentations"] li[data-path]`).slice(0,l).toArray().map(t=>{t=p(t);let n=t.find(`h3.card__title a`),a=n.prop(`title`)||n.text().trim(),s=t.find(`img.card__image`).prop(`src`),c=r(o.join(e,`templates/description-72d2b5fe.art`),{images:s?[{src:s,alt:a}]:void 0,intro:t.find(`p.card__excerpt`).text()}),l=new URL(n.prop(`href`),u).href,d=`infoq-${t.prop(`data-path`).replace(/^\//,``)}`,f=t.find(`div.card__length`).text()||void 0;return{title:a,description:c,pubDate:i(t.find(`span.card__date span`).text().trim()),link:l,category:t.find(`div.card__topics`).toArray().map(e=>p(e).text().trim()),author:t.find(`div.card__authors a`).toArray().map(e=>p(e).text().trim()).join(`/`),guid:d,id:d,content:{html:c,text:t.find(`p.card__excerpt`).text()},image:s,banner:s,language:m,enclosure_url:f?l:void 0,enclosure_type:f?`video/mp4`:void 0,enclosure_title:a,itunes_duration:f}});h=await Promise.all(h.map(t=>n.tryGet(t.link,async()=>{let{data:n}=await a(t.link),c=s(n);c(`div.player`).prevAll().remove(),c(`div.event__list-box`).remove();let l=c(`div.player__actions span`).text()||void 0,u=c(`script[type="text/javascript"]`).text(),d=u.match(/P\.s\s=\s'(.*?)';/)?.[1]??void 0,f=u.match(/P\.c\(.*?isWideScreen,\s'(.*?)',\s/)?.[1]??void 0,p=u.match(/var\stopicsInPage\s=\sJSON\.parse\('(.*?)'\);/)?.[1]?.replace(/\\/g,``)??void 0;d&&c(`div.player`).replaceWith(r(o.join(e,`templates/description-72d2b5fe.art`),{videos:[{src:d,poster:f,type:`video/${d.split(/\./).pop()}`}]}));let h=c(`meta[property="og:title"]`).prop(`content`).trim(),g=c(`meta[property="twitter:image"]`).prop(`content`)||c(`meta[property="og:image"]`).prop(`content`);t.title=h,t.pubDate=i(c(`p.date`).text()),t.link=c(`meta[property="og:url"]`).prop(`content`),t.category=p?JSON.parse(p).map(e=>e.name):c(`meta[name="keywords"]`).prop(`content`).split(/,/),t.author=c(`ul.authors a.author__link`).toArray().map(e=>c(e).text()).join(`/`),c(`div.article__content`).nextAll().remove();let _=r(o.join(e,`templates/description-72d2b5fe.art`),{images:g?[{src:g,alt:h}]:void 0,description:c(`article.article`).html()});return t.description=_,t.content={html:_,text:c(`article.article`).text()},t.image=g,t.banner=g,t.language=m,t.enclosure_url=d,t.enclosure_type=t.enclosure_url?`video/mp4`:void 0,t.enclosure_title=h,t.itunes_duration=l,t})));let g=p(`title`).text(),_=p(`meta[property="og:image"]`).prop(`content`);return{title:g,description:p(`meta[name="description"]`).prop(`content`),link:d,item:h,allowEmpty:!0,image:_,author:g.split(/-/).pop(),language:m}},l={path:`/presentations/:conference?`,name:`Presentations`,url:`www.infoq.com`,maintainers:[`nczitzk`],handler:c,example:`/infoq/presentations`,parameters:{conference:`Conference, all by default, can be found in URL`},description:"::: tip\n  If you subscribe to [InfoQ Live Jan 2024](https://www.infoq.com/infoq-live-jan-2024/presentations/)ï¼Œwhere the URL is `https://www.infoq.com/infoq-live-jan-2024/presentations/`, extract the part `https://www.infoq.com/` to the end, which is `/presentations/`, and use it as the parameter to fill in. Therefore, the route will be [`/infoq/presentations/infoq-live-jan-2024`](https://rsshub.app/infoq/presentations/infoq-live-jan-2024).\n:::\n    ",categories:[`programming`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.infoq.com/presentations`,`www.infoq.com/:conference/presentations`],target:e=>{let t=e.conference;return`/presentations${t?`/${t}`:``}`}}]};export{c as handler,l as route};
//# sourceMappingURL=presentations-QnKlPl9k.js.map