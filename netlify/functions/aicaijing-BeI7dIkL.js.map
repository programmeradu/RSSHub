{"version":3,"file":"aicaijing-BeI7dIkL.js","names":[],"sources":["../../lib/routes/aicaijing/index.ts"],"sourcesContent":["import { Route } from '@/types';\r\n\r\nimport got from '@/utils/got';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport { art } from '@/utils/render';\r\nimport path from 'node:path';\r\n\r\nexport const route: Route = {\r\n    path: '/:category?/:id?',\r\n    name: 'Unknown',\r\n    maintainers: [],\r\n    handler,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const category = ctx.req.param('category') ?? 'latest';\r\n    const id = ctx.req.param('id') ?? 14;\r\n\r\n    const titles = {\r\n        14: '热点 - 最新',\r\n        5: '热点 - 科技',\r\n        9: '热点 - 消费',\r\n        7: '热点 - 出行',\r\n        13: '热点 - 文娱',\r\n        10: '热点 - 教育',\r\n        25: '热点 - 地产',\r\n        11: '热点 - 更多',\r\n        28: '深度 - 出行',\r\n        29: '深度 - 科技',\r\n        31: '深度 - 消费',\r\n        33: '深度 - 教育',\r\n        34: '深度 - 更多',\r\n        8: '深度 - 地产',\r\n        6: '深度 - 文娱',\r\n    };\r\n\r\n    const categories = {\r\n        latest: {\r\n            url: '',\r\n            title: '最新文章',\r\n        },\r\n        recommend: {\r\n            url: '&isRecommend=true',\r\n            title: '推荐资讯',\r\n        },\r\n        cover: {\r\n            url: '&position=1',\r\n            title: '封面文章',\r\n        },\r\n        information: {\r\n            url: `&categoryId=${id}`,\r\n            title: titles[id],\r\n        },\r\n    };\r\n\r\n    const rootUrl = 'https://www.aicaijing.com.cn';\r\n    const apiRootUrl = 'https://api.aicaijing.com.cn';\r\n    const apiUrl = `${apiRootUrl}/article/detail/list?size=${ctx.req.query('limit') ?? 50}&page=1${categories[category].url}`;\r\n\r\n    const response = await got({\r\n        method: 'get',\r\n        url: apiUrl,\r\n    });\r\n\r\n    const items = response.data.data.items.map((item) => ({\r\n        title: item.title,\r\n        link: `${rootUrl}/article/${item.articleId}`,\r\n        author: item.userInfo.nickname,\r\n        pubDate: parseDate(item.createTime),\r\n        category: [item.category.name, ...item.tags.map((t) => t.name)],\r\n        description: art(path.join(__dirname, 'templates/description.art'), {\r\n            image: item.cover,\r\n            description: item.content,\r\n        }),\r\n    }));\r\n\r\n    return {\r\n        title: `AI 财经社 - ${categories[category].title}`,\r\n        link: rootUrl,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"qYAOA,MAAa,EAAe,CACxB,KAAM,mBACN,KAAM,UACN,YAAa,GACb,WAGJ,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAW,EAAI,IAAI,MAAM,aAAe,SACxC,EAAK,EAAI,IAAI,MAAM,OAAS,GAE5B,EAAS,CACX,GAAI,UACJ,EAAG,UACH,EAAG,UACH,EAAG,UACH,GAAI,UACJ,GAAI,UACJ,GAAI,UACJ,GAAI,UACJ,GAAI,UACJ,GAAI,UACJ,GAAI,UACJ,GAAI,UACJ,GAAI,UACJ,EAAG,UACH,EAAG,WAGD,EAAa,CACf,OAAQ,CACJ,IAAK,GACL,MAAO,QAEX,UAAW,CACP,IAAK,oBACL,MAAO,QAEX,MAAO,CACH,IAAK,cACL,MAAO,QAEX,YAAa,CACT,IAAK,eAAe,IACpB,MAAO,EAAO,KAIhB,EAAU,+BAEV,EAAS,yDAA0C,EAAI,IAAI,MAAM,UAAY,GAAG,SAAS,EAAW,GAAU,MAE9G,EAAW,MAAM,EAAI,CACvB,OAAQ,MACR,IAAK,IAGH,EAAQ,EAAS,KAAK,KAAK,MAAM,IAAK,IAAU,CAClD,MAAO,EAAK,MACZ,KAAM,GAAG,EAAQ,WAAW,EAAK,YACjC,OAAQ,EAAK,SAAS,SACtB,QAAS,EAAU,EAAK,YACxB,SAAU,CAAC,EAAK,SAAS,KAAM,GAAG,EAAK,KAAK,IAAK,GAAM,EAAE,OACzD,YAAa,EAAI,EAAA,KAAA,EAAA,sCAAmD,CAChE,MAAO,EAAK,MACZ,YAAa,EAAK,aAI1B,MAAO,CACH,MAAO,YAAY,EAAW,GAAU,QACxC,KAAM,EACN,KAAM"}