{"version":3,"file":"mirrormedia-BXep4qfR.js","names":["route: Route","ofetch"],"sources":["../../lib/routes/mirrormedia/index.ts"],"sourcesContent":["import { Route } from '@/types';\r\n\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport ofetch from '@/utils/ofetch';\r\nimport { getArticle } from './utils';\r\n\r\nexport const route: Route = {\r\n    path: '/',\r\n    categories: ['traditional-media'],\r\n    example: '/mirrormedia',\r\n    parameters: {},\r\n    name: '首页',\r\n    maintainers: ['dzx-dzx'],\r\n    radar: [\r\n        {\r\n            source: ['mirrormedia.mg'],\r\n        },\r\n    ],\r\n    handler,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const rootUrl = 'https://www.mirrormedia.mg';\r\n\r\n    const response = await ofetch('https://v3-statics.mirrormedia.mg/files/json/post_external01.json');\r\n\r\n    const items = [...response.choices.map((e) => ({ __from: 'choices', ...e })), ...response.latest.map((e) => ({ __from: 'latest', ...e }))]\r\n        .map((e) => ({\r\n            title: e.title,\r\n            pubDate: parseDate(e.publishedDate),\r\n            category: [...(e.sections ?? []).map((_) => _.name), e.__from],\r\n            link: `${rootUrl}/${e.style === '' ? 'external' : 'story'}/${e.slug}`,\r\n        }))\r\n        .slice(0, ctx.req.query('limit') ? Number.parseInt(ctx.req.query('limit'), 10) : 20);\r\n\r\n    const list = await Promise.all(items.map((item) => getArticle(item)));\r\n\r\n    return {\r\n        title: '鏡週刊 Mirror Media',\r\n        link: rootUrl,\r\n        item: list,\r\n    };\r\n}\r\n"],"mappings":"6SAMA,MAAaA,EAAe,CACxB,KAAM,IACN,WAAY,CAAC,qBACb,QAAS,eACT,WAAY,GACZ,KAAM,KACN,YAAa,CAAC,WACd,MAAO,CACH,CACI,OAAQ,CAAC,oBAGjB,WAGJ,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAU,6BAEV,EAAW,MAAMC,EAAO,qEAExB,EAAQ,CAAC,GAAG,EAAS,QAAQ,IAAK,IAAO,CAAE,OAAQ,UAAW,GAAG,KAAO,GAAG,EAAS,OAAO,IAAK,IAAO,CAAE,OAAQ,SAAU,GAAG,MAC/H,IAAK,IAAO,CACT,MAAO,EAAE,MACT,QAAS,EAAU,EAAE,eACrB,SAAU,CAAC,IAAI,EAAE,UAAY,IAAI,IAAK,GAAM,EAAE,MAAO,EAAE,QACvD,KAAM,GAAG,EAAQ,GAAG,EAAE,QAAU,GAAK,WAAa,QAAQ,GAAG,EAAE,UAElE,MAAM,EAAG,EAAI,IAAI,MAAM,SAAW,OAAO,SAAS,EAAI,IAAI,MAAM,SAAU,IAAM,IAE/E,EAAO,MAAM,QAAQ,IAAI,EAAM,IAAK,GAAS,EAAW,KAE9D,MAAO,CACH,MAAO,mBACP,KAAM,EACN,KAAM"}