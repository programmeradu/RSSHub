{"version":3,"file":"user-feed-CeU8umwA.js","names":["MarkdownIt","route: Route","got"],"sources":["../../lib/routes/luogu/user-feed.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport got from '@/utils/got';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport MarkdownIt from 'markdown-it';\r\nimport { getUserInfoFromUID } from './utils';\r\nconst md = MarkdownIt();\r\n\r\nexport const route: Route = {\r\n    path: '/user/feed/:uid',\r\n    categories: ['programming'],\r\n    example: '/luogu/user/feed/1',\r\n    parameters: { uid: '用户 UID' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['luogu.com/user/:uid'],\r\n        },\r\n        {\r\n            source: ['luogu.com.cn/user/:uid'],\r\n        },\r\n    ],\r\n    name: '用户动态',\r\n    maintainers: ['solstice23'],\r\n    handler,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const uid = ctx.req.param('uid');\r\n    const userInfo = await getUserInfoFromUID(uid);\r\n    const { data: response } = await got(`https://www.luogu.com.cn/api/feed/list?user=${uid}`);\r\n\r\n    const data = response.feeds.result;\r\n\r\n    return {\r\n        title: `${userInfo.name} 的洛谷动态`,\r\n        description: userInfo.description,\r\n        image: userInfo.avatar,\r\n        link: `https://www.luogu.com.cn/user/${uid}#activity`,\r\n        allowEmpty: true,\r\n        item: data.map((item) => ({\r\n            title: item.content,\r\n            description: md.render(item.content),\r\n            pubDate: parseDate(item.time, 'X'),\r\n            author: userInfo.name,\r\n            link: `https://www.luogu.com.cn/user/${uid}#activity`,\r\n            guid: item.id,\r\n        })),\r\n    };\r\n}\r\n"],"mappings":"qYAKA,MAAM,EAAKA,IAEEC,EAAe,CACxB,KAAM,kBACN,WAAY,CAAC,eACb,QAAS,qBACT,WAAY,CAAE,IAAK,UACnB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,wBAEb,CACI,OAAQ,CAAC,4BAGjB,KAAM,OACN,YAAa,CAAC,cACd,WAGJ,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAM,EAAI,IAAI,MAAM,OACpB,EAAW,MAAM,EAAmB,GACpC,CAAE,KAAM,GAAa,MAAMC,EAAI,+CAA+C,KAE9E,EAAO,EAAS,MAAM,OAE5B,MAAO,CACH,MAAO,GAAG,EAAS,KAAK,QACxB,YAAa,EAAS,YACtB,MAAO,EAAS,OAChB,KAAM,iCAAiC,EAAI,WAC3C,WAAY,GACZ,KAAM,EAAK,IAAK,IAAU,CACtB,MAAO,EAAK,QACZ,YAAa,EAAG,OAAO,EAAK,SAC5B,QAAS,EAAU,EAAK,KAAM,KAC9B,OAAQ,EAAS,KACjB,KAAM,iCAAiC,EAAI,WAC3C,KAAM,EAAK"}