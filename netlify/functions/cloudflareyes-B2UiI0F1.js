import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{art as n}from"./render-CxhTJIsl.js";import{parseDate as r}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as i}from"./got-CdvI2yKX.js";import{timezone as a}from"./timezone-BrNu6iXe.js";import o from"node:path";import{load as s}from"cheerio";t();const c={CM:`中国移动`,CU:`中国联通`,CT:`中国电信`},l={path:`/cloudflareyes/:type?`,categories:[`other`],example:`/hostmonit/cloudflareyes`,parameters:{type:`类型，见下表，默认为 v4`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`CloudFlareYes`,maintainers:[`nczitzk`],handler:u,description:`| v4 | v6 |
| -- | -- |
|    | v6 |`};async function u(t){let{type:l=`v4`}=t.req.param(),u=t.req.query(`limit`)?Number.parseInt(t.req.query(`limit`),10):30,d=`hostmonit.com`,f=`CloudFlareYes${l===`v6`?l.toUpperCase():``}`,p=`https://stock.${d}`,m=`https://api.${d}`,h=new URL(`get_optimization_ip`,m).href,g=new URL(f,p).href,{data:_}=await i.post(h,{json:{key:`iDetkOys`,...l===`v6`?{type:`v6`}:{}}}),v=_.info.slice(0,u).map(t=>{let i=t.ip,s=t.latency===void 0?void 0:`${t.latency}ms`,l=t.line===void 0?void 0:Object.hasOwn(c,t.line)?c[t.line]:t.line,u=t.loss===void 0?void 0:`${t.loss}%`,p=t.node,m=t.speed===void 0?void 0:`${t.speed} KB/s`,h=a(r(t.time),8);return{title:n(o.join(e,`templates/title-c8d56156.art`),{line:l,latency:s,loss:u,speed:m,node:p,ip:i}),link:g,description:n(o.join(e,`templates/description-e001a289.art`),{line:l,node:p,ip:i,latency:s,loss:u,speed:m}),author:p,category:[l,s,u,p].filter(Boolean),guid:`${d}-${f}-${i}#${h.toISOString()}`,pubDate:h}}),{data:y}=await i(g),b=s(y),x=new URL(b(`link[rel="icon"]`).prop(`href`),p).href;return{item:v,title:b(`title`).text().replace(/- .*$/,`- ${f}`),link:g,description:b(`meta[name="description"]`).prop(`content`),language:b(`html`).prop(`lang`),icon:x,logo:x,subtitle:f,author:b(`title`).text().split(/\s-/)[0],allowEmpty:!0}}export{l as route};
//# sourceMappingURL=cloudflareyes-B2UiI0F1.js.map