{"version":3,"file":"phys-CijRYR9a.js","names":["route: Route","ofetch"],"sources":["../../lib/routes/ncku/phys.ts"],"sourcesContent":["import type { Route } from '@/types';\r\nimport { CheerioAPI, load } from 'cheerio';\r\nimport ofetch from '@/utils/ofetch';\r\n\r\nconst currentURL = (catagory: string) => `https://phys.ncku.edu.tw/news/${catagory === '_all' ? '' : catagory}`;\r\n\r\nconst catagories = {\r\n    '24': '物理系',\r\n    scholarship: '獎助學金',\r\n    admission: '招生與錄取報到',\r\n    'course-announcement': '助教公告',\r\n    'bachelor-announcement': '大學部',\r\n    'master-announcement': '研究所',\r\n    graduation: '畢業離校',\r\n    'student-guide': '學生手冊與新生入學',\r\n    honor: '榮譽榜',\r\n    career: '求才公告',\r\n    others: '其他',\r\n    _all: '所有訊息',\r\n};\r\n\r\nexport const route: Route = {\r\n    'zh-TW': {\r\n        name: '國立成功大學物理系公告',\r\n    },\r\n    name: 'Phys News',\r\n    description: `| 分類 | catagory |\r\n| ---- | ---- |\r\n| 物理系 | 24 |\r\n| 獎助學金 | scholarship |\r\n| 招生與錄取報到 | admission |\r\n| 助教公告 | course-announcement |\r\n| 大學部 | bachelor-announcement |\r\n| 研究所 | master-announcement |\r\n| 畢業離校 | graduation |\r\n| 學生手冊與新生入學 | student-guide |\r\n| 榮譽榜 | honor |\r\n| 求才公告 | career |\r\n| 其他 | others |\r\n| 所有訊息 | _all |\r\n`,\r\n    path: '/phys/:catagory?',\r\n    parameters: {\r\n        catagory: 'catagory, default is _all',\r\n    },\r\n    categories: ['university'],\r\n    example: '/ncku/phys/_all',\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['phys.ncku.edu.tw/news/'],\r\n            target: '/phys/_all',\r\n        },\r\n        {\r\n            source: ['phys.ncku.edu.tw/news/:catagory/'],\r\n            target: '/phys/:catagory',\r\n        },\r\n    ],\r\n    maintainers: ['simbafs'],\r\n    handler: async (ctx) => {\r\n        let catagory = ctx.req.param('catagory') ?? '_all';\r\n        if (catagories[catagory] === undefined) {\r\n            catagory = '_all';\r\n        }\r\n\r\n        const $ = await ofetch<CheerioAPI>(currentURL(catagory), {\r\n            parseResponse: load,\r\n        });\r\n\r\n        const item = $('.newsList .Txt')\r\n            .toArray()\r\n            .map((e) => ({\r\n                title: $('a', e).text(),\r\n                pubDate: new Date(\r\n                    $('.newsDate', e)\r\n                        .text()\r\n                        .match(/\\d{4}(?: \\/ \\d{2}){2}/)?.[0] || ''\r\n                ),\r\n                link: $('a', e).attr('href'),\r\n                catagory: $('.newIcon', e).text(),\r\n            }));\r\n\r\n        return {\r\n            title: `成大物理系公告 - ${catagories[catagory]}`,\r\n            link: currentURL(catagory),\r\n            item,\r\n        };\r\n    },\r\n};\r\n"],"mappings":"0MAIA,MAAM,EAAc,GAAqB,iCAAiC,IAAa,OAAS,GAAK,IAE/F,EAAa,CACf,GAAM,MACN,YAAa,OACb,UAAW,UACX,sBAAuB,OACvB,wBAAyB,MACzB,sBAAuB,MACvB,WAAY,OACZ,gBAAiB,YACjB,MAAO,MACP,OAAQ,OACR,OAAQ,KACR,KAAM,QAGGA,EAAe,CACxB,QAAS,CACL,KAAM,eAEV,KAAM,YACN,YAAa;;;;;;;;;;;;;;EAeb,KAAM,mBACN,WAAY,CACR,SAAU,6BAEd,WAAY,CAAC,cACb,QAAS,kBACT,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,0BACT,OAAQ,cAEZ,CACI,OAAQ,CAAC,oCACT,OAAQ,oBAGhB,YAAa,CAAC,WACd,QAAS,KAAO,IAAQ,CACpB,IAAI,EAAW,EAAI,IAAI,MAAM,aAAe,OACxC,EAAW,KAAc,IAAA,KACzB,EAAW,QAGf,IAAM,EAAI,MAAMC,EAAmB,EAAW,GAAW,CACrD,cAAe,IAGb,EAAO,EAAE,kBACV,UACA,IAAK,IAAO,CACT,MAAO,EAAE,IAAK,GAAG,OACjB,QAAS,IAAI,KACT,EAAE,YAAa,GACV,OACA,MAAM,2BAA2B,IAAM,IAEhD,KAAM,EAAE,IAAK,GAAG,KAAK,QACrB,SAAU,EAAE,WAAY,GAAG,UAGnC,MAAO,CACH,MAAO,aAAa,EAAW,KAC/B,KAAM,EAAW,GACjB"}