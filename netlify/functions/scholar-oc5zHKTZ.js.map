{"version":3,"file":"scholar-oc5zHKTZ.js","names":["route: Route","got","$"],"sources":["../../lib/routes/google/scholar.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\n\r\nexport const route: Route = {\r\n    path: '/scholar/:query',\r\n    categories: ['journal'],\r\n    example: '/google/scholar/data+visualization',\r\n    parameters: { query: 'query statement which supports「Basic」and「Advanced」modes' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: true,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    name: 'Scholar Keywords Monitoring',\r\n    maintainers: ['HenryQW'],\r\n    handler,\r\n    description: `::: warning\r\n  Google Scholar has strict anti-crawling mechanism implemented, the demo below doesn't guarantee availability. Please deploy your own instance as it might increase the stability.\r\n:::\r\n\r\n  1.  Basic mode, sample query is the keywords desired, eg.「data visualization」, [https://rsshub.app/google/scholar/data+visualization](https://rsshub.app/google/scholar/data+visualization).\r\n\r\n  2.  Advanced mode, visit [Google Scholar](https://scholar.google.com/schhp?hl=en\\&as_sdt=0,5), click the top left corner and select「Advanced Search」, fill in your conditions and submit the search. The URL should look like this: [https://scholar.google.com/scholar?as\\_q=data+visualization\\&as\\_epq=\\&as\\_oq=\\&as\\_eq=\\&as\\_occt=any\\&as\\_sauthors=\\&as\\_publication=\\&as\\_ylo=2018\\&as\\_yhi=\\&hl=en\\&as\\_sdt=0%2C5](https://scholar.google.com/scholar?as_q=data+visualization\\&as_epq=\\&as_oq=\\&as_eq=\\&as_occt=any\\&as_sauthors=\\&as_publication=\\&as_ylo=2018\\&as_yhi=\\&hl=en\\&as_sdt=0%2C5), copy everything after \\`https://scholar.google.com/scholar?\\` from the URL and use it as the query for this route. The complete URL for the above example should look like this: [https://rsshub.app/google/scholar/as\\_q=data+visualization\\&as\\_epq=\\&as\\_oq=\\&as\\_eq=\\&as\\_occt=any\\&as\\_sauthors=\\&as\\_publication=\\&as\\_ylo=2018\\&as\\_yhi=\\&hl=en\\&as\\_sdt=0%2C5](https://rsshub.app/google/scholar/as_q=data+visualization\\&as_epq=\\&as_oq=\\&as_eq=\\&as_occt=any\\&as_sauthors=\\&as_publication=\\&as_ylo=2018\\&as_yhi=\\&hl=en\\&as_sdt=0%2C5).`,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    let params = ctx.req.param('query');\r\n    let query = params;\r\n    let description = `Google Scholar Monitor Query: ${query}`;\r\n\r\n    if (params.includes('as_q=')) {\r\n        const reg = /as_q=(.*?)&/g;\r\n        query = reg.exec(params)[1];\r\n        description = `Google Scholar Monitor Advanced Query: ${query}`;\r\n    } else {\r\n        params = 'q=' + params;\r\n    }\r\n\r\n    const url = `https://scholar.google.com/scholar?${params}`;\r\n\r\n    const response = await got({\r\n        method: 'get',\r\n        url,\r\n    });\r\n\r\n    const $ = load(response.data);\r\n    const list = $('#gs_res_ccl_mid .gs_r.gs_or.gs_scl .gs_ri').toArray();\r\n\r\n    const out = list.map((item) => {\r\n        const $ = load(item);\r\n        const itemUrl = $('h3 a').attr('href');\r\n        return {\r\n            title: $('h3 a').text(),\r\n            author: $('.gs_a').text(),\r\n            description: $('.gs_rs').text(),\r\n            link: itemUrl,\r\n            guid: itemUrl,\r\n        };\r\n    });\r\n\r\n    return {\r\n        title: `Google Scholar Monitor: ${query}`,\r\n        link: url,\r\n        description,\r\n        item: out,\r\n    };\r\n}\r\n"],"mappings":"+PAIA,MAAaA,EAAe,CACxB,KAAM,kBACN,WAAY,CAAC,WACb,QAAS,qCACT,WAAY,CAAE,MAAO,2DACrB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,KAAM,8BACN,YAAa,CAAC,WACd,UACA,YAAa;;;;;;kiCASjB,eAAe,EAAQ,EAAK,CACxB,IAAI,EAAS,EAAI,IAAI,MAAM,SACvB,EAAQ,EACR,EAAc,iCAAiC,IAEnD,GAAI,EAAO,SAAS,SAAU,CAC1B,IAAM,EAAM,eACZ,EAAQ,EAAI,KAAK,GAAQ,GACzB,EAAc,0CAA0C,SAExD,EAAS,KAAO,EAGpB,IAAM,EAAM,sCAAsC,IAE5C,EAAW,MAAMC,EAAI,CACvB,OAAQ,MACR,QAGE,EAAI,EAAK,EAAS,MAClB,EAAO,EAAE,6CAA6C,UAEtD,EAAM,EAAK,IAAK,GAAS,CAC3B,IAAMC,EAAI,EAAK,GACT,EAAUA,EAAE,QAAQ,KAAK,QAC/B,MAAO,CACH,MAAOA,EAAE,QAAQ,OACjB,OAAQA,EAAE,SAAS,OACnB,YAAaA,EAAE,UAAU,OACzB,KAAM,EACN,KAAM,KAId,MAAO,CACH,MAAO,2BAA2B,IAClC,KAAM,EACN,cACA,KAAM"}