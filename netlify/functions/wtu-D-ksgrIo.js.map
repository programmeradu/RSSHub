{"version":3,"file":"wtu-D-ksgrIo.js","names":["route: Route","got"],"sources":["../../lib/routes/wtu/index.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport got from '@/utils/got';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport timezone from '@/utils/timezone';\r\n\r\nexport const route: Route = {\r\n    path: '/:type',\r\n    categories: ['university'],\r\n    example: '/wtu/2',\r\n    parameters: { type: '公告类型，详见表格' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: true,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    name: '信息门户公告',\r\n    maintainers: ['loyio'],\r\n    handler,\r\n    description: `| 公告类型 | 通知公告 | 教务信息 | 科研动态 |\r\n| -------- | -------- | -------- | -------- |\r\n| 参数     | 1        | 2        | 3        |`,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const apiUrl = 'https://ehall.wtu.edu.cn/wtu/api/queryBulletinListByConditional.do?pageNum=1&pageSize=20&columnId=';\r\n    const listUrl = 'https://ehall.wtu.edu.cn/new/list.html?type=';\r\n    const psgUrl = 'https://ehall.wtu.edu.cn/new/detail-word.html?';\r\n    const map = new Map([\r\n        [1, { title: '通知公告', type: '2', id: '1994a3b58bef4ee887e1efc19881decd' }],\r\n        [2, { title: '教务信息', type: '6', id: '36d47fcd3e774f289adfef1d93138a9d' }],\r\n        [3, { title: '科研动态', type: '7', id: '48e8abfb983b4e4486b69feacad1dc1b' }],\r\n    ]);\r\n\r\n    const typeInt = Number.parseInt(ctx.req.param('type'));\r\n    const value = map.get(typeInt);\r\n    const title = value.title;\r\n    const columnId = value.id;\r\n    const type = value.type;\r\n    const res = await got({\r\n        method: 'get',\r\n        url: `${apiUrl}${columnId}`,\r\n    });\r\n    const resJson = res.data.bulletinList;\r\n\r\n    return {\r\n        title: `${title} - 武汉纺织大学信息门户`,\r\n        link: `${listUrl}${type}`,\r\n        description: `${title} - 武汉纺织大学信息门户`,\r\n        item: resJson.map((item) => ({\r\n            title: item.TITLE,\r\n            pubDate: timezone(parseDate(item.CREATE_TIME), 8),\r\n            link: item.GOTO_URL ?? `${psgUrl}type=${type}?bulletinId=${item.WID}`,\r\n            author: item.PUBLISH_USER_DEPT_NAME,\r\n        })),\r\n    };\r\n}\r\n"],"mappings":"uUAKA,MAAaA,EAAe,CACxB,KAAM,SACN,WAAY,CAAC,cACb,QAAS,SACT,WAAY,CAAE,KAAM,aACpB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,KAAM,SACN,YAAa,CAAC,SACd,UACA,YAAa;;8CAKjB,eAAe,EAAQ,EAAK,CACxB,IAGM,EAAM,IAAI,IAAI,CAChB,CAAC,EAAG,CAAE,MAAO,OAAQ,KAAM,IAAK,GAAI,qCACpC,CAAC,EAAG,CAAE,MAAO,OAAQ,KAAM,IAAK,GAAI,qCACpC,CAAC,EAAG,CAAE,MAAO,OAAQ,KAAM,IAAK,GAAI,uCAGlC,EAAU,OAAO,SAAS,EAAI,IAAI,MAAM,SACxC,EAAQ,EAAI,IAAI,GAChB,EAAQ,EAAM,MACd,EAAW,EAAM,GACjB,EAAO,EAAM,KACb,EAAM,MAAMC,EAAI,CAClB,OAAQ,MACR,IAAK,qGAAY,MAEf,EAAU,EAAI,KAAK,aAEzB,MAAO,CACH,MAAO,GAAG,EAAM,eAChB,KAAM,+CAAa,IACnB,YAAa,GAAG,EAAM,eACtB,KAAM,EAAQ,IAAK,IAAU,CACzB,MAAO,EAAK,MACZ,QAAS,EAAS,EAAU,EAAK,aAAc,GAC/C,KAAM,EAAK,UAAY,sDAAiB,EAAK,cAAc,EAAK,MAChE,OAAQ,EAAK"}