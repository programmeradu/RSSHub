{"version":3,"file":"60s-BA1CdnxM.js","names":["limit: number","baseUrl: string","ofetch","categoryId: number | undefined","categorySlug: string | undefined","targetUrl: string","$: CheerioAPI","items: DataItem[]","title: string","description: string | undefined","pubDate: number | string","linkUrl: string | undefined","categories: string[]","authors: DataItem['author']","guid: string","image: string | undefined","updated: number | string","processedItem: DataItem","route: Route"],"sources":["../../lib/routes/aa1/60s.ts"],"sourcesContent":["import { type Data, type DataItem, type Route, ViewType } from '@/types';\r\n\r\nimport ofetch from '@/utils/ofetch';\r\nimport { parseDate } from '@/utils/parse-date';\r\n\r\nimport { type CheerioAPI, load } from 'cheerio';\r\nimport { type Context } from 'hono';\r\n\r\nexport const handler = async (ctx: Context): Promise<Data> => {\r\n    const { category } = ctx.req.param();\r\n    const limit: number = Number.parseInt(ctx.req.query('limit') ?? '100', 10);\r\n\r\n    const apiSlug = 'wp-json/wp/v2';\r\n    const baseUrl: string = 'https://60s.aa1.cn';\r\n\r\n    const apiUrl = new URL(`${apiSlug}/posts`, baseUrl).href;\r\n    const apiSearchUrl = new URL(`${apiSlug}/categories`, baseUrl).href;\r\n\r\n    const searchResponse = await ofetch(apiSearchUrl, {\r\n        query: {\r\n            search: category,\r\n        },\r\n    });\r\n\r\n    const categoryObj = searchResponse.find((c) => c.slug === category || c.name === category);\r\n    const categoryId: number | undefined = categoryObj?.id ?? undefined;\r\n    const categorySlug: string | undefined = categoryObj?.slug ?? undefined;\r\n\r\n    const response = await ofetch(apiUrl, {\r\n        query: {\r\n            _embed: 'true',\r\n            per_page: limit,\r\n            categories: categoryId,\r\n        },\r\n    });\r\n\r\n    const targetUrl: string = new URL(categorySlug ? `category/${categorySlug}` : '', baseUrl).href;\r\n\r\n    const targetResponse = await ofetch(targetUrl);\r\n    const $: CheerioAPI = load(targetResponse);\r\n    const language = $('html').attr('lang') ?? 'zh';\r\n\r\n    let items: DataItem[] = [];\r\n\r\n    items = response.slice(0, limit).map((item): DataItem => {\r\n        const title: string = item.title?.rendered ?? item.title;\r\n        const description: string | undefined = item.content.rendered;\r\n        const pubDate: number | string = item.date_gmt;\r\n        const linkUrl: string | undefined = item.link;\r\n\r\n        const terminologies = item._embedded?.['wp:term'];\r\n\r\n        const categories: string[] = terminologies?.flat().map((c) => c.name) ?? [];\r\n        const authors: DataItem['author'] =\r\n            item._embedded?.author.map((author) => ({\r\n                name: author.name,\r\n                url: author.link,\r\n                avatar: author.avatar_urls?.['96'] ?? author.avatar_urls?.['48'] ?? author.avatar_urls?.['24'] ?? undefined,\r\n            })) ?? [];\r\n        const guid: string = item.guid?.rendered ?? item.guid;\r\n        const image: string | undefined = item._embedded?.['wp:featuredmedia']?.[0].source_url ?? undefined;\r\n        const updated: number | string = item.modified_gmt ?? pubDate;\r\n\r\n        const processedItem: DataItem = {\r\n            title,\r\n            description,\r\n            pubDate: pubDate ? parseDate(pubDate) : undefined,\r\n            link: linkUrl ?? guid,\r\n            category: categories,\r\n            author: authors,\r\n            guid,\r\n            id: guid,\r\n            content: {\r\n                html: description,\r\n                text: description,\r\n            },\r\n            image,\r\n            banner: image,\r\n            updated: updated ? parseDate(updated) : undefined,\r\n            language,\r\n        };\r\n\r\n        return processedItem;\r\n    });\r\n\r\n    const title: string = $('title').text();\r\n\r\n    return {\r\n        title,\r\n        description: $('meta[name=\"description\"]').attr('content'),\r\n        link: targetUrl,\r\n        item: items,\r\n        allowEmpty: true,\r\n        image: $('header#header-div img').attr('src'),\r\n        author: title.split(/-/).pop(),\r\n        language,\r\n        id: targetUrl,\r\n    };\r\n};\r\n\r\nexport const route: Route = {\r\n    path: '/60s/:category?',\r\n    name: '每日新闻',\r\n    url: '60s.aa1.cn',\r\n    maintainers: ['nczitzk'],\r\n    handler,\r\n    example: '/aa1/60s/news',\r\n    parameters: {\r\n        category: {\r\n            description: '分类，默认为全部，可在对应分类页 URL 中找到',\r\n            options: [\r\n                {\r\n                    label: '全部',\r\n                    value: '',\r\n                },\r\n                {\r\n                    label: '新闻词文章数据',\r\n                    value: 'freenewsdata',\r\n                },\r\n                {\r\n                    label: '最新',\r\n                    value: 'new',\r\n                },\r\n                {\r\n                    label: '本平台同款自动发文章插件',\r\n                    value: '1',\r\n                },\r\n                {\r\n                    label: '每天60秒读懂世界',\r\n                    value: 'news',\r\n                },\r\n            ],\r\n        },\r\n    },\r\n    description: `:::tip\r\n订阅 [每天60秒读懂世界](https://60s.aa1.cn/category/news)，其源网址为 \\`https://60s.aa1.cn/category/news\\`，请参考该 URL 指定部分构成参数，此时路由为 [\\`/aa1/60s/news\\`](https://rsshub.app/aa1/60s/news) 或 [\\`/aa1/60s/每天60秒读懂世界\\`](https://rsshub.app/aa1/60s/每天60秒读懂世界)。\r\n:::\r\n\r\n| 分类                                                       | ID                                                      |\r\n| ---------------------------------------------------------- | ------------------------------------------------------- |\r\n| [全部](https://60s.aa1.cn)                                 | [<空>](https://rsshub.app/aa1/60s)                      |\r\n| [新闻词文章数据](https://60s.aa1.cn/category/freenewsdata) | [freenewsdata](https://rsshub.app/aa1/60s/freenewsdata) |\r\n| [最新](https://60s.aa1.cn/category/new)                    | [new](https://rsshub.app/aa1/60s/new)                   |\r\n| [本平台同款自动发文章插件](https://60s.aa1.cn/category/1)  | [1](https://rsshub.app/aa1/60s/1)                       |\r\n| [每天 60 秒读懂世界](https://60s.aa1.cn/category/news)     | [news](https://rsshub.app/aa1/60s/news)                 |\r\n`,\r\n    categories: ['new-media'],\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportRadar: true,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['60s.aa1.cn', '60s.aa1.cn/category/:category'],\r\n            target: '/60s/:category',\r\n        },\r\n        {\r\n            title: '全部',\r\n            source: ['60s.aa1.cn'],\r\n            target: '/60s',\r\n        },\r\n        {\r\n            title: '新闻词文章数据',\r\n            source: ['60s.aa1.cn/category/freenewsdata'],\r\n            target: '/60s/freenewsdata',\r\n        },\r\n        {\r\n            title: '最新',\r\n            source: ['60s.aa1.cn/category/new'],\r\n            target: '/60s/new',\r\n        },\r\n        {\r\n            title: '本平台同款自动发文章插件',\r\n            source: ['60s.aa1.cn/category/1'],\r\n            target: '/60s/1',\r\n        },\r\n        {\r\n            title: '每天60秒读懂世界',\r\n            source: ['60s.aa1.cn/category/news'],\r\n            target: '/60s/news',\r\n        },\r\n    ],\r\n    view: ViewType.Articles,\r\n};\r\n"],"mappings":"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"}