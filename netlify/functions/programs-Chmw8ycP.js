import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as n}from"./cache-kimkMTWJ.js";import{art as r}from"./render-CxhTJIsl.js";import{parseDate as i}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as a}from"./got-CdvI2yKX.js";import o from"node:path";import s from"dayjs";import{load as c}from"cheerio";t();const l={path:`/programs`,categories:[`program-update`],example:`/appstorrent/programs`,name:`Programs`,maintainers:[`xzzpig`],handler:u,url:`appstorrent.ru/programs/`};async function u(t){let l=t?.req.query(`limit`)?Number.parseInt(t?.req.query(`limit`)??`20`):20,u=`https://appstorrent.ru`,d=`${u}/programs/`,f={http2:!0},p=await a(d,f),m=c(p.data),h=m(`article.soft-item:not(.locked)`).slice(0,l).toArray().map(e=>{let t=m(e);return{title:t.find(`.subtitle`).text().trim(),link:t.find(`.subtitle a`).attr(`href`),category:[t.find(`.info .category`).text().trim()],version:t.find(`.version`).text(),architecture:t.find(`.architecture`).text().trim(),size:t.find(`.size`).text().trim()}}),g=await Promise.all(h.map(t=>n.tryGet(t.link,async()=>{let n=await a(t.link,f),l=c(n.data),d=i(l(`.tech-info .date-news a`).attr(`href`)?.replace(`https://appstorrent.ru/`,``)??``);return{title:t.title,link:t.link,category:t.category,pubDate:d,description:r(o.join(e,`templates/description-8c629e3d.art`),{cover:u+l(`.main-title img`).attr(`src`)?.trim(),title:t.title,pubDate:s(d).format(`YYYY-MM-DD`),version:t.version,architecture:t.architecture,compatibility:l(`div.right > div.info > div.right-container > div:nth-child(5) > div > span:nth-child(2) > a`).text(),size:t.size,activation:l(`div.right > div.info > div.right-container > div:nth-child(4) > div > span:nth-child(2) > a`).text(),description:l(`.content .body-content`).first().text(),changelog:l(`.content .body-content`).last().text(),screenshots:l(`.screenshots img`).toArray().map(e=>l(e).attr(`src`)).map(e=>u+e)})}})));return{title:m(`title`).text(),link:d.toString(),allowEmpty:!0,item:g}}export{l as route};
//# sourceMappingURL=programs-Chmw8ycP.js.map