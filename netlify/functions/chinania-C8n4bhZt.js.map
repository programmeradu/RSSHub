{"version":3,"file":"chinania-C8n4bhZt.js","names":["got","cache","title","route: Route"],"sources":["../../lib/routes/chinania/index.ts"],"sourcesContent":["import { Route } from '@/types';\r\n\r\nimport cache from '@/utils/cache';\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\nimport { parseDate } from '@/utils/parse-date';\r\n\r\nexport const handler = async (ctx) => {\r\n    const { category = 'xiehuidongtai/xiehuitongzhi' } = ctx.req.param();\r\n    const limit = ctx.req.query('limit') ? Number.parseInt(ctx.req.query('limit'), 10) : 25;\r\n\r\n    const rootUrl = 'https://www.chinania.org.cn';\r\n    const currentUrl = new URL(`html/${category.endsWith('/') ? category : `${category}/`}`, rootUrl).href;\r\n\r\n    const { data: response } = await got(currentUrl);\r\n\r\n    const $ = load(response);\r\n\r\n    const language = $('html').prop('lang');\r\n\r\n    let items = $('ul.notice_list_ul li')\r\n        .slice(0, limit)\r\n        .toArray()\r\n        .map((item) => {\r\n            item = $(item);\r\n\r\n            return {\r\n                title: item.find('p').first().text(),\r\n                pubDate: parseDate(item.find('p').last().text()),\r\n                link: item.find('a').prop('href'),\r\n                language,\r\n            };\r\n        });\r\n\r\n    items = await Promise.all(\r\n        items.map((item) =>\r\n            cache.tryGet(item.link, async () => {\r\n                const { data: detailResponse } = await got(item.link);\r\n\r\n                const $$ = load(detailResponse);\r\n\r\n                const title = $$('div.article_title p').first().text();\r\n                const description = $$('div.article_content').html();\r\n\r\n                item.title = title;\r\n                item.description = description;\r\n                item.pubDate = parseDate($$('div.article_title p').last().text().split('：'));\r\n                item.author = $$(\"meta[name='keywords']\").prop('content');\r\n                item.content = {\r\n                    html: description,\r\n                    text: $$('div.article_content').text(),\r\n                };\r\n                item.language = language;\r\n\r\n                return item;\r\n            })\r\n        )\r\n    );\r\n\r\n    const title = $('title').text();\r\n    const image = new URL($('img.logo').prop('src'), rootUrl).href;\r\n\r\n    return {\r\n        title,\r\n        description: title.split(/-/)[0]?.trim(),\r\n        link: currentUrl,\r\n        item: items,\r\n        allowEmpty: true,\r\n        image,\r\n        author: $(\"meta[name='keywords']\").prop('content'),\r\n        language,\r\n    };\r\n};\r\n\r\nexport const route: Route = {\r\n    path: '/:category{.+}?',\r\n    name: '分类',\r\n    url: 'www.chinania.org.cn',\r\n    maintainers: ['nczitzk'],\r\n    handler,\r\n    example: '/chinania/xiehuidongtai/xiehuitongzhi',\r\n    parameters: { category: '分类，默认为 `xiehuidongtai/xiehuitongzhi`，即协会通知，可在对应分类页 URL 中找到' },\r\n    description: `::: tip\r\n  若订阅 [协会通知](https://www.chinania.org.cn/html/xiehuidongtai/xiehuitongzhi/)，网址为 \\`https://www.chinania.org.cn/html/xiehuidongtai/xiehuitongzhi/\\`。截取 \\`https://www.chinania.org.cn/html\\` 到末尾 \\`/\\` 的部分 \\`xiehuidongtai/xiehuitongzhi\\` 作为参数填入，此时路由为 [\\`/chinania/xiehuidongtai/xiehuitongzhi\\`](https://rsshub.app/chinania/xiehuidongtai/xiehuitongzhi)。\r\n:::\r\n\r\n<details>\r\n<summary>更多分类</summary>\r\n\r\n#### [协会动态](https://www.chinania.org.cn/html/xiehuidongtai/)\r\n\r\n| [协会动态](https://www.chinania.org.cn/html/xiehuidongtai/xiehuidongtai/)              | [协会通知](https://www.chinania.org.cn/html/xiehuidongtai/xiehuitongzhi/)              | [有色企业50强](https://www.chinania.org.cn/html/xiehuidongtai/youseqiye50qiang/)             |\r\n| -------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------- |\r\n| [xiehuidongtai/xiehuidongtai](https://rsshub.app/chinania/xiehuidongtai/xiehuidongtai) | [xiehuidongtai/xiehuitongzhi](https://rsshub.app/chinania/xiehuidongtai/xiehuitongzhi) | [xiehuidongtai/youseqiye50qiang](https://rsshub.app/chinania/xiehuidongtai/youseqiye50qiang) |\r\n\r\n#### [党建工作](https://www.chinania.org.cn/html/djgz/)\r\n\r\n| [协会党建](https://www.chinania.org.cn/html/djgz/xiehuidangjian/)      | [行业党建](https://www.chinania.org.cn/html/djgz/hangyedangjian/)      |\r\n| ---------------------------------------------------------------------- | ---------------------------------------------------------------------- |\r\n| [djgz/xiehuidangjian](https://rsshub.app/chinania/djgz/xiehuidangjian) | [djgz/hangyedangjian](https://rsshub.app/chinania/djgz/hangyedangjian) |\r\n\r\n#### [行业新闻](https://www.chinania.org.cn/html/hangyexinwen/)\r\n\r\n| [时政要闻](https://www.chinania.org.cn/html/hangyexinwen/shizhengyaowen/)              | [要闻](https://www.chinania.org.cn/html/hangyexinwen/yaowen/)          | [行业新闻](https://www.chinania.org.cn/html/hangyexinwen/guoneixinwen/)            | [资讯](https://www.chinania.org.cn/html/hangyexinwen/zixun/)         |\r\n| -------------------------------------------------------------------------------------- | ---------------------------------------------------------------------- | ---------------------------------------------------------------------------------- | -------------------------------------------------------------------- |\r\n| [hangyexinwen/shizhengyaowen](https://rsshub.app/chinania/hangyexinwen/shizhengyaowen) | [hangyexinwen/yaowen](https://rsshub.app/chinania/hangyexinwen/yaowen) | [hangyexinwen/guoneixinwen](https://rsshub.app/chinania/hangyexinwen/guoneixinwen) | [hangyexinwen/zixun](https://rsshub.app/chinania/hangyexinwen/zixun) |\r\n\r\n#### [人力资源](https://www.chinania.org.cn/html/renliziyuan/)\r\n\r\n| [相关通知](https://www.chinania.org.cn/html/renliziyuan/xiangguantongzhi/)               | [人事招聘](https://www.chinania.org.cn/html/renliziyuan/renshizhaopin/)            |\r\n| ---------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------- |\r\n| [renliziyuan/xiangguantongzhi](https://rsshub.app/chinania/renliziyuan/xiangguantongzhi) | [renliziyuan/renshizhaopin](https://rsshub.app/chinania/renliziyuan/renshizhaopin) |\r\n\r\n#### [行业统计](https://www.chinania.org.cn/html/hangyetongji/jqzs/)\r\n\r\n| [行业分析](https://www.chinania.org.cn/html/hangyetongji/tongji/)      | [数据统计](https://www.chinania.org.cn/html/hangyetongji/chanyeshuju/)           | [景气指数](https://www.chinania.org.cn/html/hangyetongji/jqzs/)    |\r\n| ---------------------------------------------------------------------- | -------------------------------------------------------------------------------- | ------------------------------------------------------------------ |\r\n| [hangyetongji/tongji](https://rsshub.app/chinania/hangyetongji/tongji) | [hangyetongji/chanyeshuju](https://rsshub.app/chinania/hangyetongji/chanyeshuju) | [hangyetongji/jqzs](https://rsshub.app/chinania/hangyetongji/jqzs) |\r\n\r\n#### [政策法规](https://www.chinania.org.cn/html/zcfg/zhengcefagui/)\r\n\r\n| [政策法规](https://www.chinania.org.cn/html/zcfg/zhengcefagui/)    |\r\n| ------------------------------------------------------------------ |\r\n| [zcfg/zhengcefagui](https://rsshub.app/chinania/zcfg/zhengcefagui) |\r\n\r\n#### [会议展览](https://www.chinania.org.cn/html/hyzl/huiyizhanlan/)\r\n\r\n| [会展通知](https://www.chinania.org.cn/html/hyzl/huiyizhanlan/)    | [会展报道](https://www.chinania.org.cn/html/hyzl/huizhanbaodao/)     |\r\n| ------------------------------------------------------------------ | -------------------------------------------------------------------- |\r\n| [hyzl/huiyizhanlan](https://rsshub.app/chinania/hyzl/huiyizhanlan) | [hyzl/huizhanbaodao](https://rsshub.app/chinania/hyzl/huizhanbaodao) |\r\n\r\n</details>\r\n    `,\r\n    categories: ['new-media'],\r\n\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportRadar: true,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['www.chinania.org.cn/html/:category'],\r\n            target: (params) => {\r\n                const category = params.category;\r\n\r\n                return category ? `/${category}` : '';\r\n            },\r\n        },\r\n        {\r\n            title: '协会动态 - 协会动态',\r\n            source: ['www.chinania.org.cn/html/xiehuidongtai/xiehuidongtai/'],\r\n            target: '/xiehuidongtai/xiehuidongtai',\r\n        },\r\n        {\r\n            title: '协会动态 - 协会通知',\r\n            source: ['www.chinania.org.cn/html/xiehuidongtai/xiehuitongzhi/'],\r\n            target: '/xiehuidongtai/xiehuitongzhi',\r\n        },\r\n        {\r\n            title: '协会动态 - 有色企业50强',\r\n            source: ['www.chinania.org.cn/html/xiehuidongtai/youseqiye50qiang/'],\r\n            target: '/xiehuidongtai/youseqiye50qiang',\r\n        },\r\n        {\r\n            title: '党建工作 - 协会党建',\r\n            source: ['www.chinania.org.cn/html/djgz/xiehuidangjian/'],\r\n            target: '/djgz/xiehuidangjian',\r\n        },\r\n        {\r\n            title: '党建工作 - 行业党建',\r\n            source: ['www.chinania.org.cn/html/djgz/hangyedangjian/'],\r\n            target: '/djgz/hangyedangjian',\r\n        },\r\n        {\r\n            title: '会议展览 - 会展通知',\r\n            source: ['www.chinania.org.cn/html/hyzl/huiyizhanlan/'],\r\n            target: '/hyzl/huiyizhanlan',\r\n        },\r\n        {\r\n            title: '会议展览 - 会展报道',\r\n            source: ['www.chinania.org.cn/html/hyzl/huizhanbaodao/'],\r\n            target: '/hyzl/huizhanbaodao',\r\n        },\r\n        {\r\n            title: '行业新闻 - 时政要闻',\r\n            source: ['www.chinania.org.cn/html/hangyexinwen/shizhengyaowen/'],\r\n            target: '/hangyexinwen/shizhengyaowen',\r\n        },\r\n        {\r\n            title: '行业新闻 - 要闻',\r\n            source: ['www.chinania.org.cn/html/hangyexinwen/yaowen/'],\r\n            target: '/hangyexinwen/yaowen',\r\n        },\r\n        {\r\n            title: '行业新闻 - 行业新闻',\r\n            source: ['www.chinania.org.cn/html/hangyexinwen/guoneixinwen/'],\r\n            target: '/hangyexinwen/guoneixinwen',\r\n        },\r\n        {\r\n            title: '行业新闻 - 资讯',\r\n            source: ['www.chinania.org.cn/html/hangyexinwen/zixun/'],\r\n            target: '/hangyexinwen/zixun',\r\n        },\r\n        {\r\n            title: '行业统计 - 行业分析',\r\n            source: ['www.chinania.org.cn/html/hangyetongji/tongji/'],\r\n            target: '/hangyetongji/tongji',\r\n        },\r\n        {\r\n            title: '行业统计 - 数据统计',\r\n            source: ['www.chinania.org.cn/html/hangyetongji/chanyeshuju/'],\r\n            target: '/hangyetongji/chanyeshuju',\r\n        },\r\n        {\r\n            title: '行业统计 - 景气指数',\r\n            source: ['www.chinania.org.cn/html/hangyetongji/jqzs/'],\r\n            target: '/hangyetongji/jqzs',\r\n        },\r\n        {\r\n            title: '人力资源 - 相关通知',\r\n            source: ['www.chinania.org.cn/html/renliziyuan/xiangguantongzhi/'],\r\n            target: '/renliziyuan/xiangguantongzhi',\r\n        },\r\n        {\r\n            title: '人力资源 - 人事招聘',\r\n            source: ['www.chinania.org.cn/html/renliziyuan/renshizhaopin/'],\r\n            target: '/renliziyuan/renshizhaopin',\r\n        },\r\n        {\r\n            title: '政策法规 - 政策法规',\r\n            source: ['www.chinania.org.cn/html/zcfg/zhengcefagui/'],\r\n            target: '/zcfg/zhengcefagui',\r\n        },\r\n    ],\r\n};\r\n"],"mappings":"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"}