import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import{art as n}from"./render-CxhTJIsl.js";import{parseDate as r}from"./parse-date-Bgabdhlb.js";import{got_default as i}from"./got-CdvI2yKX.js";import{timezone as a}from"./timezone-BrNu6iXe.js";import o from"node:path";import{load as s}from"cheerio";t();const c=`https://www.yicai.com`,l=async(t,s)=>{let l=await i({method:`get`,url:t}),d=l.data.map(t=>({title:t.NewsTitle,link:t.url.startsWith(`http`)?t.url:`${c}${t.AppID===0?`/vip`:``}${t.url}`,author:t.NewsAuthor||t.NewsSource||t.CreaterName,pubDate:a(r(t.CreateDate),8),category:[t.ChannelName],description:n(o.join(e,`templates/description-f5a5346e.art`),{image:{src:t.originPic,alt:t.NewsTitle},video:{src:t.VideoUrl,type:t.VideoUrl?.split(/\./).pop()??void 0},intro:t.NewsNotes})}));return Promise.all(u(d,s))};function u(e,t){return e.map(e=>t(e.link,async()=>{let t=await i({method:`get`,url:e.link}),n=s(t.data);if(!e.pubDate){let t=n(`script[src='/js/alert.min.js']`).next().text()||n(`title`).next().text(),i=new Map(JSON.parse(t.match(/_pb = (\[.*?]);/)[1].replaceAll(`'`,`"`)));e.pubDate=r(`${i.get(`actime`)}:00`)}return n(`h1`).remove(),n(`.u-btn6, .m-smallshare, .topic-hot`).remove(),e.description=(e.description??``)+(n(`.multiText, #multi-text, .txt`).html()??``),e}))}export{l as ProcessItems,u as fetchFullArticles,c as rootUrl};
//# sourceMappingURL=utils-BPPoW_Xu.js.map