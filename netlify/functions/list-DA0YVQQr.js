import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{cache_default as n}from"./cache-kimkMTWJ.js";import{art as r}from"./render-CxhTJIsl.js";import{parseDate as i}from"./parse-date-Bgabdhlb.js";import{ofetch_default as a}from"./ofetch-Bzt0BXUH.js";import{timezone as o}from"./timezone-BrNu6iXe.js";import{ViewType as s}from"./types-A5bA50Mg.js";import c from"node:path";import{load as l}from"cheerio";t();const u=async t=>{let{id:s=`datalist`}=t.req.param(),u=Number.parseInt(t.req.query(`limit`)??`30`,10),d=new URL(s.endsWith(`/`)?s:`${s}/`,`http://www.fangchan.com`).href,f=new URL(`api/${s.endsWith(`/`)?s.replace(/\/$/,``):s}.json`,`http://news.fangchan.com`).href,p=await a(d),m=l(p),h=m(`html`).attr(`lang`)??`zh-CN`,g=await a(f,{query:{pagesize:u,page:1}}),_=[];_=g.data.slice(0,u).map(t=>{let n=t.title,a=r(c.join(e,`templates/description-d37ebf7e.art`),{intro:t.zhaiyao}),o=t.createtime,s=t.url,l=[...new Set([t.topcolumn,t.subcolumn,...t.keyword?.split(/,/)??[]].filter(Boolean))],u=t.pic,d=t.createtime,f={title:n,description:a,pubDate:o?i(o,`X`):void 0,link:s,id:l,content:{html:a,text:t.zhaiyao??a},image:u,banner:u,updated:d?i(d,`X`):void 0,language:h};return f}),_=(await Promise.all(_.map(e=>e.link?n.tryGet(e.link,async()=>{let t=await a(e.link),n=l(t),r=n(`div.summary-text h`).text(),s=(e.description??``)+(n(`div.top-info`).html()??``)+(n(`div.summary-text-p`).html()??``),c=n(`span.news-date`).text().match(/\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}/)?.[1],u=n(`a.news-column, div.label span`).toArray(),d=[...new Set([...e.id,...u.map(e=>n(e).text()).filter(Boolean)].filter(Boolean))],f=n(`span.news-date`).text()?.split(/\d{4}-\d{2}-\d{2}/)?.[0]?.trim()?.split(/\s/)?.map(e=>({name:e})),p=c,m={title:r,description:s,pubDate:c?o(i(c),8):e.pubDate,id:d,author:f,content:{html:s,text:s},updated:p?o(i(p),8):e.updated,language:h},g=n(`ul.xgxw-ul li a`).toArray(),_=g.map(e=>{let t=n(e);return{url:t.attr(`href`),type:`related`,content_html:t.text()}}).filter(e=>!0);return _&&(m={...m,_extra:{links:_}}),{...e,...m}}):e))).filter(e=>!0);let v=`中房网`;return{title:`${v} - ${m(`div.curmbs a`).text()}`,description:m(`meta[name="description"]`).attr(`content`),link:d,item:_,allowEmpty:!0,author:v,language:h}},d={path:`/list/:id?`,name:`列表`,url:`www.fangchan.com`,maintainers:[`nczitzk`],handler:u,example:`/fangchan/list/datalist`,parameters:{id:{description:"分类，默认为 `datalist`，即数据研究，可在对应分类页 URL 中找到",options:[{label:`数据研究`,value:`datalist`},{label:`行业测评`,value:`industrylist`},{label:`政策法规`,value:`policylist`}]}},description:":::tip\n若订阅 [列表](https://www.fangchan.com/)，网址为 `https://www.fangchan.com/`，请截取 `https://www.fangchan.com/` 到末尾 `.html` 的部分 `datalist` 作为 `id` 参数填入，此时目标路由为 [`/fangchan/datalist`](https://rsshub.app/fangchan/datalist)。\n:::\n\n| [数据研究](https://www.fangchan.com/datalist)         | [行业测评](https://www.fangchan.com/industrylist)             | [政策法规](https://www.fangchan.com/policylist)           |\n| ----------------------------------------------------- | ------------------------------------------------------------- | --------------------------------------------------------- |\n| [datalist](https://rsshub.app/fangchan/list/datalist) | [industrylist](https://rsshub.app/fangchan/list/industrylist) | [policylist](https://rsshub.app/fangchan/list/policylist) |\n",categories:[`new-media`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.fangchan.com/:id`],target:e=>{let t=e.id;return`/fangchan/list/${t?`/${t}`:``}`}},{title:`数据研究`,source:[`www.fangchan.com/datalist`],target:`/list/datalist`},{title:`行业测评`,source:[`www.fangchan.com/industrylist`],target:`/list/industrylist`},{title:`政策法规`,source:[`www.fangchan.com/policylist`],target:`/list/policylist`}],view:s.Articles};export{u as handler,d as route};
//# sourceMappingURL=list-DA0YVQQr.js.map