{"version":3,"file":"mall-new-BitW6by7.js","names":["route: Route","got"],"sources":["../../lib/routes/bilibili/mall-new.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport got from '@/utils/got';\r\n\r\nexport const route: Route = {\r\n    path: '/mall/new/:category?',\r\n    categories: ['social-media'],\r\n    example: '/bilibili/mall/new/1',\r\n    parameters: { category: '分类，默认全部，见下表' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    name: '会员购新品上架',\r\n    maintainers: ['DIYgod'],\r\n    handler,\r\n    description: `| 全部 | 手办 | 魔力赏 | 周边 | 游戏 |\r\n| ---- | ---- | ------ | ---- | ---- |\r\n| 0    | 1    | 7      | 3    | 6    |`,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const category = ctx.req.param('category') || 0;\r\n\r\n    const response = await got({\r\n        method: 'get',\r\n        url: `https://mall.bilibili.com/mall-c-search/home/new_items/list?pageNum=1&pageSize=20&version=1.0&cityId=0&cateType=${category}`,\r\n        headers: {\r\n            Referer: 'https://mall.bilibili.com/newdate.html?noTitleBar=1&page=new&from=new_product&loadingShow=1',\r\n        },\r\n    });\r\n\r\n    const days = response.data.data.vo.days;\r\n    const items = [];\r\n    for (const day of days) {\r\n        items.push(...day.presaleItems);\r\n    }\r\n\r\n    const type = response.data.data.vo.cateTabs.find((item) => item.cateType === response.data.data.vo.currentCateType).cateName;\r\n\r\n    return {\r\n        title: `会员购新品上架-${type}`,\r\n        link: 'https://mall.bilibili.com/newdate.html?noTitleBar=1&page=new&from=new_product&loadingShow=1',\r\n        item: items.map((item) => ({\r\n            title: item.name,\r\n            description: `${item.name}<br>${item.priceDesc ? `${item.pricePrefix}${item.priceSymbol}${item.priceDesc[0]}` : ''}<br><img src=\"https:${item.img}\"><br><a href=\"${item.itemUrl}\">APP 内打开</a>`,\r\n            link: item.itemUrlForH5,\r\n        })),\r\n    };\r\n}\r\n"],"mappings":"gOAGA,MAAaA,EAAe,CACxB,KAAM,uBACN,WAAY,CAAC,gBACb,QAAS,uBACT,WAAY,CAAE,SAAU,eACxB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,KAAM,UACN,YAAa,CAAC,UACd,UACA,YAAa;;yCAKjB,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAW,EAAI,IAAI,MAAM,aAAe,EAExC,EAAW,MAAMC,EAAI,CACvB,OAAQ,MACR,IAAK,mHAAmH,IACxH,QAAS,CACL,QAAS,iGAIX,EAAO,EAAS,KAAK,KAAK,GAAG,KAC7B,EAAQ,GACd,IAAK,IAAM,KAAO,EACd,EAAM,KAAK,GAAG,EAAI,cAGtB,IAAM,EAAO,EAAS,KAAK,KAAK,GAAG,SAAS,KAAM,GAAS,EAAK,WAAa,EAAS,KAAK,KAAK,GAAG,iBAAiB,SAEpH,MAAO,CACH,MAAO,WAAW,IAClB,KAAM,8FACN,KAAM,EAAM,IAAK,IAAU,CACvB,MAAO,EAAK,KACZ,YAAa,GAAG,EAAK,KAAK,MAAM,EAAK,UAAY,GAAG,EAAK,cAAc,EAAK,cAAc,EAAK,UAAU,KAAO,GAAG,sBAAsB,EAAK,IAAI,iBAAiB,EAAK,QAAQ,eAChL,KAAM,EAAK"}