{"version":3,"file":"offer-BdWKx38v.js","names":[],"sources":["../../lib/routes/ikea/gb/offer.ts"],"sourcesContent":["import { Route } from '@/types';\r\n\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\nimport { art } from '@/utils/render';\r\nimport path from 'node:path';\r\n\r\nexport const route: Route = {\r\n    path: '/gb/offer',\r\n    categories: ['shopping'],\r\n    example: '/ikea/gb/offer',\r\n    parameters: {},\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['ikea.com/gb/en/offers', 'ikea.com/'],\r\n        },\r\n    ],\r\n    name: 'UK - Offers',\r\n    maintainers: ['HenryQW'],\r\n    handler,\r\n    url: 'ikea.com/gb/en/offers',\r\n};\r\n\r\nasync function handler() {\r\n    const link = 'https://www.ikea.com/gb/en/offers/';\r\n    const response = await got(link);\r\n\r\n    const $ = load(response.data);\r\n    const carousel = $('.pub__carousel-slide')\r\n        .toArray()\r\n        .map((e) => {\r\n            e = $(e);\r\n            const title = e.find('h3');\r\n            const img = e.find('.pub__image').each((_, e) => {\r\n                e.attribs.src = e.attribs.src.split('?')[0];\r\n                delete e.attribs.srcset;\r\n            });\r\n            const link = new URL(e.find('pub-hide-empty-link a').attr('href'));\r\n            const { searchParams, href } = link;\r\n            searchParams.delete('itm_content');\r\n            searchParams.delete('itm_element');\r\n            searchParams.delete('itm_campaign');\r\n            return {\r\n                title: title.text(),\r\n                description: art(path.join(__dirname, '../templates/offer.art'), {\r\n                    img: img.parent().html(),\r\n                    desc: title.next().parent().html(),\r\n                }),\r\n                link: href,\r\n                guid: `${href}#${title.text()}`,\r\n            };\r\n        });\r\n\r\n    const banner = $('div[data-pub-type=\"banner\"]')\r\n        .toArray()\r\n        .map((e) => {\r\n            e = $(e);\r\n            const title = e.find('h2');\r\n            const next = title.next();\r\n            const img = e.find('.pub__image').each((_, e) => {\r\n                e.attribs.src = e.attribs.src.split('?')[0];\r\n                delete e.attribs.srcset;\r\n            });\r\n\r\n            const link = new URL(next.find('a').attr('href'));\r\n            const { searchParams, href } = link;\r\n            searchParams.delete('itm_content');\r\n            searchParams.delete('itm_element');\r\n            searchParams.delete('itm_campaign');\r\n            return {\r\n                title: title.text(),\r\n                description: art(path.join(__dirname, '../templates/offer.art'), {\r\n                    img: img.parent().html(),\r\n                    desc: title.parent().html(),\r\n                }),\r\n                link: href,\r\n                guid: `${href}#${title.text()}`,\r\n            };\r\n        });\r\n\r\n    return {\r\n        title: 'IKEA UK - Offers',\r\n        link,\r\n        description: 'Offers by IKEA UK.',\r\n        item: [...carousel, ...banner],\r\n    };\r\n}\r\n"],"mappings":"+WAOA,MAAa,EAAe,CACxB,KAAM,YACN,WAAY,CAAC,YACb,QAAS,iBACT,WAAY,GACZ,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,wBAAyB,eAG1C,KAAM,cACN,YAAa,CAAC,WACd,UACA,IAAK,yBAGT,eAAe,GAAU,CACrB,IAAM,EAAO,qCACP,EAAW,MAAM,EAAI,GAErB,EAAI,EAAK,EAAS,MAClB,EAAW,EAAE,wBACd,UACA,IAAK,GAAM,CACR,EAAI,EAAE,GACN,IAAM,EAAQ,EAAE,KAAK,MACf,EAAM,EAAE,KAAK,eAAe,MAAM,EAAG,IAAM,CAC7C,EAAE,QAAQ,IAAM,EAAE,QAAQ,IAAI,MAAM,KAAK,GACzC,OAAO,EAAE,QAAQ,SAEf,EAAO,IAAI,IAAI,EAAE,KAAK,yBAAyB,KAAK,SACpD,CAAE,eAAc,QAAS,EAI/B,OAHA,EAAa,OAAO,eACpB,EAAa,OAAO,eACpB,EAAa,OAAO,gBACb,CACH,MAAO,EAAM,OACb,YAAa,EAAI,EAAA,KAAA,EAAA,gCAAgD,CAC7D,IAAK,EAAI,SAAS,OAClB,KAAM,EAAM,OAAO,SAAS,SAEhC,KAAM,EACN,KAAM,GAAG,EAAK,GAAG,EAAM,YAI7B,EAAS,EAAE,+BACZ,UACA,IAAK,GAAM,CACR,EAAI,EAAE,GACN,IAAM,EAAQ,EAAE,KAAK,MACf,EAAO,EAAM,OACb,EAAM,EAAE,KAAK,eAAe,MAAM,EAAG,IAAM,CAC7C,EAAE,QAAQ,IAAM,EAAE,QAAQ,IAAI,MAAM,KAAK,GACzC,OAAO,EAAE,QAAQ,SAGf,EAAO,IAAI,IAAI,EAAK,KAAK,KAAK,KAAK,SACnC,CAAE,eAAc,QAAS,EAI/B,OAHA,EAAa,OAAO,eACpB,EAAa,OAAO,eACpB,EAAa,OAAO,gBACb,CACH,MAAO,EAAM,OACb,YAAa,EAAI,EAAA,KAAA,EAAA,gCAAgD,CAC7D,IAAK,EAAI,SAAS,OAClB,KAAM,EAAM,SAAS,SAEzB,KAAM,EACN,KAAM,GAAG,EAAK,GAAG,EAAM,YAInC,MAAO,CACH,MAAO,mBACP,OACA,YAAa,qBACb,KAAM,CAAC,GAAG,EAAU,GAAG"}