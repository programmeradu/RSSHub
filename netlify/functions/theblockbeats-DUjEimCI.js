import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{cache_default as n}from"./cache-kimkMTWJ.js";import{art as r}from"./render-CxhTJIsl.js";import{parseDate as i}from"./parse-date-Bgabdhlb.js";import{ofetch_default as a}from"./ofetch-Bzt0BXUH.js";import{ViewType as o}from"./types-A5bA50Mg.js";import s from"node:path";import{load as c}from"cheerio";t();const l=`https://www.theblockbeats.info`,u=`https://api.blockbeats.cn`,d=t=>{let n=r(s.join(e,`templates/description-ee60edce.art`),t),i=c(n,null,!1);return i(`img`).each((e,t)=>{let n=i(t),r=n.attr(`src`);n.attr(`src`,r?.split(`?`)[0])}),i.html()},f={newsflash:{title:`快讯`,link:`${l}/newsflash`,api:`${u}/v2/newsflash/list`},article:{title:`文章`,link:`${l}/article`,api:`${u}/v2/article/list`}},p={path:`/:channel?/:original?`,categories:[`finance`],view:o.Articles,example:`/theblockbeats/newsflash`,parameters:{channel:{description:`类型`,options:[{value:`newsflash`,label:`快讯`},{value:`article`,label:`文章`}],default:`newsflash`},original:{description:"文章类型，仅 `channel` 为 `article` 时有效",options:[{value:`0`,label:`全部`},{value:`1`,label:`深度`},{value:`2`,label:`精选`},{value:`3`,label:`热点追踪`}],default:`0`}},name:`新闻快讯`,maintainers:[`Fatpandac`,`jameshih`,`DIYgod`],handler:m,radar:[{title:`文章`,source:[`www.theblockbeats.info/article`],target:`/article`},{title:`快讯`,source:[`www.theblockbeats.info/newsflash`],target:`/newsflash`}],description:`|    快讯   |   文章  |
| :-------: | :-----: |
| newsflash | article |

| 全部 | 深度 | 精选 | 热点追踪 |
| :--: | :--: | :--: | :---: |
|     | -2  | 1    |  2     |`};async function m(e){let{channel:t=`newsflash`,original:r}=e.req.param(),o=await a(f[t].api,{query:{limit:e.req.query(`limit`)?Number.parseInt(e.req.query(`limit`)):20,original:t===`article`?r:void 0}}),s=o.data.list.map(e=>({title:e.title,link:`${l}/${t===`newsflash`?`flash`:`news`}/${e.article_id}`,description:e.content??e.abstract,pubDate:i(e.add_time,`X`),author:e.author?.nickname,category:e.tag_list,imgUrl:e.img_url}));return t!==`newsflash`&&(s=await Promise.all(s.map(e=>n.tryGet(`theblockbeats:${e.link}`,async()=>{let t=await a(e.link),n=c(t);return e.description=d({image:e.imgUrl,description:n(`div.news-content`).html()}),e})))),{title:`TheBlockBeats - ${f[t].title}`,link:f[t].link,item:s}}export{p as route};
//# sourceMappingURL=theblockbeats-DUjEimCI.js.map