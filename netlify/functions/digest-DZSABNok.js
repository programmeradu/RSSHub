import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{parseDate as e}from"./parse-date-Bgabdhlb.js";import{ofetch_default as t}from"./ofetch-Bzt0BXUH.js";import{ViewType as n}from"./types-A5bA50Mg.js";import{load as r}from"cheerio";const i=async n=>{let i=Number.parseInt(n.req.query(`limit`)??`20`,10),a=`https://www.ifanr.com`,o=new URL(`digest`,a).href,s=new URL(`api/v5/wp/buzz`,`https://sso.ifanr.com`).href,c=await t(s,{query:{limit:i,offset:0}}),l=await t(o),u=r(l),d=u(`html`).attr(`lang`)??`zh-CN`,f=c.objects.slice(0,i).map(t=>{let n=t.post_title,r=t.post_content,i=t.created_at,o=`digest/${t.post_id}`,s=`ifanr-digest-${t.post_id}`,c=t.updated_at??i,l={title:n,description:r,pubDate:i?e(i,`X`):void 0,link:new URL(o,a).href,guid:s,id:s,content:{html:r,text:t.post_content??r},updated:c?e(c):void 0,language:d,_extra:{links:[{url:t.buzz_original_url,type:`via`,content_html:t.post_content}]}};return l}),p=u(`title`).text();return{title:p,description:p,link:o,item:f,allowEmpty:!0,image:u(`img.c-header-navbar__logo`).attr(`src`),author:u(`meta[property="og:site_name"]`).attr(`content`),language:d,id:u(`meta[property="og:url"]`).attr(`content`)}},a={path:`/digest`,name:`快讯`,url:`www.ifanr.com`,maintainers:[`nczitzk`],handler:i,example:`/ifanr/digest`,parameters:void 0,description:void 0,categories:[`new-media`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.ifanr.comdigest`],target:`/digest`}],view:n.Articles};export{i as handler,a as route};
//# sourceMappingURL=digest-DZSABNok.js.map