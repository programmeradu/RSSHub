{"version":3,"file":"luma-CU4ODL7k.js","names":["route: Route","ofetch"],"sources":["../../lib/routes/luma/index.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport ofetch from '@/utils/ofetch';\r\n\r\nexport const route: Route = {\r\n    path: '/:url',\r\n    name: 'Events',\r\n    url: 'lu.ma',\r\n    maintainers: ['cxheng315'],\r\n    example: '/luma/yieldnest',\r\n    categories: ['other'],\r\n    parameters: {\r\n        url: 'LuMa URL',\r\n    },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['lu.ma/:url'],\r\n            target: '/:url',\r\n        },\r\n    ],\r\n    handler,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const endpoint = 'https://api.lu.ma/url?url=' + ctx.req.param('url');\r\n\r\n    const response = await ofetch(endpoint);\r\n\r\n    let items;\r\n\r\n    switch (response.kind) {\r\n        case 'calendar':\r\n            items = response.data.featured_items.map((item) => ({\r\n                title: item.event.name,\r\n                link: 'https://lu.ma/' + item.event.url,\r\n                author: item.hosts ? item.hosts.map((host) => host.name).join(', ') : '',\r\n                guid: item.event.api_id,\r\n                pubDate: parseDate(item.event.start_at),\r\n                itunes_item_image: item.event.cover_url,\r\n                itunes_duration: (new Date(item.event.end_at).getTime() - new Date(item.event.start_at).getTime()) / 1000,\r\n            }));\r\n            break;\r\n        case 'event':\r\n            items = [\r\n                {\r\n                    title: response.data.event.name,\r\n                    link: 'https://lu.ma/' + response.data.event.url,\r\n                    author: response.data.hosts ? response.data.hosts.map((host) => host.name).join(', ') : '',\r\n                    guid: response.data.event.api_id,\r\n                    pubDate: parseDate(response.data.event.start_at),\r\n                    itunes_item_image: response.data.event.cover_url,\r\n                    itunes_duration: (new Date(response.data.event.end_at).getTime() - new Date(response.data.event.start_at).getTime()) / 1000,\r\n                },\r\n            ];\r\n            break;\r\n        case 'discover-place':\r\n            items = response.data.events.map((item) => ({\r\n                title: item.event.name,\r\n                link: 'https://lu.ma/' + item.event.url,\r\n                author: item.hosts ? item.hosts.map((host) => host.name).join(', ') : '',\r\n                guid: item.event.api_id,\r\n                pubDate: parseDate(item.event.start_at),\r\n                itunes_item_image: item.event.cover_url,\r\n                itunes_duration: (new Date(item.event.end_at).getTime() - new Date(item.event.start_at).getTime()) / 1000,\r\n            }));\r\n            break;\r\n        default:\r\n            items = [\r\n                {\r\n                    title: 'Not Found',\r\n                    link: 'Not Found',\r\n                },\r\n            ];\r\n            break;\r\n    }\r\n\r\n    return {\r\n        title: response.data.calendar ? response.data.calendar.name : response.data.place.name,\r\n        description: response.data.place ? response.data.place.description : '',\r\n        link: 'https://lu.ma/' + ctx.req.param('url'),\r\n        image: response.data.calendar ? response.data.calendar.cover_url : response.data.place.cover_url,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"gOAIA,MAAaA,EAAe,CACxB,KAAM,QACN,KAAM,SACN,IAAK,QACL,YAAa,CAAC,aACd,QAAS,kBACT,WAAY,CAAC,SACb,WAAY,CACR,IAAK,YAET,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,cACT,OAAQ,UAGhB,WAGJ,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAW,6BAA+B,EAAI,IAAI,MAAM,OAExD,EAAW,MAAMC,EAAO,GAE1B,EAEJ,OAAQ,EAAS,KAAjB,CACI,IAAK,WACD,EAAQ,EAAS,KAAK,eAAe,IAAK,IAAU,CAChD,MAAO,EAAK,MAAM,KAClB,KAAM,iBAAmB,EAAK,MAAM,IACpC,OAAQ,EAAK,MAAQ,EAAK,MAAM,IAAK,GAAS,EAAK,MAAM,KAAK,MAAQ,GACtE,KAAM,EAAK,MAAM,OACjB,QAAS,EAAU,EAAK,MAAM,UAC9B,kBAAmB,EAAK,MAAM,UAC9B,iBAAkB,IAAI,KAAK,EAAK,MAAM,QAAQ,UAAY,IAAI,KAAK,EAAK,MAAM,UAAU,WAAa,OAEzG,MACJ,IAAK,QACD,EAAQ,CACJ,CACI,MAAO,EAAS,KAAK,MAAM,KAC3B,KAAM,iBAAmB,EAAS,KAAK,MAAM,IAC7C,OAAQ,EAAS,KAAK,MAAQ,EAAS,KAAK,MAAM,IAAK,GAAS,EAAK,MAAM,KAAK,MAAQ,GACxF,KAAM,EAAS,KAAK,MAAM,OAC1B,QAAS,EAAU,EAAS,KAAK,MAAM,UACvC,kBAAmB,EAAS,KAAK,MAAM,UACvC,iBAAkB,IAAI,KAAK,EAAS,KAAK,MAAM,QAAQ,UAAY,IAAI,KAAK,EAAS,KAAK,MAAM,UAAU,WAAa,MAG/H,MACJ,IAAK,iBACD,EAAQ,EAAS,KAAK,OAAO,IAAK,IAAU,CACxC,MAAO,EAAK,MAAM,KAClB,KAAM,iBAAmB,EAAK,MAAM,IACpC,OAAQ,EAAK,MAAQ,EAAK,MAAM,IAAK,GAAS,EAAK,MAAM,KAAK,MAAQ,GACtE,KAAM,EAAK,MAAM,OACjB,QAAS,EAAU,EAAK,MAAM,UAC9B,kBAAmB,EAAK,MAAM,UAC9B,iBAAkB,IAAI,KAAK,EAAK,MAAM,QAAQ,UAAY,IAAI,KAAK,EAAK,MAAM,UAAU,WAAa,OAEzG,MACJ,QACI,EAAQ,CACJ,CACI,MAAO,YACP,KAAM,cAGd,MAGR,MAAO,CACH,MAAO,EAAS,KAAK,SAAW,EAAS,KAAK,SAAS,KAAO,EAAS,KAAK,MAAM,KAClF,YAAa,EAAS,KAAK,MAAQ,EAAS,KAAK,MAAM,YAAc,GACrE,KAAM,iBAAmB,EAAI,IAAI,MAAM,OACvC,MAAO,EAAS,KAAK,SAAW,EAAS,KAAK,SAAS,UAAY,EAAS,KAAK,MAAM,UACvF,KAAM"}