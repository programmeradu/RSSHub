{"version":3,"file":"cn-X2rYero2.js","names":["route: Route","c","ofetch","cache","response","$"],"sources":["../../lib/routes/mckinsey/cn/category-map.ts","../../lib/routes/mckinsey/cn/index.ts"],"sourcesContent":["export const categories = {\r\n    // https://www.mckinsey.com.cn/wp-json/wp/v2/categories?parent=25&per_page=100\r\n    2: {\r\n        name: '汽车',\r\n        slug: 'autos',\r\n    },\r\n    3: {\r\n        name: '金融服务',\r\n        slug: 'banking-insurance',\r\n    },\r\n    4: {\r\n        name: '消费者',\r\n        slug: 'consumers',\r\n    },\r\n    5: {\r\n        name: '医药与医疗',\r\n        slug: 'healthcare-pharmaceuticals',\r\n    },\r\n    7: {\r\n        name: '数字化',\r\n        slug: 'business-technology',\r\n    },\r\n    8: {\r\n        name: '制造业',\r\n        slug: 'manufacturing',\r\n    },\r\n    10: {\r\n        name: '技术，媒体与通信',\r\n        slug: 'technology-media-and-telecom',\r\n    },\r\n    12: {\r\n        name: '城市化与可持续发展',\r\n        slug: 'urbanization-sustainability',\r\n    },\r\n    13: {\r\n        name: '创新',\r\n        slug: 'innovation',\r\n    },\r\n    16: {\r\n        name: '人才与领导力',\r\n        slug: 'talent-leadership',\r\n    },\r\n    18: {\r\n        name: '宏观经济',\r\n        slug: 'macroeconomy',\r\n    },\r\n    19: {\r\n        name: '麦肯锡全球研究院',\r\n        slug: 'mckinsey-global-institute',\r\n    },\r\n    25: {\r\n        name: '洞见',\r\n        slug: 'insights',\r\n    },\r\n    41: {\r\n        name: '资本项目和基础设施',\r\n        slug: 'capital-projects-infrastructure',\r\n    },\r\n    42: {\r\n        name: '旅游、运输和物流',\r\n        slug: '交通运输与物流',\r\n    },\r\n    19139: {\r\n        name: '出海与国际化、转型',\r\n        slug: '出海与国际化、转型',\r\n    },\r\n    45: {\r\n        name: '全球基础材料',\r\n        slug: '全球基础材料',\r\n    },\r\n};\r\n","import { Route, ViewType } from '@/types';\r\nimport ofetch from '@/utils/ofetch';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport { categories } from './category-map';\r\nimport { load } from 'cheerio';\r\nimport cache from '@/utils/cache';\r\n\r\nconst baseUrl = 'https://www.mckinsey.com.cn';\r\n\r\nexport const route: Route = {\r\n    path: '/cn/:category?',\r\n    categories: ['finance'],\r\n    view: ViewType.Articles,\r\n    example: '/mckinsey/cn',\r\n    parameters: {\r\n        category: {\r\n            description: '分类，留空为 `最新洞见`',\r\n            options: Object.entries(categories).map(([, label]) => ({ value: label.slug, label: label.name })),\r\n            default: '最新洞见',\r\n        },\r\n    },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    name: '洞见',\r\n    maintainers: ['laampui'],\r\n    handler,\r\n    description: `| 分类                            | 分类名             |\r\n| ------------------------------- | ------------------ |\r\n|                                 | 全部洞见           |\r\n| autos                           | 汽车               |\r\n| banking-insurance               | 金融服务           |\r\n| consumers                       | 消费者             |\r\n| healthcare-pharmaceuticals      | 医药与医疗         |\r\n| business-technology             | 数字化             |\r\n| manufacturing                   | 制造业             |\r\n| technology-media-and-telecom    | 技术，媒体与通信   |\r\n| urbanization-sustainability     | 城市化与可持续发展 |\r\n| innovation                      | 创新               |\r\n| talent-leadership               | 人才与领导力       |\r\n| macroeconomy                    | 宏观经济           |\r\n| mckinsey-global-institute       | 麦肯锡全球研究院   |\r\n| capital-projects-infrastructure | 资本项目和基础设施 |\r\n| 交通运输与物流                  | 旅游、运输和物流   |\r\n| 出海与国际化、转型              | 出海与国际化、转型 |\r\n| 全球基础材料                    | 全球基础材料       |`,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const { category = '25' } = ctx.req.param();\r\n\r\n    let categorySlug = '';\r\n    if (category === '25') {\r\n        /* empty */\r\n    } else if (categories[category]) {\r\n        // Category number for backwards compatibility\r\n        categorySlug = categories[category].slug;\r\n    } else {\r\n        // Category slug\r\n        const c = Object.values(categories).find((c) => c.slug === category);\r\n        categorySlug = c ? c.slug : '';\r\n    }\r\n    const link = `${baseUrl}/insights/${categorySlug ? `${categorySlug}/` : ''}`;\r\n\r\n    const headers = {\r\n        'accept-language': 'en-US,en;q=0.9',\r\n        'sec-fetch-dest': 'document',\r\n        'sec-fetch-mode': 'navigate',\r\n        'sec-fetch-site': 'none',\r\n    };\r\n\r\n    const response = await ofetch(link, {\r\n        headers,\r\n    });\r\n    const $ = load(response);\r\n\r\n    const list = $('.fl-post-grid-post')\r\n        .toArray()\r\n        .map((item) => {\r\n            const $item = $(item);\r\n            const a = $item.find('h2 a');\r\n            return {\r\n                title: a.attr('title'),\r\n                description: $item.find('.fl-post-grid-content').html()?.trim(),\r\n                link: a.attr('href'),\r\n                pubDate: $item.find('[itemprop=\"datePublished\"]').length ? parseDate($item.find('[itemprop=\"datePublished\"]').attr('content')!) : undefined,\r\n            };\r\n        });\r\n\r\n    const items = await Promise.all(\r\n        list.map((item) =>\r\n            cache.tryGet(item.link, async () => {\r\n                const response = await ofetch(item.link, {\r\n                    headers,\r\n                });\r\n                const $ = load(response);\r\n\r\n                item.description = $('.ast-post-format-').html() || item.description;\r\n                item.guid = $('link[rel=\"shortlink\"]').attr('href');\r\n\r\n                return item;\r\n            })\r\n        )\r\n    );\r\n\r\n    return {\r\n        title: $('head title').text(),\r\n        link,\r\n        image: $('meta[name=\"msapplication-TileImage\"]').attr('content'),\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"kWAAA,MAAa,EAAa,CAEtB,EAAG,CACC,KAAM,KACN,KAAM,SAEV,EAAG,CACC,KAAM,OACN,KAAM,qBAEV,EAAG,CACC,KAAM,MACN,KAAM,aAEV,EAAG,CACC,KAAM,QACN,KAAM,8BAEV,EAAG,CACC,KAAM,MACN,KAAM,uBAEV,EAAG,CACC,KAAM,MACN,KAAM,iBAEV,GAAI,CACA,KAAM,WACN,KAAM,gCAEV,GAAI,CACA,KAAM,YACN,KAAM,+BAEV,GAAI,CACA,KAAM,KACN,KAAM,cAEV,GAAI,CACA,KAAM,SACN,KAAM,qBAEV,GAAI,CACA,KAAM,OACN,KAAM,gBAEV,GAAI,CACA,KAAM,WACN,KAAM,6BAEV,GAAI,CACA,KAAM,KACN,KAAM,YAEV,GAAI,CACA,KAAM,YACN,KAAM,mCAEV,GAAI,CACA,KAAM,WACN,KAAM,WAEV,MAAO,CACH,KAAM,YACN,KAAM,aAEV,GAAI,CACA,KAAM,SACN,KAAM,WC3DDA,EAAe,CACxB,KAAM,iBACN,WAAY,CAAC,WACb,KAAM,EAAS,SACf,QAAS,eACT,WAAY,CACR,SAAU,CACN,YAAa,gBACb,QAAS,OAAO,QAAQ,GAAY,KAAK,EAAG,MAAY,CAAE,MAAO,EAAM,KAAM,MAAO,EAAM,QAC1F,QAAS,SAGjB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,KAAM,KACN,YAAa,CAAC,WACd,UACA,YAAa;;;;;;;;;;;;;;;;;;+CAqBjB,eAAe,EAAQ,EAAK,CACxB,GAAM,CAAE,WAAW,MAAS,EAAI,IAAI,QAEhC,EAAe,GACnB,GAAI,IAAa,KAAM,GAEZ,EAAW,GAElB,EAAe,EAAW,GAAU,SACjC,CAEH,IAAM,EAAI,OAAO,OAAO,GAAY,KAAM,GAAMC,EAAE,OAAS,GAC3D,EAAe,EAAI,EAAE,KAAO,GAEhC,IAAM,EAAO,wCAAuB,EAAe,GAAG,EAAa,GAAK,KAElE,EAAU,CACZ,kBAAmB,iBACnB,iBAAkB,WAClB,iBAAkB,WAClB,iBAAkB,QAGhB,EAAW,MAAMC,EAAO,EAAM,CAChC,YAEE,EAAI,EAAK,GAET,EAAO,EAAE,sBACV,UACA,IAAK,GAAS,CACX,IAAM,EAAQ,EAAE,GACV,EAAI,EAAM,KAAK,QACrB,MAAO,CACH,MAAO,EAAE,KAAK,SACd,YAAa,EAAM,KAAK,yBAAyB,QAAQ,OACzD,KAAM,EAAE,KAAK,QACb,QAAS,EAAM,KAAK,8BAA8B,OAAS,EAAU,EAAM,KAAK,8BAA8B,KAAK,YAAe,IAAA,MAIxI,EAAQ,MAAM,QAAQ,IACxB,EAAK,IAAK,GACNC,EAAM,OAAO,EAAK,KAAM,SAAY,CAChC,IAAMC,EAAW,MAAMF,EAAO,EAAK,KAAM,CACrC,YAEEG,EAAI,EAAKD,GAKf,MAHA,GAAK,YAAcC,EAAE,qBAAqB,QAAU,EAAK,YACzD,EAAK,KAAOA,EAAE,yBAAyB,KAAK,QAErC,MAKnB,MAAO,CACH,MAAO,EAAE,cAAc,OACvB,OACA,MAAO,EAAE,wCAAwC,KAAK,WACtD,KAAM"}