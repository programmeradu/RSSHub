import"./esm-shims-Dqvxr0BZ.js";import{config as e}from"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as t}from"./cache-kimkMTWJ.js";import{parseDate as n}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as r}from"./got-CdvI2yKX.js";import i from"node:https";import a from"node:crypto";import{load as o}from"cheerio";const s={path:`/whpj/:format?`,categories:[`other`],example:`/cib/whpj/xh?filter_title=USD`,parameters:{format:`输出的标题格式，默认为标题 + 所有价格。短格式仅包含货币名称。`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`cib.com.cn/`],target:`/whpj`}],name:`外汇牌价`,maintainers:[`Qixingchen`],handler:c,url:`cib.com.cn/`,description:`| 短格式 | 现汇买卖 | 现钞买卖 | 现汇买入 | 现汇卖出 | 现钞买入 | 现钞卖出 |
| ------ | -------- | -------- | -------- | -------- | -------- | -------- |
| short  | xh       | xc       | xhmr     | xhmc     | xcmr     | xcmc     |`};async function c(s){let c=new i.Agent({secureOptions:a.constants.SSL_OP_LEGACY_SERVER_CONNECT}),u=await r(`https://personalbank.cib.com.cn/pers/main/pubinfo/ifxQuotationQuery.do`,{agent:{https:c}}),d=u.headers[`set-cookie`].map(e=>e.split(`;`)[0]).join(`;`),f=o(u.data),p=f(`div.main-body`).find(`div.labe_text`).text();p=p.split(`
	`)[1].replace(`日期：`,``).trim(),p=p.slice(0,11)+p.slice(15);let m=`https://personalbank.cib.com.cn/pers/main/pubinfo/ifxQuotationQuery/list?_search=false&dataSet.rows=80&dataSet.page=1&dataSet.sidx=&dataSet.sord=asc`,h=await t.tryGet(m,async()=>{let e=await r(m,{headers:{Cookie:d},agent:{https:c}});return e.data},e.cache.contentExpire,!1),g=s.req.param(`format`);return{title:`中国兴业银行外汇牌价`,link:`https://personalbank.cib.com.cn/pers/main/pubinfo/ifxQuotationQuery.do`,item:h.rows.map(e=>{let t=`${e.cell[0]} ${e.cell[1]}`,r=`现汇买入价：${e.cell[3]}`,i=`现钞买入价：${e.cell[5]}`,a=`现汇卖出价：${e.cell[4]}`,o=`现钞卖出价：${e.cell[6]}`,s=`${r} ${i} ${a} ${o}`;return{title:l(t,r,i,a,o,s,g),pubDate:n(p,`YYYY年MM月DD日 HH:mm:ss`),description:s.replaceAll(/\s/g,`<br>`),guid:`${e.cell[0]} ${e.cell[1]} ${p}`}})}}function l(e,t,n,r,i,a,o){switch(o){case`short`:return e;case`xh`:return`${e} ${t} ${r}`;case`xc`:return`${e} ${n} ${i}`;case`xhmr`:return`${e} ${t}`;case`xhmc`:return`${e} ${r}`;case`xcmr`:return`${e} ${n}`;case`xcmc`:return`${e} ${i}`;default:return`${e} ${a}`}}export{s as route};
//# sourceMappingURL=whpj-Dk7u3omh.js.map