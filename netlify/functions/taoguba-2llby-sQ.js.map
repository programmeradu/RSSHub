{"version":3,"file":"taoguba-2llby-sQ.js","names":["route: Route","got"],"sources":["../../lib/routes/taoguba/index.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\nimport { rootUrl, renderPostDetail } from './util';\r\n\r\nexport const route: Route = {\r\n    path: '/:category?',\r\n    categories: ['finance'],\r\n    example: '/taoguba',\r\n    parameters: { id: '分类，见下表，默认为社区总版' },\r\n    name: '淘股论坛',\r\n    maintainers: ['nczitzk'],\r\n    handler,\r\n    description: `| 淘股论坛 | 社区总版 | 精华加油 | 网友点赞 |\r\n| -------- | -------- | -------- | -------- |\r\n| bbs      | zongban  | jinghua  | dianzan  |`,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const category = ctx.req.param('category') ?? 'zongban';\r\n\r\n    const currentUrl = `${rootUrl}/${category}/`;\r\n\r\n    const response = await got({\r\n        method: 'get',\r\n        url: currentUrl,\r\n    });\r\n\r\n    const $ = load(response.data);\r\n\r\n    let items = $('.Nbbs-tiezi-lists')\r\n        .slice(0, ctx.req.query('limit') ? Number.parseInt(ctx.req.query('limit')) : 70)\r\n        .toArray()\r\n        .map((item) => {\r\n            item = $(item);\r\n\r\n            const a = item.find('.middle-list-tittle a');\r\n\r\n            return {\r\n                title: a.text().trim(),\r\n                link: `${rootUrl}/${a.attr('href')}`,\r\n                author: item.find('.middle-list-user a').text().trim(),\r\n            };\r\n        });\r\n\r\n    items = await Promise.all(items.map(async (item) => await renderPostDetail(item)));\r\n\r\n    return {\r\n        title: $('head title').text().trim().split('_')[0],\r\n        link: currentUrl,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"8ZAKA,MAAaA,EAAe,CACxB,KAAM,cACN,WAAY,CAAC,WACb,QAAS,WACT,WAAY,CAAE,GAAI,kBAClB,KAAM,OACN,YAAa,CAAC,WACd,UACA,YAAa;;gDAKjB,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAW,EAAI,IAAI,MAAM,aAAe,UAExC,EAAa,GAAG,EAAQ,GAAG,EAAS,GAEpC,EAAW,MAAMC,EAAI,CACvB,OAAQ,MACR,IAAK,IAGH,EAAI,EAAK,EAAS,MAEpB,EAAQ,EAAE,qBACT,MAAM,EAAG,EAAI,IAAI,MAAM,SAAW,OAAO,SAAS,EAAI,IAAI,MAAM,UAAY,IAC5E,UACA,IAAK,GAAS,CACX,EAAO,EAAE,GAET,IAAM,EAAI,EAAK,KAAK,yBAEpB,MAAO,CACH,MAAO,EAAE,OAAO,OAChB,KAAM,GAAG,EAAQ,GAAG,EAAE,KAAK,UAC3B,OAAQ,EAAK,KAAK,uBAAuB,OAAO,UAM5D,MAFA,GAAQ,MAAM,QAAQ,IAAI,EAAM,IAAI,KAAO,IAAS,MAAM,EAAiB,KAEpE,CACH,MAAO,EAAE,cAAc,OAAO,OAAO,MAAM,KAAK,GAChD,KAAM,EACN,KAAM"}