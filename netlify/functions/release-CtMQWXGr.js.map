{"version":3,"file":"release-CtMQWXGr.js","names":["route: Route","got"],"sources":["../../lib/routes/firefox/release.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\nimport { parseDate } from '@/utils/parse-date';\r\n\r\nconst platformSlugs = {\r\n    desktop: 'releasenotes',\r\n    beta: 'beta/notes',\r\n    nightly: 'nightly/notes',\r\n    android: 'android/releasenotes',\r\n    ios: 'ios/notes',\r\n};\r\n\r\nexport const route: Route = {\r\n    path: '/release/:platform?',\r\n    name: 'Unknown',\r\n    maintainers: [],\r\n    handler,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const { platform = 'desktop' } = ctx.req.param();\r\n    const devicePlatform = platform.replace('-', '/');\r\n\r\n    const link = ['https://www.mozilla.org/en-US/firefox', Object.hasOwn(platformSlugs, devicePlatform) ? platformSlugs[devicePlatform] : devicePlatform].filter(Boolean).join('/');\r\n    const response = await got.get(link);\r\n    const $ = load(response.data);\r\n    const version = $('.c-release-version').text();\r\n    const pubDate = parseDate($('.c-release-date').text(), 'MMMM D, YYYY');\r\n\r\n    return {\r\n        title: `Firefox ${platform} release notes`,\r\n        link,\r\n        item: [\r\n            {\r\n                title: `Firefox ${platform} ${version} release notes`,\r\n                link,\r\n                description: $('.c-release-notes').html(),\r\n                guid: `${platform} ${version}`,\r\n                pubDate,\r\n            },\r\n        ],\r\n    };\r\n}\r\n"],"mappings":"oTAKA,MAAM,EAAgB,CAClB,QAAS,eACT,KAAM,aACN,QAAS,gBACT,QAAS,uBACT,IAAK,aAGIA,EAAe,CACxB,KAAM,sBACN,KAAM,UACN,YAAa,GACb,WAGJ,eAAe,EAAQ,EAAK,CACxB,GAAM,CAAE,WAAW,WAAc,EAAI,IAAI,QACnC,EAAiB,EAAS,QAAQ,IAAK,KAEvC,EAAO,CAAC,wCAAyC,OAAO,OAAO,EAAe,GAAkB,EAAc,GAAkB,GAAgB,OAAO,SAAS,KAAK,KACrK,EAAW,MAAMC,EAAI,IAAI,GACzB,EAAI,EAAK,EAAS,MAClB,EAAU,EAAE,sBAAsB,OAClC,EAAU,EAAU,EAAE,mBAAmB,OAAQ,gBAEvD,MAAO,CACH,MAAO,WAAW,EAAS,gBAC3B,OACA,KAAM,CACF,CACI,MAAO,WAAW,EAAS,GAAG,EAAQ,gBACtC,OACA,YAAa,EAAE,oBAAoB,OACnC,KAAM,GAAG,EAAS,GAAG,IACrB"}