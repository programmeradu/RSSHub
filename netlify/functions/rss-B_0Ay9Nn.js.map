{"version":3,"file":"rss-B_0Ay9Nn.js","names":["route: Route"],"sources":["../../lib/routes/dw/rss.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport { config } from '@/config';\r\nimport Parser from 'rss-parser';\r\nimport { processItems } from './utils';\r\n\r\nexport const route: Route = {\r\n    path: '/rss/:channel?',\r\n    categories: ['traditional-media'],\r\n    example: '/dw/rss/rss-en-all',\r\n    parameters: {\r\n        category: 'RSS Feed Channel, see below, `rss-en-all` by default',\r\n    },\r\n    features: {\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n        requireConfig: false,\r\n    },\r\n    name: 'RSS',\r\n    maintainers: ['quiniapiezoelectricity'],\r\n    handler,\r\n    description: `\r\nFor a full list of RSS Feed Channels in English, please refer to [DW RSS Feeds](https://corporate.dw.com/en/rss-feeds/a-68693346).\r\nRSS Feed Channels in other languages are also available, for example: \\`rss-chi-all\\` renders the RSS feed in Chinese and \\`rss-de-all\\` for the RSS Feed in German\r\n`,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const category = ctx.req.param('channel') ?? 'rss-en-all';\r\n\r\n    const parser = new Parser({\r\n        customFields: {\r\n            item: ['dwsyn:contentID'],\r\n        },\r\n        headers: {\r\n            'User-Agent': config.ua,\r\n        },\r\n    });\r\n\r\n    const feed = await parser.parseURL(`https://rss.dw.com/rdf/${category}`);\r\n    const items = await processItems(\r\n        feed.items.map((item) => {\r\n            item.id = item['dwsyn:contentID'];\r\n            item.pubDate = item.isoDate;\r\n            item.description = item.content;\r\n            const link = new URL(item.link);\r\n            link.search = '';\r\n            item.link = link.href;\r\n            item.type = link.pathname.slice(link.pathname.lastIndexOf('/') + 1).startsWith('live-') ? 'liveblog' : 'article'; // dw rss feed only includes liveblogs and articles\r\n            return item;\r\n        })\r\n    );\r\n\r\n    return {\r\n        title: feed.title,\r\n        link: feed.link,\r\n        description: feed.description,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"iWAKA,MAAaA,EAAe,CACxB,KAAM,iBACN,WAAY,CAAC,qBACb,QAAS,qBACT,WAAY,CACR,SAAU,wDAEd,SAAU,CACN,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,GACf,cAAe,IAEnB,KAAM,MACN,YAAa,CAAC,0BACd,UACA,YAAa,2SAMjB,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAW,EAAI,IAAI,MAAM,YAAc,aAEvC,EAAS,IAAI,EAAO,CACtB,aAAc,CACV,KAAM,CAAC,oBAEX,QAAS,CACL,aAAc,EAAO,MAIvB,EAAO,MAAM,EAAO,SAAS,0BAA0B,KACvD,EAAQ,MAAM,EAChB,EAAK,MAAM,IAAK,GAAS,CACrB,EAAK,GAAK,EAAK,mBACf,EAAK,QAAU,EAAK,QACpB,EAAK,YAAc,EAAK,QACxB,IAAM,EAAO,IAAI,IAAI,EAAK,MAI1B,MAHA,GAAK,OAAS,GACd,EAAK,KAAO,EAAK,KACjB,EAAK,KAAO,EAAK,SAAS,MAAM,EAAK,SAAS,YAAY,KAAO,GAAG,WAAW,SAAW,WAAa,UAChG,KAIf,MAAO,CACH,MAAO,EAAK,MACZ,KAAM,EAAK,KACX,YAAa,EAAK,YAClB,KAAM"}