{"version":3,"file":"discovery-D8k2radj.js","names":["route: Route"],"sources":["../../lib/routes/mixi2/discovery.ts"],"sourcesContent":["import { type Data, type Route, ViewType } from '@/types';\r\nimport type { Context } from 'hono';\r\nimport { CONFIG_OPTIONS, generatePostDataItem, getClient, postFilter } from './utils';\r\n\r\nconst handler = async (ctx: Context) => {\r\n    const limit = Number.parseInt(ctx.req.query('limit') ?? '20', 10);\r\n\r\n    const client = getClient();\r\n\r\n    const data = await client.getRecommendedTimeline({\r\n        limit,\r\n    });\r\n\r\n    const personasData = await client.getPersonas({\r\n        personaIds: data?.posts?.map((post) => post.personaId) ?? [],\r\n    });\r\n\r\n    return {\r\n        title: '発見',\r\n        link: 'https://mixi.social/home/discovery',\r\n        image: 'https://mixi.social/_next/static/media/image_logo.8bb36f11.svg',\r\n        item:\r\n            data?.posts?.filter(postFilter).map((post) => {\r\n                const author = personasData.personas.find((persona) => persona.personaId === post.personaId);\r\n                return {\r\n                    title: `@${author?.name}`,\r\n                    ...generatePostDataItem(post, personasData.personas),\r\n                };\r\n            }) ?? [],\r\n    } as Data;\r\n};\r\n\r\nexport const route: Route = {\r\n    path: '/discovery',\r\n    name: '発見',\r\n    categories: ['social-media'],\r\n    example: '/mixi2/discovery',\r\n    features: {\r\n        supportRadar: true,\r\n        requireConfig: CONFIG_OPTIONS,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['mixi.social/home/discovery'],\r\n            target: '/discovery',\r\n            title: '発見',\r\n        },\r\n    ],\r\n    view: ViewType.SocialMedia,\r\n    handler,\r\n    maintainers: ['KarasuShin'],\r\n};\r\n"],"mappings":"uXAIA,MAAM,EAAU,KAAO,IAAiB,CACpC,IAAM,EAAQ,OAAO,SAAS,EAAI,IAAI,MAAM,UAAY,KAAM,IAExD,EAAS,IAET,EAAO,MAAM,EAAO,uBAAuB,CAC7C,UAGE,EAAe,MAAM,EAAO,YAAY,CAC1C,WAAY,GAAM,OAAO,IAAK,GAAS,EAAK,YAAc,KAG9D,MAAO,CACH,MAAO,KACP,KAAM,qCACN,MAAO,iEACP,KACI,GAAM,OAAO,OAAO,GAAY,IAAK,GAAS,CAC1C,IAAM,EAAS,EAAa,SAAS,KAAM,GAAY,EAAQ,YAAc,EAAK,WAClF,MAAO,CACH,MAAO,IAAI,GAAQ,OACnB,GAAG,EAAqB,EAAM,EAAa,cAE7C,KAILA,EAAe,CACxB,KAAM,aACN,KAAM,KACN,WAAY,CAAC,gBACb,QAAS,mBACT,SAAU,CACN,aAAc,GACd,cAAe,GAEnB,MAAO,CACH,CACI,OAAQ,CAAC,8BACT,OAAQ,aACR,MAAO,OAGf,KAAM,EAAS,YACf,UACA,YAAa,CAAC"}