{"version":3,"file":"notice-Be1rs1dE.js","names":["got","route: Route","cache"],"sources":["../../lib/routes/scu/scupi/_utils.ts","../../lib/routes/scu/scupi/notice.ts"],"sourcesContent":["import got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport { config } from '@/config';\r\n\r\nexport async function getNotifList() {\r\n    try {\r\n        const response = await got.get('https://scupi.scu.edu.cn/activities/notice', {\r\n            headers: {\r\n                'User-Agent': config.ua,\r\n            },\r\n        });\r\n        const html = response.body;\r\n        const $ = load(html);\r\n\r\n        const listElement = $('body > div.wrapper > main > section > div > div > div.news > div > ul');\r\n        return listElement\r\n            .find('article')\r\n            .toArray()\r\n            .map((articleElement) => {\r\n                const titleElement = $(articleElement).find('li > div > div.news-text > h4 > a');\r\n                const timeElement = $(articleElement).find('li > div > div.news-text > span');\r\n                const imageElement = $(articleElement).find('li > div > div.news-img > a > img');\r\n\r\n                const link = titleElement.attr('href');\r\n                const title = titleElement.attr('title');\r\n                const pubDate = timeElement.text().trim();\r\n\r\n                return {\r\n                    title,\r\n                    link,\r\n                    itunes_item_image: imageElement.attr('src'),\r\n                    pubDate: parseDate(pubDate, 'YYYY-MM-DD'),\r\n                };\r\n            });\r\n    } catch {\r\n        // console.error(error);\r\n    }\r\n\r\n    return [];\r\n}\r\n\r\nexport async function getArticle(item) {\r\n    try {\r\n        const response = await got.get(item.link, {\r\n            headers: {\r\n                'User-Agent': config.ua,\r\n            },\r\n        });\r\n        const html = response.body;\r\n        const $ = load(html);\r\n        const articleContentElement = $('body > div > main > section > div > div > div.post-content-contaier > div');\r\n        const content = articleContentElement.html();\r\n\r\n        item.description = content;\r\n        return item;\r\n    } catch {\r\n        // console.error(error);\r\n    }\r\n\r\n    return item;\r\n}\r\n","// Warning: The author still knows nothing about javascript!\r\n\r\nimport { getNotifList, getArticle } from './_utils';\r\nimport { Route } from '@/types';\r\nimport cache from '@/utils/cache';\r\n\r\nexport const route: Route = {\r\n    path: '/scupi',\r\n    categories: ['university'],\r\n    example: '/scu/scupi',\r\n    parameters: {},\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    name: '匹兹堡学院通知',\r\n    maintainers: ['sitdownkevin'],\r\n    url: 'scupi.scu.edu.cn/activities/notice',\r\n    handler,\r\n    description: ``,\r\n};\r\n\r\nasync function handler() {\r\n    // feed the data to rss\r\n    const items = await getNotifList();\r\n    const itemsWithContent = await Promise.all(items.map((item) => cache.tryGet(item.link, () => getArticle(item))));\r\n\r\n    return {\r\n        title: '四川大学匹兹堡学院',\r\n        description: '四川大学匹兹堡学院官网通知',\r\n        language: 'zh-cn',\r\n        image: 'https://upload.wikimedia.org/wikipedia/zh/4/45/Sichuan_University_logo.svg',\r\n        logo: 'https://upload.wikimedia.org/wikipedia/zh/4/45/Sichuan_University_logo.svg',\r\n        link: 'https://scupi.scu.edu.cn/',\r\n        item: itemsWithContent,\r\n    };\r\n}\r\n"],"mappings":"yXAKA,eAAsB,GAAe,CACjC,GAAI,CACA,IAAM,EAAW,MAAMA,EAAI,IAAI,6CAA8C,CACzE,QAAS,CACL,aAAc,EAAO,MAGvB,EAAO,EAAS,KAChB,EAAI,EAAK,GAET,EAAc,EAAE,yEACtB,OAAO,EACF,KAAK,WACL,UACA,IAAK,GAAmB,CACrB,IAAM,EAAe,EAAE,GAAgB,KAAK,qCACtC,EAAc,EAAE,GAAgB,KAAK,mCACrC,EAAe,EAAE,GAAgB,KAAK,qCAEtC,EAAO,EAAa,KAAK,QACzB,EAAQ,EAAa,KAAK,SAC1B,EAAU,EAAY,OAAO,OAEnC,MAAO,CACH,QACA,OACA,kBAAmB,EAAa,KAAK,OACrC,QAAS,EAAU,EAAS,sBAGpC,EAIR,MAAO,GAGX,eAAsB,EAAW,EAAM,CACnC,GAAI,CACA,IAAM,EAAW,MAAMA,EAAI,IAAI,EAAK,KAAM,CACtC,QAAS,CACL,aAAc,EAAO,MAGvB,EAAO,EAAS,KAChB,EAAI,EAAK,GACT,EAAwB,EAAE,6EAC1B,EAAU,EAAsB,OAGtC,MADA,GAAK,YAAc,EACZ,OACH,EAIR,OAAO,ECtDX,MAAaC,EAAe,CACxB,KAAM,SACN,WAAY,CAAC,cACb,QAAS,aACT,WAAY,GACZ,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,KAAM,UACN,YAAa,CAAC,gBACd,IAAK,qCACL,UACA,YAAa,IAGjB,eAAe,GAAU,CAErB,IAAM,EAAQ,MAAM,IACd,EAAmB,MAAM,QAAQ,IAAI,EAAM,IAAK,GAASC,EAAM,OAAO,EAAK,SAAY,EAAW,MAExG,MAAO,CACH,MAAO,YACP,YAAa,gBACb,SAAU,QACV,MAAO,6EACP,KAAM,6EACN,KAAM,4BACN,KAAM"}