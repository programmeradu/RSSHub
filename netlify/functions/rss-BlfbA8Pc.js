import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import{art as n}from"./render-CxhTJIsl.js";import{invalid_parameter_default as r}from"./invalid-parameter-CUJdROXf.js";import{fallback as i,queryToBoolean as a}from"./readable-social-D7TWDGpz.js";import o from"node:path";import s from"dayjs";import c from"rss-parser";t();const l=/(.+)\s+is\s+([A-Z]+)\s+\((.+)\)/,u=e=>{let t=s.duration(e-0,`seconds`),n=t.days(),r=t.hours(),i=t.minutes(),a=t.seconds();return n>0?`${n}d ${r}h ${i}m ${a}s`:r>0?`${r}h ${i}m ${a}s`:i>0?`${i}m ${a}s`:`${a}s`};var d=class{constructor(e,t=0,n=0){this.name=e,this.uptime=t,this.downtime=n}uptimeRatio(){return this.uptime/(this.uptime+this.downtime)}downtimeRatio(){return this.downtime/(this.uptime+this.downtime)}up(e){this.uptime+=e-0}down(e){this.downtime+=e-0}};const f={path:`/rss/:id/:routeParams?`,categories:[`forecast`],example:`/uptimerobot/rss/u358785-e4323652448755805d668f1a66506f2f`,parameters:{id:"the last part of your RSS URL (e.g. `u358785-e4323652448755805d668f1a66506f2f` for `https://rss.uptimerobot.com/u358785-e4323652448755805d668f1a66506f2f`)",routeParams:`extra parameters, see the table below`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`rss.uptimerobot.com/:id`],target:`/rss/:id`}],name:`RSS`,maintainers:[`Rongronggg9`],handler:p,description:`| Key    | Description                                                              | Accepts        | Defaults to |
| ------ | ------------------------------------------------------------------------ | -------------- | ----------- |
| showID | Show monitor ID (disabling it will also disable link for each RSS entry) | 0/1/true/false | true        |`};async function p(t){let s=t.req.param(`id`),f=Object.fromEntries(new URLSearchParams(t.req.param(`routeParams`))),p=i(void 0,a(f.showID),!0),m=`https://rss.uptimerobot.com/${s}`,h=await new c({customFields:{item:[`details:duration`]}}).parseURL(m),g={},_=h.items.toReversed().map(t=>{let i=t.title.match(l);if(!i)throw new r(`Unexpected title, please open an issue.`);let[a,s,c]=i.slice(1);if(c!==t.link)throw new r(`Monitor ID mismatch, please open an issue.`);let f;try{f=!c.startsWith(`http`)&&c.includes(`.`)?new URL(`http://${c}`).href:new URL(c).href}catch{}let m=t[`details:duration`],h=g[a]=g[a]||new d(a);if(s===`UP`)h.up(m);else if(s===`DOWN`)h.down(m);else throw new r(`Unexpected status, please open an issue.`);let _=n(o.join(e,`templates/rss-e4db2a83.art`),{status:s,link:f,id:p?c:null,duration:u(m),uptime:u(h.uptime),downtime:u(h.downtime),uptime_ratio:Number(h.uptimeRatio()).toLocaleString(void 0,{style:`percent`,minimumFractionDigits:2}),details:t.content});return{...t,title:`[${s}] ${a}`,description:_,link:p?f:null}});return{title:`Uptime Robot - RSS (enhanced)`,description:h.description,link:m,item:_,image:`https://uptimerobot.com/favicon.ico`}}export{f as route};
//# sourceMappingURL=rss-BlfbA8Pc.js.map