{"version":3,"file":"category-CHhV3zOj.js","names":["route: Route","got","cache"],"sources":["../../lib/routes/4gamers/category.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport cache from '@/utils/cache';\r\nimport got from '@/utils/got';\r\nimport { parseList, parseItem, getCategories } from './utils';\r\n\r\nexport const route: Route = {\r\n    path: ['/', '/category/:category'],\r\n    radar: [\r\n        {\r\n            source: ['www.4gamers.com.tw/news', 'www.4gamers.com.tw/'],\r\n            target: '',\r\n        },\r\n    ],\r\n    name: 'Unknown',\r\n    maintainers: ['TonyRL'],\r\n    handler,\r\n    url: 'www.4gamers.com.tw/news',\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const category = ctx.req.param('category');\r\n    const limit = ctx.req.query('limit') ? Number.parseInt(ctx.req.query('limit')) : 25;\r\n    const isLatest = !category;\r\n\r\n    const { data: response } = await got(`https://www.4gamers.com.tw/site/api/news/${isLatest ? 'latest' : `by-category/${category}`}`, {\r\n        searchParams: {\r\n            nextStart: 0,\r\n            pageSize: limit,\r\n        },\r\n    });\r\n    const list = parseList(response.data.results);\r\n\r\n    const items = await Promise.all(list.map((item) => cache.tryGet(item.link, () => parseItem(item))));\r\n\r\n    let categories = [];\r\n    let categoryName = '最新消息';\r\n    if (!isLatest) {\r\n        categories = await getCategories(cache.tryGet);\r\n        categoryName = categories.find((c) => c.id === Number.parseInt(category)).name;\r\n    }\r\n\r\n    return {\r\n        title: `4Gamers - ${categoryName}`,\r\n        link: `https://www.4gamers.com.tw/news${isLatest ? '' : `/category/${category}/${categoryName}`}`,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"4cAKA,MAAaA,EAAe,CACxB,KAAM,CAAC,IAAK,uBACZ,MAAO,CACH,CACI,OAAQ,CAAC,0BAA2B,uBACpC,OAAQ,KAGhB,KAAM,UACN,YAAa,CAAC,UACd,UACA,IAAK,2BAGT,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAW,EAAI,IAAI,MAAM,YACzB,EAAQ,EAAI,IAAI,MAAM,SAAW,OAAO,SAAS,EAAI,IAAI,MAAM,UAAY,GAC3E,EAAW,CAAC,EAEZ,CAAE,KAAM,GAAa,MAAMC,EAAI,4CAA4C,EAAW,SAAW,eAAe,MAAc,CAChI,aAAc,CACV,UAAW,EACX,SAAU,KAGZ,EAAO,EAAU,EAAS,KAAK,SAE/B,EAAQ,MAAM,QAAQ,IAAI,EAAK,IAAK,GAASC,EAAM,OAAO,EAAK,SAAY,EAAU,MAEvF,EAAa,GACb,EAAe,OAMnB,OALK,IACD,EAAa,MAAM,EAAcA,EAAM,QACvC,EAAe,EAAW,KAAM,GAAM,EAAE,KAAO,OAAO,SAAS,IAAW,MAGvE,CACH,MAAO,aAAa,IACpB,KAAM,kCAAkC,EAAW,GAAK,aAAa,EAAS,GAAG,MACjF,KAAM"}