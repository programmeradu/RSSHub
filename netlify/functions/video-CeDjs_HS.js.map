{"version":3,"file":"video-CeDjs_HS.js","names":[],"sources":["../../lib/routes/manyvids/video.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport ofetch from '@/utils/ofetch';\r\nimport cache from '@/utils/cache';\r\nimport { UserProfile, Videos } from './types';\r\nimport { art } from '@/utils/render';\r\nimport path from 'node:path';\r\n\r\nexport const route: Route = {\r\n    path: '/profile/vids/:uid',\r\n    radar: [\r\n        {\r\n            source: ['www.manyvids.com/Profile/:uid/:handle/Store/*', 'www.manyvids.com/Profile/:uid/:handle/Store'],\r\n        },\r\n    ],\r\n    parameters: { uid: 'User ID, can be found in the URL.' },\r\n    name: 'Creator Videos',\r\n    example: '/manyvids/profile/vids/1001213004',\r\n    maintainers: ['TonyRL'],\r\n    handler,\r\n};\r\n\r\nconst getProfileById = (uid: string) => cache.tryGet(`manyvids:profile:${uid}`, () => ofetch(`https://www.manyvids.com/bff/profile/profiles/${uid}`)) as Promise<UserProfile>;\r\n\r\nconst render = (data) => art(path.join(__dirname, 'templates/video.art'), data);\r\n\r\nasync function handler(ctx) {\r\n    const { uid } = ctx.req.param();\r\n\r\n    const profile = await getProfileById(uid);\r\n    const videos = await ofetch<Videos>(`https://www.manyvids.com/bff/store/videos/${uid}/`, {\r\n        query: { page: 1 },\r\n    });\r\n\r\n    const items = videos.data.map((v) => ({\r\n        title: v.title,\r\n        link: `https://www.manyvids.com/Video/${v.id}/${v.slug}`,\r\n        author: v.creator.stageName,\r\n        description: render({ poster: v.thumbnail.url, src: v.preview.url }),\r\n    }));\r\n\r\n    return {\r\n        title: `${profile.displayName}'s Profile - Porn vids, Pics & More | ManyVids - ManyVids`,\r\n        link: `https://www.manyvids.com/Profile/${uid}/${profile.urlHandle}/Store/Videos`,\r\n        image: profile.avatar,\r\n        description: profile.bio,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"+UAOA,MAAa,EAAe,CACxB,KAAM,qBACN,MAAO,CACH,CACI,OAAQ,CAAC,gDAAiD,iDAGlE,WAAY,CAAE,IAAK,qCACnB,KAAM,iBACN,QAAS,oCACT,YAAa,CAAC,UACd,WAGE,EAAkB,GAAgB,EAAM,OAAO,oBAAoB,QAAa,EAAO,iDAAiD,MAExI,EAAU,GAAS,EAAI,EAAA,KAAA,EAAA,gCAA6C,GAE1E,eAAe,EAAQ,EAAK,CACxB,GAAM,CAAE,OAAQ,EAAI,IAAI,QAElB,EAAU,MAAM,EAAe,GAC/B,EAAS,MAAM,EAAe,6CAA6C,EAAI,GAAI,CACrF,MAAO,CAAE,KAAM,KAGb,EAAQ,EAAO,KAAK,IAAK,IAAO,CAClC,MAAO,EAAE,MACT,KAAM,kCAAkC,EAAE,GAAG,GAAG,EAAE,OAClD,OAAQ,EAAE,QAAQ,UAClB,YAAa,EAAO,CAAE,OAAQ,EAAE,UAAU,IAAK,IAAK,EAAE,QAAQ,SAGlE,MAAO,CACH,MAAO,GAAG,EAAQ,YAAY,2DAC9B,KAAM,oCAAoC,EAAI,GAAG,EAAQ,UAAU,eACnE,MAAO,EAAQ,OACf,YAAa,EAAQ,IACrB,KAAM"}