{"version":3,"file":"earthquake-B5u2JLMY.js","names":["route: Route","got"],"sources":["../../lib/routes/earthquake/index.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport got from '@/utils/got';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport timezone from '@/utils/timezone';\r\n\r\nexport const route: Route = {\r\n    path: '/:region?',\r\n    categories: ['forecast'],\r\n    example: '/earthquake',\r\n    parameters: { region: '区域，0全部，1国内（默认），2国外' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: true,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['www.cea.gov.cn/cea/xwzx/zqsd/index.html', 'www.cea.gov.cn/'],\r\n            target: '',\r\n        },\r\n    ],\r\n    name: '中国地震局',\r\n    maintainers: ['LogicJake'],\r\n    handler,\r\n    url: 'www.cea.gov.cn/cea/xwzx/zqsd/index.html',\r\n    description: `可通过全局过滤参数订阅您感兴趣的地区.`,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const region = ctx.req.param('region') ?? 1;\r\n    const api = 'https://www.cea.gov.cn/eportal/ui?struts.portlet.mode=view&struts.portlet.action=/portlet/expressEarthquake!queryExpressEarthquakeList.action&pageId=363409&moduleId=a852ba487b534470a84a30f00e7d6670';\r\n    const link = 'https://www.cea.gov.cn/cea/xwzx/zqsd/index.html';\r\n    const response = await got({\r\n        method: 'post',\r\n        url: api,\r\n        form: {\r\n            region,\r\n            dateType: 2,\r\n            magnitude: 0,\r\n        },\r\n    });\r\n\r\n    const data = response.data;\r\n\r\n    const out = data.map((item) => {\r\n        const { id, epicenter, latitudes, longitudes, depth, orig_time, num_mag } = item;\r\n        const date = orig_time;\r\n        const num = num_mag;\r\n\r\n        const description = `北京时间${date}，${epicenter}（纬度${latitudes}度，经度${longitudes}度）发生${num}级地震，震源深度${depth}千米`;\r\n        return {\r\n            title: `${epicenter}发生${num}级地震`,\r\n            link: `https://www.cea.gov.cn/eportal/ui?struts.portlet.mode=view&struts.portlet.action=/portlet/expressEarthquake!toNewInfoView.action&pageId=366521&id=${id}`,\r\n            pubDate: timezone(parseDate(date, 'YYYY-MM-DD HH:mm:ss'), +8),\r\n            description,\r\n        };\r\n    });\r\n\r\n    return {\r\n        title: '中国地震局震情速递',\r\n        link,\r\n        item: out,\r\n    };\r\n}\r\n"],"mappings":"uUAKA,MAAaA,EAAe,CACxB,KAAM,YACN,WAAY,CAAC,YACb,QAAS,cACT,WAAY,CAAE,OAAQ,sBACtB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,0CAA2C,mBACpD,OAAQ,KAGhB,KAAM,QACN,YAAa,CAAC,aACd,UACA,IAAK,0CACL,YAAa,uBAGjB,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAS,EAAI,IAAI,MAAM,WAAa,EAGpC,EAAW,MAAMC,EAAI,CACvB,OAAQ,OACR,IAAK,wMACL,KAAM,CACF,SACA,SAAU,EACV,UAAW,KAIb,EAAO,EAAS,KAEhB,EAAM,EAAK,IAAK,GAAS,CAC3B,GAAM,CAAE,KAAI,YAAW,YAAW,aAAY,QAAO,YAAW,WAAY,EACtE,EAAO,EACP,EAAM,EAEN,EAAc,OAAO,EAAK,GAAG,EAAU,KAAK,EAAU,MAAM,EAAW,MAAM,EAAI,UAAU,EAAM,IACvG,MAAO,CACH,MAAO,GAAG,EAAU,IAAI,EAAI,KAC5B,KAAM,qJAAqJ,IAC3J,QAAS,EAAS,EAAU,EAAM,uBAAwB,GAC1D,iBAIR,MAAO,CACH,MAAO,YACP,uDACA,KAAM"}