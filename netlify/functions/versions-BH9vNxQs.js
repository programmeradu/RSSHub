import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import{config as n}from"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{art as r}from"./render-CxhTJIsl.js";import{parseDate as i}from"./parse-date-Bgabdhlb.js";import{ofetch_default as a}from"./ofetch-Bzt0BXUH.js";import o from"node:path";import s from"markdown-it";t();const c=a.create({headers:{"user-agent":n.trueUA}}),l=s({html:!0}),u={path:`/project/:id/versions/:routeParams?`,categories:[`game`],example:`/modrinth/project/sodium/versions`,parameters:{id:`Id or slug of the Modrinth project`,routeParams:`Extra route params. See the table below for options`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`modrinth.com/mod/:id/*`,`modrinth.com/plugin/:id/*`,`modrinth.com/datapack/:id/*`,`modrinth.com/shader/:id/*`,`modrinth.com/resourcepack/:id/*`,`modrinth.com/modpack/:id/*`,`modrinth.com/mod/:id`,`modrinth.com/plugin/:id`,`modrinth.com/datapack/:id`,`modrinth.com/shader/:id`,`modrinth.com/resourcepack/:id`,`modrinth.com/modpack/:id`],target:`/project/:id/versions`}],name:`Project versions`,maintainers:[`SettingDust`],handler:d,description:`| Name           | Example                                      |
| -------------- | -------------------------------------------- |
| loaders        | loaders=fabric&loaders=quilt&loaders=forge |
| game_versions | game_versions=1.20.1&game_versions=1.20.2 |
| featured       | featured=true                                |`};async function d(t){let{id:n,routeParams:a}=t.req.param(),s=new URLSearchParams(a);try{let t=await c(`https://api.modrinth.com/v2/project/${n}`),a=await c(`https://api.modrinth.com/v2/project/${n}/version`,{query:{loaders:s.has(`loaders`)?JSON.stringify(s.getAll(`loaders`)):``,game_versions:s.has(`game_versions`)?JSON.stringify(s.getAll(`game_versions`)):``}}),u=await c(`https://api.modrinth.com/v2/users`,{query:{ids:JSON.stringify([...new Set(a.map(e=>e.author_id))])}}),d={};for(let e of u)d[e.id]=e;return{title:`${t.title} Modrinth versions`,description:t.description,link:`https://modrinth.com/project/${n}`,item:a.map(t=>({title:`${t.name} for ${t.loaders.join(`/`)} on ${[...new Set([t.game_versions[0],t.game_versions.at(-1)])].join(`-`)}`,link:`https://modrinth.com/project/${n}/version/${t.version_number}`,pubDate:i(t.date_published),description:r(o.join(e,`templates/version-c1e57753.art`),{...t,changelog:l.render(t.changelog)}),guid:t.id,author:d[t.author_id].username}))}}catch(e){throw e?.response?.statusCode===404?Error(`${e.message}: Project ${n} not found`):e}}export{u as route};
//# sourceMappingURL=versions-BH9vNxQs.js.map