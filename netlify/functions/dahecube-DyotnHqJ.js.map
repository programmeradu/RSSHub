{"version":3,"file":"dahecube-DyotnHqJ.js","names":["TYPE","parseUrl","utils","route: Route","got","cache"],"sources":["../../lib/routes/dahecube/utils.ts","../../lib/routes/dahecube/index.ts"],"sourcesContent":["const TYPE = {\r\n    recommend: {\r\n        name: '推荐',\r\n        id: 1,\r\n    },\r\n    history: {\r\n        name: '党史',\r\n        id: 37,\r\n    },\r\n    stock: {\r\n        name: '豫股',\r\n        id: 2,\r\n    },\r\n    business: {\r\n        name: '财经',\r\n        id: 4,\r\n    },\r\n    education: {\r\n        name: '投教',\r\n        id: 36,\r\n    },\r\n    finance: {\r\n        name: '金融',\r\n        id: 5,\r\n    },\r\n    science: {\r\n        name: '科创',\r\n        id: 19,\r\n    },\r\n    invest: {\r\n        name: '投融',\r\n        id: 29,\r\n    },\r\n    column: {\r\n        name: '专栏',\r\n        id: 33,\r\n    },\r\n};\r\n\r\nfunction parseUrl(type) {\r\n    return type === 'recommend' ? 'https://www.dahecube.com/index.html?recid=1' : `https://www.dahecube.com/channel.html?recid=${TYPE[type].id}`;\r\n}\r\n\r\nexport default { TYPE, parseUrl };\r\n","import { Route } from '@/types';\r\nimport cache from '@/utils/cache';\r\nimport got from '@/utils/got';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport utils from './utils';\r\nconst { TYPE, parseUrl } = utils;\r\n\r\nexport const route: Route = {\r\n    path: '/:type?',\r\n    categories: ['new-media'],\r\n    example: '/dahecube',\r\n    parameters: { type: '板块，见下表，默认为推荐' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    name: '新闻',\r\n    maintainers: ['linbuxiao'],\r\n    handler,\r\n    description: `| 推荐      | 党史    | 豫股  | 财经     | 投教      | 金融    | 科创    | 投融   | 专栏   |\r\n| --------- | ------- | ----- | -------- | --------- | ------- | ------- | ------ | ------ |\r\n| recommend | history | stock | business | education | finance | science | invest | column |`,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const type = ctx.req.param('type') ?? 'recommend';\r\n    const params = JSON.stringify({\r\n        channelid: TYPE[type].id,\r\n        pno: 1,\r\n        psize: 15,\r\n    });\r\n\r\n    const res = await got({\r\n        method: 'post',\r\n        url: 'https://app.dahecube.com/napi/news/pc/list',\r\n        headers: {\r\n            'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',\r\n        },\r\n        body: params,\r\n    });\r\n\r\n    const list = res.data.data.items.map((item) => ({\r\n        title: item.title,\r\n        pubDate: parseDate(item.pubtime, 'YYYY-MM-DD HH:ss:mm'),\r\n        author: item.source,\r\n        id: item.recid,\r\n    }));\r\n\r\n    const items = await Promise.all(\r\n        list.map((item) =>\r\n            cache.tryGet(item.id, async () => {\r\n                const detailResponse = await got({\r\n                    method: 'post',\r\n                    url: 'https://app.dahecube.com/napi/news/pc/artinfo',\r\n                    headers: {\r\n                        'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',\r\n                    },\r\n                    body: JSON.stringify({\r\n                        artid: item.id,\r\n                    }),\r\n                });\r\n\r\n                item.description = detailResponse.data.data.content;\r\n                item.link = `https://www.dahecube.com/article.html?artid=${item.id}`;\r\n                delete item.id;\r\n                return item;\r\n            })\r\n        )\r\n    );\r\n\r\n    const ret = {\r\n        title: '大河财立方',\r\n        link: parseUrl(type),\r\n        description: `大河财立方 ${TYPE[type].name}`,\r\n        language: 'zh-cn',\r\n        item: items,\r\n    };\r\n\r\n    ctx.set('json', ret);\r\n    return ret;\r\n}\r\n"],"mappings":"yUAAA,MAAMA,EAAO,CACT,UAAW,CACP,KAAM,KACN,GAAI,GAER,QAAS,CACL,KAAM,KACN,GAAI,IAER,MAAO,CACH,KAAM,KACN,GAAI,GAER,SAAU,CACN,KAAM,KACN,GAAI,GAER,UAAW,CACP,KAAM,KACN,GAAI,IAER,QAAS,CACL,KAAM,KACN,GAAI,GAER,QAAS,CACL,KAAM,KACN,GAAI,IAER,OAAQ,CACJ,KAAM,KACN,GAAI,IAER,OAAQ,CACJ,KAAM,KACN,GAAI,KAIZ,SAASC,EAAS,EAAM,CACpB,OAAO,IAAS,YAAc,8CAAgD,+CAA+CD,EAAK,GAAM,KAG5I,IAAA,EAAe,CAAE,KAAA,EAAM,SAAA,GCtCvB,KAAM,CAAE,OAAM,YAAaE,EAEdC,EAAe,CACxB,KAAM,UACN,WAAY,CAAC,aACb,QAAS,YACT,WAAY,CAAE,KAAM,gBACpB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,KAAM,KACN,YAAa,CAAC,aACd,UACA,YAAa;;+FAKjB,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAO,EAAI,IAAI,MAAM,SAAW,YAChC,EAAS,KAAK,UAAU,CAC1B,UAAW,EAAK,GAAM,GACtB,IAAK,EACL,MAAO,KAGL,EAAM,MAAMC,EAAI,CAClB,OAAQ,OACR,IAAK,6CACL,QAAS,CACL,eAAgB,oDAEpB,KAAM,IAGJ,EAAO,EAAI,KAAK,KAAK,MAAM,IAAK,IAAU,CAC5C,MAAO,EAAK,MACZ,QAAS,EAAU,EAAK,QAAS,uBACjC,OAAQ,EAAK,OACb,GAAI,EAAK,SAGP,EAAQ,MAAM,QAAQ,IACxB,EAAK,IAAK,GACNC,EAAM,OAAO,EAAK,GAAI,SAAY,CAC9B,IAAM,EAAiB,MAAMD,EAAI,CAC7B,OAAQ,OACR,IAAK,gDACL,QAAS,CACL,eAAgB,oDAEpB,KAAM,KAAK,UAAU,CACjB,MAAO,EAAK,OAOpB,MAHA,GAAK,YAAc,EAAe,KAAK,KAAK,QAC5C,EAAK,KAAO,+CAA+C,EAAK,KAChE,OAAO,EAAK,GACL,MAKb,EAAM,CACR,MAAO,QACP,KAAM,EAAS,GACf,YAAa,SAAS,EAAK,GAAM,OACjC,SAAU,QACV,KAAM,GAIV,OADA,EAAI,IAAI,OAAQ,GACT"}