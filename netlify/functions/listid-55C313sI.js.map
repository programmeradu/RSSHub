{"version":3,"file":"listid-55C313sI.js","names":["route: Route","InvalidParameterError","cache"],"sources":["../../lib/routes/yahoo/news/listid.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport cache from '@/utils/cache';\r\nimport { getList, parseList, parseItem } from './utils';\r\nimport InvalidParameterError from '@/errors/types/invalid-parameter';\r\n\r\nexport const route: Route = {\r\n    path: '/news/list/:region/:listId',\r\n    categories: ['new-media'],\r\n    example: '/yahoo/news/list/hk/09fcf7b0-0ab2-11e8-bf1f-4d52d4f79454',\r\n    parameters: { region: '`hk`, `tw`', listId: '見下表' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['hk.news.yahoo.com/'],\r\n        },\r\n        {\r\n            source: ['tw.news.yahoo.com/'],\r\n        },\r\n    ],\r\n    name: '合作媒體',\r\n    maintainers: ['TonyRL', 'williamgateszhao', 'tpnonthealps'],\r\n    handler,\r\n    description: `\r\n| 合作媒體 (\\`HK\\`) | \\`:listId\\`                              |\r\n| ----------------- | ---------------------------------------- |\r\n| 東方日報          | \\`33ddd580-0ab3-11e8-bfe1-4b555fb1e429\\` |\r\n| now.com           | \\`01b4d760-0ab4-11e8-af3a-54037d3dced3\\` |\r\n| am730             | \\`c4842090-0ab2-11e8-af7f-041a72ce7398\\` |\r\n| BBC               | \\`4d3fc9a0-fac8-11e9-87f2-564ca250983e\\` |\r\n| 信報財經新聞      | \\`5a8a0aa0-0ab3-11e8-b3dc-d990c79d6cb1\\` |\r\n| 香港電台          | \\`b4bfc2d0-0ab3-11e8-bf9f-c888fc09923f\\` |\r\n| 法新社            | \\`1cc44280-facb-11e9-ad7c-f3ba971275c8\\` |\r\n| Bloomberg         | \\`40023670-facc-11e9-9dde-9175ff306602\\` |\r\n| 香港動物報        | \\`6058fa9c-d74d-487a-8b49-aa99a2a2978e\\` |`,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const { region, listId } = ctx.req.param();\r\n    if (!['hk', 'tw'].includes(region)) {\r\n        throw new InvalidParameterError(`Unsupported region: ${region}`);\r\n    }\r\n\r\n    const response = await getList(region, listId);\r\n\r\n    // console.log('Response:', response.stream_items);\r\n    // console.log('Type of response:', typeof response.stream_items);\r\n    // console.log('Is response an array?', Array.isArray(response.stream_items));\r\n    const list = parseList(region, response.stream_items);\r\n\r\n    const items = await Promise.all(list.map((item) => parseItem(item, cache.tryGet)));\r\n\r\n    const author = items[0].author;\r\n    const atIndex = author.indexOf('@'); // fing '@'\r\n    const source = atIndex === -1 ? author : author.slice(atIndex + 1).trim();\r\n    // console.log(source);\r\n\r\n    return {\r\n        title: `Yahoo 新聞 - ${source ?? ''}`,\r\n        link: `https://${region}.news.yahoo.com`,\r\n        image: 'https://s.yimg.com/cv/apiv2/social/images/yahoo_default_logo-1200x1200.png',\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"odAKA,MAAaA,EAAe,CACxB,KAAM,6BACN,WAAY,CAAC,aACb,QAAS,2DACT,WAAY,CAAE,OAAQ,aAAc,OAAQ,OAC5C,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,uBAEb,CACI,OAAQ,CAAC,wBAGjB,KAAM,OACN,YAAa,CAAC,SAAU,mBAAoB,gBAC5C,UACA,YAAa,0qBAcjB,eAAe,EAAQ,EAAK,CACxB,GAAM,CAAE,SAAQ,UAAW,EAAI,IAAI,QACnC,GAAI,CAAC,CAAC,KAAM,MAAM,SAAS,GACvB,MAAM,IAAIC,EAAsB,uBAAuB,KAG3D,IAAM,EAAW,MAAM,EAAQ,EAAQ,GAKjC,EAAO,EAAU,EAAQ,EAAS,cAElC,EAAQ,MAAM,QAAQ,IAAI,EAAK,IAAK,GAAS,EAAU,EAAMC,EAAM,UAEnE,EAAS,EAAM,GAAG,OAClB,EAAU,EAAO,QAAQ,KACzB,EAAS,IAAY,GAAK,EAAS,EAAO,MAAM,EAAU,GAAG,OAGnE,MAAO,CACH,MAAO,cAAc,GAAU,KAC/B,KAAM,WAAW,EAAO,iBACxB,MAAO,6EACP,KAAM"}