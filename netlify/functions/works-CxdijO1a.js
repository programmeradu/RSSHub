import"./esm-shims-Dqvxr0BZ.js";import{config as e}from"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{cache_default as t}from"./cache-kimkMTWJ.js";import"./render-CxhTJIsl.js";import{ofetch_default as n}from"./ofetch-Bzt0BXUH.js";import{config_not_found_default as r}from"./config-not-found-BVqhRP9D.js";import{baseUrl as i,processWork as a}from"./utils-Bzyzoa63.js";const o={path:`/works/:username`,categories:[`picture`],example:`/skeb/works/@brm2_1925`,parameters:{username:`Skeb Username with @`},features:{requireConfig:[{name:`SKEB_BEARER_TOKEN`,optional:!1,description:'在瀏覽器開發者工具（F12）的主控台中輸入 `localStorage.getItem("token")` 獲取'}],requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`Creator Works`,maintainers:[`SnowAgar25`],handler:s,radar:[{title:`Creator Works`,source:[`skeb.jp/:username`],target:`/works/:username`}],description:`Get the latest works of a specific creator on Skeb`};async function s(o){let s=o.req.param(`username`);if(!e.skeb||!e.skeb.bearerToken)throw new r(`Skeb works RSS is disabled due to the lack of <a href="https://docs.rsshub.app/deploy/config#route-specific-configurations">relevant config</a>`);let c=`${i}/api/users/${s.replace(`@`,``)}/works`,l=await t.tryGet(c,async()=>{let r=async(i=0,a=3)=>{let o=await n(c,{retry:0,method:`GET`,query:{role:`creator`,sort:`date`,offset:`0`},headers:{"User-Agent":e.ua,Cookie:`request_key=${t.get(`skeb:request_key`)}`,Authorization:`Bearer ${e.skeb.bearerToken}`}}).catch(e=>{if(i>=a)throw Error(`Max retries reached`);let n=e.response?._data?.match(/request_key=(.*?);/)?.[1];if(n)return t.set(`skeb:request_key`,n),r(i+1,a);throw e});return o},i=await r();if(!i||!Array.isArray(i))throw Error(`Invalid data received from API`);return i.map(e=>a(e)).filter(Boolean)});return{title:`Skeb - ${s}'s Works`,link:`${i}/${s}`,item:l}}export{o as route};
//# sourceMappingURL=works-CxdijO1a.js.map