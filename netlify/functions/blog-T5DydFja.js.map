{"version":3,"file":"blog-T5DydFja.js","names":["ofetch","url","cache","route: Route"],"sources":["../../lib/routes/tailwindcss/constants.ts","../../lib/routes/tailwindcss/utils.ts","../../lib/routes/tailwindcss/blog.ts"],"sourcesContent":["/** The base URL of this route. */\r\nexport const BASE_URL = new URL('https://tailwindcss.com/');\r\n","import ofetch from '@/utils/ofetch';\r\nimport { Data, DataItem } from '@/types';\r\nimport { BASE_URL } from './constants';\r\nimport cache from '@/utils/cache';\r\nimport { load } from 'cheerio';\r\n\r\n/** Fetch the content of a given article. */\r\nexport const fetchArticleContent = async (url: string): Promise<string> => {\r\n    const data = await ofetch(url, { responseType: 'text' });\r\n    const $ = load(data);\r\n\r\n    return $('article.prose').html() ?? '';\r\n};\r\n\r\n/** Fetch the feed object. */\r\nexport const fetchFeed = async (limit: number): Promise<Data> => {\r\n    const url = new URL('/feeds/atom.xml', BASE_URL).href;\r\n\r\n    const data = await ofetch(url, { responseType: 'text' });\r\n\r\n    const $ = load(data, { xml: true });\r\n\r\n    const items = await Promise.all(\r\n        $('entry')\r\n            .toArray()\r\n            .slice(0, limit)\r\n            .map((entry) => {\r\n                const title = $(entry).find('title').text();\r\n                const id = $(entry).find('id').text();\r\n                const url = $(entry).find('link[href]').attr('href');\r\n                const imageUrl = $(entry).find('link[rel=\"enclosure\"]').attr('href');\r\n\r\n                if (url === undefined) {\r\n                    throw new Error(`No article URL found for article with id ${id}`);\r\n                }\r\n\r\n                return cache.tryGet(\r\n                    `tailwindcss:${id}`,\r\n                    async () =>\r\n                        ({\r\n                            title,\r\n                            link: url,\r\n                            image: imageUrl,\r\n                            description: await fetchArticleContent(url),\r\n                            author: $(entry)\r\n                                .find('author')\r\n                                .toArray()\r\n                                .map((el) => ({\r\n                                    name: $(el).find('name').text(),\r\n                                    url: $(el).find('url').text(),\r\n                                })),\r\n                            pubDate: $(entry).find('updated').text(),\r\n                            guid: $(entry).find('id').text(),\r\n                        }) as DataItem\r\n                );\r\n            })\r\n    );\r\n\r\n    return {\r\n        title: $('feed > title').text(),\r\n        item: items,\r\n        author: $('feed > author > name').text(),\r\n        logo: $('feed > logo').text(),\r\n        icon: $('feed > icon').text(),\r\n        description: $('feed > subtitle').text(),\r\n        link: $('feed > link[rel=\"alternate\"]').attr('href'),\r\n    } as Data;\r\n};\r\n","import { Route } from '@/types';\r\nimport { Context } from 'hono';\r\nimport { fetchFeed } from './utils';\r\n\r\nexport const handler = (ctx: Context) => {\r\n    const limit = Number.parseInt(ctx.req.query('limit') || '10');\r\n\r\n    return fetchFeed(limit);\r\n};\r\n\r\nexport const route: Route = {\r\n    path: '/blog',\r\n    categories: ['programming'],\r\n    example: '/tailwindcss/blog',\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    name: 'Blog',\r\n    maintainers: ['goestav'],\r\n    handler,\r\n};\r\n"],"mappings":"8PACA,MAAa,EAAW,IAAI,IAAI,4BCMnB,EAAsB,KAAO,IAAiC,CACvE,IAAM,EAAO,MAAMA,EAAO,EAAK,CAAE,aAAc,SACzC,EAAI,EAAK,GAEf,OAAO,EAAE,iBAAiB,QAAU,IAI3B,EAAY,KAAO,IAAiC,CAC7D,IAAM,EAAM,IAAI,IAAI,kBAAmB,GAAU,KAE3C,EAAO,MAAMA,EAAO,EAAK,CAAE,aAAc,SAEzC,EAAI,EAAK,EAAM,CAAE,IAAK,KAEtB,EAAQ,MAAM,QAAQ,IACxB,EAAE,SACG,UACA,MAAM,EAAG,GACT,IAAK,GAAU,CACZ,IAAM,EAAQ,EAAE,GAAO,KAAK,SAAS,OAC/B,EAAK,EAAE,GAAO,KAAK,MAAM,OACzBC,EAAM,EAAE,GAAO,KAAK,cAAc,KAAK,QACvC,EAAW,EAAE,GAAO,KAAK,yBAAyB,KAAK,QAE7D,GAAIA,IAAQ,IAAA,GACR,MAAU,MAAM,4CAA4C,KAGhE,OAAOC,EAAM,OACT,eAAe,IACf,UACK,CACG,QACA,KAAMD,EACN,MAAO,EACP,YAAa,MAAM,EAAoBA,GACvC,OAAQ,EAAE,GACL,KAAK,UACL,UACA,IAAK,IAAQ,CACV,KAAM,EAAE,GAAI,KAAK,QAAQ,OACzB,IAAK,EAAE,GAAI,KAAK,OAAO,UAE/B,QAAS,EAAE,GAAO,KAAK,WAAW,OAClC,KAAM,EAAE,GAAO,KAAK,MAAM,aAMlD,MAAO,CACH,MAAO,EAAE,gBAAgB,OACzB,KAAM,EACN,OAAQ,EAAE,wBAAwB,OAClC,KAAM,EAAE,eAAe,OACvB,KAAM,EAAE,eAAe,OACvB,YAAa,EAAE,mBAAmB,OAClC,KAAM,EAAE,gCAAgC,KAAK,UC7DxC,EAAW,GAAiB,CACrC,IAAM,EAAQ,OAAO,SAAS,EAAI,IAAI,MAAM,UAAY,MAExD,OAAO,EAAU,IAGRE,EAAe,CACxB,KAAM,QACN,WAAY,CAAC,eACb,QAAS,oBACT,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,KAAM,OACN,YAAa,CAAC,WACd"}