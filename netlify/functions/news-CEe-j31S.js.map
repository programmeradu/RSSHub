{"version":3,"file":"news-CEe-j31S.js","names":["route: Route","got"],"sources":["../../lib/routes/mihoyo/sr/news.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport got from '@/utils/got';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport timezone from '@/utils/timezone';\r\n\r\nconst categories = {\r\n    'zh-cn': {\r\n        'news-all': {\r\n            id: '255',\r\n            title: '最新',\r\n        },\r\n        news: {\r\n            id: '256',\r\n            title: '新闻',\r\n        },\r\n        notice: {\r\n            id: '257',\r\n            title: '公告',\r\n        },\r\n        activity: {\r\n            id: '258',\r\n            title: '活动',\r\n        },\r\n        link: 'https://sr.mihoyo.com/news',\r\n    },\r\n    'zh-tw': {\r\n        'news-all': {\r\n            id: '248',\r\n            title: '最新',\r\n        },\r\n        news: {\r\n            id: '249',\r\n            title: '資訊',\r\n        },\r\n        notice: {\r\n            id: '250',\r\n            title: '公告',\r\n        },\r\n        activity: {\r\n            id: '251',\r\n            title: '活動',\r\n        },\r\n        link: 'https://hsr.hoyoverse.com/zh-tw/news',\r\n    },\r\n};\r\n\r\nexport const route: Route = {\r\n    path: '/sr/:location?/:category?',\r\n    categories: ['game'],\r\n    example: '/mihoyo/sr',\r\n    parameters: { location: '区域，可选 `zh-cn`（国服，简中）或 `zh-tw`（国际服，繁中）', category: '分类，见下表，默认为最新' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['sr.mihoyo.com/news'],\r\n            target: '/sr',\r\n        },\r\n    ],\r\n    name: '崩坏：星穹铁道',\r\n    maintainers: ['shinanory'],\r\n    handler,\r\n    url: 'sr.mihoyo.com/news',\r\n    description: `#### 新闻 {#mi-ha-you-beng-huai-xing-qiong-tie-dao-xin-wen}\r\n\r\n| 最新     | 新闻 | 公告   | 活动     |\r\n| -------- | ---- | ------ | -------- |\r\n| news-all | news | notice | activity |`,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    // location 地区 category 类型\r\n    const { location = 'zh-cn', category = 'news-all' } = ctx.req.param();\r\n    const limit = ctx.req.query('limit') ? Number.parseInt(ctx.req.query('limit')) : 50;\r\n    const url =\r\n        location === 'zh-cn'\r\n            ? `https://api-takumi-static.mihoyo.com/content_v2_user/app/1963de8dc19e461c/getContentList?iPage=1&iPageSize=${limit}&sLangKey=zh-cn&isPreview=0&iChanId=${categories[location][category].id}`\r\n            : `https://api-os-takumi-static.hoyoverse.com/content_v2_user/app/113fe6d3b4514cdd/getContentList?iPage=1&iPageSize=${limit}&sLangKey=${location}&isPreview=0&iChanId=${categories[location][category].id}`;\r\n\r\n    const response = await got(url);\r\n    const list = response.data.data.list;\r\n    const items = list.map((item) => ({\r\n        title: item.sTitle,\r\n        description: item.sContent,\r\n        link: `${categories[location].link}/${item.iInfoId}`,\r\n        pubDate: timezone(parseDate(item.dtStartTime), +8),\r\n        category: item.sCategoryName,\r\n    }));\r\n\r\n    return {\r\n        title: `${categories[location][category].title}-崩坏：星穹铁道`,\r\n        link: url,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"uUAKA,MAAM,EAAa,CACf,QAAS,CACL,WAAY,CACR,GAAI,MACJ,MAAO,MAEX,KAAM,CACF,GAAI,MACJ,MAAO,MAEX,OAAQ,CACJ,GAAI,MACJ,MAAO,MAEX,SAAU,CACN,GAAI,MACJ,MAAO,MAEX,KAAM,8BAEV,QAAS,CACL,WAAY,CACR,GAAI,MACJ,MAAO,MAEX,KAAM,CACF,GAAI,MACJ,MAAO,MAEX,OAAQ,CACJ,GAAI,MACJ,MAAO,MAEX,SAAU,CACN,GAAI,MACJ,MAAO,MAEX,KAAM,yCAIDA,EAAe,CACxB,KAAM,4BACN,WAAY,CAAC,QACb,QAAS,aACT,WAAY,CAAE,SAAU,wCAAyC,SAAU,gBAC3E,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,sBACT,OAAQ,QAGhB,KAAM,UACN,YAAa,CAAC,aACd,UACA,IAAK,qBACL,YAAa;;;;0CAOjB,eAAe,EAAQ,EAAK,CAExB,GAAM,CAAE,WAAW,QAAS,WAAW,YAAe,EAAI,IAAI,QACxD,EAAQ,EAAI,IAAI,MAAM,SAAW,OAAO,SAAS,EAAI,IAAI,MAAM,UAAY,GAC3E,EACF,IAAa,QACP,8GAA8G,EAAM,sCAAsC,EAAW,GAAU,GAAU,KACzL,oHAAoH,EAAM,YAAY,EAAS,uBAAuB,EAAW,GAAU,GAAU,KAEzM,EAAW,MAAMC,EAAI,GACrB,EAAO,EAAS,KAAK,KAAK,KAC1B,EAAQ,EAAK,IAAK,IAAU,CAC9B,MAAO,EAAK,OACZ,YAAa,EAAK,SAClB,KAAM,GAAG,EAAW,GAAU,KAAK,GAAG,EAAK,UAC3C,QAAS,EAAS,EAAU,EAAK,aAAc,GAC/C,SAAU,EAAK,iBAGnB,MAAO,CACH,MAAO,GAAG,EAAW,GAAU,GAAU,MAAM,UAC/C,KAAM,EACN,KAAM"}