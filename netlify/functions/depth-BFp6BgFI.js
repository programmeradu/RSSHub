import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as n}from"./cache-kimkMTWJ.js";import{art as r}from"./render-CxhTJIsl.js";import{parseDate as i}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as a}from"./got-CdvI2yKX.js";import{invalid_parameter_default as o}from"./invalid-parameter-CUJdROXf.js";import{getSearchParams as s,rootUrl as c}from"./utils-vRWn3Cpl.js";import l from"node:path";import{load as u}from"cheerio";t();const d={1e3:`头条`,1003:`股市`,1135:`港股`,1007:`环球`,1005:`公司`,1118:`券商`,1110:`基金`,1006:`地产`,1032:`金融`,1119:`汽车`,1111:`科创`,1127:`创业版`,1160:`品见`,1124:`期货`,1176:`投教`},f={path:`/depth/:category?`,categories:[`finance`],example:`/cls/depth/1000`,parameters:{category:`分类代码，可在首页导航栏的目标网址 URL 中找到`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`深度`,maintainers:[`nczitzk`],handler:p,description:`| 头条 | 股市 | 港股 | 环球 | 公司 | 券商 | 基金 | 地产 | 金融 | 汽车 | 科创 | 创业版 | 品见 | 期货 | 投教 |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ------ | ---- | ---- | ---- |
| 1000 | 1003 | 1135 | 1007 | 1005 | 1118 | 1110 | 1006 | 1032 | 1119 | 1111 | 1127   | 1160 | 1124 | 1176 |`};async function p(t){let f=t.req.param(`category`)??`1000`,p=t.req.query(`limit`)?Number.parseInt(t.req.query(`limit`)):50,m=d[f];if(!m)throw new o(`Bad category. See <a href="https://docs.rsshub.app/routes/finance#cai-lian-she-shen-du">docs</a>`);let h=`${c}/v3/depth/home/assembled/${f}`,g=`${c}/depth?id=${f}`,_=await a({method:`get`,url:h,searchParams:s()}),v=[..._.data.data.top_article,..._.data.data.depth_list].slice(0,p).map(e=>({title:e.title||e.brief,link:`${c}/detail/${e.id}`,pubDate:i(e.ctime*1e3),author:e.source}));return v=await Promise.all(v.map(t=>n.tryGet(t.link,async()=>{let n=await a({method:`get`,url:t.link}),i=u(n.data),o=JSON.parse(i(`script#__NEXT_DATA__`).text()),s=o.props.initialState.detail.articleDetail;return t.author=s.author?.name??t.author??``,t.description=r(l.join(e,`templates/depth-e4f336cf.art`),{articleDetail:s}),t}))),{title:`财联社 - ${m}`,link:g,item:v}}export{f as route};
//# sourceMappingURL=depth-BFp6BgFI.js.map