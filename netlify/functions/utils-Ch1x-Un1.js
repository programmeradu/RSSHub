import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import{config as n}from"./config-Dl8a1sIg.js";import{cache_default as r}from"./cache-kimkMTWJ.js";import{art as i}from"./render-CxhTJIsl.js";import{parseDate as a}from"./parse-date-Bgabdhlb.js";import{ofetch_default as o}from"./ofetch-Bzt0BXUH.js";import s from"node:path";import{load as c}from"cheerio";t();const l=()=>r.tryGet(`aeon:buildId`,async()=>{let e=await o(`https://aeon.co`),t=c(e),n=JSON.parse(t(`script#__NEXT_DATA__`).text());return n.buildId},n.cache.routeExpire,!1),u=async t=>{let n=await Promise.all(t.map(t=>r.tryGet(t.link,async()=>{let n=await l(),r=await o(`https://aeon.co/_next/data/${n}/${t.type}s/${t.slug}.json?id=${t.slug}`),u=r.pageProps.article,d=u.type.toLowerCase();if(t.pubDate=a(u.publishedAt),d===`video`)t.description=i(s.join(e,`templates/video-69f6a825.art`),{article:u});else{if(u.audio?.id){let e=await o(`https://api.aeonmedia.co/graphql`,{method:`POST`,body:{query:`query getAudio($audioId: ID!) {
                                    audio(id: $audioId) {
                                        id
                                        streamUrl
                                    }
                                }`,variables:{audioId:u.audio.id},operationName:`getAudio`}});delete t.image,t.enclosure_url=e.data.audio.streamUrl,t.enclosure_type=`audio/mpeg`}let n=c(u.body,null,!1),r=u.image;n(`p.pullquote`).remove();let a=u.authors.map(e=>`<p>`+e.name+e.authorBio.replaceAll(/^<p>/g,` `)).join(``);t.description=i(s.join(e,`templates/essay-be5b1b9b.art`),{banner:r,authorsBio:a,content:n.html()})}return t})));return n};export{l as getBuildId,u as getData};
//# sourceMappingURL=utils-Ch1x-Un1.js.map