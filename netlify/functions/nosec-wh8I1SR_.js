import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{ofetch_default as e}from"./ofetch-Bzt0BXUH.js";import{got_default as t}from"./got-CdvI2yKX.js";import{load as n}from"cheerio";const r={threaten:`威胁情报`,security:`安全动态`,hole:`漏洞预警`,leakage:`数据泄露`,speech:`专题报告`,skill:`技术分析`,tool:`安全工具`},i={path:`/:keykind?`,categories:[`programming`],example:`/nosec/hole`,parameters:{keykind:`对应文章分类`},name:`Posts`,maintainers:[`hellodword`],description:"| 分类     | 标识       |\n| :------- | :--------- |\n| 威胁情报 | `threaten` |\n| 安全动态 | `security` |\n| 漏洞预警 | `hole`     |\n| 数据泄露 | `leakage`  |\n| 专题报告 | `speech`   |\n| 技术分析 | `skill`    |\n| 安全工具 | `tool`     |",handler:a,radar:[{source:[`nosec.org/home/index/:keykind`,`nosec.org/home/index`],target:e=>`/nosec${e.keykind?`/${e.keybind.replace(`.html`,``)}`:``}`}]};async function a(i){let a=await e.raw(`https://nosec.org/home/index`),o=n(a._data),s=o(`meta[name="csrf-token"]`).attr(`content`),c=a.headers.getSetCookie().toString(),l=c.match(/XSRF-TOKEN=[^\s;]+/)[0],u=c.match(/laravel_session[^\s;]+/)[0],d=i.req.param(`keykind`)||``,f,p,m;Object.hasOwn(r,d)?(f=`keykind=${d}&page=1`,p=`NOSEC 安全讯息平台 - ${r[d]}`,m=`https://nosec.org/home/index/${d}.html`):(f=`keykind=&page=1`,p=`NOSEC 安全讯息平台`,m=`https://nosec.org/home/index`);let h=await t({method:`post`,url:`https://nosec.org/home/ajaxindexdata`,headers:{"Content-Type":`application/x-www-form-urlencoded; charset=UTF-8`,Accept:`application/json`,cookie:`${l};${u}`,"X-CSRF-TOKEN":s},body:f}),g=h.data.data.threatData.data;return{title:p,link:m,description:p,item:g.map(e=>({title:e.title,description:e.summary,pubDate:new Date(e.publiced_at).toUTCString(),link:`https://nosec.org/home/detail/${e.id}.html`,author:e.username}))}}export{i as route};
//# sourceMappingURL=nosec-wh8I1SR_.js.map