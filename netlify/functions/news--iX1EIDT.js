import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as e}from"./cache-kimkMTWJ.js";import"./ofetch-Bzt0BXUH.js";import{got_default as t}from"./got-CdvI2yKX.js";import*as n from"node:url";import r from"node:querystring";const i=`http://jw.scut.edu.cn`,a=i+`/dist/`;i+``,i+``,i+``;const o=e=>`${i}/zhinan/cms/article/view.do?type=posts&id=${e}`,s=e=>`${i}/dist/#/detail/index?id=${e}&type=news`,c=e=>{let t=e.getTimezoneOffset()/60;return new Date(e.getTime()-3600*1e3*(8+t))},l=e=>{let t=new Date(e);return t.setHours(8),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),c(t)},u=e=>!!e.link,d=e=>e.replaceAll(`src="/`,`src="${n.resolve(i,`.`)}`).replaceAll(`href="/`,`href="${n.resolve(i,`.`)}`),f=e=>{if(!e.success)throw Error(`article api error`)},p=e=>e?`<p><img src="${e}"></p>`:``,m=e=>`<p>链接：<a href="${o(e)}">电脑版</a>&nbsp;|&nbsp;<a href="${s(e)}">手机版</a></p>`,h=e=>p(e.bannerUrl)+d(e.content)+m(e.id),g={path:`/jwc/news`,categories:[`university`],example:`/scut/jwc/news`,parameters:{},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`教务处新闻动态`,maintainers:[`imkero`],handler:_};async function _(){let n=r.stringify({pageNo:1,pageSize:20}),i=await t({method:`post`,url:`http://jw.scut.edu.cn/zhinan/jw/api/v2/findNewsTrends.do?${n}`,headers:{Referer:a}});f(i.data);let s=i.data.data.list,c=await Promise.all(s.map(async n=>{let i=o(n.id),s=await e.get(i);if(s)return JSON.parse(s);let c=r.stringify({id:n.id,categoryType:``}),d=await t({method:`post`,url:`http://jw.scut.edu.cn/zhinan/jw/api/v2/getArticleInfo.do?${c}`,headers:{Referer:a}});f(d.data);let p=d.data.data;p.id=n.id;let m=null;u(p)||(m=h(p));let g={title:p.name,link:i,description:m,pubDate:l(p.createDate).toUTCString()};return e.set(i,JSON.stringify(g)),g}));return{title:`华南理工大学教务处新闻动态`,link:`http://jw.scut.edu.cn/zhinan/cms/toNews.do`,item:c}}export{g as route};
//# sourceMappingURL=news--iX1EIDT.js.map