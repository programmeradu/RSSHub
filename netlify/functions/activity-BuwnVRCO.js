import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{art as n}from"./render-CxhTJIsl.js";import"./ofetch-Bzt0BXUH.js";import{got_default as r}from"./got-CdvI2yKX.js";import i from"node:path";import{load as a}from"cheerio";t();const o={path:`/activity/:city/:category/:subcategory/:keyword?`,categories:[`shopping`],example:`/damai/activity/上海/音乐会/全部/柴可夫斯基`,parameters:{city:"城市，如果不需要限制，请填入`全部`",category:"分类，如果不需要限制，请填入`全部`",subcategory:"子分类，如果不需要限制，请填入`全部`",keyword:`搜索关键字，置空为不限制`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`票务更新`,maintainers:[`hoilc`,`Konano`],handler:s,description:`城市、分类名、子分类名，请参见[大麦网搜索页面](https://search.damai.cn/search.htm)`};async function s(t){let o=t.req.param(`city`)===`全部`?``:t.req.param(`city`),s=t.req.param(`category`)===`全部`?``:t.req.param(`category`),c=t.req.param(`subcategory`)===`全部`?``:t.req.param(`subcategory`),l=t.req.param(`keyword`)??``,u=await r(`https://search.damai.cn/searchajax.html`,{searchParams:{keyword:l,cty:o,ctl:s,sctl:c,tsg:0,st:``,et:``,order:3,pageSize:30,currPage:1,tn:``}}),d=u.data,f=d.pageData.resultData||[];return{title:`大麦网票务 - ${o||`全国`} - ${s||`全部分类`}${c?` - `+c:``}${l?` - `+l:``}`,link:`https://search.damai.cn/search.htm`,allowEmpty:!0,item:f.map(t=>({title:t.nameNoHtml,author:t.actors?a(t.actors,null,!1).text():`大麦网`,description:n(i.join(e,`templates/activity-f0d47d24.art`),{item:t}),link:`https://detail.damai.cn/item.htm?id=${t.projectid}`}))}}export{o as route};
//# sourceMappingURL=activity-BuwnVRCO.js.map