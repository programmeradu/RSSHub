{"version":3,"file":"cccfna-RI2kIvOV.js","names":["route: Route","ofetch","list: DataItem[]","cache","$"],"sources":["../../lib/routes/cccfna/index.ts"],"sourcesContent":["import { Route, DataItem } from '@/types';\r\nimport cache from '@/utils/cache';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport timezone from '@/utils/timezone';\r\nimport { load } from 'cheerio';\r\nimport ofetch from '@/utils/ofetch';\r\n\r\nexport const route: Route = {\r\n    path: '/:category/:type?',\r\n    categories: ['government'],\r\n    example: '/cccfna/meirigengxin',\r\n    parameters: {\r\n        category: '文章种类，即一级分类，详情见下表',\r\n        type: '文章类型，即二级分类，详情见下表',\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['www.cccfna.org.cn/:category/:type?'],\r\n        },\r\n    ],\r\n    description: `\r\n::: tip\r\n存在**二级分类**的**一级分类**不能单独当作参数，如：\\`/cccfna/hangyezixun\\`\r\n:::\r\n\r\n文章的目录分级如下:\r\n\r\n- shanghuidongtai（商会通知）\r\n- meirigengxin（每日更新）\r\n- tongzhigonggao（通知公告）\r\n- hangyezixun（行业资讯）\r\n  - zhengcedaohang（政策导航）\r\n  - yujinxinxi（预警信息）\r\n  - shichangdongtai（市场动态）\r\n  - gongxuxinxi（供需信息）\r\n- maoyitongji（贸易统计）\r\n  - tongjikuaibao（统计快报）\r\n  - hangyetongji（行业统计）\r\n  - guobiemaoyi（国别贸易）\r\n  - maoyizhinan（贸易指南）\r\n- nongchanpinbaogao（农产品报告）\r\n  - nongchanpinyuebao（农产品月报）\r\n  - zhongdianchanpinyuebao（重点产品月报）\r\n  - zhongdianchanpinzoushi（重点产品走势）`,\r\n    name: '资讯信息',\r\n    maintainers: ['hualiong'],\r\n    handler: async (ctx) => {\r\n        const { category, type } = ctx.req.param();\r\n        const baseURL = `https://www.cccfna.org.cn/${category}${type ? '/' + type : ''}`;\r\n\r\n        const response = await ofetch(baseURL);\r\n        const $ = load(response);\r\n\r\n        const list: DataItem[] = $('body > script')\r\n            .last()\r\n            .text()\r\n            .match(new RegExp(`https://www.cccfna.org.cn/${category}/.+?.html`, 'g'))!\r\n            .slice(0, 15)\r\n            .map((link) => ({ title: '', link }));\r\n\r\n        const items = await Promise.all(\r\n            list.map((item) =>\r\n                cache.tryGet(item.link!, async () => {\r\n                    const $ = load(await ofetch(item.link!));\r\n                    const content = $('.list_cont');\r\n\r\n                    item.title = content.find('.title').text();\r\n                    item.pubDate = timezone(parseDate(content.find('.tip > .time').text(), '发布时间：YYYY-MM-DD'), +8);\r\n                    item.description = content.find('#article-content').html()!;\r\n\r\n                    return item;\r\n                })\r\n            )\r\n        );\r\n\r\n        return {\r\n            title: $('head > title').text(),\r\n            link: baseURL,\r\n            item: items as DataItem[],\r\n        };\r\n    },\r\n};\r\n"],"mappings":"qWAOA,MAAaA,EAAe,CACxB,KAAM,oBACN,WAAY,CAAC,cACb,QAAS,uBACT,WAAY,CACR,SAAU,mBACV,KAAM,oBAEV,MAAO,CACH,CACI,OAAQ,CAAC,wCAGjB,YAAa;;;;;;;;;;;;;;;;;;;;;;;oCAwBb,KAAM,OACN,YAAa,CAAC,YACd,QAAS,KAAO,IAAQ,CACpB,GAAM,CAAE,WAAU,QAAS,EAAI,IAAI,QAC7B,EAAU,6BAA6B,IAAW,EAAO,IAAM,EAAO,KAEtE,EAAW,MAAMC,EAAO,GACxB,EAAI,EAAK,GAETC,EAAmB,EAAE,iBACtB,OACA,OACA,MAAU,OAAO,6BAA6B,EAAS,WAAY,MACnE,MAAM,EAAG,IACT,IAAK,IAAU,CAAE,MAAO,GAAI,UAE3B,EAAQ,MAAM,QAAQ,IACxB,EAAK,IAAK,GACNC,EAAM,OAAO,EAAK,KAAO,SAAY,CACjC,IAAMC,EAAI,EAAK,MAAMH,EAAO,EAAK,OAC3B,EAAUG,EAAE,cAMlB,MAJA,GAAK,MAAQ,EAAQ,KAAK,UAAU,OACpC,EAAK,QAAU,EAAS,EAAU,EAAQ,KAAK,gBAAgB,OAAQ,mBAAoB,GAC3F,EAAK,YAAc,EAAQ,KAAK,oBAAoB,OAE7C,MAKnB,MAAO,CACH,MAAO,EAAE,gBAAgB,OACzB,KAAM,EACN,KAAM"}