import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import"./cache-kimkMTWJ.js";import"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as e}from"./got-CdvI2yKX.js";import{finishArticleItem as t}from"./wechat-mp-BwNEdjlr.js";import n from"dayjs";import{load as r}from"cheerio";const i={path:`/mp/msgalbum/:biz/:aid`,categories:[`new-media`],example:`/wechat/mp/msgalbum/MzA3MDM3NjE5NQ==/1375870284640911361`,parameters:{biz:`公众号id`,aid:`Tag id`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`公众号文章话题 Tag`,maintainers:[`MisteryMonster`],handler:a,description:"一些公众号（如看理想）会在微信文章里添加 Tag ，点入 Tag 的链接如 `https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzA3MDM3NjE5NQ==&action=getalbum&album_id=1375870284640911361`，其中`biz` 为 `MzA3MDM3NjE5NQ==`，`aid` 为 `1375870284640911361`。"};async function a(i){let{biz:a,aid:o}=i.req.param(),s=`&album_id=${o}`,c=await e({method:`get`,url:`https://mp.weixin.qq.com/mp/appmsgalbum?__biz=${a}&action=getalbum${s}`}),l=r(c.data),u=l(`li`).toArray(),d=l(`.album__author-name`).text()+`|`+l(`.album__label-title`).text(),f=await Promise.all(u.map(e=>{let n=l(e).attr(`data-link`).replace(`http://`,`https://`),r=l(e).attr(`data-title`),i={title:r,link:n,guid:n};return t(i)}));return{title:d,link:`https://mp.weixin.qq.com/mp/appmsgalbum?__biz=${a}&action=getalbum${s}`,item:u.map((e,t)=>({title:f[t].title,description:l(e).find(`.album__item-img`).html()+`<br><br>${f[t].description}`,link:f[t].link,guid:f[t].guid,author:f[t].author,pubDate:n.unix(l(e).find(`.js_article_create_time`).text()).format()}))}}export{i as route};
//# sourceMappingURL=msgalbum-DmZ2Zf6K.js.map