{"version":3,"file":"utils-64c9fN3C.js","names":["cache","ofetch"],"sources":["../../lib/routes/30secondsofcode/utils.ts"],"sourcesContent":["import { DataItem } from '@/types';\r\nimport { load } from 'cheerio';\r\nimport ofetch from '@/utils/ofetch';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport cache from '@/utils/cache';\r\n\r\nexport const rootUrl = 'https://www.30secondsofcode.org';\r\n\r\nexport async function processList(listElements) {\r\n    const items = await Promise.allSettled(\r\n        listElements.map((item) => {\r\n            const $ = load(item);\r\n            const link = $(' article > h3 > a').attr('href');\r\n            const date = $(' article > small > time').attr('datetime');\r\n            return processItem({ link, date });\r\n        })\r\n    );\r\n    return items.map((item) => (item.status === 'fulfilled' ? item.value : ({ title: 'Error Reading Item' } as DataItem)));\r\n}\r\n\r\nasync function processItem({ link: articleLink, date }) {\r\n    return await cache.tryGet(`30secondsofcode:${articleLink}`, async () => {\r\n        const finalLink = `${rootUrl}${articleLink}`;\r\n        const response = await ofetch(finalLink);\r\n        const $ = load(response);\r\n        const tags = $.root()\r\n            .find('body > main > nav > ol > li:not(:first-child):not(:last-child)')\r\n            .toArray()\r\n            .map((tag) => $(tag).find('a').text());\r\n        const article = $('main > article');\r\n        const title = article.find('h1').text();\r\n        article.find('img').each((_, element) => {\r\n            const img = $(element);\r\n            const src = img.attr('src');\r\n            if (src?.startsWith('/')) {\r\n                img.attr('src', `${rootUrl}${src}`);\r\n            }\r\n        });\r\n        const image = article.find('img').attr('src');\r\n        const description = article.clone().find('h1, script').remove().end().html();\r\n\r\n        return {\r\n            title,\r\n            link: finalLink,\r\n            pubDate: parseDate(date),\r\n            description,\r\n            author: '30 Seconds of Code',\r\n            category: tags,\r\n            image: `${rootUrl}${image}`,\r\n            banner: `${rootUrl}${image}`,\r\n        } as DataItem;\r\n    });\r\n}\r\n"],"mappings":"8LAMA,MAAa,EAAU,kCAEvB,eAAsB,EAAY,EAAc,CAC5C,IAAM,EAAQ,MAAM,QAAQ,WACxB,EAAa,IAAK,GAAS,CACvB,IAAM,EAAI,EAAK,GACT,EAAO,EAAE,qBAAqB,KAAK,QACnC,EAAO,EAAE,2BAA2B,KAAK,YAC/C,OAAO,EAAY,CAAE,OAAM,YAGnC,OAAO,EAAM,IAAK,GAAU,EAAK,SAAW,YAAc,EAAK,MAAS,CAAE,MAAO,uBAGrF,eAAe,EAAY,CAAE,KAAM,EAAa,QAAQ,CACpD,OAAO,MAAMA,EAAM,OAAO,mBAAmB,IAAe,SAAY,CACpE,IAAM,EAAY,GAAG,IAAU,IACzB,EAAW,MAAMC,EAAO,GACxB,EAAI,EAAK,GACT,EAAO,EAAE,OACV,KAAK,kEACL,UACA,IAAK,GAAQ,EAAE,GAAK,KAAK,KAAK,QAC7B,EAAU,EAAE,kBACZ,EAAQ,EAAQ,KAAK,MAAM,OACjC,EAAQ,KAAK,OAAO,MAAM,EAAG,IAAY,CACrC,IAAM,EAAM,EAAE,GACR,EAAM,EAAI,KAAK,OACjB,GAAK,WAAW,MAChB,EAAI,KAAK,MAAO,GAAG,IAAU,OAGrC,IAAM,EAAQ,EAAQ,KAAK,OAAO,KAAK,OACjC,EAAc,EAAQ,QAAQ,KAAK,cAAc,SAAS,MAAM,OAEtE,MAAO,CACH,QACA,KAAM,EACN,QAAS,EAAU,GACnB,cACA,OAAQ,qBACR,SAAU,EACV,MAAO,GAAG,IAAU,IACpB,OAAQ,GAAG,IAAU"}