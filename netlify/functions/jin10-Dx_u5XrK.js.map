{"version":3,"file":"jin10-Dx_u5XrK.js","names":[],"sources":["../../lib/routes/jin10/index.ts"],"sourcesContent":["import { Route, ViewType } from '@/types';\r\n\r\nimport cache from '@/utils/cache';\r\nimport got from '@/utils/got';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport timezone from '@/utils/timezone';\r\nimport { art } from '@/utils/render';\r\nimport path from 'node:path';\r\nimport { config } from '@/config';\r\n\r\nexport const route: Route = {\r\n    path: '/:important?',\r\n    categories: ['finance'],\r\n    view: ViewType.Notifications,\r\n    example: '/jin10',\r\n    parameters: { important: '只看重要，任意值开启，留空关闭' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['jin10.com/'],\r\n            target: '',\r\n        },\r\n    ],\r\n    name: '市场快讯',\r\n    maintainers: ['laampui'],\r\n    handler,\r\n    url: 'jin10.com/',\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const { important = false } = ctx.req.param();\r\n    const data = await cache.tryGet(\r\n        'jin10:index',\r\n        async () => {\r\n            const { data: response } = await got('https://flash-api.jin10.com/get_flash_list', {\r\n                headers: {\r\n                    'x-app-id': 'bVBF4FyRTn5NJF5n',\r\n                    'x-version': '1.0.0',\r\n                },\r\n                searchParams: {\r\n                    channel: '-8200',\r\n                    vip: '1',\r\n                },\r\n            });\r\n            return response.data.filter((item) => item.type !== 1);\r\n        },\r\n        config.cache.routeExpire,\r\n        false\r\n    );\r\n\r\n    const item = data.map((item) => {\r\n        const titleMatch = item.data.content.match(/^【(.*?)】/);\r\n        let title;\r\n        let content = item.data.content;\r\n        if (titleMatch) {\r\n            title = titleMatch[1];\r\n            content = content.replace(titleMatch[0], '');\r\n        } else {\r\n            title = item.data.vip_title || item.data.content;\r\n        }\r\n\r\n        return {\r\n            title,\r\n            description: art(path.join(__dirname, 'templates/description.art'), {\r\n                content,\r\n                pic: item.data.pic,\r\n            }),\r\n            pubDate: timezone(parseDate(item.time), 8),\r\n            link: item.data.link,\r\n            guid: `jin10:index:${item.id}`,\r\n            important: item.important,\r\n        };\r\n    });\r\n\r\n    return {\r\n        title: '金十数据',\r\n        link: 'https://www.jin10.com/',\r\n        item: important ? item.filter((item) => item.important) : item,\r\n    };\r\n}\r\n"],"mappings":"2iBAUA,MAAa,EAAe,CACxB,KAAM,eACN,WAAY,CAAC,WACb,KAAM,EAAS,cACf,QAAS,SACT,WAAY,CAAE,UAAW,mBACzB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,cACT,OAAQ,KAGhB,KAAM,OACN,YAAa,CAAC,WACd,UACA,IAAK,cAGT,eAAe,EAAQ,EAAK,CACxB,GAAM,CAAE,YAAY,IAAU,EAAI,IAAI,QAChC,EAAO,MAAM,EAAM,OACrB,cACA,SAAY,CACR,GAAM,CAAE,KAAM,GAAa,MAAM,EAAI,6CAA8C,CAC/E,QAAS,CACL,WAAY,mBACZ,YAAa,SAEjB,aAAc,CACV,QAAS,QACT,IAAK,OAGb,OAAO,EAAS,KAAK,OAAQ,GAAS,EAAK,OAAS,IAExD,EAAO,MAAM,YACb,IAGE,EAAO,EAAK,IAAK,GAAS,CAC5B,IAAM,EAAa,EAAK,KAAK,QAAQ,MAAM,YACvC,EACA,EAAU,EAAK,KAAK,QAQxB,OAPI,GACA,EAAQ,EAAW,GACnB,EAAU,EAAQ,QAAQ,EAAW,GAAI,KAEzC,EAAQ,EAAK,KAAK,WAAa,EAAK,KAAK,QAGtC,CACH,QACA,YAAa,EAAI,EAAA,KAAA,EAAA,sCAAmD,CAChE,UACA,IAAK,EAAK,KAAK,MAEnB,QAAS,EAAS,EAAU,EAAK,MAAO,GACxC,KAAM,EAAK,KAAK,KAChB,KAAM,eAAe,EAAK,KAC1B,UAAW,EAAK,aAIxB,MAAO,CACH,MAAO,OACP,KAAM,yBACN,KAAM,EAAY,EAAK,OAAQ,GAAS,EAAK,WAAa"}