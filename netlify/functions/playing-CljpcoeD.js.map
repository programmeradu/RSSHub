{"version":3,"file":"playing-CljpcoeD.js","names":["route: Route","got"],"sources":["../../lib/routes/douban/other/playing.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\n\r\nexport const route: Route = {\r\n    path: ['/movie/playing', '/movie/playing/:score'],\r\n    categories: ['social-media'],\r\n    example: '/douban/movie/playing',\r\n    parameters: {},\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    name: '正在上映的电影',\r\n    maintainers: ['DIYgod'],\r\n    handler,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const score = Number.parseFloat(ctx.req.param('score')) || 0;\r\n    const response = await got({\r\n        method: 'get',\r\n        url: `https://movie.douban.com/cinema/nowplaying/beijing`,\r\n    });\r\n    const $ = load(response.data);\r\n\r\n    return {\r\n        title: `正在上映的${score ? `超过 ${score} 分的` : ''}电影`,\r\n        link: `https://movie.douban.com/cinema/nowplaying/`,\r\n        item: $('.list-item')\r\n            .toArray()\r\n            .map((i) => {\r\n                const item = $(i);\r\n                const itemScore = Number.parseFloat(item.attr('data-score')) || 0;\r\n                return itemScore >= score\r\n                    ? {\r\n                          title: item.attr('data-title'),\r\n                          description: `标题：${item.attr('data-title')}<br>评分：${itemScore}<br>片长：${item.attr('data-duration')}<br>制片国家/地区：${item.attr('data-region')}<br>导演：${item.attr(\r\n                              'data-director'\r\n                          )}<br>主演：${item.attr('data-actors')}<br><img src=\"${item.find('.poster img').attr('src')}\">`,\r\n                          link: `https://movie.douban.com/subject/${item.attr('id')}`,\r\n                      }\r\n                    : null;\r\n            })\r\n            .filter(Boolean),\r\n        allowEmpty: true,\r\n    };\r\n}\r\n"],"mappings":"+PAIA,MAAaA,EAAe,CACxB,KAAM,CAAC,iBAAkB,yBACzB,WAAY,CAAC,gBACb,QAAS,wBACT,WAAY,GACZ,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,KAAM,UACN,YAAa,CAAC,UACd,WAGJ,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAQ,OAAO,WAAW,EAAI,IAAI,MAAM,WAAa,EACrD,EAAW,MAAMC,EAAI,CACvB,OAAQ,MACR,IAAK,uDAEH,EAAI,EAAK,EAAS,MAExB,MAAO,CACH,MAAO,QAAQ,EAAQ,MAAM,EAAM,KAAO,GAAG,IAC7C,KAAM,8CACN,KAAM,EAAE,cACH,UACA,IAAK,GAAM,CACR,IAAM,EAAO,EAAE,GACT,EAAY,OAAO,WAAW,EAAK,KAAK,gBAAkB,EAChE,OAAO,GAAa,EACd,CACI,MAAO,EAAK,KAAK,cACjB,YAAa,MAAM,EAAK,KAAK,cAAc,SAAS,EAAU,SAAS,EAAK,KAAK,iBAAiB,cAAc,EAAK,KAAK,eAAe,SAAS,EAAK,KACnJ,iBACF,SAAS,EAAK,KAAK,eAAe,gBAAgB,EAAK,KAAK,eAAe,KAAK,OAAO,IACzF,KAAM,oCAAoC,EAAK,KAAK,SAExD,OAET,OAAO,SACZ,WAAY"}