{"version":3,"file":"category-CL7nlPzX.js","names":["got","route: Route"],"sources":["../../lib/routes/abmedia/category.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport got from '@/utils/got';\r\nimport { parseDate } from '@/utils/parse-date';\r\n\r\nconst rootUrl = 'https://www.abmedia.io';\r\nconst cateAPIUrl = `${rootUrl}/wp-json/wp/v2/categories`;\r\nconst postsAPIUrl = `${rootUrl}/wp-json/wp/v2/posts`;\r\n\r\nconst getCategoryId = (category) => got.get(`${cateAPIUrl}?slug=${category}`).then((res) => res.data[0].id);\r\n\r\nexport const route: Route = {\r\n    path: '/:category?',\r\n    categories: ['new-media'],\r\n    example: '/abmedia/technology-development',\r\n    parameters: { category: '类别，默认为产品技术' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['www.abmedia.io/category/:catehory'],\r\n            target: '/:category',\r\n        },\r\n    ],\r\n    name: '类别',\r\n    maintainers: [],\r\n    handler,\r\n    description: `参数可以从链接中拿到，如：\r\n\r\n  \\`https://www.abmedia.io/category/technology-development\\` 对应 \\`/abmedia/technology-development\\``,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const category = ctx.req.param('category') ?? 'technology-development';\r\n    const limit = ctx.req.param('limit') ?? 25;\r\n    const categoryId = await getCategoryId(category);\r\n\r\n    const response = await got.get(`${postsAPIUrl}?categories=${categoryId}&page=1&per_page=${limit}`);\r\n    const data = response.data;\r\n\r\n    const items = data.map((item) => ({\r\n        title: item.title.rendered,\r\n        link: item.link,\r\n        description: item.content.rendered,\r\n        pubDate: parseDate(item.date),\r\n    }));\r\n\r\n    return {\r\n        title: `abmedia - ${category}`,\r\n        link: `${rootUrl}/category/${category}`,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"qRAIA,MAAM,EAAU,yBACV,EAAa,GAAG,EAAQ,2BACxB,EAAc,GAAG,EAAQ,sBAEzB,EAAiB,GAAaA,EAAI,IAAI,GAAG,EAAW,QAAQ,KAAY,KAAM,GAAQ,EAAI,KAAK,GAAG,IAE3FC,EAAe,CACxB,KAAM,cACN,WAAY,CAAC,aACb,QAAS,kCACT,WAAY,CAAE,SAAU,cACxB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,qCACT,OAAQ,eAGhB,KAAM,KACN,YAAa,GACb,UACA,YAAa,oHAKjB,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAW,EAAI,IAAI,MAAM,aAAe,yBACxC,EAAQ,EAAI,IAAI,MAAM,UAAY,GAClC,EAAa,MAAM,EAAc,GAEjC,EAAW,MAAMD,EAAI,IAAI,GAAG,EAAY,cAAc,EAAW,mBAAmB,KACpF,EAAO,EAAS,KAEhB,EAAQ,EAAK,IAAK,IAAU,CAC9B,MAAO,EAAK,MAAM,SAClB,KAAM,EAAK,KACX,YAAa,EAAK,QAAQ,SAC1B,QAAS,EAAU,EAAK,SAG5B,MAAO,CACH,MAAO,aAAa,IACpB,KAAM,GAAG,EAAQ,YAAY,IAC7B,KAAM"}