{"version":3,"file":"news-BwLXxLP-.js","names":["route: Route","cache","got"],"sources":["../../lib/routes/followin/news.ts"],"sourcesContent":["import { Route, ViewType } from '@/types';\r\nimport cache from '@/utils/cache';\r\nimport got from '@/utils/got';\r\nimport { baseUrl, favicon, getBuildId, parseList, parseItem } from './utils';\r\n\r\nexport const route: Route = {\r\n    path: '/news/:lang?',\r\n    categories: ['finance'],\r\n    view: ViewType.Articles,\r\n    example: '/followin/news',\r\n    parameters: {\r\n        lang: {\r\n            description: 'Language',\r\n            options: [\r\n                { value: 'en', label: 'English' },\r\n                { value: 'zh-Hans', label: '简体中文' },\r\n                { value: 'zh-Hant', label: '繁體中文' },\r\n                { value: 'vi', label: 'Tiếng Việt' },\r\n            ],\r\n            default: 'en',\r\n        },\r\n    },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['followin.io/:lang?/news', 'followin.io/news'],\r\n        },\r\n    ],\r\n    name: 'News',\r\n    maintainers: ['TonyRL'],\r\n    handler,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const { lang = 'en' } = ctx.req.param();\r\n    const { limit = 20 } = ctx.req.query();\r\n\r\n    const buildId = await getBuildId(cache.tryGet);\r\n    const { data: response } = await got(`${baseUrl}/_next/data/${buildId}/${lang}/news.json`);\r\n\r\n    const list = parseList(response.pageProps.dehydratedState.queries.find((q) => q.queryKey[0] === '/feed/list/recommended/news').state.data.pages[0].list.slice(0, limit), lang, buildId);\r\n    const items = await Promise.all(list.map((item) => parseItem(item, cache.tryGet)));\r\n\r\n    return {\r\n        title: `${lang === 'en' ? 'News' : lang === 'vi' ? 'Bản tin' : '快讯'} - Followin`,\r\n        link: `${baseUrl}/${lang}/news`,\r\n        image: favicon,\r\n        language: lang,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"0eAKA,MAAaA,EAAe,CACxB,KAAM,eACN,WAAY,CAAC,WACb,KAAM,EAAS,SACf,QAAS,iBACT,WAAY,CACR,KAAM,CACF,YAAa,WACb,QAAS,CACL,CAAE,MAAO,KAAM,MAAO,WACtB,CAAE,MAAO,UAAW,MAAO,QAC3B,CAAE,MAAO,UAAW,MAAO,QAC3B,CAAE,MAAO,KAAM,MAAO,eAE1B,QAAS,OAGjB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,0BAA2B,sBAG5C,KAAM,OACN,YAAa,CAAC,UACd,WAGJ,eAAe,EAAQ,EAAK,CACxB,GAAM,CAAE,OAAO,MAAS,EAAI,IAAI,QAC1B,CAAE,QAAQ,IAAO,EAAI,IAAI,QAEzB,EAAU,MAAM,EAAWC,EAAM,QACjC,CAAE,KAAM,GAAa,MAAMC,EAAI,GAAG,EAAQ,cAAc,EAAQ,GAAG,EAAK,aAExE,EAAO,EAAU,EAAS,UAAU,gBAAgB,QAAQ,KAAM,GAAM,EAAE,SAAS,KAAO,+BAA+B,MAAM,KAAK,MAAM,GAAG,KAAK,MAAM,EAAG,GAAQ,EAAM,GACzK,EAAQ,MAAM,QAAQ,IAAI,EAAK,IAAK,GAAS,EAAU,EAAMD,EAAM,UAEzE,MAAO,CACH,MAAO,GAAG,IAAS,KAAO,OAAS,IAAS,KAAO,UAAY,KAAK,aACpE,KAAM,GAAG,EAAQ,GAAG,EAAK,OACzB,MAAO,EACP,SAAU,EACV,KAAM"}