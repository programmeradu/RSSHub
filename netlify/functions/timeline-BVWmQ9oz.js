import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as n}from"./cache-kimkMTWJ.js";import{art as r}from"./render-CxhTJIsl.js";import{parseDate as i}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as a}from"./got-CdvI2yKX.js";import{ViewType as o}from"./types-A5bA50Mg.js";import s from"node:path";import{load as c}from"cheerio";t();const l={path:`/timeline/:category?`,categories:[`finance`],view:o.Articles,example:`/jinse/timeline`,parameters:{category:{description:`分类`,options:[{value:`头条`,label:`头条`},{value:`独家`,label:`独家`},{value:`铭文`,label:`铭文`},{value:`产业`,label:`产业`},{value:`项目`,label:`项目`},{value:`政策`,label:`政策`},{value:`AI`,label:`AI`},{value:`Web 3.0`,label:`Web 3.0`},{value:`以太坊 2.0`,label:`以太坊 2.0`},{value:`DeFi`,label:`DeFi`},{value:`Layer2`,label:`Layer2`},{value:`NFT`,label:`NFT`},{value:`DAO`,label:`DAO`},{value:`百科`,label:`百科`}],default:`头条`}},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`首页`,maintainers:[`nczitzk`],handler:u,description:`| 头条   | 独家 | 铭文    | 产业       | 项目 |
| ------ | ---- | ------- | ---------- | ---- |
| 政策   | AI   | Web 3.0 | 以太坊 2.0 | DeFi |
| Layer2 | NFT  | DAO     | 百科       |      |`};async function u(t){let{category:o=`头条`}=t.req.param(),l=t.req.query(`limit`)?Number.parseInt(t.req.query(`limit`),10):50,u=`https://www.jinse.cn`,d=new URL(`noah/v3/timelines`,`https://api.jinse.cn`).href,f=u,{data:p}=await a(d,{searchParams:{catelogue_key:o===`头条`?`www`:o,limit:l,information_id:0,flag:`up`}}),m=p.data.list.slice(0,l).map(t=>(t=t.object_1??t.object_2,{title:t.title,link:t.jump_url,description:r(s.join(e,`templates/description-e9a60166.art`),{images:t.cover?[{src:t.cover.replace(/_[^\W_]+(\.\w+)$/,`_true$1`),alt:t.title}]:void 0,intro:t.summary,description:t.content}),author:t.author.nickname,guid:`jinse${/\/lives\//.test(t.jump_url)?`-lives`:``}-${t.id}`,pubDate:i(t.published_at,`X`),upvotes:t.up_counts??0,downvotes:t.down_counts??0,comments:t.comment_count??0}));m=await Promise.all(m.map(t=>n.tryGet(t.link,async()=>{if(/\/lives\//.test(t.link))return t;let{data:n}=await a(t.link),i=c(n);return t.description+=r(s.join(e,`templates/description-e9a60166.art`),{description:i(`section.js-article-content`).html()||i(`div.js-article`).html()}),t.category=i(`section.js-article-tag_state_1 a span`).toArray().map(e=>i(e).text()),t})));let{data:h}=await a(f),g=c(h),_=g(`meta[name="author"]`).prop(`content`),v=g(`a.js-logoBox img`).prop(`src`),y=new URL(g(`link[rel="favicon"]`).prop(`href`),u).href;return{item:m,title:`${_} - ${o}`,link:f,description:g(`meta[name="description"]`).prop(`content`),language:g(`html`).prop(`lang`),image:v,icon:y,logo:y,subtitle:g(`meta[name="keywords"]`).prop(`content`),author:_,allowEmpty:!0}}export{l as route};
//# sourceMappingURL=timeline-BVWmQ9oz.js.map