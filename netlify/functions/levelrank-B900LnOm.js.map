{"version":3,"file":"levelrank-B900LnOm.js","names":["route: Route","ofetch"],"sources":["../../lib/routes/air-level/levelrank.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport ofetch from '@/utils/ofetch'; // 统一使用的请求库\r\nimport { load } from 'cheerio'; // 类似 jQuery 的 API HTML 解析器\r\n\r\nexport const route: Route = {\r\n    path: ['/rank/:status?'],\r\n    radar: [\r\n        {\r\n            source: ['m.air-level.com/rank/:status', 'm.air-level.com/rank'],\r\n            target: '/rank/:status',\r\n        },\r\n    ],\r\n    parameters: {\r\n        status: '地区',\r\n    },\r\n    name: '空气质量排行',\r\n    maintainers: ['lifetraveler'],\r\n    example: '/air-level/rank/best,/air-level/rank',\r\n    handler,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const status = ctx.req.param('status');\r\n    const currentUrl = 'https://m.air-level.com/rank';\r\n    const response = await ofetch(currentUrl);\r\n    const $ = load(response);\r\n    let table = '';\r\n    let title = '';\r\n\r\n    const titleBest = $('body > div.container > div.row.page > div:nth-child(1) > div:nth-child(5) > h3').text().replaceAll('[]', '');\r\n    const tableBest = $('body > div.container > div.row.page > div:nth-child(1) > div:nth-child(5) > table').html();\r\n    const titleWorst = $('body > div.container > div.row.page > div:nth-child(1) > div:nth-child(3) > h3').text().replaceAll('[]', '');\r\n    const tableWorst = $('body > div.container > div.row.page > div:nth-child(1) > div:nth-child(3) > table').html();\r\n\r\n    if (status) {\r\n        if (status === 'best') {\r\n            title = titleBest;\r\n            table = `<table border=\"1 solid black\">${tableBest}</table>`;\r\n        }\r\n\r\n        if (status === 'worsest') {\r\n            title = titleWorst;\r\n            table = `<table border=\"1 solid black\">${tableWorst}</table>`;\r\n        }\r\n    } else {\r\n        title = $('body > div.container > div.row.page > div:nth-child(1) > h2').text().replaceAll('[]', '');\r\n        table = `${titleBest}<br/><table border=\"1 solid black\">${tableBest}</table><br/><table border=\"1 solid black\">${titleWorst}<br/>${tableWorst}</table>`;\r\n    }\r\n\r\n    const pubtime = $('body > div.container > div.row.page > div:nth-child(1) > h4').text();\r\n    const items = [\r\n        {\r\n            title,\r\n            link: currentUrl,\r\n            description: table,\r\n            guid: pubtime,\r\n        },\r\n    ];\r\n    return {\r\n        title,\r\n        item: items,\r\n        description: '空气质量排行',\r\n        link: currentUrl,\r\n    };\r\n}\r\n"],"mappings":"0MAIA,MAAaA,EAAe,CACxB,KAAM,CAAC,kBACP,MAAO,CACH,CACI,OAAQ,CAAC,+BAAgC,wBACzC,OAAQ,kBAGhB,WAAY,CACR,OAAQ,MAEZ,KAAM,SACN,YAAa,CAAC,gBACd,QAAS,uCACT,WAGJ,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAS,EAAI,IAAI,MAAM,UACvB,EAAa,+BACb,EAAW,MAAMC,EAAO,GACxB,EAAI,EAAK,GACX,EAAQ,GACR,EAAQ,GAEN,EAAY,EAAE,kFAAkF,OAAO,WAAW,KAAM,IACxH,EAAY,EAAE,qFAAqF,OACnG,EAAa,EAAE,kFAAkF,OAAO,WAAW,KAAM,IACzH,EAAa,EAAE,qFAAqF,OAEtG,GACI,IAAW,SACX,EAAQ,EACR,EAAQ,iCAAiC,EAAU,WAGnD,IAAW,YACX,EAAQ,EACR,EAAQ,iCAAiC,EAAW,aAGxD,EAAQ,EAAE,+DAA+D,OAAO,WAAW,KAAM,IACjG,EAAQ,GAAG,EAAU,qCAAqC,EAAU,6CAA6C,EAAW,OAAO,EAAW,WAGlJ,IAAM,EAAU,EAAE,+DAA+D,OAC3E,EAAQ,CACV,CACI,QACA,KAAM,EACN,YAAa,EACb,KAAM,IAGd,MAAO,CACH,QACA,KAAM,EACN,YAAa,SACb,KAAM"}