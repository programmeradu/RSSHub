import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as n}from"./cache-kimkMTWJ.js";import{art as r}from"./render-CxhTJIsl.js";import{parseDate as i}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as a}from"./got-CdvI2yKX.js";import o from"node:path";import{load as s}from"cheerio";import c from"iconv-lite";t();const l={path:`/new`,categories:[`blog`],example:`/xys/new`,parameters:{},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`xys.org/`,`xys.org/new.html`]}],name:`新到资料`,maintainers:[`wenzhenl`],handler:u,url:`xys.org/`};async function u(t){let l=`http://www.xys.org`,u=`${l}/new.html`,d=await a({method:`get`,url:u,responseType:`buffer`}),f=c.decode(d.data,`gb2312`),p=s(f),m=p(`li a`).slice(4,t.req.query(`limit`)?Number.parseInt(t.req.query(`limit`)):30).toArray().map(e=>{e=p(e);let t=e.attr(`href`);/^https?:\/\//.test(t)||(t=l+`/`+t.replace(/^\//,``));let n=e.parent().text().trim().slice(0,8);return n=i(n,`YY.MM.DD`),{title:e.text(),link:t,pubDate:n}});return m=await Promise.all(m.filter(e=>!e.link.endsWith(`.zip`)).map(t=>n.tryGet(t.link,async()=>{let n=/(?:https?:\/\/)?(?:www\.)?youtu\.?be(?:\.com)?\/?.*(?:watch|embed)?(?:.*v=|v\/|\/)([\w-]+)&?/g,i=t.link.match(n);if(i)t.description=r(o.join(e,`templates/desc-e08456f5.art`),{youTube:t.link.slice(32)});else{let e=await a({method:`get`,url:t.link,responseType:`buffer`}),n=c.decode(e.data,`gb2312`),r=s(n);t.description=r.text().replaceAll(`
`,`<br>
`)}return t}))),{title:`新语丝 - 新到资料`,link:u,item:m}}export{l as route};
//# sourceMappingURL=new-DThZd3Ed.js.map