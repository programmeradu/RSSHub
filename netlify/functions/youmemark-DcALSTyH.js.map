{"version":3,"file":"youmemark-DcALSTyH.js","names":["route: Route","ofetch","items: Data['item']"],"sources":["../../lib/routes/youmemark/index.ts"],"sourcesContent":["import { Route, Data } from '@/types';\r\nimport ofetch from '@/utils/ofetch';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport { load } from 'cheerio';\r\n\r\nexport const route: Route = {\r\n    path: '/:userid',\r\n    categories: ['blog'],\r\n    example: '/youmemark/pseudoyu',\r\n    parameters: { userid: '`userid` is the user id of youmemark' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    name: 'Bookmarks',\r\n    maintainers: ['pseudoyu'],\r\n    handler,\r\n    radar: [\r\n        {\r\n            source: ['youmemark.com/user/:userid'],\r\n            target: '/:userid',\r\n        },\r\n    ],\r\n    description: `Get user's public bookmarks from YouMeMark\r\n::: tip\r\n  Add \\`?limit=<number>\\` to the end of the route to limit the number of items. Default is 10.\r\n:::`,\r\n};\r\n\r\nasync function handler(ctx): Promise<Data> {\r\n    const userid = ctx.req.param('userid');\r\n    const limit = ctx.req.query('limit') ? Number.parseInt(ctx.req.query('limit')) : 10;\r\n\r\n    const response = await ofetch(`https://youmemark.com/user/${userid}`, {\r\n        headers: {\r\n            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36',\r\n        },\r\n    });\r\n\r\n    const $ = load(response);\r\n\r\n    const name = $('h2.font-bold').text().trim();\r\n    const avatar = $('span.relative.flex img, span.relative.flex.shrink-0 img').attr('src');\r\n    const intro = $('.text-center .prose p, .text-sm.text-gray-500.text-center .prose p').first().text().trim();\r\n\r\n    const items: Data['item'] = [];\r\n    $('h2:contains(\"收集箱\")')\r\n        .parent()\r\n        .find('.rounded-lg.space-y-2')\r\n        .each((_, element) => {\r\n            const $item = $(element);\r\n\r\n            const $linkDiv = $item.find('> div').first();\r\n            const $link = $linkDiv.find('a');\r\n            const title = $link.find('span').first().text().trim();\r\n            const domain = $link.find('span').last().text().trim().replaceAll(/[()]/g, '').trim();\r\n            const link = $link.attr('href');\r\n\r\n            const $contentDiv = $linkDiv.find('> div.text-sm.text-gray-500');\r\n            const content = $contentDiv.find('p').text().trim();\r\n\r\n            const dateStr = $item.find('.text-xs.text-gray-500 span').text().trim();\r\n\r\n            if (link && title && dateStr) {\r\n                items.push({\r\n                    title,\r\n                    link,\r\n                    description: content,\r\n                    pubDate: parseDate(dateStr, 'YYYY-MM-DD'),\r\n                    author: domain,\r\n                    guid: link,\r\n                });\r\n            }\r\n        });\r\n\r\n    return {\r\n        title: `${name}'s Bookmarks - YouMeMark`,\r\n        link: `https://youmemark.com/user/${userid}`,\r\n        description: intro,\r\n        image: avatar,\r\n        item: items.slice(0, limit),\r\n        language: 'en',\r\n    } as Data;\r\n}\r\n"],"mappings":"+PAKA,MAAaA,EAAe,CACxB,KAAM,WACN,WAAY,CAAC,QACb,QAAS,sBACT,WAAY,CAAE,OAAQ,wCACtB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,KAAM,YACN,YAAa,CAAC,YACd,UACA,MAAO,CACH,CACI,OAAQ,CAAC,8BACT,OAAQ,aAGhB,YAAa;;;MAMjB,eAAe,EAAQ,EAAoB,CACvC,IAAM,EAAS,EAAI,IAAI,MAAM,UACvB,EAAQ,EAAI,IAAI,MAAM,SAAW,OAAO,SAAS,EAAI,IAAI,MAAM,UAAY,GAE3E,EAAW,MAAMC,EAAO,8BAA8B,IAAU,CAClE,QAAS,CACL,aAAc,qHAIhB,EAAI,EAAK,GAET,EAAO,EAAE,gBAAgB,OAAO,OAChC,EAAS,EAAE,2DAA2D,KAAK,OAC3E,EAAQ,EAAE,sEAAsE,QAAQ,OAAO,OAE/FC,EAAsB,GA8B5B,OA7BA,EAAE,sBACG,SACA,KAAK,yBACL,MAAM,EAAG,IAAY,CAClB,IAAM,EAAQ,EAAE,GAEV,EAAW,EAAM,KAAK,SAAS,QAC/B,EAAQ,EAAS,KAAK,KACtB,EAAQ,EAAM,KAAK,QAAQ,QAAQ,OAAO,OAC1C,EAAS,EAAM,KAAK,QAAQ,OAAO,OAAO,OAAO,WAAW,QAAS,IAAI,OACzE,EAAO,EAAM,KAAK,QAElB,EAAc,EAAS,KAAK,+BAC5B,EAAU,EAAY,KAAK,KAAK,OAAO,OAEvC,EAAU,EAAM,KAAK,+BAA+B,OAAO,OAE7D,GAAQ,GAAS,GACjB,EAAM,KAAK,CACP,QACA,OACA,YAAa,EACb,QAAS,EAAU,EAAS,cAC5B,OAAQ,EACR,KAAM,MAKf,CACH,MAAO,GAAG,EAAK,0BACf,KAAM,8BAA8B,IACpC,YAAa,EACb,MAAO,EACP,KAAM,EAAM,MAAM,EAAG,GACrB,SAAU"}