import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import{config as n}from"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{cache_default as r}from"./cache-kimkMTWJ.js";import{art as i}from"./render-CxhTJIsl.js";import{parseDate as a}from"./parse-date-Bgabdhlb.js";import{ofetch_default as o}from"./ofetch-Bzt0BXUH.js";import s from"node:path";import*as c from"cheerio";t();const l=`https://www.famitsu.com`,u={path:`/category/:category?`,categories:[`game`],example:`/famitsu/category/new-article`,parameters:{category:"Category, see table below, `new-article` by default"},radar:[{source:[`www.famitsu.com/category/:category/page/1`]}],name:`Category`,maintainers:[`TonyRL`],handler:m,description:`| 新着        | Switch | PS5 | PS4 | PC ゲーム | ニュース | 動画   | 特集・企画記事  | インタビュー | 取材・リポート | レビュー | インディーゲーム |
| ----------- | ------ | --- | --- | --------- | -------- | ------ | --------------- | ------------ | -------------- | -------- | ---------------- |
| new-article | switch | ps5 | ps4 | pc-game   | news     | videos | special-article | interview    | event-report   | review   | indie-game       |`};function d(){return r.tryGet(`famitsu:buildId`,async()=>{let e=await o(l),t=c.load(e),n=JSON.parse(t(`#__NEXT_DATA__`).text());return n.buildId},n.cache.routeExpire,!1)}function f(t){return i(s.join(e,`templates/description-e9ee1c8c.art`),t)}function p(e){if(Array.isArray(e.content))return e.content.map(e=>e.type&&p(e)).join(``);switch(e.type){case`B`:case`INTERVIEWEE`:case`STRONG`:return`<b>${e.content}</b>`;case`HEAD`:return`<h2>${e.content}</h2>`;case`SHEAD`:return`<h3>${e.content}</h3>`;case`LINK_B`:case`LINK_B_TAB`:return`<a href="${e.url}"><b>${e.content}</b></a><br>`;case`IMAGE`:return`<img src="${e.path}">`;case`NEWS`:return`<a href="${e.url}">${e.content}<br>${e.description}</a><br>`;case`HTML`:return e.content;case`ANNOTATION`:case`CAPTION`:case`ITEMIZATION`:case`ITEMIZATION_NUM`:case`NOLINK`:case`STRING`:case`TWITTER`:case`YOUTUBE`:return`<div><span>${e.content}</span></div>`;case`BUTTON`:case`BUTTON_ANDROID`:case`BUTTON_EC`:case`BUTTON_IOS`:case`BUTTON_TAB`:case`LINK`:case`LINK_TAB`:return`<a href="${e.url}">${e.content}</a><br>`;default:throw Error(`Unhandle type: ${e.type}`)}}async function m(e){let{category:t=`new-article`}=e.req.param(),n=`${l}/category/${t}/page/1`,i=await d(),s=await o(`https://www.famitsu.com/_next/data/${i}/category/${t}/page/1.json`,{query:{categoryCode:t,pageNumber:1}}),c=s.pageProps.categoryArticleDataForPc.filter(e=>!e.advertiserName).map(e=>{let t=e.publishedAt?.slice(0,7).replace(`-`,``);return{title:e.title,link:`https://www.famitsu.com/article/${t}/${e.id}`,pubDate:a(e.publishedAt),category:[...new Set([e.mainCategory.nameJa,...e.subCategories?.map(e=>e.nameJa)??[]])],publicationDate:t,articleId:e.id}}),u=await Promise.all(c.map(e=>r.tryGet(e.link,async()=>{let t=await o(`https://www.famitsu.com/_next/data/${i}/article/${e.publicationDate}/${e.articleId}.json`,{query:{publicationDate:e.publicationDate,articleId:e.articleId}}),n=t.pageProps.articleDetailData;return e.author=n.authors?.map(e=>e.name_ja).join(`, `)??n.user.name_ja,e.description=f({bannerImage:n.ogpImageUrl??n.thumbnailUrl,content:n.content.flatMap(e=>e.contents.map(e=>p(e))).join(``)}),e})));return{title:`${s.pageProps.targetCategory.nameJa}の最新記事 | ゲーム・エンタメ最新情報のファミ通.com`,image:`https://www.famitsu.com/img/1812/favicons/apple-touch-icon.png`,link:n,item:u,language:`ja`}}export{u as route};
//# sourceMappingURL=category-BnicU7jt.js.map