{"version":3,"file":"luxiang-7_jZi9i7.js","names":["route: Route","got","item"],"sources":["../../lib/routes/zhibo8/luxiang.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport timezone from '@/utils/timezone';\r\n\r\nexport const route: Route = {\r\n    path: '/luxiang/:category?',\r\n    radar: [\r\n        {\r\n            source: ['zhibo8.cc/:category/luxiang.htm'],\r\n            target: '/luxiang/:category',\r\n        },\r\n    ],\r\n    name: 'Unknown',\r\n    maintainers: ['TonyRL'],\r\n    handler,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const rootUrl = 'https://www.zhibo8.cc';\r\n    const { category = 'nba' } = ctx.req.param();\r\n    const link = `${rootUrl}/${category}/luxiang.htm`;\r\n\r\n    const response = await got(link);\r\n    const $ = load(response.data);\r\n\r\n    const list = $('.box')\r\n        .toArray()\r\n        .flatMap((item) => {\r\n            item = $(item);\r\n            const dateStr = item.find('h2').text().split(' ')[0];\r\n            return item\r\n                .find('a')\r\n                .toArray()\r\n                .map((item) => {\r\n                    const href = $(item).attr('href');\r\n                    return {\r\n                        title: `${item.previousSibling.data.replace(' | ', '')} ${$(item).text()}`,\r\n                        link: `${rootUrl}${href}`,\r\n                        pubDate: timezone(parseDate(`${href.replace(`/${category}/`, '').slice(0, 4)} ${dateStr}`, 'YYYY M月D日'), +8),\r\n                    };\r\n                });\r\n        });\r\n\r\n    return {\r\n        title: $('head title').text(),\r\n        link,\r\n        image: 'https://www.zhibo8.cc/favicon.ico',\r\n        item: list,\r\n    };\r\n}\r\n"],"mappings":"sWAMA,MAAaA,EAAe,CACxB,KAAM,sBACN,MAAO,CACH,CACI,OAAQ,CAAC,mCACT,OAAQ,uBAGhB,KAAM,UACN,YAAa,CAAC,UACd,WAGJ,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAU,wBACV,CAAE,WAAW,OAAU,EAAI,IAAI,QAC/B,EAAO,GAAG,EAAQ,GAAG,EAAS,cAE9B,EAAW,MAAMC,EAAI,GACrB,EAAI,EAAK,EAAS,MAElB,EAAO,EAAE,QACV,UACA,QAAS,GAAS,CACf,EAAO,EAAE,GACT,IAAM,EAAU,EAAK,KAAK,MAAM,OAAO,MAAM,KAAK,GAClD,OAAO,EACF,KAAK,KACL,UACA,IAAK,GAAS,CACX,IAAM,EAAO,EAAEC,GAAM,KAAK,QAC1B,MAAO,CACH,MAAO,GAAGA,EAAK,gBAAgB,KAAK,QAAQ,MAAO,IAAI,GAAG,EAAEA,GAAM,SAClE,KAAM,GAAG,IAAU,IACnB,QAAS,EAAS,EAAU,GAAG,EAAK,QAAQ,IAAI,EAAS,GAAI,IAAI,MAAM,EAAG,GAAG,GAAG,IAAW,aAAc,QAK7H,MAAO,CACH,MAAO,EAAE,cAAc,OACvB,OACA,MAAO,oCACP,KAAM"}