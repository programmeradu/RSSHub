{"version":3,"file":"earthquake-CyXjC0dA.js","names":["route: Route","ofetch"],"sources":["../../lib/routes/hko/earthquake.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport ofetch from '@/utils/ofetch';\r\nimport { load } from 'cheerio';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport timezone from '@/utils/timezone';\r\n\r\nexport const route: Route = {\r\n    path: '/earthquake',\r\n    name: '全球地震資訊網',\r\n    maintainers: ['after9'],\r\n    handler,\r\n    example: '/hko/earthquake',\r\n    categories: ['forecast'],\r\n    description: '来自香港天文台的全球5级以上地震记录',\r\n};\r\n\r\nasync function handler() {\r\n    const title = '来自香港天文台的全球5级以上地震记录';\r\n    const link = 'https://www.hko.gov.hk/tc/gts/equake/quake-info.htm';\r\n    const description = '提供經天文台分析的全球5.0級或以上及本地有感的地震資訊。';\r\n\r\n    // 发送 HTTP GET 请求到 API 并解构返回的数据对象\r\n    const response = await ofetch('https://www.hko.gov.hk/gts/QEM/eq_app-30d_uc.xml', {\r\n        headers: {\r\n            accept: 'application/xml',\r\n        },\r\n    });\r\n\r\n    const $ = load(response);\r\n\r\n    const items = $('Earthquake > EventGroup > Event')\r\n        // 使用“toArray()”方法将选择的所有 DOM 元素以数组的形式返回。\r\n        .toArray()\r\n        // 使用“map()”方法遍历数组，并从每个元素中解析需要的数据。\r\n        .map((item) => {\r\n            item = $(item);\r\n            const degree = item.find('Mag').text();\r\n            const city = item.find('City').text();\r\n            const citystring = item.find('citystring').text();\r\n            const hktDate = item.find('HKTDate').text();\r\n            const hktTime = item.find('HKTTime').text();\r\n            const latAndLon = '經緯:[' + item.find('Lat').text() + ',' + item.find('Lon').text() + ']';\r\n            return {\r\n                title: `[震級:${degree}] [地點:${city}]`,\r\n                description: `${citystring}, ${latAndLon}`,\r\n                pubDate: timezone(parseDate(hktDate + hktTime, 'YYYYMMDDHHmm'), +8),\r\n            };\r\n        });\r\n\r\n    return {\r\n        title,\r\n        link,\r\n        description,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"iTAMA,MAAaA,EAAe,CACxB,KAAM,cACN,KAAM,UACN,YAAa,CAAC,UACd,UACA,QAAS,kBACT,WAAY,CAAC,YACb,YAAa,sBAGjB,eAAe,GAAU,CACrB,IAKM,EAAW,MAAMC,EAAO,mDAAoD,CAC9E,QAAS,CACL,OAAQ,qBAIV,EAAI,EAAK,GAET,EAAQ,EAAE,mCAEX,UAEA,IAAK,GAAS,CACX,EAAO,EAAE,GACT,IAAM,EAAS,EAAK,KAAK,OAAO,OAC1B,EAAO,EAAK,KAAK,QAAQ,OACzB,EAAa,EAAK,KAAK,cAAc,OACrC,EAAU,EAAK,KAAK,WAAW,OAC/B,EAAU,EAAK,KAAK,WAAW,OAC/B,EAAY,OAAS,EAAK,KAAK,OAAO,OAAS,IAAM,EAAK,KAAK,OAAO,OAAS,IACrF,MAAO,CACH,MAAO,OAAO,EAAO,QAAQ,EAAK,GAClC,YAAa,GAAG,EAAW,IAAI,IAC/B,QAAS,EAAS,EAAU,EAAU,EAAS,gBAAiB,MAI5E,MAAO,CACH,2BACA,2DACA,4CACA,KAAM"}