{"version":3,"file":"celebrity-DqpRawb6.js","names":["route: Route","got"],"sources":["../../lib/routes/douban/other/celebrity.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\n\r\nexport const route: Route = {\r\n    path: '/celebrity/:id/:sort?',\r\n    categories: ['social-media'],\r\n    example: '/douban/celebrity/1274261',\r\n    parameters: { id: '电影人 id', sort: '排序方式，缺省为 `time`（时间排序），可为 `vote` （评价排序）' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    name: '豆瓣电影人',\r\n    maintainers: ['minimalistrojan'],\r\n    handler,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const id = ctx.req.param('id');\r\n    const sort = ctx.req.param('sort') || 'time';\r\n\r\n    // 发起 HTTP GET 请求\r\n    const response = await got({\r\n        method: 'get',\r\n        url: `https://movie.douban.com/celebrity/${id}/movies?sortby=${sort}`,\r\n    });\r\n\r\n    const data = response.data; // response.data 为 HTTP GET 请求返回的 HTML\r\n\r\n    const $ = load(data); // 使用 cheerio 加载返回的 HTML\r\n    const list = $('div.grid_view > ul li'); // 使用 cheerio 选择器\r\n\r\n    const person = $('#content > h1')\r\n        .text()\r\n        .replace(/的全部作品（\\d+）/, '');\r\n    let itemPicUrl;\r\n\r\n    return {\r\n        title: `豆瓣电影人 - ${person}`,\r\n        link: `https://movie.douban.com/celebrity/${id}/movies?sortby=${sort}`,\r\n        item: list.toArray().map((item) => {\r\n            item = $(item);\r\n            itemPicUrl = item.find('img').attr('src');\r\n            return {\r\n                title: '《' + item.find('h6 > a').text() + '》' + item.find('h6 > span').text().replace('(', '（').replace(')', '）').replaceAll('[', '【').replaceAll(']', '】'),\r\n                description: `<img src=\"${itemPicUrl}\"/><br/>主演：${item.find('dl > dd').last().text()}<br/>评分：${item.find('.star > span:nth-child(2)').text()}`,\r\n                link: item.find('dt > a').attr('href'),\r\n            };\r\n        }),\r\n    };\r\n}\r\n"],"mappings":"+PAIA,MAAaA,EAAe,CACxB,KAAM,wBACN,WAAY,CAAC,gBACb,QAAS,4BACT,WAAY,CAAE,GAAI,SAAU,KAAM,0CAClC,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,KAAM,QACN,YAAa,CAAC,mBACd,WAGJ,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAK,EAAI,IAAI,MAAM,MACnB,EAAO,EAAI,IAAI,MAAM,SAAW,OAGhC,EAAW,MAAMC,EAAI,CACvB,OAAQ,MACR,IAAK,sCAAsC,EAAG,iBAAiB,MAG7D,EAAO,EAAS,KAEhB,EAAI,EAAK,GACT,EAAO,EAAE,yBAET,EAAS,EAAE,iBACZ,OACA,QAAQ,aAAc,IACvB,EAEJ,MAAO,CACH,MAAO,WAAW,IAClB,KAAM,sCAAsC,EAAG,iBAAiB,IAChE,KAAM,EAAK,UAAU,IAAK,IACtB,EAAO,EAAE,GACT,EAAa,EAAK,KAAK,OAAO,KAAK,OAC5B,CACH,MAAO,IAAM,EAAK,KAAK,UAAU,OAAS,IAAM,EAAK,KAAK,aAAa,OAAO,QAAQ,IAAK,KAAK,QAAQ,IAAK,KAAK,WAAW,IAAK,KAAK,WAAW,IAAK,KACvJ,YAAa,aAAa,EAAW,aAAa,EAAK,KAAK,WAAW,OAAO,OAAO,UAAU,EAAK,KAAK,6BAA6B,SACtI,KAAM,EAAK,KAAK,UAAU,KAAK"}