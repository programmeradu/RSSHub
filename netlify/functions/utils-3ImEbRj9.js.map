{"version":3,"file":"utils-3ImEbRj9.js","names":["date","got"],"sources":["../../lib/routes/jsu/utils/index.ts"],"sourcesContent":["import got from '@/utils/got'; // 自订的 got\r\nimport { load } from 'cheerio'; // 可以使用类似 jQuery 的 API HTML 解析器\r\n\r\n/**\r\n * 获取页面内容\r\n * @param selector 正文CSS选择器\r\n * @param pageUrl 页面URL\r\n * @returns {Promise<string|string>} 页面内容，为符合RSS规范的HTML\r\n */\r\nasync function getPageItem(selector, pageUrl) {\r\n    const response = await got({\r\n        method: 'get',\r\n        url: pageUrl,\r\n        https: { rejectUnauthorized: false },\r\n    });\r\n    const $ = load(response.data);\r\n    const page = $(selector);\r\n    return page ? page.html() : '无法获取内容';\r\n}\r\n\r\n/**\r\n * 获取页面内容、标题、日期\r\n * @param selector 正文CSS选择器\r\n * @param pageUrl 页面URL\r\n * @param titleSelector 标题CSS选择器\r\n * @param dateSelector 日期CSS选择器\r\n * @param dateHander 日期处理函数，在CMS系统中会以“日期：点击数”等特殊格式显示日期，需要处理切分出日期\r\n * @returns {Promise<{date, pageInfo: string, title: (*|jQuery|string)}|{date: string, pageInfo: string, title: string}>} 页面内容、标题、日期\r\n */\r\nasync function getPageDetails(selector, pageUrl, titleSelector, dateSelector, dateHander = (date) => date) {\r\n    const response = await got({\r\n        method: 'get',\r\n        url: pageUrl,\r\n        https: { rejectUnauthorized: false },\r\n    });\r\n    const $ = load(response.data);\r\n    const page = $(selector);\r\n    const date = dateHander($(dateSelector).text());\r\n    const title = $(titleSelector).text();\r\n    return page\r\n        ? { pageInfo: page.html(), date, title }\r\n        : {\r\n              pageInfo: '无法获取内容',\r\n              date: '1970-1-1',\r\n              title: '无法获取标题',\r\n          };\r\n}\r\nconst getPageItemAndDate = getPageDetails;\r\n\r\nexport { getPageItem, getPageItemAndDate };\r\n"],"mappings":"+EA6BA,eAAe,EAAe,EAAU,EAAS,EAAe,EAAc,EAAc,GAASA,EAAM,CACvG,IAAM,EAAW,MAAMC,EAAI,CACvB,OAAQ,MACR,IAAK,EACL,MAAO,CAAE,mBAAoB,MAE3B,EAAI,EAAK,EAAS,MAClB,EAAO,EAAE,GACT,EAAO,EAAW,EAAE,GAAc,QAClC,EAAQ,EAAE,GAAe,OAC/B,OAAO,EACD,CAAE,SAAU,EAAK,OAAQ,OAAM,SAC/B,CACI,SAAU,SACV,KAAM,WACN,MAAO,UAGrB,MAAM,EAAqB"}