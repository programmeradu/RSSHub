import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import{config as n}from"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as r}from"./cache-kimkMTWJ.js";import{art as i}from"./render-CxhTJIsl.js";import{parseDate as a}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as o}from"./got-CdvI2yKX.js";import{config_not_found_default as s}from"./config-not-found-BVqhRP9D.js";import c from"node:path";t();const l=`https://zodgame.xyz`,u={path:`/forum/:fid?`,categories:[`bbs`],example:`/zodgame/forum/13`,parameters:{fid:`forum id, can be found in URL`},features:{requireConfig:[{name:`ZODGAME_COOKIE`,description:``}],requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`forum`,maintainers:[`FeCCC`],handler:d};async function d(t){let u=t.req.param(`fid`),d=`${l}/api/mobile/index.php?version=4&module=forumdisplay&fid=${u}`,f=n.zodgame.cookie;if(f===void 0)throw new s(`Zodgame RSS is disabled due to the lack of <a href="https://docs.rsshub.app/deploy/config#route-specific-configurations">relevant config</a>`);let p=await o({method:`get`,url:d,headers:{Cookie:f}}),m=p.data.Variables,h=m.forum_threadlist.map(e=>{if(!m.threadtypes.types[e.typeid])return;let t=m.threadtypes.types[e.typeid];return{tid:e.tid,title:`[${t}] ${e.subject}`,author:e.author,link:`${l}/forum.php?mod=viewthread&tid=${e.tid}&extra=page%3D1`,category:t,pubDate:a(e.dbdateline*1e3)}}).filter(e=>e!==void 0),g=await Promise.all(h.map(t=>r.tryGet(t.tid,async()=>{let n=await o({method:`get`,url:`${l}/api/mobile/index.php?version=4&module=viewthread&tid=${t.tid}`,headers:{Cookie:f}}),r=n.data.Variables,a=``;return r.thread.freemessage?(a+=r.thread.freemessage,a+=i(c.join(e,`templates/forum-c3ab5e98.art`),{content:r.postlist[0].message})):a+=r.postlist[0].message,{title:t.title,author:t.author,link:t.link,description:a,category:t.category,pubDate:t.pubDate,guid:t.tid,upvotes:Number.parseInt(r.thread.recommend_add,10),downvotes:Number.parseInt(r.thread.recommend_sub,10),comments:Number.parseInt(r.thread.replies,10)}})));return{title:`${m.forum.name} - ZodGame论坛`,link:`${l}/forum.php?mod=forumdisplay&fid=${u}`,item:g}}export{u as route};
//# sourceMappingURL=forum-RFyZ-5DD.js.map