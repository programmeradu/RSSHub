{"version":3,"file":"new-iL36RRdy.js","names":["route: Route","got"],"sources":["../../lib/routes/uniqlo/new.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport got from '@/utils/got';\r\n\r\nexport const route: Route = {\r\n    path: '/new/:country/:category',\r\n    categories: ['shopping'],\r\n    example: '/uniqlo/new/sg/men',\r\n    parameters: { country: 'currently only supports sg, us, jp', category: 'supports `men` `women`, `kids`, `baby`' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    name: 'New Arrivals',\r\n    maintainers: ['DIYgod'],\r\n    handler,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const { country, category } = ctx.req.param();\r\n\r\n    const map = {\r\n        sg: {\r\n            url: 'https://www.uniqlo.com/sg/api/commerce/v3/en/products',\r\n            withFlag: true,\r\n            path: {\r\n                women: 5855,\r\n                men: 5856,\r\n                kids: 5857,\r\n                baby: 5858,\r\n            },\r\n        },\r\n        us: {\r\n            url: 'https://www.uniqlo.com/us/api/commerce/v5/en/products',\r\n            withFlag: false,\r\n            path: {\r\n                women: 22210,\r\n                men: 22211,\r\n                kids: 22212,\r\n                baby: 22213,\r\n            },\r\n        },\r\n        jp: {\r\n            url: 'https://www.uniqlo.com/jp/api/commerce/v5/ja/products',\r\n            withFlag: false,\r\n            path: {\r\n                women: 1071,\r\n                men: 1072,\r\n                kids: 1073,\r\n                baby: 1074,\r\n            },\r\n            lang: 'ja',\r\n        },\r\n    };\r\n    const { data } = await got(map[country].url, {\r\n        searchParams: {\r\n            path: map[country].path[category],\r\n            flagCodes: map[country].withFlag ? 'salesStart newSKU,salesStart newSKU,salesStart newSKU' : undefined,\r\n            sort: 1,\r\n            limit: 24,\r\n            offset: 0,\r\n        },\r\n    });\r\n\r\n    const items = data.result.items.map((item) => ({\r\n        title: item.name,\r\n        link: `https://www.uniqlo.com/${country}/${map[country].lang || 'en'}/products/${item.productId}`,\r\n        description: `${item.longDescription || item.name}<br><br>Price: ${(item.prices.base || item.prices.promo).currency.symbol}${(item.prices.base || item.prices.promo).value}<br><br>${\r\n            item.images.main.length ? item.images.main.map((image) => `<img src=\"${image.url || image.image}\">`).join('') : ''\r\n        }${item.images.sub.map((image) => `<img src=\"${image.url || image.image}\">`).join('')}`,\r\n    }));\r\n\r\n    return {\r\n        title: `Uniqlo ${category} new arrivals in ${country}`,\r\n        link: `https://www.uniqlo.com/${country}/${map[country].lang || 'en'}/feature/new/${category}`,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"gOAGA,MAAaA,EAAe,CACxB,KAAM,0BACN,WAAY,CAAC,YACb,QAAS,qBACT,WAAY,CAAE,QAAS,qCAAsC,SAAU,0CACvE,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,KAAM,eACN,YAAa,CAAC,UACd,WAGJ,eAAe,EAAQ,EAAK,CACxB,GAAM,CAAE,UAAS,YAAa,EAAI,IAAI,QAEhC,EAAM,CACR,GAAI,CACA,IAAK,wDACL,SAAU,GACV,KAAM,CACF,MAAO,KACP,IAAK,KACL,KAAM,KACN,KAAM,OAGd,GAAI,CACA,IAAK,wDACL,SAAU,GACV,KAAM,CACF,MAAO,MACP,IAAK,MACL,KAAM,MACN,KAAM,QAGd,GAAI,CACA,IAAK,wDACL,SAAU,GACV,KAAM,CACF,MAAO,KACP,IAAK,KACL,KAAM,KACN,KAAM,MAEV,KAAM,OAGR,CAAE,QAAS,MAAMC,EAAI,EAAI,GAAS,IAAK,CACzC,aAAc,CACV,KAAM,EAAI,GAAS,KAAK,GACxB,UAAW,EAAI,GAAS,SAAW,wDAA0D,IAAA,GAC7F,KAAM,EACN,MAAO,GACP,OAAQ,KAIV,EAAQ,EAAK,OAAO,MAAM,IAAK,IAAU,CAC3C,MAAO,EAAK,KACZ,KAAM,0BAA0B,EAAQ,GAAG,EAAI,GAAS,MAAQ,KAAK,YAAY,EAAK,YACtF,YAAa,GAAG,EAAK,iBAAmB,EAAK,KAAK,kBAAkB,EAAK,OAAO,MAAQ,EAAK,OAAO,OAAO,SAAS,UAAU,EAAK,OAAO,MAAQ,EAAK,OAAO,OAAO,MAAM,UACvK,EAAK,OAAO,KAAK,OAAS,EAAK,OAAO,KAAK,IAAK,GAAU,aAAa,EAAM,KAAO,EAAM,MAAM,KAAK,KAAK,IAAM,KACjH,EAAK,OAAO,IAAI,IAAK,GAAU,aAAa,EAAM,KAAO,EAAM,MAAM,KAAK,KAAK,SAGtF,MAAO,CACH,MAAO,UAAU,EAAS,mBAAmB,IAC7C,KAAM,0BAA0B,EAAQ,GAAG,EAAI,GAAS,MAAQ,KAAK,eAAe,IACpF,KAAM"}