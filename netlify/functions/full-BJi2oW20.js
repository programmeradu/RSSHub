import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as e}from"./cache-kimkMTWJ.js";import"./ofetch-Bzt0BXUH.js";import{got_default as t}from"./got-CdvI2yKX.js";import{rss_parser_default as n}from"./rss-parser-1vyhErsD.js";import{load as r}from"cheerio";const i=n=>e.tryGet(n,async()=>{let e=await t(n),i=r(e.data),a=i(`.slug`).text().trim();if(i(`.audio-availability-message`).length>0)return null;for(let e of i(`.audio-module`).toArray()){let t=i(i(e).find(`.audio-tool-download a`)).attr(`href`),n=`<audio controls><source src="${t}" type="audio/mp3"></audio>`;i(e).replaceWith(n)}let o=i(`#primaryaudio`),s=o.length>0?i(`#primaryaudio`).html():``,c=/\?storyId=(\d+)&amp;mediaId=(\d+)/,l=i.html().match(c);if(l){let e=l[1],t=l[2],n=`<iframe width="740" height="416" src="https://www.npr.org/embedded-video?storyId=${e}&mediaId=${t}&jwMediaType=music" frameborder="0" scrolling="no"></iframe>`,r=i(`.npr-video`);r.length===1&&r.replaceWith(n)}i(`.enlarge_measure`).remove(),i(`.enlarge_html`).remove(),i(`.hide-caption`).remove(),i(`.toggle-caption`).remove(),i(`.credit-caption b.credit`).remove(),i(`.credit-caption span.credit`).wrap(`<figcaption></figcaption>`),i(`.caption > p`).wrap(`<figcaption></figcaption>`);let u=s+i(`.storytext`).toArray().map(e=>i(e).html()).join(``);return{article:u,categories:a}}),a={path:`/:endpoint?`,categories:[`traditional-media`],example:`/npr/1001`,parameters:{endpoint:"Channel ID, can be found in Official RSS URL, `1001` by default"},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`News`,maintainers:[`bennyyip`],handler:o,description:`Provide full article RSS for CBC topics.`};async function o(e){let t=e.req.param(`endpoint`)||`1001`,r=await n.parseURL(`https://feeds.npr.org/${t}/rss.xml`),a=(await Promise.all(r.items.map(async e=>{let t=await i(e.link);return t===null?null:{...e,description:t.article,category:t.categories}}))).filter(Boolean);return{title:r.title,link:r.link,description:r.description,icon:`https://media.npr.org/images/podcasts/primary/npr_generic_image_300.jpg?s=200`,item:a}}export{a as route};
//# sourceMappingURL=full-BJi2oW20.js.map