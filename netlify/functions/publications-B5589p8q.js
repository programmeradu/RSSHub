import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./proxy-D7ccvALx.js";import{cache_default as e}from"./cache-kimkMTWJ.js";import{parseDate as t}from"./parse-date-Bgabdhlb.js";import{puppeteer_default as n}from"./puppeteer-f0D6AISB.js";import{load as r}from"cheerio";const i={path:`/publications/:id`,radar:[{source:[`researchgate.net/profile/:username`],target:`/publications/:username`}],name:`Unknown`,maintainers:[],handler:a};async function a(i){let a=i.req.param(`id`),o=`https://www.researchgate.net/profile/${a}`,s=await n(),c=await s.newPage();await c.setRequestInterception(!0),c.on(`request`,e=>{e.resourceType()===`document`||e.resourceType()===`script`?e.continue():e.abort()}),await c.goto(o);let l=await c.evaluate(()=>document.documentElement.innerHTML);await c.close();let u=r(l),d=u(`div[itemprop="headline"] a`).toArray().slice(0,i.req.query(`limit`)?Number(i.req.query(`limit`)):15).map(e=>(e=u(e),{title:e.text(),link:e.attr(`href`)})),f=await Promise.all(d.map(n=>e.tryGet(n.link,async()=>{let e=await s.newPage();await e.setRequestInterception(!0),e.on(`request`,e=>{e.resourceType()===`document`||e.resourceType()===`script`?e.continue():e.abort()}),await e.goto(n.link);let i=await e.evaluate(()=>document.documentElement.innerHTML);await e.close();let a=r(i);n.doi=a(`meta[property="citation_doi"]`).attr(`content`),n.pubDate=t(a(`meta[property="citation_publication_date"]`).attr(`content`));let o=[];return a(`meta[property="citation_author"]`).each(function(){o.push(a(this).attr(`content`))}),n.author=o.join(`, `),n.description=a(`div[itemprop="description"]`).html(),n})));return await s.close(),{title:`${u(`meta[property="profile:username"]`).attr(`content`)}'s Publications - ResearchGate`,link:o,item:f}}export{i as route};
//# sourceMappingURL=publications-B5589p8q.js.map