{"version":3,"file":"channel-kvV0s8Sy.js","names":["route: Route","utils","InvalidParameterError","getDataByChannelIdGoogle","getDataByChannelIdYoutubei"],"sources":["../../lib/routes/youtube/channel.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport utils, { callApi } from './utils';\r\nimport InvalidParameterError from '@/errors/types/invalid-parameter';\r\nimport { getDataByChannelId as getDataByChannelIdYoutubei } from './api/youtubei';\r\nimport { getDataByChannelId as getDataByChannelIdGoogle } from './api/google';\r\n\r\nexport const route: Route = {\r\n    path: '/channel/:id/:routeParams?',\r\n    categories: ['social-media'],\r\n    example: '/youtube/channel/UCDwDMPOZfxVV0x_dz0eQ8KQ',\r\n    parameters: {\r\n        id: 'YouTube channel id',\r\n        routeParams: 'Extra parameters, see the table below',\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['www.youtube.com/channel/:id'],\r\n            target: '/channel/:id',\r\n        },\r\n    ],\r\n    name: 'Channel with id',\r\n    maintainers: ['DIYgod', 'pseudoyu'],\r\n    handler,\r\n    description: `:::tip Parameter\r\n| Name       | Description                                                                         | Default |\r\n| ---------- | ----------------------------------------------------------------------------------- | ------- |\r\n| embed      | Whether to embed the video, fill in any value to disable embedding                  | embed   |\r\n| filterShorts | Whether to filter out shorts from the feed, fill in any falsy value to show shorts | true    |\r\n:::\r\n\r\n::: tip\r\nYouTube provides official RSS feeds for channels, for instance [https://www.youtube.com/feeds/videos.xml?channel\\_id=UCDwDMPOZfxVV0x\\_dz0eQ8KQ](https://www.youtube.com/feeds/videos.xml?channel_id=UCDwDMPOZfxVV0x_dz0eQ8KQ).\r\n:::`,\r\n    features: {\r\n        requireConfig: [\r\n            {\r\n                name: 'YOUTUBE_KEY',\r\n                description: ' YouTube API Key, support multiple keys, split them with `,`, [API Key application](https://console.developers.google.com/)',\r\n                optional: true,\r\n            },\r\n        ],\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const id = ctx.req.param('id');\r\n\r\n    // Parse route parameters\r\n    const routeParams = ctx.req.param('routeParams');\r\n    const params = new URLSearchParams(routeParams);\r\n\r\n    // Get embed parameter\r\n    const embed = !params.get('embed');\r\n\r\n    // Get filterShorts parameter (default to true if not specified)\r\n    const filterShortsStr = params.get('filterShorts');\r\n    const filterShorts = filterShortsStr === null || filterShortsStr === '' || filterShortsStr === 'true';\r\n\r\n    if (!utils.isYouTubeChannelId(id)) {\r\n        throw new InvalidParameterError(`Invalid YouTube channel ID. \\nYou may want to use <code>/youtube/user/:id</code> instead.`);\r\n    }\r\n\r\n    const data = await callApi({\r\n        googleApi: getDataByChannelIdGoogle,\r\n        youtubeiApi: getDataByChannelIdYoutubei,\r\n        params: { channelId: id, embed, filterShorts },\r\n    });\r\n\r\n    return data;\r\n}\r\n"],"mappings":"6eAMA,MAAaA,EAAe,CACxB,KAAM,6BACN,WAAY,CAAC,gBACb,QAAS,4CACT,WAAY,CACR,GAAI,qBACJ,YAAa,yCAEjB,MAAO,CACH,CACI,OAAQ,CAAC,+BACT,OAAQ,iBAGhB,KAAM,kBACN,YAAa,CAAC,SAAU,YACxB,UACA,YAAa;;;;;;;;;KAUb,SAAU,CACN,cAAe,CACX,CACI,KAAM,cACN,YAAa,8HACb,SAAU,KAGlB,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,KAIvB,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAK,EAAI,IAAI,MAAM,MAGnB,EAAc,EAAI,IAAI,MAAM,eAC5B,EAAS,IAAI,gBAAgB,GAG7B,EAAQ,CAAC,EAAO,IAAI,SAGpB,EAAkB,EAAO,IAAI,gBAC7B,EAAe,IAAoB,MAAQ,IAAoB,IAAM,IAAoB,OAE/F,GAAI,CAACC,EAAM,mBAAmB,GAC1B,MAAM,IAAIC,EAAsB;8DAGpC,IAAM,EAAO,MAAM,EAAQ,CACvB,UAAWC,EACX,YAAaC,EACb,OAAQ,CAAE,UAAW,EAAI,QAAO,kBAGpC,OAAO"}