import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import{config as n}from"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as r}from"./cache-kimkMTWJ.js";import{art as i}from"./render-CxhTJIsl.js";import{parseDate as a}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as o}from"./got-CdvI2yKX.js";import{timezone as s}from"./timezone-BrNu6iXe.js";import{config_not_found_default as c}from"./config-not-found-BVqhRP9D.js";import l from"node:path";import{load as u}from"cheerio";t();const d=new Set([`2btjia.com`,`88btbtt.com`,`btbtt15.com`,`btbtt20.com`]),f={path:`/:category?`,categories:[`multimedia`],example:`/btzj`,parameters:{category:`分类，可在对应分类页 URL 中找到，默认为首页`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`btbtt20.com/`]}],name:`分类`,maintainers:[`nczitzk`],handler:p,url:`btbtt20.com/`,description:"::: tip\n  分类页中域名末尾到 `.htm` 前的字段即为对应分类，如 [电影](https://www.btbtt20.com/forum-index-fid-951.htm) `https://www.btbtt20.com/forum-index-fid-951.htm` 中域名末尾到 `.htm` 前的字段为 `forum-index-fid-951`，所以路由应为 [`/btzj/forum-index-fid-951`](https://rsshub.app/btzj/forum-index-fid-951)\n\n  部分分类页，如 [电影](https://www.btbtt20.com/forum-index-fid-951.htm)、[剧集](https://www.btbtt20.com/forum-index-fid-950.htm) 等，提供了更复杂的分类筛选。你可以将选项选中后，获得结果分类页 URL 中分类参数，构成路由。如选中分类 [高清电影 - 年份：2021 - 地区：欧美](https://www.btbtt20.com/forum-index-fid-1183-typeid1-0-typeid2-738-typeid3-10086-typeid4-0.htm) `https://www.btbtt20.com/forum-index-fid-1183-typeid1-0-typeid2-738-typeid3-10086-typeid4-0.htm` 中域名末尾到 `.htm` 前的字段为 `forum-index-fid-1183-typeid1-0-typeid2-738-typeid3-10086-typeid4-0`，所以路由应为 [`/btzj/forum-index-fid-1183-typeid1-0-typeid2-738-typeid3-10086-typeid4-0`](https://rsshub.app/btzj/forum-index-fid-1183-typeid1-0-typeid2-738-typeid3-10086-typeid4-0)\n:::\n\n  基础分类如下：\n\n| 交流                | 电影                | 剧集                | 高清电影             |\n| ------------------- | ------------------- | ------------------- | -------------------- |\n| forum-index-fid-975 | forum-index-fid-951 | forum-index-fid-950 | forum-index-fid-1183 |\n\n| 音乐                | 动漫                | 游戏                | 综艺                 |\n| ------------------- | ------------------- | ------------------- | -------------------- |\n| forum-index-fid-953 | forum-index-fid-981 | forum-index-fid-955 | forum-index-fid-1106 |\n\n| 图书                 | 美图                | 站务              | 科技                |\n| -------------------- | ------------------- | ----------------- | ------------------- |\n| forum-index-fid-1151 | forum-index-fid-957 | forum-index-fid-2 | forum-index-fid-952 |\n\n| 求助                 | 音轨字幕             |\n| -------------------- | -------------------- |\n| forum-index-fid-1187 | forum-index-fid-1191 |\n\n::: tip\n  BT 之家的域名会变更，本路由以 `https://www.btbtt20.com` 为默认域名，若该域名无法访问，可以通过在路由后方加上 `?domain=<域名>` 指定路由访问的域名。如指定域名为 `https://www.btbtt15.com`，则在 `/btzj` 后加上 `?domain=btbtt15.com` 即可，此时路由为 [`/btzj?domain=btbtt15.com`](https://rsshub.app/btzj?domain=btbtt15.com)\n\n  如果加入了分类参数，直接在分类参数后加入 `?domain=<域名>` 即可。如指定分类 [剧集](https://www.btbtt20.com/forum-index-fid-950.htm) `https://www.btbtt20.com/forum-index-fid-950.htm` 并指定域名为 `https://www.btbtt15.com`，即在 `/btzj/forum-index-fid-950` 后加上 `?domain=btbtt15.com`，此时路由为 [`/btzj/forum-index-fid-950?domain=btbtt15.com`](https://rsshub.app/btzj/forum-index-fid-950?domain=btbtt15.com)\n\n  目前，你可以选择的域名有 `btbtt10-20.com` 共 10 个，或 `88btbbt.com`，该站也提供了专用网址查询工具。详见 [此贴](https://www.btbtt20.com/thread-index-fid-2-tid-4550191.htm)\n:::"};async function p(t){let f=t.req.param(`category`)??``,p=t.req.query(`domain`)??`btbtt15.com`;if(!n.feature.allow_user_supply_unsafe_domain&&!d.has(new URL(`http://${p}/`).hostname))throw new c(`This RSS is disabled unless 'ALLOW_USER_SUPPLY_UNSAFE_DOMAIN' is set to 'true'.`);f===`base`?(f=``,p=`88btbtt.com`):f===`govern`&&(f=``,p=`2btjia.com`);let m=`https://www.${p}`,h=`${m}${f?`/${f}.htm`:``}`,g=await o({method:`get`,url:h}),_=u(g.data);_(`.bg2`).prevAll(`table`).remove();let v=_(`#threadlist table`).toArray().map(e=>{let t=_(e).find(`.subject_link`);return{title:t.text(),link:`${m}/${t.attr(`href`)}`}});return v=await Promise.all(v.map(t=>r.tryGet(t.link,async()=>{let n=await o({method:`get`,url:t.link}),r=u(n.data);r(`h2, .message`).remove(),r(`.attachlist`).find(`a`).each(function(){r(this).children(`img`).attr(`src`,`${m}${r(this).children(`img`).attr(`src`)}`),r(this).attr(`href`,`${m}/${r(this).attr(`href`).replace(/^attach-dialog/,`attach-download`)}`)});let c=r(`.attachlist`).find(`a`);return t.description=r(`.post`).html(),t.author=r(`.purple, .grey`).first().prev().text(),t.pubDate=s(a(r(`.bg2 b`).first().text()),8),c.length>0&&(t.description+=i(l.join(e,`templates/torrents-56ba857b.art`),{torrents:c.toArray().map(e=>r(e).parent().html())}),t.enclosure_type=`application/x-bittorrent`,t.enclosure_url=c.first().attr(`href`)),t}))),{title:`${_(`#menu, #threadtype`).find(`.checked`).toArray().map(e=>_(e).text()).filter(e=>e!==`全部`).join(`|`)} - BT之家`,link:h,item:v}}export{f as route};
//# sourceMappingURL=btzj-mtocB8gJ.js.map