import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{cache_default as e}from"./cache-kimkMTWJ.js";import{parseDate as t}from"./parse-date-Bgabdhlb.js";import{ofetch_default as n}from"./ofetch-Bzt0BXUH.js";import{timezone as r}from"./timezone-BrNu6iXe.js";import{ViewType as i}from"./types-A5bA50Mg.js";import{load as a}from"cheerio";const o=async i=>{let{category:o=`gzdt`}=i.req.param(),s=Number.parseInt(i.req.query(`limit`)??`30`,10),c=`http://www.gjs.moa.gov.cn`,l=new URL(o.endsWith(`/`)?o:`${o}/`,c).href,u=await n(l),d=a(u),f=d(`html`).attr(`lang`)??`zh-CN`,p=[];p=d(`ul#div li`).slice(0,s).toArray().map(e=>{let n=d(e),r=n.find(`a`),i=r.attr(`title`)??n.find(`span.sj_gztzle`).text(),a=n.find(`span.sj_gztzri`).text(),o=r.attr(`href`),s=a,c={title:i,pubDate:t(a),link:o?new URL(o,l).href:void 0,updated:t(s),language:f};return c}),p=(await Promise.all(p.map(i=>i.link?e.tryGet(i.link,async()=>{let e=await n(i.link),o=a(e),s=o(`meta[name="ArticleTitle"]`).attr(`content`)??``,c=o(`div.TRS_Editor`).html()??``,l=o(`meta[name="PubDate"]`).attr(`content`),u=o(`meta[name="Url"]`).attr(`content`),d=o(`meta[name="ColumnName"], meta[name="ContentSource"], meta[name="Keywords"]`).toArray(),p=[...new Set(d.map(e=>o(e).attr(`content`)).filter(Boolean))],m=o(`meta[name="Author"]`).attr(`content`),h=l,g={title:s,description:c,pubDate:l?r(t(l),8):i.pubDate,link:u??i.link,category:p,author:m,content:{html:c,text:c},updated:h?r(t(h),8):i.updated,language:f},_=o(`div.sj_fujianxia_right ul li a`).first(),v=_.attr(`href`);if(v){let e=`application/${v.split(`.`).pop()}`,t=_.text();g={...g,enclosure_url:new URL(v,i.link).href,enclosure_type:e,enclosure_title:t||s}}return{...i,...g}}):i))).filter(e=>!0);let m=`中华人民共和国农业农村部国际合作司`,h=d(`meta[name="ColumnName"]`).attr(`content`)??``;return{title:`${m} - ${h}`,description:h,link:l,item:p,allowEmpty:!0,image:new URL(`images/logo-china.png`,c).href,author:m,language:f}},s={path:`/moa/gjs/:category{.+}?`,name:`中华人民共和国农业农村部国际合作司`,url:`www.gjs.moa.gov.cn`,maintainers:[`nczitzk`],handler:o,example:`/gov/moa/gjs/gzdt`,parameters:{category:{description:"分类，默认为 `gzdt`，即工作动态，可在对应分类页 URL 中找到",options:[{label:`工作动态`,value:`gzdt`},{label:`通知公告`,value:`tzgg`},{label:`“一带一路”合作和农业走出去`,value:`ydylhzhhnyzcq`},{label:`农业国际贸易监测与展望`,value:`ncpmy`},{label:`多双边合作`,value:`dsbhz`}]}},description:":::tip\n若订阅 [中华人民共和国农业农村部国际合作司工作动态](https://www.gjs.moa.gov.cn/gzdt/)，网址为 `https://www.gjs.moa.gov.cn/gzdt/`，请截取 `https://www.gjs.moa.gov.cn/` 到末尾 `/` 的部分 `gzdt` 作为 `category` 参数填入，此时目标路由为 [`/gov/moa/gjs/gzdt`](https://rsshub.app/gov/moa/gjs/gzdt)。\n:::\n\n| [工作动态](http://www.gjs.moa.gov.cn/gzdt/) | [通知公告](http://www.gjs.moa.gov.cn/tzgg/) | [“一带一路”合作和农业走出去](http://www.gjs.moa.gov.cn/ydylhzhhnyzcq/) | [农业国际贸易监测与展望](http://www.gjs.moa.gov.cn/ncpmy/) | [多双边合作](http://www.gjs.moa.gov.cn/dsbhz/) |\n| ------------------------------------------- | ------------------------------------------- | ---------------------------------------------------------------------- | ---------------------------------------------------------- | ---------------------------------------------- |\n| [gzdt](https://rsshub.app/gov/moa/gjs/gzdt) | [tzgg](https://rsshub.app/gov/moa/gjs/tzgg) | [ydylhzhhnyzcq](https://rsshub.app/gov/moa/gjs/ydylhzhhnyzcq)          | [ncpmy](https://rsshub.app/gov/moa/gjs/ncpmy)              | [dsbhz](https://rsshub.app/gov/moa/gjs/dsbhz)  |\n",categories:[`government`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.gjs.moa.gov.cn/:category{.+}?`],target:e=>{let t=e.category;return`/gov/moa/gjs${t?`/${t}`:``}`}},{title:`工作动态`,source:[`www.gjs.moa.gov.cn/gzdt/`],target:`/moa/gjs/gzdt`},{title:`通知公告`,source:[`www.gjs.moa.gov.cn/tzgg/`],target:`/moa/gjs/tzgg`},{title:`“一带一路”合作和农业走出去`,source:[`www.gjs.moa.gov.cn/ydylhzhhnyzcq/`],target:`/moa/gjs/ydylhzhhnyzcq`},{title:`农业国际贸易监测与展望`,source:[`www.gjs.moa.gov.cn/ncpmy/`],target:`/moa/gjs/ncpmy`},{title:`多双边合作`,source:[`www.gjs.moa.gov.cn/dsbhz/`],target:`/moa/gjs/dsbhz`}],view:i.Articles};export{o as handler,s as route};
//# sourceMappingURL=gjs-DZQf9lhZ.js.map