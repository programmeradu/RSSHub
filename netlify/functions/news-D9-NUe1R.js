import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as e}from"./cache-kimkMTWJ.js";import{parseDate as t}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as n}from"./got-CdvI2yKX.js";import{timezone as r}from"./timezone-BrNu6iXe.js";import{load as i}from"cheerio";import a from"iconv-lite";async function o(e){let a=await n.get(e),o=a.data,s=i(o),c=r(t(s(`.article`).text().match(/\d{4}(?:\/\d{2}){2}/)),8),l=s(`.article_con`).html(),u=s(`h2`).text();return{description:l,pubDate:c,title:u}}const s=(e,t,n)=>Promise.all(t.map(t=>{let r=i(t),a=r(`a`),s=new URL(a.attr(`href`),e).href;return n.tryGet(s,async()=>{let{description:e,pubDate:t,title:n}=await o(s);return{title:a.text().includes(`...`)?n:a.text(),link:s,author:`绿色新闻网`,description:e,pubDate:t}})}));var c={ProcessFeed:s};const l={path:`/news/:type`,categories:[`university`],example:`/bjfu/news/lsyw`,parameters:{type:`新闻栏目`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`news.bjfu.edu.cn/:type/index.html`]}],name:`绿色新闻网`,maintainers:[`markmingjie`],handler:u,description:`| 绿色要闻 | 校园动态 | 教学科研 | 党建思政 | 一周排行 |
| -------- | -------- | -------- | -------- | -------- |
| lsyw     | xydt     | jxky     | djsz     | yzph     |`};async function u(t){let r=t.req.param(`type`),o,s;switch(r){case`xydt`:o=`校园动态`,s=`lsxy/`;break;case`jxky`:o=`教学科研`,s=`jxky/`;break;case`djsz`:o=`党建思政`,s=`djsz/`;break;case`yzph`:o=`一周排行`,s=`yzph/`;break;case`lsyw`:default:o=`绿色要闻`,s=`lsyw/`}let l=`http://news.bjfu.edu.cn/`+s,u=await n({method:`get`,responseType:`buffer`,url:l}),d=u.data,f=i(a.decode(d,`utf-8`)),p=f(`meta[http-equiv="Content-Type"]`).attr(`content`).match(/charset=(.*)/)?.[1];p?.toLowerCase()!==`utf-8`&&(f=i(a.decode(d,p??`utf-8`)));let m=f(`.news_ul li`).slice(0,12).toArray(),h=await c.ProcessFeed(l,m,e);return{title:`北林新闻- `+o,link:`http://news.bjfu.edu.cn/`+s,description:`绿色新闻网 - `+o,item:h}}export{l as route};
//# sourceMappingURL=news-D9-NUe1R.js.map