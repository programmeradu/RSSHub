import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as n}from"./cache-kimkMTWJ.js";import{art as r}from"./render-CxhTJIsl.js";import{parseDate as i}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as a}from"./got-CdvI2yKX.js";import{timezone as o}from"./timezone-BrNu6iXe.js";import s from"node:path";import{load as c}from"cheerio";t();const l={path:`/news/breakingnews/:id`,categories:[`traditional-media`],example:`/udn/news/breakingnews/99`,parameters:{id:`类别`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`udn.com/news/breaknews/1/:id`,`udn.com/`]}],name:`即時新聞`,maintainers:[`miles170`],handler:u,description:`| 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 11   | 12   | 13   | 99     |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ------ |
| 精選 | 要聞 | 社會 | 地方 | 兩岸 | 國際 | 財經 | 運動 | 娛樂 | 生活 | 股市 | 文教 | 數位 | 不分類 |`};async function u(t){let l=t.req.param(`id`),u=`/news/breaknews/1/${l}#breaknews`,f=await d(u),p=`https://udn.com`,m=await a(`${p}/api/more?page=1&channelId=1&cate_id=${l}&type=breaknews`),h=await Promise.all(m.data.lists.map(t=>{let l=t.titleLink.startsWith(`http`)?t.titleLink:`${p}${t.titleLink}`,u=new URL(l);return u.query=u.search=``,l=u.toString(),n.tryGet(l,async()=>{let n=await a(l),u=n.data.match(/<script language=javascript>window\.location\.href="(https?:\/\/[^"]+)"/);u&&(n=await a(u[1]));let d=c(n.data),f=d(`script[type="application/ld+json"]`).eq(0).text().trim().replaceAll(/[\b\t\n]/g,``),p=f.startsWith(`[`)?JSON.parse(f)[0]:JSON.parse(f),m=d(`.article-content__editor`),h=d(`.article-body__editor`),g=``;return p.image&&(g+=r(s.join(e,`templates/figure-c6915e6f.art`),{src:p.image.contentUrl,alt:p.image.name})),m.length?g+=m.html():h.length&&(g+=h.html()),p.publisher.name.includes(`轉角國際 udn Global`)&&(g=d(`.story_body_content`).html().split(/<!--\d+?-->/g).slice(1,-1).join(``)),{title:t.title,author:[{name:d(`.article-content__author`).text().match(`中央社`)?.at(0)},{name:p.publisher.name.match(`轉角國際 udn Global`)?.at(0)},p.author].filter(e=>!!e.name),description:g,pubDate:o(i(t.time.date,`YYYY-MM-DD HH:mm`),8),category:[p.articleSection,u?d(`.article-head li.breadcrumb__item:last > b`).text():d(`meta[name='subsection']`).attr(`content`),...p.keywords.split(`,`)],link:l}})}));return{title:`即時${f} - 聯合新聞網`,link:`${p}${u}`,description:`udn.com 提供即時新聞以及豐富的政治、社會、地方、兩岸、國際、財經、數位、運動、NBA、娛樂、生活、健康、旅遊新聞，以最即時、多元的內容，滿足行動世代的需求`,item:h}}const d=async e=>{let t=`https://udn.com/news/breaknews`,r=await n.tryGet(t,async()=>{let e=await a(t),n=c(e.data),r=n(`.cate-list__subheader a`).toArray().map(e=>(e=n(e),[e.attr(`href`),e.text().trim()]));return Object.fromEntries(r)});return e in r?r[e]:`列表`};export{l as route};
//# sourceMappingURL=breaking-news-DoO9hATR.js.map