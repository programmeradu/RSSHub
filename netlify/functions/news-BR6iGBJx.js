import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as e}from"./cache-kimkMTWJ.js";import"./ofetch-Bzt0BXUH.js";import{got_default as t}from"./got-CdvI2yKX.js";import*as n from"node:url";import{load as r}from"cheerio";const i=`http://www.wsyu.edu.cn`,a={xxyw:{name:`学校要闻`,url:`/info/iList.jsp?cat_id=10307`},zhxw:{name:`综合新闻`,url:`/info/iList.jsp?cat_id=10119`},mtjj:{name:`媒体聚焦`,url:`/info/iList.jsp?cat_id=10120`}},o={path:`/news/:type?`,categories:[`university`],example:`/wsyu/news/xxyw`,parameters:{type:"分类，默认为 `xxyw`"},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`新闻中心`,maintainers:[`Derekmini`],handler:s,description:`| 学校要闻 | 综合新闻 | 媒体聚焦 |
| -------- | -------- | -------- |
| xxyw     | zhxw     | mtjj     |`};async function s(o){let s=o.req.param(`type`)||`xxyw`,c=i+a[s].url,l=await t({method:`get`,url:c,headers:{Referer:i}}),u=r(l.data),d=u(`.mainContent li`).slice(0,10).toArray().map(e=>u(`a`,e).attr(`href`)),f=u(`.mainContent li`).slice(0,10).toArray().map(e=>u(`a`,e).text()),p=u(`.mainContent li`).slice(0,10).toArray().map(e=>u(`span`,e).text()),m=await Promise.all(d.map(async(a,o)=>{if(a=n.resolve(i,a),a.includes(`.htm`)){let n=await e.get(a);if(n)return JSON.parse(n);let i=await t.get(a),s=r(i.data);s(`.content .photos`).remove();let c={title:f[o],link:a,description:s(`.content`).html(),pubDate:p[o]};return e.set(a,JSON.stringify(c)),c}else{let e={title:f[o],link:a,description:`此链接为文件，请点击下载`,pubDate:p[o]};return e}}));return{title:`武昌首义学院-`+a[s].name,link:c,item:m}}export{o as route};
//# sourceMappingURL=news-BR6iGBJx.js.map