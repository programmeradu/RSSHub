import{cache_default as e}from"./cache-kimkMTWJ.js";import{parseDate as t}from"./parse-date-Bgabdhlb.js";import{got_default as n}from"./got-CdvI2yKX.js";import{timezone as r}from"./timezone-BrNu6iXe.js";import{load as i}from"cheerio";const a=e=>{let t;switch(e=e.slice(0,4).toLowerCase(),e){case`tzgg`:t=`通知公告`;break;case`ggtz`:t=`公告通知`;break;case`jwdt`:t=`教务动态`;break;case`xyxw`:t=`学院新闻`;break;case`jzxx`:t=`讲座信息`;break;case`xzzq`:t=`下载专区`;break;default:t=``}return t};var o=a;async function s(e,a=``){try{let{data:o}=await n(e,{https:{rejectUnauthorized:!1}}),s=i(o),c=/\d{4}(?:\/\d{2}){2}/,l=`.newscontent`;a===`xky`&&(c=/\d{4}-\d{2}-\d{2}/,l=`.content .edit`);let u=(s(`.info`).first().html()?.match(c)||[])[0],d=r(t(u,`YYYY-MM-DD`,`zh-cn`),8),f=s(l).first();f.find(`table`).remove();let p=f.text().replaceAll(/\s+/g,``);return a===`gfxy`&&(p=p.replace(`点击下载文件:`,``)),{description:p,pubDate:d}}catch{return{description:``,pubDate:null}}}var c=s;const l=e=>{let t=e===`1`?``:`_${Number.parseInt(e)-1}`;return`index${t}.html`};var u=l;async function d(t,{baseHost:r,baseCategory:a,baseType:s,baseTitle:l,baseDescription:d=``,baseDeparment:f=``,baseClass:p=`div.article_list ul li:has(a)`}){let{category:m=a,type:h=s,page:g=`1`}=t.req.param(),_=`${l} - ${o(m)}`,v=d?`${d} - ${o(m)}`:_,y=h?`/${h}`:``,b=`${r}${y}/${m}`,x=`${b}/${u(g)}`,{data:S}=await n(x),C=i(S),w=C(p).toArray().map(e=>{e=C(e);let t=e.find(`a`),n=t.attr(`href`),r=t.text(),i=n.startsWith(`./`)&&!n.endsWith(`.pdf`)?`${b}${n.replace(`./`,`/`)}`:n;return{title:r,link:i}}),T=await Promise.all(w.map(t=>e.tryGet(t.link,async()=>{let e=await c(t.link,f);return t.pubDate=e.pubDate,t.description=e.description,t})));return{title:_,description:v,link:x,item:T}}var f=d;export{f as common_default};
//# sourceMappingURL=common-C1jtplR_.js.map