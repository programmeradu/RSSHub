import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./cache-kimkMTWJ.js";import{parseDate as e}from"./parse-date-Bgabdhlb.js";import{ofetch_default as t}from"./ofetch-Bzt0BXUH.js";import{ViewType as n}from"./types-A5bA50Mg.js";import{fetchArticle as r}from"./utils-BXdY0xFm.js";import i from"p-map";const a={path:`/mobile/:path{.+}?`,categories:[`traditional-media`],example:`/apnews/mobile/ap-top-news`,view:n.Articles,parameters:{path:{description:`Corresponding path from AP News website`,default:`ap-top-news`}},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`apnews.com/`]}],name:`News (from mobile client API)`,maintainers:[`dzx-dzx`],handler:o};async function o(n){let a=n.req.param(`path`)?`/${n.req.param(`path`)}`:`/hub/ap-top-news`,o=await t(`https://apnews.com/graphql/delivery/ap/v1`,{query:{operationName:`ContentPageQuery`,variables:{path:a},extensions:{persistedQuery:{version:1,sha256Hash:`3bc305abbf62e9e632403a74cc86dc1cba51156d2313f09b3779efec51fc3acb`}}}}),s=o.data.Screen,c=[...s.main.filter(e=>e.__typename===`ColumnContainer`).flatMap(e=>e.columns),...s.main.filter(e=>e.__typename!==`ColumnContainer`)].filter(e=>e.__typename!==`GoogleDfPAdModule`).flatMap(e=>{switch(e.__typename){case`PageListModule`:return e.items;case`VideoPlaylistModule`:return e.playlist;default:return}}).filter(Boolean).map(t=>{if(t.__typename===`PagePromo`)return{title:t.title,link:t.url,pubDate:e(t.publishDateStamp),category:t.category,description:t.description,guid:t.id};if(t.__typename===`VideoPlaylistItem`)return{title:t.title,link:t.url,description:t.description,guid:t.contentId}}).filter(Boolean).sort((e,t)=>t.pubDate-e.pubDate).slice(0,n.req.query(`limit`)?Number.parseInt(n.req.query(`limit`),10):20),l=n.req.query(`fulltext`)===`true`?await i(c,e=>r(e),{concurrency:10}):c;return{title:s.category??s.title,item:l,link:`https://apnews.com`}}export{a as route};
//# sourceMappingURL=mobile-api-DbBTMFLf.js.map