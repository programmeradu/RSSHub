import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{cache_default as e}from"./cache-kimkMTWJ.js";import{parseDate as t}from"./parse-date-Bgabdhlb.js";import{ofetch_default as n}from"./ofetch-Bzt0BXUH.js";import{timezone as r}from"./timezone-BrNu6iXe.js";import{ViewType as i}from"./types-A5bA50Mg.js";import{load as a}from"cheerio";const o=async i=>{let{filter:o}=i.req.param(),s=Number.parseInt(i.req.query(`limit`)??`30`,10),c=`https://diariofruticola.cl`,l=new URL(`filtro/${o}`,c).href,u=await n(l),d=a(u),f=d(`html`).attr(`lang`)??`es`,p=[];return p=d(`div#printableArea a.text-dark`).slice(0,s).toArray().map(e=>{let t=d(e),n=t.text(),r=t.attr(`href`),i={title:n,link:r?new URL(r,c).href:void 0,language:f};return i}),p=(await Promise.all(p.map(i=>i.link?e.tryGet(i.link,async()=>{let e=await n(i.link),o=a(e),s=o(`h1.my-2`).text(),c=o(`div.ck-content`).html()??``,l=e.match(/"datePublished":\s"(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2})"/)?.[1]??void 0,u=e.match(/"dateModified":\s"(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2})"/)?.[1]??void 0,d={title:s,description:c,pubDate:l?r(t(l),-3):i.pubDate,content:{html:c,text:c},updated:u?r(t(u),-3):i.updated,language:f};return{...i,...d}}):i))).filter(e=>!0),{title:d(`title`).text(),description:d(`meta[property="og:description"]`).attr(`content`),link:l,item:p,allowEmpty:!0,image:d(`img#logo`).attr(`src`),author:d(`meta[name="keywords"]`).attr(`content`),language:f,id:d(`meta[property="og:url"]`).attr(`content`)}},s={path:`/filtro/:filter{.+}`,name:`Filtro`,url:`diariofruticola.cl`,maintainers:[`nczitzk`],handler:o,example:`/diariofruticola/filtro/cerezas/71`,parameters:{filter:{description:`Filter`}},description:":::tip\nIf you subscribe to [Cerezas](https://www.diariofruticola.cl/filtro/cerezas/71/)ï¼Œwhere the URL is `https://www.diariofruticola.cl/filtro/cerezas/71/`, extract the part `https://diariofruticola.cl/filtro` to the end, which is `/`, and use it as the parameter to fill in. Therefore, the route will be [`/diariofruticola/filtro/cerezas/71`](https://rsshub.app/diariofruticola/filtro/cerezas/71).\n:::\n",categories:[`new-media`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`diariofruticola.cl/filtro/:filter`],target:e=>{let t=e.filter;return`/diariofruticola/filtro${t?`/${t}`:``}`}}],view:i.Articles};export{o as handler,s as route};
//# sourceMappingURL=filtro-BWNF3dej.js.map