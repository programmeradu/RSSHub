import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{art as n}from"./render-CxhTJIsl.js";import{parseDate as r}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as i}from"./got-CdvI2yKX.js";import{invalid_parameter_default as a}from"./invalid-parameter-CUJdROXf.js";import o from"node:path";import{load as s}from"cheerio";t();const c={path:`/album/:id`,categories:[`multimedia`],example:`/iqiyi/album/神武天尊-2020-1b4lufwxd7h`,parameters:{id:`剧集 id, 可在该主页 URL 中找到`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`剧集`,maintainers:[`TonyRL`],handler:l,description:`::: tip
  可抓取內容根据服务器所在地区而定
:::`};async function l(t){let c=t.req.param(`id`),{data:l}=await i(`https://www.iq.com/album/${c}`),u=s(l),d=JSON.parse(u(`#__NEXT_DATA__`).text()),{album:f}=d.props.initialState,{data:{data:p}}=await i(`https://pcw-api.iqiyi.com/album/album/baseinfo/${f.videoAlbumInfo.albumId}`);if(Object.keys(f.cacheAlbumList).length===0)throw new a(`${p.name} is not available in this server region.`);let m=1,h=!1,g=[];do{let{data:{data:e}}=await i(`https://pcw-api.iq.com/api/v2/episodeListSource/${f.videoAlbumInfo.albumId}`,{searchParams:{platformId:3,modeCode:`intl`,langCode:`zh_cn`,endOrder:f.videoAlbumInfo.maxOrder,startOrder:m}});g=[...g,...e.epg],m=e.pos,h=e.hasMore}while(h);let _=g.map(t=>({title:t.name,description:n(o.join(e,`templates/album-70f81ea0.art`),{item:t}),link:`https://www.iq.com/play/${t.playLocSuffix}`,pubDate:r(t.initIssueTime)}));return{title:p.name,description:p.description,image:f.videoAlbumInfo.albumFocus1024,link:`https://www.iq.com/album/${f.videoAlbumInfo.albumLocSuffix}`,item:_,allowEmpty:!0}}export{c as route};
//# sourceMappingURL=album-C0W9xeNQ.js.map