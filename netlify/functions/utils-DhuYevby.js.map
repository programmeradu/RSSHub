{"version":3,"file":"utils-DhuYevby.js","names":[],"sources":["../../lib/routes/javtrailers/utils.ts"],"sourcesContent":["import { Video } from './types';\r\n\r\nimport ofetch from '@/utils/ofetch';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport { art } from '@/utils/render';\r\nimport path from 'node:path';\r\n\r\nexport const baseUrl = 'https://javtrailers.com';\r\nexport const headers = {\r\n    Authorization: 'AELAbPQCh_fifd93wMvf_kxMD_fqkUAVf@BVgb2!md@TNW8bUEopFExyGCoKRcZX',\r\n};\r\n\r\nexport const hdGallery = (gallery) =>\r\n    gallery.map((item) => {\r\n        if (item.startsWith('https://pics.dmm.co.jp/')) {\r\n            return item.replace(/-(\\d+)\\.jpg$/, 'jp-$1.jpg');\r\n        } else if (item.startsWith('https://image.mgstage.com/')) {\r\n            return item.replace(/cap_t1_/, 'cap_e_');\r\n        }\r\n        return item;\r\n    });\r\n\r\nexport const parseList = (videos) =>\r\n    videos.map((item) => ({\r\n        title: `${item.dvdId} ${item.title}`,\r\n        link: `${baseUrl}/video/${item.contentId}`,\r\n        pubDate: parseDate(item.releaseDate),\r\n        contentId: item.contentId,\r\n    }));\r\n\r\nexport const getItem = async (item) => {\r\n    const response = await ofetch(`${baseUrl}/api/video/${item.contentId}`, {\r\n        headers,\r\n    });\r\n\r\n    const videoInfo: Video = response.video;\r\n    videoInfo.gallery = hdGallery(videoInfo.gallery);\r\n\r\n    item.description = art(path.join(__dirname, 'templates/description.art'), {\r\n        videoInfo,\r\n    });\r\n    item.author = videoInfo.casts.map((cast) => `${cast.name} ${cast.jpName}`).join(', ');\r\n    item.category = videoInfo.categories.map((category) => `${category.name}／${category.jpName}／${category.zhName}`);\r\n\r\n    return item;\r\n};\r\n"],"mappings":"2PAOA,MAAa,EAAU,0BACV,EAAU,CACnB,cAAe,oEAGN,EAAa,GACtB,EAAQ,IAAK,GACL,EAAK,WAAW,2BACT,EAAK,QAAQ,eAAgB,aAC7B,EAAK,WAAW,8BAChB,EAAK,QAAQ,UAAW,UAE5B,GAGF,EAAa,GACtB,EAAO,IAAK,IAAU,CAClB,MAAO,GAAG,EAAK,MAAM,GAAG,EAAK,QAC7B,KAAM,GAAG,EAAQ,SAAS,EAAK,YAC/B,QAAS,EAAU,EAAK,aACxB,UAAW,EAAK,aAGX,EAAU,KAAO,IAAS,CACnC,IAAM,EAAW,MAAM,EAAO,GAAG,EAAQ,aAAa,EAAK,YAAa,CACpE,YAGE,EAAmB,EAAS,MASlC,MARA,GAAU,QAAU,EAAU,EAAU,SAExC,EAAK,YAAc,EAAI,EAAA,KAAA,EAAA,sCAAmD,CACtE,cAEJ,EAAK,OAAS,EAAU,MAAM,IAAK,GAAS,GAAG,EAAK,KAAK,GAAG,EAAK,UAAU,KAAK,MAChF,EAAK,SAAW,EAAU,WAAW,IAAK,GAAa,GAAG,EAAS,KAAK,GAAG,EAAS,OAAO,GAAG,EAAS,UAEhG"}