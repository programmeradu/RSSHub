import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{cache_default as e}from"./cache-kimkMTWJ.js";import{parseDate as t}from"./parse-date-Bgabdhlb.js";import{ofetch_default as n}from"./ofetch-Bzt0BXUH.js";import{timezone as r}from"./timezone-BrNu6iXe.js";import i from"dayjs";import a from"dayjs/plugin/duration.js";import{load as o}from"cheerio";i.extend(a);const s={path:`/explore/:type`,categories:[`multimedia`],example:`/podwise/explore/latest`,parameters:{type:`latest or all episodes.`},radar:[{source:[`podwise.ai/explore/:type`]}],name:`Episodes`,maintainers:[`lyling`],handler:async i=>{let a=i.req.param(`type`),s=`https://podwise.ai/explore/${a}`,u=await n(s),d=o(u),f=d(`#navigator`).next(),p=f.find(`h1`).first().text(),m=f.find(`p`).eq(1).text(),h=f.find(`.group`).toArray().map(e=>{e=d(e);let n=e.find(`a`).first().attr(`href`),i=e.find(`p`).first().text(),a=e.find(`a`).next().children(`span`).text();return{link:`https://podwise.ai${n}`,description:i,pubDate:r(t(a,`DD MMM YYYY`,`en`),8)}}),g=await Promise.all(h.map(t=>e.tryGet(t.link,async()=>{let e=await n(t.link),r=o(e);t.description=r(`summary`).first().html();let i=r(`img[alt="Podcast cover"]`).eq(1),a=i.next().find(`span`).eq(2),s=JSON.parse(r(`script:contains("podName")`).first().text().match(/self\.__next_f\.push\((.+)\)/)?.[1]??``),u=JSON.parse(s[1].slice(2))[1][3].children[3].episode;return t.title=u.title,t.author=u.podName,t.itunes_item_image=u.cover,t.itunes_duration=c(a.text()),t.enclosure_url=u.link,t.enclosure_type=l(u.linkType),t})));return{title:p,description:m,link:s,item:g}}};function c(e){let t=e.match(/(\d+h)?(\d+m)?/),n=t[1]?Number.parseInt(t[1]):0,r=t[2]?Number.parseInt(t[2]):0;return i.duration({hours:n,minutes:r}).asSeconds()}function l(e){switch(e){case`mp3`:return`audio/mpeg`;case`m4a`:return`audio/x-m4a`;case`mp4`:return`video/mp4`;default:return e}}export{s as route};
//# sourceMappingURL=episodes-DsvR-WvT.js.map