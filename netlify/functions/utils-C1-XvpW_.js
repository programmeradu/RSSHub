import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import{cache_default as n}from"./cache-kimkMTWJ.js";import{art as r}from"./render-CxhTJIsl.js";import{ofetch_default as i}from"./ofetch-Bzt0BXUH.js";import a from"node:path";import{load as o}from"cheerio";t();const s=async e=>{let t=await i(`https://api.aeonmedia.co/graphql`,{method:`POST`,headers:{"Content-Type":`application/json`},body:JSON.stringify({query:`query getImageById($id: ID!) { image(id: $id) { id url alt caption width height } }`,variables:{id:e,site:`Aeon`},operationName:`getImageById`})});return t.data.image.url};function c(t){let n=t.type.toLowerCase(),i=``,s=``,c=``;switch(n){case`film`:i=r(a.join(e,`templates/video-1cc670e1.art`),{article:t});break;case`guide`:{s=t.imageSquare?.url,c=t.authors.map(e=>e.bio).join(` `);let n=[`Need To Know`,`What To Do`,`Key Points`,`Learn More`,`Links & Books`],l=Object.keys(t).filter(e=>e.startsWith(`section`)&&e!==`section`),u=l.map(e=>{let r=o(t[e]);r(`p.pullquote`).remove();let i=n.shift();return`<h2>${i}</h2>`+r.html()}).join(``);i=r(a.join(e,`templates/essay-379aa878.art`),{banner:s,authorsBio:c,content:u});break}case`idea`:{s=t.imageLandscape?.url,c=t.authors.map(e=>e.bio).join(` `);let n=o(t.body);n(`p.pullquote`).remove(),i=r(a.join(e,`templates/essay-379aa878.art`),{banner:s,authorsBio:c,content:n.html()});break}default:break}return i}const l=async e=>{let t=await Promise.all(e.map(e=>n.tryGet(e.link,async()=>{let t=await i(e.json),n=t.pageProps.article;e.pubDate=new Date(n.publishedAt).toUTCString();let r=c(n),a=o(r);await Promise.all(a(`dl > dt`).toArray().map(async e=>{let t=a(e).text(),n=await s(t);a(e).replaceWith(`<img src="${n}" alt="${t}">`)}));let l=``;return l=n.type===`film`?n.creditsShort:n.authors.map(e=>e.name).join(`, `),e.description=a.html(),e.author=l,e})));return t};export{l as getData};
//# sourceMappingURL=utils-C1-XvpW_.js.map