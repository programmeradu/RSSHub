import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import{config as n,rand_user_agent_default as r}from"./config-Dl8a1sIg.js";import{logger_default as i}from"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{cache_default as a}from"./cache-kimkMTWJ.js";import{art as o}from"./render-CxhTJIsl.js";import{parseDate as s}from"./parse-date-Bgabdhlb.js";import{reject_default as c}from"./reject-Q-VxOB_U.js";import{ofetch_default as l}from"./ofetch-Bzt0BXUH.js";import u from"node:path";t();function d(e,t){let n=[];for(let e=0;e<256;e++)n[e]=e;for(let e=0,r=0;e<256;e++){r=(r+n[e]+t.codePointAt(e%t.length))%256;let i=n[e];n[e]=n[r],n[r]=i}let r=[];for(let t=0,i=0,a=0;a<e.length;a++){t=(t+1)%256,i=(i+n[t])%256;let o=n[t];n[t]=n[i],n[i]=o;let s=(n[t]+n[i])%256;r.push(String.fromCodePoint(n[s]^e.codePointAt(a)))}return r.join(``)}function f(e,t){return(e<<(t%=32)|e>>>32-t)>>>0}function p(e){if(0<=e&&e<16)return 2043430169;if(16<=e&&e<64)return 2055708042;i.error(`invalid j for constant Tj`)}function m(e,t,n,r){return 0<=e&&e<16?(t^n^r)>>>0:16<=e&&e<64?(t&n|t&r|n&r)>>>0:(i.error(`invalid j for bool function FF`),0)}function h(e,t,n,r){return 0<=e&&e<16?(t^n^r)>>>0:16<=e&&e<64?(t&n|~t&r)>>>0:(i.error(`invalid j for bool function GG`),0)}function g(){this.reg[0]=1937774191,this.reg[1]=1226093241,this.reg[2]=388252375,this.reg[3]=3666478592,this.reg[4]=2842636476,this.reg[5]=372324522,this.reg[6]=3817729613,this.reg[7]=2969243214,this.chunk=[],this.size=0}function _(e){let t=encodeURIComponent(e).replaceAll(/%([0-9A-F]{2})/g,(e,t)=>String.fromCodePoint(`0x`+t)),n=Array.from({length:t.length});return Array.prototype.forEach.call(t,(e,t)=>{n[t]=e.codePointAt(0)}),n}function v(e){let t=typeof e==`string`?_(e):e;this.size+=t.length;let n=64-this.chunk.length;if(t.length<n)this.chunk=this.chunk.concat(t);else for(this.chunk=this.chunk.concat(t.slice(0,n));this.chunk.length>=64;)this._compress(this.chunk),this.chunk=n<t.length?t.slice(n,Math.min(n+64,t.length)):[],n+=64}function y(e,t){e&&(this.reset(),this.write(e)),this._fill();for(let e=0;e<this.chunk.length;e+=64)this._compress(this.chunk.slice(e,e+64));let n;if(t===`hex`){n=``;for(let e=0;e<8;e++)n+=se(this.reg[e].toString(16),8,`0`)}else{n=Array.from({length:32});for(let e=0;e<8;e++){let t=this.reg[e];n[4*e+3]=(255&t)>>>0,t>>>=8,n[4*e+2]=(255&t)>>>0,t>>>=8,n[4*e+1]=(255&t)>>>0,t>>>=8,n[4*e]=(255&t)>>>0}}return this.reset(),n}function b(e){let t=Array.from({length:132});for(let n=0;n<16;n++)t[n]=e[4*n]<<24,t[n]|=e[4*n+1]<<16,t[n]|=e[4*n+2]<<8,t[n]|=e[4*n+3],t[n]>>>=0;for(let e=16;e<68;e++){let n=t[e-16]^t[e-9]^f(t[e-3],15);n=n^f(n,15)^f(n,23),t[e]=(n^f(t[e-13],7)^t[e-6])>>>0}for(let e=0;e<64;e++)t[e+68]=(t[e]^t[e+4])>>>0;return t}function x(e){if(e<64){i.error(`compress error: not enough data`);return}else{let t=b(e),n=this.reg.slice(0);for(let e=0;e<64;e++){let r=f(n[0],12)+n[4]+f(p(e),e);r=(4294967295&r)>>>0,r=f(r,7);let i=(r^f(n[0],12))>>>0,a=m(e,n[0],n[1],n[2]);a=a+n[3]+i+t[e+68],a=(4294967295&a)>>>0;let o=h(e,n[4],n[5],n[6]);o=o+n[7]+r+t[e],o=(4294967295&o)>>>0,n[3]=n[2],n[2]=f(n[1],9),n[1]=n[0],n[0]=a,n[7]=n[6],n[6]=f(n[5],19),n[5]=n[4],n[4]=(o^f(o,9)^f(o,17))>>>0}for(let e=0;e<8;e++)this.reg[e]=(this.reg[e]^n[e])>>>0}}function S(){let e=8*this.size,t=this.chunk.push(128)%64;for(64-t<8&&(t-=64);t<56;t++)this.chunk.push(0);for(let t=0;t<4;t++){let n=Math.floor(e/4294967296);this.chunk.push(n>>>8*(3-t)&255)}for(let t=0;t<4;t++)this.chunk.push(e>>>8*(3-t)&255)}function C(){this.reg=[],this.chunk=[],this.size=0,this.reset()}C.prototype.reset=g,C.prototype.write=v,C.prototype.sum=y,C.prototype._compress=x,C.prototype._fill=S;function w(e,t){let n={s0:`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=`,s1:`Dkdpgh4ZKsQB80/Mfvw36XI1R25+WUAlEi7NLboqYTOPuzmFjJnryx9HVGcaStCe=`,s2:`Dkdpgh4ZKsQB80/Mfvw36XI1R25-WUAlEi7NLboqYTOPuzmFjJnryx9HVGcaStCe=`,s3:`ckdp1h4ZKsUB80/Mfvw36XIgR25+WQAlEi7NLboqYTOPuzmFjJnryx9HVGDaStCe`,s4:`Dkdpgh2ZmsQB80/MfvV36XI1R45-WUAlEixNLwoqYTOPuzKFjJnry79HbGcaStCe`},r={0:16515072,1:258048,2:4032,str:n[t]},i=``,a=0,o=T(a,e);for(let t=0;t<e.length/3*4;t++){Math.floor(t/4)!==a&&(a+=1,o=T(a,e));let n=t%4,s;switch(n){case 0:s=(o&r[0])>>18,i+=r.str.charAt(s);break;case 1:s=(o&r[1])>>12,i+=r.str.charAt(s);break;case 2:s=(o&r[2])>>6,i+=r.str.charAt(s);break;case 3:s=o&63,i+=r.str.charAt(s);break;default:break}}return i}function T(e,t){return e*=3,t.codePointAt(e)<<16|t.codePointAt(e+1)<<8|t.codePointAt(e+2)}function E(e,t){return[e&170|t[0]&85,e&85|t[0]&170,e>>8&170|t[1]&85,e>>8&85|t[1]&170]}function D(e,t,n,r=`cus`,i=[0,1,14]){let a=new C,o=Date.now(),s=a.sum(a.sum(e+r)),c=a.sum(a.sum(r)),l=a.sum(w(d(t,Reflect.apply(String.fromCharCode,null,[.00390625,1,14])),`s3`)),u=Date.now(),f={8:3,10:u,15:{aid:6383,pageId:6241,boe:!1,ddrt:7,paths:{include:[{},{},{},{},{},{},{}],exclude:[]},track:{mode:0,delay:300,paths:[]},dump:!0,rpU:``},16:o,18:44,19:[1,0,1,5]};f[20]=f[16]>>24&255,f[21]=f[16]>>16&255,f[22]=f[16]>>8&255,f[23]=f[16]&255,f[24]=f[16]/256/256/256/256>>0,f[25]=f[16]/256/256/256/256/256>>0,f[26]=i[0]>>24&255,f[27]=i[0]>>16&255,f[28]=i[0]>>8&255,f[29]=i[0]&255,f[30]=i[1]/256&255,f[31]=i[1]%256&255,f[32]=i[1]>>24&255,f[33]=i[1]>>16&255,f[34]=i[2]>>24&255,f[35]=i[2]>>16&255,f[36]=i[2]>>8&255,f[37]=i[2]&255,f[38]=s[21],f[39]=s[22],f[40]=c[21],f[41]=c[22],f[42]=l[23],f[43]=l[24],f[44]=f[10]>>24&255,f[45]=f[10]>>16&255,f[46]=f[10]>>8&255,f[47]=f[10]&255,f[48]=f[8],f[49]=f[10]/256/256/256/256>>0,f[50]=f[10]/256/256/256/256/256>>0,f[51]=f[15].pageId,f[52]=f[15].pageId>>24&255,f[53]=f[15].pageId>>16&255,f[54]=f[15].pageId>>8&255,f[55]=f[15].pageId&255,f[56]=f[15].aid,f[57]=f[15].aid&255,f[58]=f[15].aid>>8&255,f[59]=f[15].aid>>16&255,f[60]=f[15].aid>>24&255;let p=[];for(let e=0;e<n.length;e++)p.push(n.codePointAt(e));f[64]=p.length,f[65]=f[64]&255,f[66]=f[64]>>8&255,f[69]=0,f[70]=f[69]&255,f[71]=f[69]>>8&255,f[72]=f[18]^f[20]^f[26]^f[30]^f[38]^f[40]^f[42]^f[21]^f[27]^f[31]^f[35]^f[39]^f[41]^f[43]^f[22]^f[28]^f[32]^f[36]^f[23]^f[29]^f[33]^f[37]^f[44]^f[45]^f[46]^f[47]^f[48]^f[49]^f[50]^f[24]^f[25]^f[52]^f[53]^f[54]^f[55]^f[57]^f[58]^f[59]^f[60]^f[65]^f[66]^f[70]^f[71];let m=[f[18],f[20],f[52],f[26],f[30],f[34],f[58],f[38],f[40],f[53],f[42],f[21],f[27],f[54],f[55],f[31],f[35],f[57],f[39],f[41],f[43],f[22],f[28],f[32],f[60],f[36],f[23],f[29],f[33],f[37],f[44],f[45],f[59],f[46],f[47],f[48],f[49],f[50],f[24],f[25],f[65],f[66],f[70],f[71]];return m=m.concat(p).concat(f[72]),d(String.fromCharCode.apply(null,m),Reflect.apply(String.fromCharCode,null,[121]))}function O(){let e=[];return e=e.concat(E(Math.random()*1e4,[3,45])),e=e.concat(E(Math.random()*1e4,[1,0])),e=e.concat(E(Math.random()*1e4,[1,5])),String.fromCharCode.apply(null,e)}function k(e,t){let n=O()+D(e,t,`1536|747|1536|834|0|30|0|0|1536|834|1536|864|1525|747|24|24|Win32`);return w(n,`s4`)+`=`}const A={path:`/user/token/:token`,categories:[`new-media`],example:`/toutiao/user/token/MS4wLjABAAAAEmbqJP2CmC8XXv1BpMvQ3sQHKAxFsq8wHxj8XVIQWja6tMcB-QEbFkzkRNgMl12M`,parameters:{token:`用户 token，可在用户主页 URL 找到`},features:{antiCrawler:!0},radar:[{source:[`www.toutiao.com/c/user/token/:token`]}],name:`头条主页`,maintainers:[`TonyRL`],handler:j};async function j(t){let{token:i}=t.req.param(),d=r({browser:`chrome`,os:`windows`,device:`desktop`}),f=await a.tryGet(`toutiao:user:${i}`,async()=>{let e=`category=profile_all&token=${i}&max_behot_time=0&entrance_gid&aid=24&app_name=toutiao_web`,t=await l(`https://www.toutiao.com/api/pc/list/feed?${e}&a_bogus=${k(e,d)}`,{headers:{"User-Agent":d}});return t.data},n.cache.routeExpire,!1);if(!f)throw new c(`无法获取用户信息`);let p=f.map(t=>{switch(t.cell_type){case 0:case 49:{let n=t.video.play_addr_list.sort((e,t)=>t.bitrate-e.bitrate)[0];return{title:t.title,description:o(u.join(e,`templates/video-c5c55552.art`),{poster:t.video.origin_cover.url_list[0],url:t.video.play_addr_list.sort((e,t)=>t.bitrate-e.bitrate)[0].play_url_list[0]}),link:`https://www.toutiao.com/video/${t.id}/`,pubDate:s(t.publish_time,`X`),author:t.user?.info.name??t.source,enclosure_url:n?.play_url_list[0],enclosure_type:n?.play_url_list[0]?`video/mp4`:void 0,user:{name:t.user?.info.name,avatar:t.user?.info.avatar_url,description:t.user?.info.desc}}}case 32:{let e=t.large_image_list?.pop();return{title:t.content?.split(`
`)[0],description:t.rich_content,link:`https://www.toutiao.com/w/${t.id}/`,pubDate:s(t.publish_time,`X`),author:t.user?.name,enclosure_url:e?.url,enclosure_type:e?.url?`image/${new URL(e.url).pathname.split(`.`).pop()}`:void 0,user:{name:t.user?.name,avatar:t.user?.avatar_url,description:t.user?.desc}}}case 60:default:return{title:t.title,description:t.abstract,link:`https://www.toutiao.com/article/${t.id}/`,pubDate:s(t.publish_time,`X`),author:t.user_info?.name,user:{name:t.user_info?.name,avatar:t.user_info?.avatar_url,description:t.user_info?.description}}}});return{title:`${p[0].user.name}的头条主页 - 今日头条(www.toutiao.com)`,description:p[0].user.description,link:`https://www.toutiao.com/c/user/token/${i}/`,image:p[0].user.avatar,item:p}}export{A as route};
//# sourceMappingURL=user-Hj4Pnpmr.js.map