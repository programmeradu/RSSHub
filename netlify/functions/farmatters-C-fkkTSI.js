import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{art as n}from"./render-CxhTJIsl.js";import{parseDate as r}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as i}from"./got-CdvI2yKX.js";import{timezone as a}from"./timezone-BrNu6iXe.js";import o from"node:path";import{load as s}from"cheerio";import c from"markdown-it";t();const l=c({html:!0}),u={1:0,2:2,3:1},d={path:[`/exclusive/:locale?`,`/news/:locale?`,`/:locale?`,`/:type/:id/:locale?`],categories:[`new-media`],example:`/farmatters/exclusive`,parameters:{locale:"Locale, `zh-CN` or `en-US`, `zh-CN` by default"},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`farmatters.com/exclusive`],target:`/exclusive`}],name:`Exclusive`,maintainers:[`nczitzk`],handler:f,url:`farmatters.com/news`};async function f(t){let{type:c,id:d,locale:f=`zh-CN`}=t.req.param(),p=t.req.query(`limit`)?Number.parseInt(t.req.query(`limit`),10):50,m={locale:f,page:0,pagesize:p};c===`wiki`&&d?m.subCatalogId=d:c&&d&&(m[c]=d);let h=`https://farmatters.com`,g=new URL(`api/v1/doc/list`,h).href,_=new URL(`${f===`zh-CN`?``:`en/`}${c?c===`wiki`?`wiki`:`tag/${d}`:`news`}`,h).href,{data:v}=await i(g,{searchParams:m,https:{rejectUnauthorized:!1}}),y=v.data.list.slice(0,p).map(t=>({title:t.title,link:new URL(`doc/${t.id}`,h).href,description:n(o.join(e,`templates/description-20a08b0d.art`),{image:t.headImageUrl?{src:t.headImageUrl,alt:t.title}:void 0,description:l.render(t.content??t.summary)}),author:t.author,category:[t.catalogName,t.subCatalogName??void 0,...t.tags?.map(e=>e.tagName)??[]].filter(Boolean),guid:`farmatters-${t.id}`,pubDate:a(r(t.createdAt),8)})),{data:b}=await i(_,{https:{rejectUnauthorized:!1}}),x=s(b),S=`${x(`h4`).first().text()}${c===`wiki`?` - ${x(`div.css-6f6728 div.MuiBox-root`).eq(u[d]).text()}`:``}`,C=new URL(`favicon.ico`,h).href;return{item:y,title:`${x(`title`).text().split(/-/)[0].trim()} - ${S}`,link:_,description:x(`meta[name="description"]`).prop(`content`),language:x(`html`).prop(`lang`),image:new URL(x(`img`).first().prop(`src`),h).href,icon:C,logo:C,subtitle:S,allowEmpty:!0}}export{d as route};
//# sourceMappingURL=farmatters-C-fkkTSI.js.map