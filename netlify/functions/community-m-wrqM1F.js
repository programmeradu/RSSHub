import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import"./cache-kimkMTWJ.js";import{art as n}from"./render-CxhTJIsl.js";import{parseRelativeDate as r}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import"./not-found-CRS5K6wf.js";import{got_default as i}from"./got-CdvI2yKX.js";import{isYouTubeChannelId as a}from"./utils-Dj6x2BMn.js";import o from"node:path";import{load as s}from"cheerio";t();const c={path:`/community/:handle`,categories:[`social-media`],example:`/youtube/community/@JFlaMusic`,parameters:{handle:`YouTube handles or channel id`},name:`Community`,maintainers:[`TonyRL`],handler:l};async function l(t){let c=t.req.param(`handle`),l=c;a(c)&&(l=`channel/${c}`);let{data:u}=await i(`https://www.youtube.com/${l}/community`),d=s(u),f=JSON.parse(d(`script`).text().match(/ytInitialData = ({.*?});/)?.[1]??`{}`),p=f.metadata.channelMetadataRenderer,m=p.title,h=f.contents.twoColumnBrowseResultsRenderer.tabs.find(e=>e.tabRenderer.endpoint.commandMetadata.webCommandMetadata.url.endsWith(`/posts`)||e.tabRenderer.endpoint.commandMetadata.webCommandMetadata.url.endsWith(`/community`)),g=h.tabRenderer.content.sectionListRenderer.contents[0].itemSectionRenderer.contents;if(g[0].messageRenderer)throw Error(g[0].messageRenderer.text.runs[0].text);let _=g.filter(e=>e.backstagePostThreadRenderer).map(t=>{let i=t.backstagePostThreadRenderer.post.backstagePostRenderer||t.backstagePostThreadRenderer.post.sharedPostRenderer.originalPost.backstagePostRenderer,a=i.backstageAttachment?.postMultiImageRenderer?.images.map(e=>e.backstageImageRenderer.image.thumbnails.pop())??[i.backstageAttachment?.backstageImageRenderer?.image.thumbnails.pop()];return{title:i.contentText.runs?.[0].text??``,description:n(o.join(e,`templates/community-13e8a9f5.art`),{runs:i.contentText.runs,media:a}),link:`https://www.youtube.com/post/${i.postId}`,author:i.authorText.runs[0].text,pubDate:r(i.publishedTimeText.runs[0].text.split(`(`)[0])}});return{title:`${m} - Community - YouTube`,link:p.channelUrl,description:p.description,item:_}}export{c as route};
//# sourceMappingURL=community-m-wrqM1F.js.map