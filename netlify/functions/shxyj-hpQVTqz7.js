import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{parseDate as e}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as t}from"./got-CdvI2yKX.js";import{load as n}from"cheerio";const r={path:`/shxyj/:year?/:issue?`,categories:[`journal`],example:`/ajcass/shxyj/2024/1`,parameters:{year:"Year of the issue, `null` for the lastest",issue:"Issue number, `null` for the lastest"},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`社会学研究`,maintainers:[`CNYoki`],handler:i};async function i(r){let{year:i,issue:a}=r.req.param();if(!i){let e=await t(`https://shxyj.ajcass.com/`),r=n(e.body),o=r(`p.hod.pop`).first().text(),s=o.match(/(\d{4}) Vol\.(\d+):/);if(s)i=s[1],a=s[2];else throw Error(`无法获取最新的 year 和 issue`)}let o=`https://shxyj.ajcass.com/Magazine/?Year=${i}&Issue=${a}`,s=await t(o),c=n(s.body),l=c(`#tab tr`).toArray().map(t=>{let n=c(t),r=n.find(`a`).first().text().trim(),o=n.find(`a`).first().attr(`href`),s=n.find(`li`).eq(1).text().replace(`[摘要]`,``).trim(),l=n.find(`li`).eq(2).text().replace(`作者：`,``).trim(),u=e(`${i}-${Number.parseInt(a)*2}`);return r&&o?{title:r,link:`https://shxyj.ajcass.com${o}`,description:s,author:l,pubDate:u}:null}).filter(e=>e!==null);return{title:`社会学研究 ${i}年第${a}期`,link:o,item:l}}export{r as route};
//# sourceMappingURL=shxyj-hpQVTqz7.js.map