import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as e}from"./cache-kimkMTWJ.js";import"./ofetch-Bzt0BXUH.js";import{got_default as t}from"./got-CdvI2yKX.js";import{rss_parser_default as n}from"./rss-parser-1vyhErsD.js";import r from"dayjs";import{load as i}from"cheerio";import a from"dayjs/plugin/utc.js";import o from"dayjs/plugin/timezone.js";r.extend(a),r.extend(o);const s=`phoronix:web-articles`,c=`https://www.phoronix.com`,l=`${c}/rss.php`,u=async()=>{let e=await n.parseURL(l);return{title:e.title,link:e.link,description:e.description,item:e.items,language:e.language,icon:`https://www.phoronix.com/android-chrome-192x192.png`,image:`https://www.phoronix.com/android-chrome-192x192.png`,logo:`https://www.phoronix.com/phxcms7-css/phoronix.png`,category:[`Linux Hardware Reviews`,`Linux hardware benchmarks`,`Linux Hardware`,`Linux benchmarking`,`Desktop Linux`,`GNU/Linux benchmarks`,`Open Source AMD`,`Linux How To`,`X.Org drivers`,`Ubuntu hardware`,`Phoronix Test Suite`]}},d=e=>{let t=i(e.body);return{title:t(`title`).text(),link:e.url,description:t(`meta[name="Description"]`).attr(`content`),item:[...new Set(t(`#main a`).toArray().map(e=>e.attribs.href))].filter(e=>e&&(e.startsWith(`/review/`)||e.startsWith(`/news/`))).map(e=>({link:`${c}${e}`})),language:`en-us`,icon:`https://www.phoronix.com/android-chrome-192x192.png`,image:`https://www.phoronix.com/android-chrome-192x192.png`,logo:`https://www.phoronix.com/phxcms7-css/phoronix.png`,category:t(`meta[name="keywords"]`).attr(`content`).split(`, `)}},f=n=>e.tryGet(`${s}:${n}`,async()=>{try{return d(await t(n))}catch(e){if((e.name===`HTTPError`||e.name===`FetchError`)&&e.response.statusCode===404)return`404`;throw e}}),p=async(n,r)=>{let i=new URL(`/scan.php`,c);i.searchParams.set(`page`,n),r&&(n===`category`?i.searchParams.set(`item`,r):i.searchParams.set(`q`,r));let a,o=await e.tryGet(`phoronix:redirect:${i.toString()}`,async()=>(a=await t(i.toString()),a.url));if(a){let t=d(a);return e.set(`${s}:${o}`,t),t}return await f(o)},m=async(e,t)=>{let n=t?`${c}/${e}/${t}`:`${c}/${e}`,r=await f(n);return r===`404`&&(r=await p(e,t)),r},h={path:`/:category?/:topic?`,categories:[`new-media`],example:`/phoronix/linux/KDE`,parameters:{category:`Category`,topic:"Topic. You may find available parameters from their navigator links. E.g. to subscribe to `https://www.phoronix.com/reviews/Operating+Systems`, fill in the path `/phoronix/reviews/Operating+Systems`"},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`phoronix.com/:category?/:topic?`]}],name:`News & Reviews`,maintainers:[`oppliate`,`Rongronggg9`],handler:g};async function g(n){let{category:a,topic:o}=n.req.param(),s;switch(a){case`category`:case`news_topic`:s=await p(a,o);break;case`rss`:s=await u();break;default:s=a?await m(a,o):await u();break}return s.item=await Promise.all(s.item.map(n=>e.tryGet(`phoronix:articles:${n.link}`,async()=>{let a=await t(n.link),o=a.body,s=i(o),l=s(`.content`),u=s(`.author > a`),d=u.slice(0,-2).toArray().map(e=>s(e).text()),f=[];n.link.includes(`/news/`)?f.push(`News`):n.link.includes(`/review/`)&&f.push(`Review`);let p=u.eq(-2);p.length&&f.push(p.text());let m;if(!n.pubDate){let e=p.length&&p[0].nextSibling?.nodeValue;e&&(e=e.replaceAll(/on|at|\./g,``).trim(),m=/\d{4}$/.test(e)?r.utc(`${e} 08:00 UTC`).tz(`America/Indiana/Indianapolis`,!0):r(e),m.isValid()||(m=e))}let h=s(`.pagination > a`).toArray().map(e=>`${c}${e.attribs.href}`).slice(0,-1);if(h.length){let n=await Promise.all(h.map(n=>e.tryGet(n,async()=>{let e=await t(n),r=e.data,a=i(r),o=a(`.content`);return o.html()})));l.append(n)}let g=l.find(`img`),_=g.first();if(_.attr(`src`)?.startsWith(`/assets/categories/`)){let e=_.parent();e.text().trim()?_.remove():e.remove()}return g.each((e,t)=>{t.attribs.src=t.attribs.src.replace(/_med$/,``)}),{title:n.title||s(`article h1`).text(),pubDate:n.pubDate||m,author:d.join(`, `),link:n.link,summary:s(`meta[name="twitter:description"]`).attr(`content`),description:l.html(),image:s(`meta[name="twitter:image"]`).attr(`content`),category:n.category||f}}))),s}export{h as route};
//# sourceMappingURL=phoronix-DTTl1Ru7.js.map