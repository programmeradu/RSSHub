import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as e}from"./cache-kimkMTWJ.js";import{parseDate as t}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as n}from"./got-CdvI2yKX.js";import{load as r}from"cheerio";const i=`https://cpc.ey.gov.tw`,a={xwg:{name:`新闻稿`,url:`/Page/A3412E2A5A7B398F`},xfzx:{name:`消费资讯`,url:`/Page/E414CC218269CCE8`}},o={path:`/:type?`,categories:[`government`],example:`/cpcey/xwg`,parameters:{type:"默认为 `xwg`"},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`消费资讯`,maintainers:[`Fatpandac`],handler:s,description:`| 新闻稿 | 消费资讯 |
| :----: | :------: |
|   xwg  |   xfzx   |`};async function s(o){let s=o.req.param(`type`)??`xwg`,c=i+a[s].url,l=await n.get(c),u=r(l.data),d=u(`div.words > ul > li`).toArray().map(e=>{let n=u(e).find(`span`).text(),r=n.split(`-`),a=Number.parseInt(r[0])+1911+`/`+r[1]+`/`+r[2];return{link:i+u(e).find(`a`).attr(`href`),title:u(e).find(`a`).attr(`title`),pubDate:t(a,`YYYY/MM/DD`)}}),f=await Promise.all(d.map(async t=>{let i=``,a=!t.link.includes(`.html`);return a&&(i=await e.tryGet(t.link,async()=>{let e=await n.get(t.link),i=r(e.data),a=i(`div.words > div.graybg.ail > div`).html();return a})),t.description=i,t}));return{title:`行政院消费者保护会-${a[s].name}`,link:c,item:f}}export{o as route};
//# sourceMappingURL=cpcey-CU6Z9O0E.js.map