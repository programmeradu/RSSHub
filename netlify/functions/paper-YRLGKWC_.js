import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as n}from"./cache-kimkMTWJ.js";import{art as r}from"./render-CxhTJIsl.js";import{parseDate as i}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as a}from"./got-CdvI2yKX.js";import o from"node:path";import{load as s}from"cheerio";t();const c={path:`/paper/:id?`,categories:[`traditional-media`],example:`/cntheory/paper`,parameters:{id:`板块，默认为全部`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`学习时报`,maintainers:[`nczitzk`],handler:l,description:"如订阅 **第 A1 版：国内大局**，路由为 [`/cntheory/paper/国内大局`](https://rsshub.app/cntheory/paper/国内大局)。"};async function l(t){let c=t.req.param(`id`),l=`https://paper.cntheory.com`,u=await a({method:`get`,url:l});u=await a({method:`get`,url:`${l}/${u.data.match(/URL=(.*)"/)[1]}`});let d=s(u.data),f=u.data.match(/images\/(\d{4}-\d{2}\/\d{2})\/\w+\/\w+_brief/),p=`${l}/html/${f[1]}`,m=[];return await Promise.all(d(`#pageLink`).toArray().filter(e=>c?d(e).text().split(`：`).pop()===c:!0).map(e=>`${p}/${d(e).attr(`href`).replace(/\.\//,``)}`).map(async e=>{let t=await a({method:`get`,url:e}),n=s(t.data);m.push(...n(`table`).last().find(`a`).toArray().map(e=>`${p}/${d(e).attr(`href`)}`))})),m=await Promise.all(m.map(t=>n.tryGet(t,async()=>{let n=await a({method:`get`,url:t}),c=s(n.data);return{link:t,title:c(`h1`).text(),pubDate:i(f[1],`YYYY-MM/DD`),enclosure_url:`${l}${c(`.ban_t a`).first().attr(`href`).match(/(\/images.*)/)[1]}`,description:r(o.join(e,`templates/description-89542799.art`),{resource:c(`#reslist`).html().replaceAll(`display:none;`,``),description:c(`founder-content`).html()})}}))),{title:`学习时报${c?` - ${c}`:``}`,link:l,item:m,allowEmpty:!0}}export{c as route};
//# sourceMappingURL=paper-YRLGKWC_.js.map