import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as n}from"./cache-kimkMTWJ.js";import{art as r}from"./render-CxhTJIsl.js";import{parseDate as i}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as a}from"./got-CdvI2yKX.js";import{timezone as o}from"./timezone-BrNu6iXe.js";import s from"node:path";import{load as c}from"cheerio";t();const l=async t=>{let{category:l=`fgw_zxxxgk`}=t.req.param(),u=t.req.query(`limit`)?Number.parseInt(t.req.query(`limit`),10):20,d=`https://fgw.sh.gov.cn`,f=new URL(`${l}/index.html`,d).href,{data:p}=await a(f),m=c(p),h=m(`html`).prop(`lang`),g=m(`ul.nowrapli li`).slice(0,u).toArray().map(e=>(e=m(e),{title:e.find(`a`).prop(`title`),pubDate:i(e.find(`span.time`).text()),link:new URL(e.find(`a`).prop(`href`),d).href,language:h}));g=await Promise.all(g.map(t=>n.tryGet(t.link,async()=>{if(!t.link.endsWith(`.html`))return t.enclosure_url=t.link,t.enclosure_type=t.link?`application/${t.link.split(/\./).pop()}`:void 0,t.enclosure_title=t.title,t;let{data:n}=await a(t.link),l=c(n),u=l(`meta[name="ArticleTitle"]`).prop(`content`),f=l(`div.pdf-content img`).first().prop(`src`),p=r(s.join(e,`templates/description-6d4e805c.art`),{images:f?[{src:f,alt:u}]:void 0,description:l(`div#ivs_content`).html()});t.title=u,t.description=p,t.pubDate=o(i(l(`meta[name="PubDate"]`).prop(`content`)),8),t.category=[...new Set([l(`meta[name="ColumnName"]`).prop(`content`),l(`meta[name="ColumnKeywords"]`).prop(`content`)])].filter(Boolean),t.author=l(`meta[name="ContentSource"]`).prop(`content`),t.content={html:p,text:l(`div#ivs_content`).text()},t.image=f,t.banner=f,t.language=h;let m=l(`div.pdf-content a, div.xgfj a`).first().prop(`href`);return t.enclosure_url=m?new URL(m,d).href:void 0,t.enclosure_type=m?`application/${m.split(/\./).pop()}`:void 0,t.enclosure_title=u,t})));let _=m(`meta[name="SiteName"]`).prop(`content`),v=m(`span.logo-icon img`).prop(`src`);return{title:`${_} - ${m(`meta[name="ColumnName"]`).prop(`content`)}`,description:m(`meta[name="ColumnDescription"]`).prop(`content`),link:f,item:g,allowEmpty:!0,image:v,author:_,language:h}},u={path:[`/sh/fgw/:category{.+}?`,`/shanghai/fgw/:category{.+}?`],name:`上海市发展和改革委员会`,url:`fgw.sh.gov.cn`,maintainers:[`nczitzk`],handler:l,example:`/gov/sh/fgw/fgw_zxxxgk`,parameters:{category:"分类，默认为 `fgw_zxxxgk`，即最新信息公开，可在对应分类页 URL 中找到"},description:"::: tip\n  若订阅 [最新信息公开](https://fgw.sh.gov.cn/fgw_zxxxgk/index.html)，网址为 `https://fgw.sh.gov.cn/fgw_zxxxgk/index.html`。截取 `https://fgw.sh.gov.cn/` 到末尾 `/index.html` 的部分 `fgw_zxxxgk` 作为参数填入，此时路由为 [`/gov/sh/fgw/fgw_zxxxgk`](https://rsshub.app/gov/sh/fgw/fgw_zxxxgk)。\n:::\n\n| 最新信息公开 | 要闻动态   |\n| ------------ | ---------- |\n| fgw_zxxxgk   | fgw_fzggdt |\n  ",categories:[`government`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`fgw.sh.gov.cn/:category`],target:e=>{let t=e.category.replace(/\/index\.html/,``);return`/gov/sh/fgw${t?`/${t}`:``}`}},{title:`最新信息公开`,source:[`fgw.sh.gov.cn/fgw_zxxxgk/index.html`],target:`/sh/fgw/fgw_zxxxgk`},{title:`要闻动态`,source:[`fgw.sh.gov.cn/fgw_fzggdt/index.html`],target:`/sh/fgw/fgw_fzggdt`}]};export{l as handler,u as route};
//# sourceMappingURL=fgw-C_GQCO4h.js.map