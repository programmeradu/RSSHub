{"version":3,"file":"news-DkrBm5DA.js","names":["route: Route","ofetch","cache"],"sources":["../../lib/routes/gamekee/news.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport ofetch from '@/utils/ofetch';\r\nimport { load } from 'cheerio';\r\nimport cache from '@/utils/cache';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport { config } from '@/config';\r\n\r\nexport const route: Route = {\r\n    path: '/news',\r\n    categories: ['game'],\r\n    example: '/gamekee/news',\r\n    radar: [\r\n        {\r\n            source: ['gamekee.com', 'gamekee.com/news'],\r\n            target: '/news',\r\n        },\r\n    ],\r\n    name: '游戏情报',\r\n    maintainers: ['ueiu'],\r\n    handler,\r\n    url: 'gamekee.com/news',\r\n};\r\n\r\nasync function handler() {\r\n    const rootUrl = 'https://www.gamekee.com';\r\n    const url = `${rootUrl}/v1/index/newsList`;\r\n    const { data } = await ofetch(url, {\r\n        headers: {\r\n            'game-alias': 'www',\r\n            'device-num': '1',\r\n            'User-Agent': config.ua,\r\n        },\r\n        query: {\r\n            page_no: 1,\r\n            limit: 20,\r\n        },\r\n    });\r\n    const list = data.map((item) => {\r\n        const link = new URL(`${item.id}.html`, rootUrl).href;\r\n        const title = item.title;\r\n        const pubDate = parseDate(item.created_at, 'X');\r\n        return {\r\n            link,\r\n            title,\r\n            pubDate,\r\n        };\r\n    });\r\n    const items = await Promise.all(\r\n        list.map((item) =>\r\n            cache.tryGet(item.link, async () => {\r\n                const response = await ofetch(item.link);\r\n                const $ = load(response);\r\n                item.description = $('div.content').html();\r\n                return item;\r\n            })\r\n        )\r\n    );\r\n\r\n    return {\r\n        link: `${rootUrl}/news`,\r\n        title: '游戏情报|Gamekee',\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"oUAOA,MAAaA,EAAe,CACxB,KAAM,QACN,WAAY,CAAC,QACb,QAAS,gBACT,MAAO,CACH,CACI,OAAQ,CAAC,cAAe,oBACxB,OAAQ,UAGhB,KAAM,OACN,YAAa,CAAC,QACd,UACA,IAAK,oBAGT,eAAe,GAAU,CACrB,IAAM,EAAU,0BACV,EAAM,GAAG,EAAQ,oBACjB,CAAE,QAAS,MAAMC,EAAO,EAAK,CAC/B,QAAS,CACL,aAAc,MACd,aAAc,IACd,aAAc,EAAO,IAEzB,MAAO,CACH,QAAS,EACT,MAAO,MAGT,EAAO,EAAK,IAAK,GAAS,CAC5B,IAAM,EAAO,IAAI,IAAI,GAAG,EAAK,GAAG,OAAQ,GAAS,KAC3C,EAAQ,EAAK,MACb,EAAU,EAAU,EAAK,WAAY,KAC3C,MAAO,CACH,OACA,QACA,aAGF,EAAQ,MAAM,QAAQ,IACxB,EAAK,IAAK,GACNC,EAAM,OAAO,EAAK,KAAM,SAAY,CAChC,IAAM,EAAW,MAAMD,EAAO,EAAK,MAC7B,EAAI,EAAK,GAEf,MADA,GAAK,YAAc,EAAE,eAAe,OAC7B,MAKnB,MAAO,CACH,KAAM,GAAG,EAAQ,OACjB,MAAO,eACP,KAAM"}