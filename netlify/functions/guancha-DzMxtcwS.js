import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as e}from"./cache-kimkMTWJ.js";import{parseDate as t,parseRelativeDate as n}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as r}from"./got-CdvI2yKX.js";import{timezone as i}from"./timezone-BrNu6iXe.js";import{load as a}from"cheerio";const o={review:{title:`评论 & 研究`,query:`.module-news-main`},story:{title:`要闻`,query:`.img-List`},fengwen:{title:`风闻`,query:`.fengwen-list`},redian:{title:`热点`},gundong:{title:`滚动`},all:{title:`全部`},home:{title:`首页`},others:{title:`热点 & 滚动`}},s={path:`/:category?`,categories:[`new-media`],example:`/guancha`,parameters:{category:`分类，见下表，默认为全部`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`guancha.cn/`]}],name:`首页`,maintainers:[`nczitzk`,`Jeason0228`],handler:c,url:`guancha.cn/`,description:`| 全部 | 评论 & 研究 | 要闻  | 风闻    | 热点新闻 | 滚动新闻 |
| ---- | ----------- | ----- | ------- | -------- | -------- |
| all  | review      | story | fengwen | redian   | gundong  |

  home = 评论 & 研究 + 要闻 + 风闻

  others = 热点新闻 + 滚动新闻

::: tip
  观察者网首页左中右的三个 column 分别对应 **评论 & 研究**、**要闻**、**风闻** 三个部分。
:::`};async function c(s){let c=s.req.param(`category`)??`all`,l=`https://www.guancha.cn`,u=[],d=[],f=[];if(c===`review`||c===`story`||c===`fengwen`||c===`all`||c===`home`){let e=await r({method:`get`,url:l}),t=a(e.data),n=e=>e.find(`h4.module-title a`).toArray().filter(e=>t(e).attr(`href`)!==`https://user.guancha.cn`).map(e=>{e=t(e);let n=e.attr(`href`);return{title:e.text(),link:`${n.indexOf(`http`)===0?``:l}${n.replace(/\.shtml/,`_s.shtml`)}`}});u=c===`all`||c===`home`?[...n(t(o.review.query)).slice(0,10/3),...n(t(o.story.query)).slice(0,10/3),...n(t(o.fengwen.query)).slice(0,10/3)]:n(t(o[c].query)).slice(0,10)}if(c===`redian`||c===`all`||c===`others`){let e=await r({method:`get`,url:`${l}/api/redian.htm`});d=e.data.items.map(e=>({title:e.TITLE,link:`${l}${e.HTTP_URL.replace(/\.shtml/,`_s.shtml`)}`})).slice(0,c===`all`?10/3:10)}if(c===`gundong`||c===`all`||c===`others`){let e=await r({method:`get`,url:`${l}/api/gundong.htm`});f=e.data.items.map(e=>({title:e.TITLE,link:`${l}${e.HTTP_URL.replace(/\.shtml/,`_s.shtml`)}`})).slice(0,c===`all`?10/3:10)}let p=await Promise.all([...u,...d,...f].map(o=>e.tryGet(o.link,async()=>{let e=await r({method:`get`,url:o.link}),s=e.data.match(/user.guancha.cn\/main\/content\?id=(.*)";/);s!==null&&(o.link=`https://user.guancha.cn/main/content?id=${s[1]}&page=0`,e=await r({method:`get`,url:o.link}));let c=a(e.data),l=e.data.match(/"pubDate": "(.*)"/);return o.pubDate=l===null?n(c(`.time1`).text()):i(t(l[1]),8),o.description=c(`.all-txt`).html()||c(`.article-txt-content`).html(),o.author=c(`.author-intro p a`).text()||c(`.article-content div div h4 a`).text()||c(`.editor-intro p a`).text()||c(`.left-main > div.time.fix > span`).eq(2).text(),o})));return{title:`观察者网 - ${o[c].title}`,link:l,item:p}}export{s as route};
//# sourceMappingURL=guancha-DzMxtcwS.js.map