{"version":3,"file":"news-ClzPF4I2.js","names":["route: Route","got"],"sources":["../../lib/routes/mihoyo/zzz/news.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport got from '@/utils/got';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport timezone from '@/utils/timezone';\r\n\r\nconst categories = {\r\n    'zh-cn': {\r\n        'news-all': {\r\n            id: '273',\r\n            title: '最新',\r\n        },\r\n        news: {\r\n            id: '278',\r\n            title: '新闻',\r\n        },\r\n        notice: {\r\n            id: '279',\r\n            title: '公告',\r\n        },\r\n        activity: {\r\n            id: '280',\r\n            title: '活动',\r\n        },\r\n        title: '绝区零',\r\n        link: 'https://zzz.mihoyo.com/news',\r\n        apiRootUrl: 'https://api-takumi-static.mihoyo.com/content_v2_user/app/706fd13a87294881/getContentList',\r\n    },\r\n    'zh-tw': {\r\n        'news-all': {\r\n            id: '288',\r\n            title: '最新',\r\n        },\r\n        news: {\r\n            id: '295',\r\n            title: '新聞',\r\n        },\r\n        notice: {\r\n            id: '296',\r\n            title: '公告',\r\n        },\r\n        activity: {\r\n            id: '297',\r\n            title: '活動',\r\n        },\r\n        title: '絕區零',\r\n        link: 'https://zenless.hoyoverse.com/zh-tw/news',\r\n        apiRootUrl: 'https://api-os-takumi-static.hoyoverse.com/content_v2_user/app/3e9196a4b9274bd7/getContentList',\r\n    },\r\n};\r\n\r\nexport const route: Route = {\r\n    path: '/zzz/:location?/:category?',\r\n    categories: ['game'],\r\n    example: '/mihoyo/zzz',\r\n    parameters: { location: '区域，可选 `zh-cn`（国服，简中）或 `zh-tw`（国际服，繁中）', category: '分类，见下表，默认为最新' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['zzz.mihoyo.com/news'],\r\n            target: '/zzz',\r\n        },\r\n    ],\r\n    name: '绝区零',\r\n    maintainers: ['Yeye-0426'],\r\n    handler,\r\n    url: 'zzz.mihoyo.com/news',\r\n    description: `#### 新闻 {#mi-ha-you-jue-qu-ling-xin-wen}\r\n\r\n| 最新     | 新闻 | 公告   | 活动     |\r\n| -------- | ---- | ------ | -------- |\r\n| news-all | news | notice | activity |`,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    // location 地区 category 类型\r\n    const { location = 'zh-cn', category = 'news-all' } = ctx.req.param();\r\n    const limit = ctx.req.query('limit') ? Number.parseInt(ctx.req.query('limit')) : 50;\r\n\r\n    const params = {\r\n        'zh-cn': `iPageSize=${limit}&iPage=1&sLangKey=zh-cn&isPreview=0&iChanId=${categories[location][category].id}`,\r\n        'zh-tw': `iPageSize=${limit}&iPage=1&sLangKey=zh-tw&isPreview=0&iChanId=${categories[location][category].id}`,\r\n    };\r\n\r\n    const apiUrl = `${categories[location].apiRootUrl}?${params[location]}`;\r\n    const response = await got(apiUrl);\r\n    const list = response.data.data.list;\r\n    const items = list.map((item) => ({\r\n        title: item.sTitle,\r\n        description: item.sContent,\r\n        link: `${categories[location].link}/${item.iInfoId}`,\r\n        pubDate: timezone(parseDate(item.dtStartTime), +8), // 使用 timezone 工具指定时区 (+8是北京时间)\r\n        category: item.sCategoryName,\r\n    }));\r\n\r\n    return {\r\n        title: `${categories[location][category].title}-${categories[location].title}`,\r\n        link: `${categories[location].link}?category=${categories[location][category].id}`,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"uUAKA,MAAM,EAAa,CACf,QAAS,CACL,WAAY,CACR,GAAI,MACJ,MAAO,MAEX,KAAM,CACF,GAAI,MACJ,MAAO,MAEX,OAAQ,CACJ,GAAI,MACJ,MAAO,MAEX,SAAU,CACN,GAAI,MACJ,MAAO,MAEX,MAAO,MACP,KAAM,8BACN,WAAY,4FAEhB,QAAS,CACL,WAAY,CACR,GAAI,MACJ,MAAO,MAEX,KAAM,CACF,GAAI,MACJ,MAAO,MAEX,OAAQ,CACJ,GAAI,MACJ,MAAO,MAEX,SAAU,CACN,GAAI,MACJ,MAAO,MAEX,MAAO,MACP,KAAM,2CACN,WAAY,mGAIPA,EAAe,CACxB,KAAM,6BACN,WAAY,CAAC,QACb,QAAS,cACT,WAAY,CAAE,SAAU,wCAAyC,SAAU,gBAC3E,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,uBACT,OAAQ,SAGhB,KAAM,MACN,YAAa,CAAC,aACd,UACA,IAAK,sBACL,YAAa;;;;0CAOjB,eAAe,EAAQ,EAAK,CAExB,GAAM,CAAE,WAAW,QAAS,WAAW,YAAe,EAAI,IAAI,QACxD,EAAQ,EAAI,IAAI,MAAM,SAAW,OAAO,SAAS,EAAI,IAAI,MAAM,UAAY,GAE3E,EAAS,CACX,QAAS,aAAa,EAAM,8CAA8C,EAAW,GAAU,GAAU,KACzG,QAAS,aAAa,EAAM,8CAA8C,EAAW,GAAU,GAAU,MAGvG,EAAS,GAAG,EAAW,GAAU,WAAW,GAAG,EAAO,KACtD,EAAW,MAAMC,EAAI,GACrB,EAAO,EAAS,KAAK,KAAK,KAC1B,EAAQ,EAAK,IAAK,IAAU,CAC9B,MAAO,EAAK,OACZ,YAAa,EAAK,SAClB,KAAM,GAAG,EAAW,GAAU,KAAK,GAAG,EAAK,UAC3C,QAAS,EAAS,EAAU,EAAK,aAAc,GAC/C,SAAU,EAAK,iBAGnB,MAAO,CACH,MAAO,GAAG,EAAW,GAAU,GAAU,MAAM,GAAG,EAAW,GAAU,QACvE,KAAM,GAAG,EAAW,GAAU,KAAK,YAAY,EAAW,GAAU,GAAU,KAC9E,KAAM"}