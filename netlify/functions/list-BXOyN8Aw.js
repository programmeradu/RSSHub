import"./esm-shims-Dqvxr0BZ.js";import{config as e}from"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{parseDate as t}from"./parse-date-Bgabdhlb.js";import{ofetch_default as n}from"./ofetch-Bzt0BXUH.js";import{config_not_found_default as r}from"./config-not-found-BVqhRP9D.js";const i={path:`/list/:routeParams?`,categories:[`reading`],example:`/readwise/list/location=new&category=article`,parameters:{routeParams:`Parameter combinations, see the description above.`},features:{requireConfig:[{name:`READWISE_ACCESS_TOKEN`,optional:!1,description:"Visit `https://readwise.io/access_token` to get your access token."}],requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`read.readwise.io`],target:`/list`}],name:`Reader Document List`,maintainers:[`xbot`],handler:a,description:"Specify options (in the format of query string) in parameter `routeParams` to filter documents.\n\n| Parameter                  | Description                                                                            |   Values                                                                                    |  Default                             |\n| -------------------------- | -------------------------------------------------------------------------------------- |   ----------------------------------------------------------------------------------------- |  ----------------------------------- |\n| `location`               | The document's location.                                                               |   `new`/`later`/`shortlist`/`archive`/`feed`                                      |                                      |\n| `category`               | The document's category.                                                               |   `article`/`email`/`rss`/`highlight`/`note`/`pdf`/`epub`/`tweet`/`video` |                                      |\n| `updatedAfter`           | Fetch only documents updated after this date.                                          |   string (formatted as ISO 8601 date)                                                       ||\n| `tag`                    | The document's tag, can be specified once or multiple times.                           |||\n| `tagStrategy`            | If multiple tags are specified, should the documents match all of them or any of them. |   `any`/`all`                                                                           |  `any`                             |\n\nCustomise parameter values to fetch specific documents, for example:\n\n```\nhttps://rsshub.app/readwise/list/location=new&category=article\n```\n\nfetches articles in the Inbox.\n\n```\nhttps://rsshub.app/readwise/list/category=article&tag=shortlist&tag=AI&tagStrategy=all\n```\n\nfetches articles tagged both by `shortlist` and `AI`. "};async function a(i){if(!e.readwise||!e.readwise.accessToken)throw new r(`Readwise access token is missing`);let a=`https://readwise.io/api/v3/list/?`,o,s;if(i.req.param(`routeParams`)){let e=new URLSearchParams(i.req.param(`routeParams`)),t=e.get(`location`),n=e.get(`category`),r=e.get(`updatedAfter`);o=e.get(`tag`),s=e.get(`tagStrategy`)===`any`||e.get(`tagStrategy`)===`all`?e.get(`tagStrategy`):`any`,t&&(a+=`location=${t}&`),n&&(a+=`category=${n}&`),r&&(a+=`updatedAfter=${r}&`)}let c=[];async function l(t){let r=await n(t,{headers:{Authorization:`Token ${e.readwise.accessToken}`}});c.push(...r.results),r.nextPageCursor&&await l(a+`pageCursor=${r.nextPageCursor}`)}await l(a);let u=c.filter(e=>{if(!o)return!0;let t=e.tags;if(!t)return!1;if(Array.isArray(o)){if(s===`any`)return o.some(e=>Object.values(t).some(t=>t.name===e));if(s===`all`)return o.every(e=>Object.values(t).some(t=>t.name===e))}else{let e=o;return Object.values(t).some(t=>t.name===e)}return!1}).map(e=>({title:e.title,link:e.source_url,description:e.summary,pubDate:t(e.created_at),author:e.author}));return{allowEmpty:!0,title:`Readwise Reader`,link:`https://read.readwise.io`,item:u}}export{i as route};
//# sourceMappingURL=list-BXOyN8Aw.js.map