import"./esm-shims-Dqvxr0BZ.js";import{config as e}from"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as t}from"./cache-kimkMTWJ.js";import{parseDate as n}from"./parse-date-Bgabdhlb.js";import"./md5-4BNsOP-F.js";import"./ofetch-Bzt0BXUH.js";import{got_default as r}from"./got-CdvI2yKX.js";import{ViewType as i}from"./types-A5bA50Mg.js";import{header as a}from"./utils-DNrWGW3Z.js";const o={path:`/people/allCollections/:id`,categories:[`social-media`],view:i.Articles,example:`/zhihu/people/allCollections/87-44-49-67`,parameters:{id:`作者 id，可在用户主页 URL 中找到`},features:{requireConfig:[{name:`ZHIHU_COOKIES`,description:``}],requirePuppeteer:!1,antiCrawler:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.zhihu.com/people/:id`]}],name:`用户全部收藏内容`,maintainers:[`Healthyyue`],handler:s};async function s(i){let o=i.req.param(`id`),s=`https://api.zhihu.com/people/${o}/collections`,c=await r(s,{headers:{cookie:e.zhihu.cookies,Referer:`https://www.zhihu.com/people/${o}/collections`}}),l=c.data.data,u=await Promise.all(l.map(async n=>{let i=await r(`https://www.zhihu.com/api/v4/collections/${n.id}/items?offset=0&limit=20`,{headers:{...a,cookie:e.zhihu.cookies,Referer:`https://www.zhihu.com/collection/${n.id}`}}),{data:o,paging:{totals:s}}=i.data;if(s>20){let i=Array.from({length:Math.ceil(s/20)-1},(e,t)=>(t+1)*20),c=await Promise.all(i.map(i=>t.tryGet(`https://www.zhihu.com/api/v4/collections/${n.id}/items?offset=${i}&limit=20`,async()=>{let t=await r(`https://www.zhihu.com/api/v4/collections/${n.id}/items?offset=${i}&limit=20`,{headers:{...a,cookie:e.zhihu.cookies,Referer:`https://www.zhihu.com/collection/${n.id}`}});return t.data.data})));o.push(...c.flat())}return{collectionId:n.id,collectionTitle:n.title,items:o}})),d=u.flatMap(e=>e.items.map(t=>({...t,collectionTitle:e.collectionTitle})));return{title:`${l[0].creator.name}的知乎收藏`,link:`https://www.zhihu.com/people/${o}/collections`,item:d.map(e=>{let t=e.content;return{title:t.type===`article`||t.type===`zvideo`?t.title:t.question.title,link:t.url,description:t.type===`zvideo`?`<img src=${t.video.url}/>`:t.content,pubDate:n((t.type===`article`?t.updated:t.updated_time)*1e3),category:[e.collectionTitle]}})}}export{o as route};
//# sourceMappingURL=all-collections-iOJkFd_6.js.map