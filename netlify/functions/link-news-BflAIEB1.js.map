{"version":3,"file":"link-news-BflAIEB1.js","names":["route: Route","got"],"sources":["../../lib/routes/bilibili/link-news.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport got from '@/utils/got';\r\n\r\nexport const route: Route = {\r\n    path: '/link/news/:product',\r\n    categories: ['social-media'],\r\n    example: '/bilibili/link/news/live',\r\n    parameters: { product: '公告分类, 包括 直播:live 小视频:vc 相簿:wh' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    name: 'link 公告',\r\n    maintainers: ['Qixingchen'],\r\n    handler,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const product = ctx.req.param('product');\r\n\r\n    let productTitle = '';\r\n\r\n    switch (product) {\r\n        case 'live':\r\n            productTitle = '直播';\r\n            break;\r\n        case 'vc':\r\n            productTitle = '小视频';\r\n            break;\r\n        case 'wh':\r\n            productTitle = '相簿';\r\n            break;\r\n    }\r\n\r\n    const response = await got({\r\n        method: 'get',\r\n        url: `https://api.vc.bilibili.com/news/v1/notice/list?platform=pc&product=${product}&category=all&page_no=1&page_size=20`,\r\n        headers: {\r\n            Referer: 'https://link.bilibili.com/p/eden/news',\r\n        },\r\n    });\r\n    const data = response.data.data.items;\r\n\r\n    return {\r\n        title: `bilibili ${productTitle}公告`,\r\n        link: `https://link.bilibili.com/p/eden/news#/?tab=${product}&tag=all&page_no=1`,\r\n        description: `bilibili ${productTitle}公告`,\r\n        item:\r\n            data &&\r\n            data.map((item) => ({\r\n                title: item.title,\r\n                description: `${item.mark}<br><img src=\"${item.cover_url}\">`,\r\n                pubDate: new Date(item.ctime.replace(' ', 'T') + '+08:00').toUTCString(),\r\n                link: item.announce_link ?? `https://link.bilibili.com/p/eden/news#/newsdetail?id=${item.id}`,\r\n            })),\r\n    };\r\n}\r\n"],"mappings":"gOAGA,MAAaA,EAAe,CACxB,KAAM,sBACN,WAAY,CAAC,gBACb,QAAS,2BACT,WAAY,CAAE,QAAS,iCACvB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,KAAM,UACN,YAAa,CAAC,cACd,WAGJ,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAU,EAAI,IAAI,MAAM,WAE1B,EAAe,GAEnB,OAAQ,EAAR,CACI,IAAK,OACD,EAAe,KACf,MACJ,IAAK,KACD,EAAe,MACf,MACJ,IAAK,KACD,EAAe,KACf,MAGR,IAAM,EAAW,MAAMC,EAAI,CACvB,OAAQ,MACR,IAAK,uEAAuE,EAAQ,sCACpF,QAAS,CACL,QAAS,2CAGX,EAAO,EAAS,KAAK,KAAK,MAEhC,MAAO,CACH,MAAO,YAAY,EAAa,IAChC,KAAM,+CAA+C,EAAQ,oBAC7D,YAAa,YAAY,EAAa,IACtC,KACI,GACA,EAAK,IAAK,IAAU,CAChB,MAAO,EAAK,MACZ,YAAa,GAAG,EAAK,KAAK,gBAAgB,EAAK,UAAU,IACzD,QAAS,IAAI,KAAK,EAAK,MAAM,QAAQ,IAAK,KAAO,UAAU,cAC3D,KAAM,EAAK,eAAiB,wDAAwD,EAAK"}