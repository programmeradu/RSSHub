import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{art as n}from"./render-CxhTJIsl.js";import{parseDate as r}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as i}from"./got-CdvI2yKX.js";import a from"node:path";t();const o={path:`/knowledge/:topic?/:type?`,categories:[`new-media`],example:`/dedao/knowledge`,parameters:{topic:`话题 id，可在对应话题页 URL 中找到`,type:"分享类型，`true` 指精选，`false` 指最新，默认为精选"},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`dedao.cn/knowledge/topic/:topic`,`dedao.cn/knowledge`,`dedao.cn/`]}],name:`知识城邦`,maintainers:[`nczitzk`],handler:s};async function s(t){let o=t.req.param(`topic`)??``,s=/t|y/i.test(t.req.param(`type`)??`true`),c=t.req.query(`limit`)?Number.parseInt(t.req.query(`limit`)):100,l=`https://www.dedao.cn`,u=`${l}/knowledge${o===``?``:`/topic/`+o}`,d=`${l}/pc/ledgers/${o===``?`notes/friends_timeline`:`topic/notes/list`}`,f=`${l}/pc/ledgers/topic/detail`,p=``,m=``;if(o!==``){let e=await i({method:`post`,url:f,json:{incr_view_count:!1,topic_id_hazy:o}});p=e.data.c.name,m=e.data.c.intro}let h=await i({method:`post`,url:d,json:{count:c,load_chain:!0,is_elected:s,page_id:0,topic_id_hazy:o,version:2}}),g=(o===``?h.data.c.notes:h.data.c.note_detail_list).map(t=>({title:t.f_part.note,author:t.f_part.nick_name,link:`${l}/knowledge/note/${t.f_part.note_id_hazy}`,pubDate:r(t.f_part.time_desc,`MM-DD`),description:n(a.join(e,`templates/knowledge-74577996.art`),{rootUrl:l,f_part:t.f_part,s_part:t.s_part})}));return{title:`得到 - 知识城邦${p===``?``:` - `+p}`,link:u,item:g,description:m}}export{o as route};
//# sourceMappingURL=knowledge-BzZ2Mr8B.js.map