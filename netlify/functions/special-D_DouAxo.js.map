{"version":3,"file":"special-D_DouAxo.js","names":["route: Route","InvalidParameterError","got","url","cache"],"sources":["../../lib/routes/163/news/special.ts"],"sourcesContent":["import InvalidParameterError from '@/errors/types/invalid-parameter';\r\nimport { Route } from '@/types';\r\nimport cache from '@/utils/cache';\r\nimport got from '@/utils/got';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport { load } from 'cheerio';\r\nconst typeMap = {\r\n    1: '轻松一刻',\r\n    2: '槽值',\r\n    3: '人间',\r\n    4: '大国小民',\r\n    5: '三三有梗',\r\n    6: '数读',\r\n    7: '看客',\r\n    8: '下划线',\r\n    9: '谈心社',\r\n    10: '哒哒',\r\n    11: '胖编怪聊',\r\n    12: '曲一刀',\r\n    13: '今日之声',\r\n    14: '浪潮',\r\n    15: '沸点',\r\n};\r\nexport const route: Route = {\r\n    path: '/news/special/:type?',\r\n    categories: ['new-media'],\r\n    example: '/163/news/special/1',\r\n    parameters: { type: '栏目' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    name: '专栏',\r\n    maintainers: ['nczitzk'],\r\n    handler,\r\n    description: `| 轻松一刻 | 槽值 | 人间 | 大国小民 | 三三有梗 | 数读 | 看客 | 下划线 | 谈心社 | 哒哒 | 胖编怪聊 | 曲一刀 | 今日之声 | 浪潮 | 沸点 |\r\n| -------- | ---- | ---- | -------- | -------- | ---- | ---- | ------ | ------ | ---- | -------- | ------ | -------- | ---- | ---- |\r\n| 1        | 2    | 3    | 4        | 5        | 6    | 7    | 8      | 9      | 10   | 11       | 12     | 13       | 14   | 15   |`,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    if (!ctx.req.param('type')) {\r\n        throw new InvalidParameterError('Bad parameter. See <a href=\"https://docs.rsshub.app/routes/game#wang-yi-da-shen\">https://docs.rsshub.app/routes/game#wang-yi-da-shen</a>');\r\n    }\r\n    const selectedType = Number.parseInt(ctx.req.param('type'));\r\n    let type;\r\n    switch (selectedType) {\r\n        case 1:\r\n            type = `BD21K0DLwangning`; // 轻松一刻\r\n            break;\r\n        case 2:\r\n            type = `CICMICLUwangning`; // 槽值\r\n            break;\r\n        case 3:\r\n            type = `CICMOMBLwangning`; // 人间\r\n            break;\r\n        case 4:\r\n            type = `CICMPVC5wangning`; // 大国小民\r\n            break;\r\n        case 5:\r\n            type = `CICMLCOUwangning`; // 三三有梗\r\n            break;\r\n        case 6:\r\n            type = `D551V75Cwangning`; // 数读\r\n            break;\r\n        case 7:\r\n            type = `D55253RHwangning`; // 看客\r\n            break;\r\n        case 8:\r\n            type = `D553A53Lwangning`; // 下划线\r\n            break;\r\n        case 9:\r\n            type = `D553PGHQwangning`; // 谈心社\r\n            break;\r\n        case 10:\r\n            type = `CICMS5BIwangning`; // 哒哒\r\n            break;\r\n        case 11:\r\n            type = `CQ9UDVKOwangning`; // 胖编怪聊\r\n            break;\r\n        case 12:\r\n            type = `CQ9UJIJNwangning`; // 曲一刀\r\n            break;\r\n        case 13:\r\n            type = `BD284UM8wangning`; // 今日之声\r\n            break;\r\n        case 14:\r\n            type = `CICMMGBHwangning`; // 浪潮\r\n            break;\r\n        case 15:\r\n            type = `D5543R68wangning`; // 沸点\r\n            break;\r\n        default:\r\n            break;\r\n    }\r\n    const url = `https://3g.163.com/touch/reconstruct/article/list/${type}/0-20.html`;\r\n    const response = await got(url);\r\n    const data = response.data;\r\n    const matches = data.replaceAll(/\\s/g, '').match(/artiList\\((.*?)]}\\)/);\r\n    const articlelist0 = matches[1].replace(/\".*?wangning/, '\"articles') + ']}';\r\n    const articlelist = JSON.parse(articlelist0);\r\n    const articles = articlelist.articles;\r\n\r\n    const items = await Promise.all(\r\n        articles.map((article) => {\r\n            let url = article.url;\r\n            if (url === null || article.skipType === 'video') {\r\n                const skipurl = article.skipURL;\r\n                const vid = skipurl.match(/vid=(.*?)$/);\r\n                if (vid !== null) {\r\n                    url = `https://3g.163.com/exclusive/video/${vid[1]}.html`;\r\n                }\r\n            }\r\n            return cache.tryGet(url, async () => {\r\n                const article_response = await got(url);\r\n                const $ = load(article_response.data);\r\n\r\n                article.link = url;\r\n                article.description = $('.article-body').html() || $('div[class=\"video\"]').html();\r\n                article.pubDate = parseDate(article.ptime);\r\n\r\n                return article;\r\n            });\r\n        })\r\n    );\r\n\r\n    const selectedTypeName = typeMap[selectedType];\r\n\r\n    return {\r\n        title: selectedTypeName ? `${selectedTypeName} - 网易专栏` : '网易专栏',\r\n        link: 'https://3g.163.com/touch/exclusive/?referFrom=163',\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"obAMA,MAAM,EAAU,CACZ,EAAG,OACH,EAAG,KACH,EAAG,KACH,EAAG,OACH,EAAG,OACH,EAAG,KACH,EAAG,KACH,EAAG,MACH,EAAG,MACH,GAAI,KACJ,GAAI,OACJ,GAAI,MACJ,GAAI,OACJ,GAAI,KACJ,GAAI,MAEKA,EAAe,CACxB,KAAM,uBACN,WAAY,CAAC,aACb,QAAS,sBACT,WAAY,CAAE,KAAM,MACpB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,KAAM,KACN,YAAa,CAAC,WACd,UACA,YAAa;;uIAKjB,eAAe,EAAQ,EAAK,CACxB,GAAI,CAAC,EAAI,IAAI,MAAM,QACf,MAAM,IAAIC,EAAsB,4IAEpC,IAAM,EAAe,OAAO,SAAS,EAAI,IAAI,MAAM,SAC/C,EACJ,OAAQ,EAAR,CACI,IAAK,GACD,EAAO,mBACP,MACJ,IAAK,GACD,EAAO,mBACP,MACJ,IAAK,GACD,EAAO,mBACP,MACJ,IAAK,GACD,EAAO,mBACP,MACJ,IAAK,GACD,EAAO,mBACP,MACJ,IAAK,GACD,EAAO,mBACP,MACJ,IAAK,GACD,EAAO,mBACP,MACJ,IAAK,GACD,EAAO,mBACP,MACJ,IAAK,GACD,EAAO,mBACP,MACJ,IAAK,IACD,EAAO,mBACP,MACJ,IAAK,IACD,EAAO,mBACP,MACJ,IAAK,IACD,EAAO,mBACP,MACJ,IAAK,IACD,EAAO,mBACP,MACJ,IAAK,IACD,EAAO,mBACP,MACJ,IAAK,IACD,EAAO,mBACP,MACJ,QACI,MAER,IAAM,EAAM,qDAAqD,EAAK,YAChE,EAAW,MAAMC,EAAI,GACrB,EAAO,EAAS,KAChB,EAAU,EAAK,WAAW,MAAO,IAAI,MAAM,uBAC3C,EAAe,EAAQ,GAAG,QAAQ,eAAgB,aAAe,KACjE,EAAc,KAAK,MAAM,GACzB,EAAW,EAAY,SAEvB,EAAQ,MAAM,QAAQ,IACxB,EAAS,IAAK,GAAY,CACtB,IAAIC,EAAM,EAAQ,IAClB,GAAIA,IAAQ,MAAQ,EAAQ,WAAa,QAAS,CAC9C,IAAM,EAAU,EAAQ,QAClB,EAAM,EAAQ,MAAM,cACtB,IAAQ,OACR,EAAM,sCAAsC,EAAI,GAAG,QAG3D,OAAOC,EAAM,OAAOD,EAAK,SAAY,CACjC,IAAM,EAAmB,MAAMD,EAAIC,GAC7B,EAAI,EAAK,EAAiB,MAMhC,MAJA,GAAQ,KAAOA,EACf,EAAQ,YAAc,EAAE,iBAAiB,QAAU,EAAE,sBAAsB,OAC3E,EAAQ,QAAU,EAAU,EAAQ,OAE7B,OAKb,EAAmB,EAAQ,GAEjC,MAAO,CACH,MAAO,EAAmB,GAAG,EAAiB,SAAW,OACzD,KAAM,oDACN,KAAM"}