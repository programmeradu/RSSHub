import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as e}from"./cache-kimkMTWJ.js";import{parseDate as t}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as n}from"./got-CdvI2yKX.js";import{load as r}from"cheerio";const i={path:`/realtime/:category?`,categories:[`traditional-media`],example:`/ebc/realtime/politics`,parameters:{category:`Category from the last segment of the URL of the corresponding site`},features:{requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1,requireConfig:!1},name:`即時新聞`,maintainers:[`quiniapiezoelectricity`],handler:a,description:``,radar:[{source:[`news.ebc.net.tw/realtime/:category`],target:`/:category`}]};async function a(i){let a=i.req.param(`category`)??``,o=await n(`https://news.ebc.net.tw/list/load`,{method:`POST`,headers:{Accept:`*/*`,"Content-Type":`application/x-www-form-urlencoded; charset=UTF-8`,"X-Requested-With":`XMLHttpRequest`},body:new URLSearchParams({list_type:`realtime`,cate_code:a,page:`1`}).toString()}),s=r(o.data),c=s(`div.list > a`).toArray().map(e=>new URL(s(e).attr(`href`)??``,`https://news.ebc.net.tw`).href),l=await Promise.all(c.map(i=>e.tryGet(i,async()=>{let e=await n(i),a=r(e.data),o=a(`[type="application/ld+json"]`).toArray().flatMap(e=>JSON.parse(a(e).text())).find(e=>e[`@type`]===`NewsArticle`);a(`.img_box`).each((e,t)=>{a(t).children(`div.img_caption`).replaceWith(a(`<figcaption>${a(t).children(`div.img_caption`).text()}</figcaption>`)),a(t).children(`div.img`).children().unwrap(),a(t).wrapInner(a(`<figure></figure>`))}),a(`[style="font-size:16px;"]`).each((e,t)=>{a(t).replaceWith(`<small>${a(t).text()}</small>`)});let s=a(`div.article_cover`),c=a(`div.article_content`);return c.find(`.inline_text, .inline_box, .rss_box`).remove(),{title:o.headline,link:i,pubDate:t(o.datePublished),author:o.author.name,description:s.html()+c.html(),category:o.keywords?[o.articleSection,...o.keywords.split(`,`)]:[o.articleSection]}})));return{title:`東森新聞|即時`,link:a?`https://news.ebc.net.tw/realtime/${a}`:`https://news.ebc.net.tw/realtime`,language:`zh-TW`,item:l}}export{i as route};
//# sourceMappingURL=realtime-txM9Mu5d.js.map