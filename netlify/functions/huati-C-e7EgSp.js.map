{"version":3,"file":"huati-C-e7EgSp.js","names":["route: Route","utils","got","InvalidParameterError"],"sources":["../../lib/routes/coolapk/huati.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport got from '@/utils/got';\r\nimport utils from './utils';\r\nimport InvalidParameterError from '@/errors/types/invalid-parameter';\r\n\r\nexport const route: Route = {\r\n    path: '/huati/:tag',\r\n    categories: ['social-media'],\r\n    example: '/coolapk/huati/iPhone',\r\n    parameters: { tag: '话题名称' },\r\n    features: {\r\n        requireConfig: [\r\n            {\r\n                name: 'ALLOW_USER_HOTLINK_TEMPLATE',\r\n                optional: true,\r\n                description: '设置为`true`并添加`image_hotlink_template`参数来代理图片',\r\n            },\r\n        ],\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    name: '话题',\r\n    maintainers: ['xizeyoupan'],\r\n    handler,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const tag = ctx.req.param('tag');\r\n    const full_url = utils.base_url + `/v6/page/dataList?url=%23%2Ffeed%2FmultiTagFeedList%3FlistType%3Ddateline_desc%26tag=${tag}&title=%E6%9C%80%E6%96%B0%E5%8F%91%E5%B8%83&subTitle=&page=1`;\r\n    const response = await got(full_url, {\r\n        headers: utils.getHeaders(),\r\n    });\r\n    const data = response.data.data;\r\n\r\n    let out = await Promise.all(data.map((item) => utils.parseDynamic(item)));\r\n\r\n    out = out.filter(Boolean); // 去除空值\r\n    if (out.length === 0) {\r\n        throw new InvalidParameterError('这个话题还没有被创建或现在没有图文及动态内容。');\r\n    }\r\n    return {\r\n        title: `酷安话题-${tag}`,\r\n        link: `https://www.coolapk.com/`,\r\n        description: `酷安话题-${tag}`,\r\n        item: out,\r\n    };\r\n}\r\n"],"mappings":"ubAKA,MAAaA,EAAe,CACxB,KAAM,cACN,WAAY,CAAC,gBACb,QAAS,wBACT,WAAY,CAAE,IAAK,QACnB,SAAU,CACN,cAAe,CACX,CACI,KAAM,8BACN,SAAU,GACV,YAAa,gDAGrB,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,KAAM,KACN,YAAa,CAAC,cACd,WAGJ,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAM,EAAI,IAAI,MAAM,OACpB,EAAWC,EAAM,SAAW,wFAAwF,EAAI,8DACxH,EAAW,MAAMC,EAAI,EAAU,CACjC,QAASD,EAAM,eAEb,EAAO,EAAS,KAAK,KAEvB,EAAM,MAAM,QAAQ,IAAI,EAAK,IAAK,GAASA,EAAM,aAAa,KAGlE,GADA,EAAM,EAAI,OAAO,SACb,EAAI,SAAW,EACf,MAAM,IAAIE,EAAsB,2BAEpC,MAAO,CACH,MAAO,QAAQ,IACf,KAAM,2BACN,YAAa,QAAQ,IACrB,KAAM"}