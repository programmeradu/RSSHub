import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import{config as n}from"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as r}from"./cache-kimkMTWJ.js";import{art as i}from"./render-CxhTJIsl.js";import"./ofetch-Bzt0BXUH.js";import{got_default as a}from"./got-CdvI2yKX.js";import{config_not_found_default as o}from"./config-not-found-BVqhRP9D.js";import s from"node:path";t();const c=`QWeather`,l={path:`/3days/:location`,categories:[`forecast`],example:`/qweather/3days/广州`,parameters:{location:`N`},features:{requireConfig:[{name:`HEFENG_KEY`,description:``}],requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`近三天天气`,maintainers:[`Rein-Ou`,`la3rence`],handler:u,description:`获取订阅近三天天气预报`};async function u(t){if(!n.hefeng.key)throw new o(`QWeather RSS is disabled due to the lack of <a href="https://docs.rsshub.app/zh/install/config#%E5%92%8C%E9%A3%8E%E5%A4%A9%E6%B0%94">relevant config</a>`);let l=await r.tryGet(`qweather:`+t.req.param(`location`)+`:id`,async()=>{let e=await a(`https://geoapi.qweather.com/v2/city/lookup?location=${t.req.param(`location`)}&key=${n.hefeng.key}`);return e.data.location[0].id}),u=await r.tryGet(`qweather:`+t.req.param(`location`),async()=>{let e=await a(`https://devapi.qweather.com/v7/weather/3d?key=${n.hefeng.key}&location=${l}`);return e.data},n.cache.contentExpire,!1),d=await r.tryGet(`qweather:air:${t.req.param(`location`)}`,async()=>{let e=await a(`https://devapi.qweather.com/v7/air/5d?location=${l}&key=${n.hefeng.key}`);return e.data},n.cache.contentExpire,!1),f={updateTime:u.updateTime,fxLink:u.fxLink,daily:u.daily.map(e=>{let t=d.daily.find(t=>t.fxDate===e.fxDate);return t?{...e,aqi:t.aqi,aqiLevel:t.level,aqiCategory:t.category,aqiPrimary:t.primary}:e})},p=f.daily.map(n=>({title:`${n.fxDate}: ${n.textDay===n.textNight?n.textDay:n.textDay+`转`+n.textNight} ${n.tempMin}~${n.tempMax}℃`,description:i(s.join(e,`templates/3days-cee3addb.art`),{item:n}),pubDate:f.updateTime,guid:`位置：`+t.req.param(`location`)+`--日期：`+n.fxDate,link:f.fxLink,author:c}));return{title:t.req.param(`location`)+`未来三天天气`,description:t.req.param(`location`)+`未来三天天气情况，使用和风彩云 API (包括空气质量)`,item:p,link:f.fxLink,author:c}}export{l as route};
//# sourceMappingURL=3days-CebRxABA.js.map