import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{cache_default as e}from"./cache-kimkMTWJ.js";import{parseDate as t}from"./parse-date-Bgabdhlb.js";import{ofetch_default as n}from"./ofetch-Bzt0BXUH.js";import{ViewType as r}from"./types-A5bA50Mg.js";import{load as i}from"cheerio";const a=async r=>{let{category:a=`Industry/Comment`}=r.req.param(),o=Number.parseInt(r.req.query(`limit`)??`15`,10),s=`https://www.chinaratings.com.cn`,c=new URL(`CreditResearch/${a.endsWith(`/`)?a:`${a}/`}`,s).href,l=await n(c),u=i(l),d=`zh-CN`,f=[];f=u(`div.contRight ul.list li`).slice(0,o).toArray().map(e=>{let n=u(e),r=n.find(`a`),i=r.text(),a=n.find(`span`).text(),o=r.attr(`href`),s=a,l={title:i,pubDate:a?t(a):void 0,link:o?new URL(o,c).href:void 0,updated:s?t(s):void 0,language:d};return l}),f=(await Promise.all(f.map(r=>r.link?e.tryGet(r.link,async()=>{let e=await n(r.link),a=i(e),o=a(`div.newshead h2, div.title h3`).text(),c=a(`div.news div.content`).html()??``,l=a(`div.newshead p span, div.title p span`).text(),u=l?.match(/(\d{4}-\d{2}-\d{2})/)?.[1],f=l?.match(/来源：(.*?)/)?.[1],p=u,m={title:o,description:c,pubDate:u?t(u):r.pubDate,author:f,content:{html:c,text:c},updated:p?t(p):r.updated,language:d},h=e.match(/(\/upload\/docs\/\d{4}-\d{2}-\d{2}\/doc_\d+)"/)?.[1],g=h?`${new URL(h,s).href}.pdf`:void 0;return g&&(m={...m,enclosure_url:g,enclosure_type:`application/pdf`,enclosure_title:o}),{...r,...m}}):r))).filter(e=>!0);let p=u(`title`).text();return{title:p,link:c,item:f,allowEmpty:!0,image:u(`a.logo_c`).attr(`href`)?new URL(u(`a.logo_c`).attr(`href`),c).href:void 0,author:p.split(/-/).pop(),language:d,id:c}},o={path:`/CreditResearch/:category{.+}?`,name:`中债研究`,url:`www.chinaratings.com.cn`,maintainers:[`nczitzk`],handler:a,example:`/chinaratings/CreditResearch`,parameters:{category:"分类，默认为 `Industry/Comment`，即行业评论，可在对应分类页 URL 中找到"},description:":::tip\n若订阅 [行业评论](https://www.chinaratings.com.cn/CreditResearch/Industry/Comment/)，网址为 `https://www.chinaratings.com.cn/CreditResearch/Industry/Comment/`，请截取 `https://www.chinaratings.com.cn/CreditResearch/` 到末尾 `/` 的部分 `Industry/Comment` 作为 `category` 参数填入，此时目标路由为 [`/chinaratings/CreditResearch/Industry/Comment`](https://rsshub.app/chinaratings/CreditResearch/Industry/Comment)。\n:::\n",categories:[`finance`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.chinaratings.com.cn/CreditResearch/:category`],target:e=>{let t=e.category;return`/chinaratings/CreditResearch${t?`/${t}`:``}`}}],view:r.Articles};export{a as handler,o as route};
//# sourceMappingURL=credit-research-CwAbK8E8.js.map