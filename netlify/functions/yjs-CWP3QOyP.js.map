{"version":3,"file":"yjs-CWP3QOyP.js","names":["got","route: Route","cache"],"sources":["../../lib/routes/swjtu/jtys/yjs.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport cache from '@/utils/cache';\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\nimport { parseDate } from '@/utils/parse-date';\r\n\r\nconst rootURL = 'https://ctt.swjtu.edu.cn';\r\nconst url_addr = `${rootURL}/yethan/WebIndexAction?setAction=newsList&bigTypeId=0E4BF4D36E232918`;\r\n\r\nconst getItem = (item, cache) => {\r\n    const news_info = item.find('div[class=\"news-title newsInfo\"]');\r\n    const news_month = item.find('.month').text();\r\n    const news_day = item.find('.day').text();\r\n\r\n    const info_id = news_info.attr('newsid');\r\n    const info_title = news_info.text();\r\n    const link = `${rootURL}/yethan/WebIndexAction?setAction=newsInfo&newsId=${info_id}`;\r\n    return cache.tryGet(link, async () => {\r\n        const resp = await got({\r\n            method: 'get',\r\n            url: link,\r\n        });\r\n        const $$ = load(resp.data);\r\n        const info_text = $$('.news-left').html();\r\n\r\n        return {\r\n            title: info_title,\r\n            pubDate: parseDate(`${news_month}.${news_day}`),\r\n            link,\r\n            description: info_text,\r\n        };\r\n    });\r\n};\r\n\r\nexport const route: Route = {\r\n    path: '/jtys/yjs',\r\n    categories: ['university'],\r\n    example: '/swjtu/jtys/yjs',\r\n    parameters: {},\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: true,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    name: '交通运输与物流学院',\r\n    maintainers: ['qizidog'],\r\n    handler,\r\n    description: `#### 研究生通知 {#xi-nan-jiao-tong-da-xue-jiao-tong-yun-shu-yu-wu-liu-xue-yuan-yan-jiu-sheng-tong-zhi}`,\r\n};\r\n\r\nasync function handler() {\r\n    const resp = await got({\r\n        method: 'get',\r\n        url: url_addr,\r\n    });\r\n\r\n    const $ = load(resp.data);\r\n    const list = $(\"[class='news-list flex']\");\r\n\r\n    const items = await Promise.all(\r\n        list.toArray().map((i) => {\r\n            const item = $(i);\r\n            return getItem(item, cache);\r\n        })\r\n    );\r\n\r\n    return {\r\n        title: '西南交大交运学院-研究生通知',\r\n        link: url_addr,\r\n        item: items,\r\n        allowEmpty: true,\r\n    };\r\n}\r\n"],"mappings":"wWAMA,MAAM,EAAU,2BACV,EAAW,GAAG,EAAQ,sEAEtB,GAAW,EAAM,IAAU,CAC7B,IAAM,EAAY,EAAK,KAAK,oCACtB,EAAa,EAAK,KAAK,UAAU,OACjC,EAAW,EAAK,KAAK,QAAQ,OAE7B,EAAU,EAAU,KAAK,UACzB,EAAa,EAAU,OACvB,EAAO,GAAG,EAAQ,mDAAmD,IAC3E,OAAO,EAAM,OAAO,EAAM,SAAY,CAClC,IAAM,EAAO,MAAMA,EAAI,CACnB,OAAQ,MACR,IAAK,IAEH,EAAK,EAAK,EAAK,MACf,EAAY,EAAG,cAAc,OAEnC,MAAO,CACH,MAAO,EACP,QAAS,EAAU,GAAG,EAAW,GAAG,KACpC,OACA,YAAa,MAKZC,EAAe,CACxB,KAAM,YACN,WAAY,CAAC,cACb,QAAS,kBACT,WAAY,GACZ,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,KAAM,YACN,YAAa,CAAC,WACd,UACA,YAAa,qGAGjB,eAAe,GAAU,CACrB,IAAM,EAAO,MAAMD,EAAI,CACnB,OAAQ,MACR,IAAK,IAGH,EAAI,EAAK,EAAK,MACd,EAAO,EAAE,4BAET,EAAQ,MAAM,QAAQ,IACxB,EAAK,UAAU,IAAK,GAAM,CACtB,IAAM,EAAO,EAAE,GACf,OAAO,EAAQ,EAAME,MAI7B,MAAO,CACH,MAAO,iBACP,KAAM,EACN,KAAM,EACN,WAAY"}