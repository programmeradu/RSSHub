import{cache_default as e}from"./cache-kimkMTWJ.js";import{parseDate as t}from"./parse-date-Bgabdhlb.js";import{ofetch_default as n}from"./ofetch-Bzt0BXUH.js";import{timezone as r}from"./timezone-BrNu6iXe.js";import{load as i}from"cheerio";const a=`https://www.jisilu.cn`,o=async(a,o,s)=>{let c=o.find(`div.aw-item`).toArray().map(e=>{let n=a(e),i=n.find(`h4 a`),o=i.text(),s=i.prop(`href`),c=n.find(`.aw-text-color-999`).text().match(/(\d{4}-\d{2}-\d{2}\s\d{2}:\d{2})/)?.[1],l=n.find(`a.aw-user-name`),u=l.prop(`href`)?[{name:l.text(),url:l.prop(`href`)}]:l.text();return{title:o,pubDate:c?r(t(c),8):void 0,link:s,category:n.find(`span.aw-question-tags a, a.aw-topic-name`).toArray().map(e=>a(e).text()),author:u}});return(await Promise.all(c.map(a=>!a.link&&typeof a.link!=`string`?a:e.tryGet(a.link,async()=>{let e=await n(a.link),o=i(e),s=o(`div.aw-mod-head h1`).text();if(!s)return a;let c=a.link?/answer_id/.test(a.link):!1,l=(c?o(`div.markitup-box`).last():o(`div.markitup-box`).first()).html()??``,u=o(c?`div.aw-dynamic-topic-meta`:`div.aw-question-detail-meta`).find(`span.aw-text-color-999`).text(),d=u.match(c?/(\d{4}-\d{2}-\d{2}\s\d{2}:\d{2})/:/发表时间\s(\d{4}-\d{2}-\d{2}\s\d{2}:\d{2})/)?.[1],f=u.match(/最后修改时间\s(\d{4}-\d{2}-\d{2}\s\d{2}:\d{2})/)?.[1],p=o(c?`p.publisher a.aw-user-name`:`div.aw-side-bar-mod-body a.aw-user-name`).first(),m=p.prop(`href`)?[{name:p.text(),url:p.prop(`href`),avatar:p.parent().parent().find(`img`).first().prop(`src`)}]:p.text();return{title:s,description:l,pubDate:d?r(t(d),8):a.pubDate,link:a.link,category:a.category,author:m,content:{html:l,text:o(`div.aw-question-detail-txt`).first().text()},updated:f?r(t(f),8):a.updated}})))).filter(e=>!0).slice(0,s)};export{o as processItems,a as rootUrl};
//# sourceMappingURL=util-BXYGn3zC.js.map