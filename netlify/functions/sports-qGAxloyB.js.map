{"version":3,"file":"sports-qGAxloyB.js","names":["route: Route","cache"],"sources":["../../lib/routes/swjtu/sports.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport cache from '@/utils/cache';\r\nimport { load } from 'cheerio';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport { ofetch } from 'ofetch';\r\n\r\nconst rootURL = 'https://sports.swjtu.edu.cn';\r\nconst pageURL = `${rootURL}/xwzx.htm`;\r\n\r\nexport const route: Route = {\r\n    path: '/sports',\r\n    categories: ['university'],\r\n    example: '/swjtu/sports',\r\n    parameters: {},\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: true,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['sports.swjtu.edu.cn/'],\r\n        },\r\n    ],\r\n    name: '体育学院',\r\n    description: '新闻资讯',\r\n    maintainers: ['AzureG03'],\r\n    handler,\r\n};\r\n\r\nconst getItem = (item, cache) => {\r\n    const title = item.find('p.toe').text();\r\n    const link = `${rootURL}/${item.find('a').attr('href')}`;\r\n\r\n    return cache.tryGet(link, async () => {\r\n        const res = await ofetch(link);\r\n        const $ = load(res);\r\n\r\n        const pubDate = parseDate(\r\n            $('div.info span:nth-of-type(3)')\r\n                .text()\r\n                .slice(3)\r\n                .match(/\\d{4}(-|\\/|.)\\d{1,2}\\1\\d{1,2}/)?.[0]\r\n        );\r\n        const description = $('div.detail-wrap').html();\r\n        return {\r\n            title,\r\n            pubDate,\r\n            link,\r\n            description,\r\n        };\r\n    });\r\n};\r\n\r\nasync function handler() {\r\n    const res = await ofetch(pageURL);\r\n\r\n    const $ = load(res);\r\n    const $list = $('div.news-list > ul > li');\r\n\r\n    const items = await Promise.all(\r\n        $list.toArray().map((i) => {\r\n            const $item = $(i);\r\n            return getItem($item, cache);\r\n        })\r\n    );\r\n\r\n    return {\r\n        title: '西南交大体院-新闻资讯',\r\n        link: pageURL,\r\n        item: items,\r\n        allowEmpty: true,\r\n    };\r\n}\r\n"],"mappings":"kOAMA,MAAM,EAAU,8BACV,EAAU,GAAG,EAAQ,WAEdA,EAAe,CACxB,KAAM,UACN,WAAY,CAAC,cACb,QAAS,gBACT,WAAY,GACZ,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,0BAGjB,KAAM,OACN,YAAa,OACb,YAAa,CAAC,YACd,WAGE,GAAW,EAAM,IAAU,CAC7B,IAAM,EAAQ,EAAK,KAAK,SAAS,OAC3B,EAAO,GAAG,EAAQ,GAAG,EAAK,KAAK,KAAK,KAAK,UAE/C,OAAO,EAAM,OAAO,EAAM,SAAY,CAClC,IAAM,EAAM,MAAM,EAAO,GACnB,EAAI,EAAK,GAET,EAAU,EACZ,EAAE,gCACG,OACA,MAAM,GACN,MAAM,mCAAmC,IAE5C,EAAc,EAAE,mBAAmB,OACzC,MAAO,CACH,QACA,UACA,OACA,kBAKZ,eAAe,GAAU,CACrB,IAAM,EAAM,MAAM,EAAO,GAEnB,EAAI,EAAK,GACT,EAAQ,EAAE,2BAEV,EAAQ,MAAM,QAAQ,IACxB,EAAM,UAAU,IAAK,GAAM,CACvB,IAAM,EAAQ,EAAE,GAChB,OAAO,EAAQ,EAAOC,MAI9B,MAAO,CACH,MAAO,cACP,KAAM,EACN,KAAM,EACN,WAAY"}