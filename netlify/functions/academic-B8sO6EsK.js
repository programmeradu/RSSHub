import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as n}from"./cache-kimkMTWJ.js";import{art as r}from"./render-CxhTJIsl.js";import{parseDate as i}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as a}from"./got-CdvI2yKX.js";import{timezone as o}from"./timezone-BrNu6iXe.js";import s from"node:path";import{load as c}from"cheerio";t();const l=async t=>{let{id:l=`1`}=t.req.param(),u=t.req.query(`limit`)?Number.parseInt(t.req.query(`limit`),10):10,d=`https://www.eshukan.com`,f=new URL(`academic/index.aspx?cid=${l}`,d).href,{data:p}=await a(f),m=c(p),h=m(`ul.article li`).slice(0,u).toArray().map(t=>{t=m(t);let n=t.find(`a`),a=n.contents().last().text(),c=t.find(`p span`).text().match(/(\d{4}\/\d{2}\/\d{2}\s\d{2}:\d{2}:\d{2})/)?.[1];t.find(`p span`).remove();let l=r(s.join(e,`templates/description-7545a891.art`),{intro:t.find(`p`).text()});return{title:a,description:l,pubDate:c?o(i(c),8):void 0,link:new URL(n.prop(`href`),f).href,content:{html:l,text:t.find(`p`).text()}}});h=await Promise.all(h.map(t=>n.tryGet(t.link,async()=>{let{data:n}=await a(t.link),l=c(n),u=l(`h1`).text(),d=r(s.join(e,`templates/description-7545a891.art`),{intro:l(`div.summary`).html(),description:l(`div.detail`).html()}),f=l(`div.author`).text().match(/(\d{4}\/\d{2}\/\d{2}\s\d{2}:\d{2}:\d{2})/)?.[1];return t.title=u,t.description=d,t.pubDate=f?o(i(f),8):t.pubDate,t.author=l(`div.author a`).text(),t.content={html:d,text:l(`div.detail`).text()},t})));let g=m(`title`).text(),_=new URL(m(`div.logo img`).prop(`src`),d).href;return{title:g,description:m(`meta[name="description"]`).prop(`content`),link:f,item:h,allowEmpty:!0,image:_,author:g.split(/_/).pop()}},u={path:`/academic/:id?`,name:`学术资讯`,url:`www.eshukan.com`,maintainers:[`nczitzk`],handler:l,example:`/eshukan/academic/1`,parameters:{category:"栏目 id，默认为 `1`，即期刊动态，可在对应栏目页 URL 中找到"},description:"::: tip\n  若订阅 [期刊动态](https://www.eshukan.com/academic/index.aspx?cid=1)，网址为 `https://www.eshukan.com/academic/index.aspx?cid=1`。截取 `https://www.eshukan.com/academic/index.aspx?cid=` 到末尾的部分 `1` 作为参数填入，此时路由为 [`/eshukan/academic/1`](https://rsshub.app/eshukan/academic/1)。\n:::\n    ",categories:[`study`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.eshukan.com/academic/index.aspx`],target:(e,t)=>{t=new URL(t);let n=t.searchParams.get(`id`);return`/academic${n?`/${n}`:``}`}}]};export{l as handler,u as route};
//# sourceMappingURL=academic-B8sO6EsK.js.map