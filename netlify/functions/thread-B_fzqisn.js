import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{art as n}from"./render-CxhTJIsl.js";import{parseDate as r}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as i}from"./got-CdvI2yKX.js";import{countReplies as a,viewThread as o}from"./query-Pb8sqRaC.js";import s from"node:path";t();const c={path:`/thread/:id`,radar:[{source:[`lkong.com/thread/:id`,`lkong.com/`]}],name:`Unknown`,maintainers:[`nczitzk`,`ma6254`],handler:l};async function l(t){let c=t.req.param(`id`),l=`https://www.lkong.com`,u=`https://api.lkong.com/api`,d=`${l}/thread/${c}`,f=await i({method:`post`,url:u,json:a(c)});if(f.data.errors)throw Error(f.data.errors[0].message);let p=await i({method:`post`,url:u,json:o(c,Math.ceil(f.data.data.thread.replies/20))}),m=p.data.data.posts.map(t=>({guid:t.pid,author:t.user.name,title:`#${t.lou} ${t.user.name}`,link:`${l}/thread/${c}?pid=${t.pid}`,pubDate:r(t.dateline),description:(t.quote?n(s.join(e,`templates/quote-45cb32ad.art`),{target:`${l}/thread/${c}?pid=${t.quote.pid}`,author:t.quote.author.name,content:n(s.join(e,`templates/content-2787cf60.art`),{content:JSON.parse(t.quote.content)})}):``)+n(s.join(e,`templates/content-2787cf60.art`),{content:JSON.parse(t.content)})}));return{title:`${p.data.data.thread.title} - 龙空`,link:d,item:m}}export{c as route};
//# sourceMappingURL=thread-B_fzqisn.js.map