import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{parseDate as e}from"./parse-date-Bgabdhlb.js";import{md5 as t}from"./md5-4BNsOP-F.js";import{ofetch_default as n}from"./ofetch-Bzt0BXUH.js";import r from"node:crypto";import i from"sanitize-html";import a from"crypto-js";const o=a.enc.Utf8.parse(`eRtYuIoPaSdFgHqW`),s=a.enc.Utf8.parse(`Nmc09JkLzX8765Vb`),c=`https://pubscholar.cn`,l=e=>r.createHash(`sha1`).update(e).digest(`hex`),u=()=>r.randomUUID(),d=e=>{if(!e)return null;let t=``;for(;t.length<e;){let e=Math.random().toString(36).slice(2).toUpperCase();t+=e}return t.slice(0,e)},f=()=>{let e=d(6),t=Date.now().toString(),n=l([`6m6pingbinwaktg227gngifoocrfbo95`,t,e].sort().join(``));return{nonce:e,timestamp:t,signature:n}},p=e=>{let t=a.AES.encrypt(a.enc.Utf8.parse(e),o,{iv:s,mode:a.mode.CBC,padding:a.pad.Pkcs7}).ciphertext.toString();return t},m={path:`/explore/:category?/:keyword?`,name:`Explore`,maintainers:[`TonyRL`],example:`/pubscholar/explore`,parameters:{category:"Category, see the table below, `articles` by default",keyword:`Search Keyword`},handler:h,description:`| Articles / 论文 | Patents / 专利 | Reports / 领域快报 | Information / 动态快讯 | Datasets / 科学数据 | Books / 图书 |
| --------------- | -------------- | ------------------ | ---------------------- | ------------------- | ------------ |
| articles        | patents        | bulletins          | reports                | sciencedata         | books        |`};async function h(r){let{category:a=`articles`,keyword:o}=r.req.param(),s=u(),l=await n(`${c}/hky/open/resources/api/v1/${a}`,{method:`POST`,headers:{...f(),Cookie:`XSRF-TOKEN=${s}`,"X-XSRF-TOKEN":s},body:{page:1,size:10,order_field:`date`,order_direction:`desc`,user_id:t(Date.now().toString()),lang:`zh`,query:o,strategy:null,orderField:`default`}}),d=l.content.map(t=>({title:(t.is_free||t.links.some(e=>e.is_open_access)?`「Open Access」`:``)+i(t.title,{allowedTags:[],allowedAttributes:{}}),description:t.abstracts+`<br>${t.links.map(e=>`<a href="${e.url}">${e.is_open_access?`「Open Access」`:``}${e.name}</a>`).join(`<br>`)}`,author:t.author.join(`; `),pubDate:e(t.date),category:t.keywords.map(e=>i(e,{allowedTags:[],allowedAttributes:{}})),link:`${c}/${a}/${p(t.id)}`}));return{title:`PubScholar 公益学术平台`,link:`${c}/explore`,item:d}}export{m as route};
//# sourceMappingURL=explore-BRqMN5KA.js.map