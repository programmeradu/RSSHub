import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import{cache_default as n}from"./cache-kimkMTWJ.js";import{art as r}from"./render-CxhTJIsl.js";import{parseDate as i}from"./parse-date-Bgabdhlb.js";import{getSubPath as a}from"./common-utils-CvkwbCD5.js";import{got_default as o}from"./got-CdvI2yKX.js";import{timezone as s}from"./timezone-BrNu6iXe.js";import{finishArticleItem as c}from"./wechat-mp-BwNEdjlr.js";import{load as l}from"cheerio";t();const u=async(t,u)=>{let d=a(u).split(`/`).filter(e=>e!==``),[f,p]=d,m=t.pathstartat===void 0?0:t.pathstartat,h=`http://`+p+`.`+f+`.gov.cn`;for(let e=0;e<m;e++){let t=d[e+2];h=h+`/`+t}let g=t.defaultPath,_=t.name_element,v=t.name_match_type,y=t.name_match,b=t.name_join,x=t.list_element,S=t.list_include;if(x===void 0&&(x=`a[href*="content"]`,S=`site`),S===`site`){x=x.split(`,`).filter(e=>e!==``);for(let e=0;e<x.length;e++)x[e]+=`[href*="`+h.slice(7)+`"]`;x=x.join(`,`)}let C=t.title_element,w=t.title_match,T=t.author_element,E=t.author_match,D=t.authorisme,O=t.description_element,k=t.pubDate_element,A=t.pubDate_match,j=t.pubDate_format;d.splice(0,2+m);let M=d.join(`/`);M=M===``?g:M.endsWith(`/`)?M:M+`/`;let N=`${h}/${M}`,P=``,F=``,I=``;if(M.startsWith(`gkmlpt`)){C=void 0,w=void 0,O=`div[class="article-content"]`,k=void 0,A=void 0,j=void 0;let e=await o(`${h}/gkmlpt/api/all/0`);F=D+`政府信息公开平台`,I=e.data.articles.filter(e=>e.url.includes(`content`))}else{let e=await o(N),t=e.data;switch(P=l(t),v){case`name`:F=_;break;case`meta`:_=_.split(`,`).filter(e=>e!==``);for(let e=0;e<_.length;e++)_[e]=P(`meta[name="`+_[e].trim()+`"]`).attr(`content`);F=_.join(b);break;case`element`:_=_.split(`,`).filter(e=>e!==``);for(let e=0;e<_.length;e++)_[e]=P(_[e].trim()).text().match(y)[1];F=_.join(b);break;default:F=P(`head title`).text();break}I=P(x)}let L=I.map((e,t)=>{let n=``;return M.startsWith(`gkmlpt`)?n=e.url:(n=P(t).attr(`href`),n.startsWith(`http`)||(n=n.startsWith(`/`)?`${h}${n}`:`${h}/${n}`)),n}),R=await Promise.all(L.map(t=>{let a=new URL(t);return a.pathname===`/zcjdpt`?n.tryGet(t,async()=>{let n=`https://zcjd.cloud.gd.gov.cn/api/home/article`+a.search,c=await o(n),l=c.data.data;for(let e=0;e<l.jie_du_items.length;e++)l.jie_du_items[e].jd_content=l.jie_du_items[e].jd_content.replaceAll(/((\n {4})|(\n))/g,`</p><p style="font-size: 16px;line-height: 32px;text-indent: 2em;">`);return{link:t,title:l.art_title,description:r(d.join(e,`templates/zcjdpt-4ba87351.art`),l),pubDate:s(i(l.pub_time),8),author:/(本|本网|本站)/.test(l.pub_unite)?D:l.pub_unite}}):a.host===`mp.weixin.qq.com`?c({link:t}):n.tryGet(t,async()=>{let{data:e}=await o(t),n=l(e),r=``;r=T===void 0?n(`meta[name="ContentSource"]`).attr(`content`):n(T).text().trim().match(E)[1].trim().replaceAll(/(-*$)/g,``);let a=``;a=k===void 0?n(`meta[name="PubDate"]`).attr(`content`):n(k).text().trim().match(A)[1].trim().replaceAll(/(-*$)/g,``);let c=``;c=C===void 0?n(`meta[name="ArticleTitle"]`).attr(`content`):n(C).text().trim().match(w)[1];let u=O.split(`,`).filter(e=>e!==``);for(let e=0;e<u.length;e++)u[e]=n(u[e].trim()).html();let d=u.join(``);return{link:t,title:c,description:d,pubDate:s(i(a,j),8),author:/本|本网|本站/.test(r)?D:r}})}));return{title:F,link:N,item:R}};export{u as gdgov};
//# sourceMappingURL=general-BpGpkjEt.js.map