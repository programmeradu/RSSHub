import"./esm-shims-Dqvxr0BZ.js";import{config as e}from"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as t}from"./cache-kimkMTWJ.js";import{parseDate as n}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as r}from"./got-CdvI2yKX.js";import{load as i}from"cheerio";const a={name:`Packages`,categories:[`program-update`],maintainers:[`CaoMeiYouRen`],path:`/pkgs/:name/:routeParams?`,parameters:{name:`Packages name`,routeParams:`Filters of packages type. E.g. branch=edge&repo=main&arch=armv7&maintainer=Jakub%20Jirutka`},example:`/alpinelinux/pkgs/nodejs`,description:`Alpine Linux packages update`,handler:s,radar:[{source:[`https://pkgs.alpinelinux.org/packages`],target:(e,t)=>{let n=new URL(t).searchParams,r=n.get(`name`);n.delete(`name`);let i=n.toString();return`/alpinelinux/pkgs/${r}/${i}`}}],zh:{name:`软件包`,description:`Alpine Linux 软件包更新`}};function o(e){let t=i(e),n=t(`tbody tr`).toArray().map(e=>({package:t(e).find(`.package a`).text().trim(),packageUrl:t(e).find(`.package a`).attr(`href`)?.trim(),description:t(e).find(`.package a`).attr(`aria-label`)?.trim(),version:t(e).find(`.version`).text().trim(),project:t(e).find(`.url a`).attr(`href`)?.trim(),license:t(e).find(`.license`).text().trim(),branch:t(e).find(`.branch`).text().trim(),repository:t(e).find(`.repo a`).text().trim(),architecture:t(e).find(`.arch a`).text().trim(),maintainer:t(e).find(`.maintainer a`).text().trim(),buildDate:t(e).find(`.bdate`).text().trim()}));return n}async function s(i){let{name:a,routeParams:s}=i.req.param(),c=new URLSearchParams(s);c.append(`name`,a);let l=`https://pkgs.alpinelinux.org/packages?${c.toString()}`,u=`alpinelinux:packages:${c.toString()}`,d=await t.tryGet(u,async()=>{let e=await r({url:l}),t=e.data;return o(t)},e.cache.routeExpire,!1),f=d.map(e=>({title:`${e.package}@${e.version}/${e.architecture}`,description:`Version: ${e.version}<br>Project: ${e.project}<br>Description: ${e.description}<br>License: ${e.license}<br>Branch: ${e.branch}<br>Repository: ${e.repository}<br>Maintainer: ${e.maintainer}<br>Build Date: ${e.buildDate}`,link:`https://pkgs.alpinelinux.org${e.packageUrl}`,guid:`https://pkgs.alpinelinux.org${e.packageUrl}#${e.version}`,author:e.maintainer,pubDate:n(e.buildDate)}));return{title:`${a} - Alpine Linux packages`,link:l,description:`Alpine Linux packages update`,item:f}}export{a as route};
//# sourceMappingURL=pkgs-CeRD4NBD.js.map