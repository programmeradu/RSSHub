import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import{config as n}from"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as r}from"./cache-kimkMTWJ.js";import{art as i}from"./render-CxhTJIsl.js";import{parseDate as a}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as o}from"./got-CdvI2yKX.js";import s from"node:path";import{load as c}from"cheerio";t();const l={path:`/news/author/:mid`,categories:[`new-media`],example:`/tencent/news/author/5933889`,parameters:{mid:`企鹅号 ID`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{title:`当前作者文章`,source:[`news.qq.com/omn/author/:mid`]}],name:`作者`,maintainers:[`LogicJake`,`miles170`],handler:u};async function u(t){let l=t.req.param(`mid`),u=/^\d+$/.test(l)?`chlid`:`guestSuid`,d=`https://i.news.qq.com/i/getUserHomepageInfo?${u}=${l}`,f=await r.tryGet(d,async()=>(await o(d)).data.userinfo),p=f.nick,m=f.user_desc,h=encodeURIComponent(f.suid),g=`https://i.news.qq.com/getSubNewsMixedList?guestSuid=${h}&tabId=om_index`,_=await r.tryGet(g,async()=>(await o(g)).data.newslist,n.cache.routeExpire,!1),v=await Promise.all(_.map(t=>{let n=t.title,l=a(t.timestamp,`X`),u=t.url,d=t.source,f=t.abstract;return t.articletype===`4`||t.articletype===`118`?{title:n,description:`<a href=${t.url}><img src="${t.articletype===`4`?t.miniProShareImage:t.miniVideoPic}" style="width: 100%"></a>`,link:u,author:d,pubDate:l}:r.tryGet(u,async()=>{let t=await o(u),r=c(t.data),a=JSON.parse(r(`script:contains("window.DATA")`).text().match(/window\.DATA = ({.+});/)[1]),p=c(a.originContent?.text||``,null,!1);return p&&p(`*`).contents().filter((e,t)=>t.type===`comment`).replaceWith((t,n)=>i(s.join(e,`templates/image-82fa7d61.art`),{attribute:n.data.trim(),originAttribute:a.originAttribute})),{title:n,description:p.html()||f,link:u,author:d,pubDate:l}})}));return{title:p,description:m,link:`https://new.qq.com/omn/author/${l}`,item:v,image:f?.shareImg}}export{l as route};
//# sourceMappingURL=author-sTph4QpZ.js.map