{"version":3,"file":"hottoys-C-dbm1t7.js","names":["route: Route","puppeteer"],"sources":["../../lib/routes/hottoys/index.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport { load } from 'cheerio';\r\nimport puppeteer from '@/utils/puppeteer';\r\n\r\nexport const route: Route = {\r\n    path: '/',\r\n    categories: ['shopping'],\r\n    example: '/hottoys',\r\n    radar: [\r\n        {\r\n            source: ['hottoys.com.hk/'],\r\n        },\r\n    ],\r\n    name: 'Toys List',\r\n    maintainers: ['jw0903'],\r\n    handler,\r\n    url: 'hottoys.com.hk/',\r\n    features: {\r\n        requirePuppeteer: true,\r\n    },\r\n};\r\n\r\nasync function handler() {\r\n    const baseUrl = 'https://www.hottoys.com.hk';\r\n\r\n    // 导入 puppeteer 工具类并初始化浏览器实例\r\n    const browser = await puppeteer();\r\n    // 打开一个新标签页\r\n    const page = await browser.newPage();\r\n    // 拦截所有请求\r\n    await page.setRequestInterception(true);\r\n\r\n    page.on('request', (request) => {\r\n        // 在这次例子，我们只允许 HTML 请求\r\n        request.resourceType() === 'document' ? request.continue() : request.abort();\r\n    });\r\n\r\n    await page.goto(baseUrl, {\r\n        waitUntil: 'domcontentloaded',\r\n    });\r\n    const response = await page.content();\r\n    await page.close();\r\n    const $ = load(response);\r\n    const items = $('li.productListItem')\r\n        .toArray()\r\n        .map((item) => {\r\n            const dom = $(item);\r\n            const a = dom.find('a').first();\r\n            const img = dom.find('img').first();\r\n            return {\r\n                title: img.attr('title') ?? 'hottoys',\r\n                link: `${baseUrl}/${a.attr('href')}`,\r\n                description: `<img src=\"${baseUrl}${img.attr('src')}\" />`,\r\n                guid: a.attr('href'),\r\n            };\r\n        });\r\n    await browser.close();\r\n    return {\r\n        title: 'Hot Toys New Products',\r\n        link: baseUrl,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"iLAIA,MAAaA,EAAe,CACxB,KAAM,IACN,WAAY,CAAC,YACb,QAAS,WACT,MAAO,CACH,CACI,OAAQ,CAAC,qBAGjB,KAAM,YACN,YAAa,CAAC,UACd,UACA,IAAK,kBACL,SAAU,CACN,iBAAkB,KAI1B,eAAe,GAAU,CACrB,IAAM,EAAU,6BAGV,EAAU,MAAMC,IAEhB,EAAO,MAAM,EAAQ,UAE3B,MAAM,EAAK,uBAAuB,IAElC,EAAK,GAAG,UAAY,GAAY,CAE5B,EAAQ,iBAAmB,WAAa,EAAQ,WAAa,EAAQ,UAGzE,MAAM,EAAK,KAAK,EAAS,CACrB,UAAW,qBAEf,IAAM,EAAW,MAAM,EAAK,UAC5B,MAAM,EAAK,QACX,IAAM,EAAI,EAAK,GACT,EAAQ,EAAE,sBACX,UACA,IAAK,GAAS,CACX,IAAM,EAAM,EAAE,GACR,EAAI,EAAI,KAAK,KAAK,QAClB,EAAM,EAAI,KAAK,OAAO,QAC5B,MAAO,CACH,MAAO,EAAI,KAAK,UAAY,UAC5B,KAAM,GAAG,EAAQ,GAAG,EAAE,KAAK,UAC3B,YAAa,aAAa,IAAU,EAAI,KAAK,OAAO,MACpD,KAAM,EAAE,KAAK,WAIzB,OADA,MAAM,EAAQ,QACP,CACH,MAAO,wBACP,KAAM,EACN,KAAM"}