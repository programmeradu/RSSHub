import"./esm-shims-Dqvxr0BZ.js";import{config as e}from"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{cache_default as t}from"./cache-kimkMTWJ.js";import{parseDate as n,parseRelativeDate as r}from"./parse-date-Bgabdhlb.js";import{ofetch_default as i}from"./ofetch-Bzt0BXUH.js";import{timezone as a}from"./timezone-BrNu6iXe.js";import{fetchArticle as o}from"./wechat-mp-BwNEdjlr.js";import{load as s}from"cheerio";const c={all:{name:`最新资讯`,link:`https://www.oschina.net/news/project`,ajaxUrl:`https://www.oschina.net/news/widgets/_news_index_all_list?p=1&type=ajax`},industry:{name:`综合资讯`,link:`https://www.oschina.net/news/industry`,ajaxUrl:`https://www.oschina.net/news/widgets/_news_index_generic_list?p=1&type=ajax`},project:{name:`软件更新资讯`,link:`https://www.oschina.net/news/project`,ajaxUrl:`https://www.oschina.net/news/widgets/_news_index_project_list?p=1&type=ajax`},"industry-news":{name:`行业资讯`,link:`https://www.oschina.net/news/industry-news`,ajaxUrl:`https://www.oschina.net/news/widgets/_news_index_industry_list?p=1&type=ajax`},programming:{name:`编程语言资讯`,link:`https://www.oschina.net/news/programming`,ajaxUrl:`https://www.oschina.net/news/widgets/_news_index_programming_language_list?p=1&type=ajax`}},l={path:`/news/:category?`,categories:[`programming`],example:`/oschina/news/project`,parameters:{category:`板块名`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`oschina.net/news/:category`],target:`/news/:category`}],name:`资讯`,maintainers:[`tgly307`,`zengxs`],handler:d,description:`| [综合资讯][osc_gen] | [软件更新资讯][osc_proj] | [行业资讯][osc_ind] | [编程语言资讯][osc_pl] |
| ------------------- | ------------------------ | ------------------- | ---------------------- |
| industry            | project                  | industry-news       | programming            |

  订阅 [全部板块资讯][osc_all] 可以使用 [https://rsshub.app/oschina/news](https://rsshub.app/oschina/news)

  [osc_all]: https://www.oschina.net/news "开源中国 - 全部资讯"

  [osc_gen]: https://www.oschina.net/news/industry "开源中国 - 综合资讯"

  [osc_proj]: https://www.oschina.net/news/project "开源中国 - 软件更新资讯"

  [osc_ind]: https://www.oschina.net/news/industry-news "开源中国 - 行业资讯"

  [osc_pl]: https://www.oschina.net/news/programming "开源中国 - 编程语言资讯"`},u=()=>t.tryGet(`oschina:cookie`,async()=>{let e=await i.raw(`https://www.oschina.net/news`),t=e.headers.getSetCookie().map(e=>e.split(`;`)[0]).join(`; `);return t},e.cache.routeExpire,!1);async function d(e){let l=e.req.param(`category`)??`all`,d=c[l],f=await u(),p=await i(d.ajaxUrl,{headers:{Referer:d.link,"X-Requested-With":`XMLHttpRequest`,Cookie:f}}),m=s(p);m(`.ad-wrap`).remove();let h=m(`.items .news-item`).toArray().map(e=>{e=m(e);let t=e.find(`.extra > .list > .item:nth-of-type(2)`).text();return{title:e.find(`h3 a`).attr(`title`),description:e.find(`.description p`).text(),link:e.find(`h3 a`).attr(`href`),pubDate:a(/\//.test(t)?n(t,[`YYYY/MM/DD HH:mm`,`MM/DD HH:mm`]):r(t),8)}}),g=await Promise.all(h.map(e=>t.tryGet(e.link,async()=>{if(/^https?:\/\/(my|www)\.oschina.net\/.*$/.test(e.link)){let t=await i(e.link,{headers:{Referer:d.link,Cookie:f}}),n=s(t);n(`.ad-wrap`).remove(),e.description=n(`.article-detail`).html(),e.author=n(`.article-box__meta .item`).first().text()}else if(/^https?:\/\/gitee\.com\/.*$/.test(e.link)){let t=await i(e.link,{headers:{Referer:d.link}}),n=s(t);e.description=n(`.file_content`).html()}else if(/^https?:\/\/osc\.cool\/.*$/.test(e.link))return o(e.link,!0);return e})));return{title:`开源中国-${d.name}`,link:d.link,item:g}}export{l as route};
//# sourceMappingURL=news-Q9vBXoZy.js.map