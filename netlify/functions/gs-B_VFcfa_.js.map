{"version":3,"file":"gs-B_VFcfa_.js","names":["got","cache","route: Route"],"sources":["../../lib/routes/hust/gs.ts"],"sourcesContent":["import { Route } from '@/types';\r\n\r\nimport cache from '@/utils/cache';\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\nimport { parseDate } from '@/utils/parse-date';\r\n\r\nexport const handler = async (ctx) => {\r\n    const { category = 'xwdt' } = ctx.req.param();\r\n    const limit = ctx.req.query('limit') ? Number.parseInt(ctx.req.query('limit'), 10) : 16;\r\n\r\n    const rootUrl = 'https://gs.hust.edu.cn';\r\n    const currentUrl = new URL(`${category}.htm`, rootUrl).href;\r\n\r\n    const { data: response } = await got(currentUrl);\r\n\r\n    const $ = load(response);\r\n\r\n    let items = $('div.btlist ul li')\r\n        .slice(0, limit)\r\n        .toArray()\r\n        .map((item) => {\r\n            item = $(item);\r\n\r\n            const a = item.find('a');\r\n            const link = a.prop('href');\r\n\r\n            return {\r\n                title: a.text(),\r\n                pubDate: parseDate(item.find('span.time').text()),\r\n                link: link.startsWith('http') ? link : new URL(link, rootUrl).href,\r\n            };\r\n        });\r\n\r\n    items = await Promise.all(\r\n        items.map((item) =>\r\n            cache.tryGet(item.link, async () => {\r\n                try {\r\n                    const { data: detailResponse } = await got(item.link);\r\n\r\n                    const $$ = load(detailResponse);\r\n\r\n                    const description = $$('div.v_news_content').html();\r\n\r\n                    item.title = $$('div.article_title h1, h5').text();\r\n                    item.description = description;\r\n                    item.content = {\r\n                        html: description,\r\n                        text: $$('div.v_news_content').text(),\r\n                    };\r\n                } catch {\r\n                    // no-empty\r\n                }\r\n\r\n                return item;\r\n            })\r\n        )\r\n    );\r\n\r\n    const title = $('meta[name=\"keywords\"]').prop('content')?.replace(/,/g, ' - ') ?? $('title').text();\r\n    const image = new URL($('div.logo img').prop('src'), rootUrl).href;\r\n\r\n    return {\r\n        title,\r\n        description: title.split(/-/).pop()?.trim(),\r\n        link: currentUrl,\r\n        item: items,\r\n        allowEmpty: true,\r\n        image,\r\n    };\r\n};\r\n\r\nexport const route: Route = {\r\n    path: '/gs/:category{.+}?',\r\n    name: '研究生院',\r\n    url: 'gs.hust.edu.cn',\r\n    maintainers: ['nczitzk'],\r\n    handler,\r\n    example: '/hust/gs/xwdt',\r\n    parameters: { category: '分类，默认为新闻动态，即 `xwdt`，可在对应分类页 URL 中找到' },\r\n    description: `::: tip\r\n  若订阅 [新闻动态](https://gs.hust.edu.cn/xwdt.htm)，网址为 \\`https://gs.hust.edu.cn/xwdt.htm\\`。截取 \\`https://gs.hust.edu.cn/\\` 到末尾 \\`.htm\\` 的部分 \\`xwdt\\` 作为参数填入，此时路由为 [\\`/hust/gs/xwdt\\`](https://rsshub.app/hust/gs/xwdt)。\r\n:::\r\n\r\n| [新闻动态](https://gs.hust.edu.cn/xwdt.htm) | [研究生服务专区](https://gs.hust.edu.cn/yjsfwzq.htm) | [综合管理](https://gs.hust.edu.cn/gzzd/zhgl.htm)  |\r\n| ------------------------------------------- | ---------------------------------------------------- | ------------------------------------------------- |\r\n| [xwdt](https://rsshub.app/hust/gs/xwdt)     | [yjsfwzq](https://rsshub.app/hust/gs/yjsfwzq)        | [gzzd/zhgl](https://rsshub.app/hust/gs/gzzd/zhgl) |\r\n\r\n#### [通知公告](https://gs.hust.edu.cn/tzgg/kcjksap.htm)\r\n\r\n| [课程及考试安排](https://gs.hust.edu.cn/tzgg/kcjksap.htm) | [国际交流](https://gs.hust.edu.cn/tzgg/gjjl.htm)  | [学位工作](https://gs.hust.edu.cn/tzgg/xwgz.htm)  | [同济医学院](https://gs.hust.edu.cn/tzgg/tjyxy.htm) | [其他](https://gs.hust.edu.cn/tzgg/qt.htm)    |\r\n| --------------------------------------------------------- | ------------------------------------------------- | ------------------------------------------------- | --------------------------------------------------- | --------------------------------------------- |\r\n| [tzgg/kcjksap](https://rsshub.app/hust/gs/tzgg/kcjksap)   | [tzgg/gjjl](https://rsshub.app/hust/gs/tzgg/gjjl) | [tzgg/xwgz](https://rsshub.app/hust/gs/tzgg/xwgz) | [tzgg/tjyxy](https://rsshub.app/hust/gs/tzgg/tjyxy) | [tzgg/qt](https://rsshub.app/hust/gs/tzgg/qt) |\r\n\r\n#### [学籍管理](https://gs.hust.edu.cn/pygz/zbjs1/xjyd.htm)\r\n\r\n| [学籍异动](https://gs.hust.edu.cn/pygz/zbjs1/xjyd.htm)        | [毕业管理](https://gs.hust.edu.cn/pygz/zbjs1/bygl.htm)        |\r\n| ------------------------------------------------------------- | ------------------------------------------------------------- |\r\n| [pygz/zbjs1/xjyd](https://rsshub.app/hust/gs/pygz/zbjs1/xjyd) | [pygz/zbjs1/bygl](https://rsshub.app/hust/gs/pygz/zbjs1/bygl) |\r\n\r\n#### [教学管理](https://gs.hust.edu.cn/pygz/zbjs13/jxyj.htm)\r\n\r\n| [教学研究](https://gs.hust.edu.cn/pygz/zbjs13/jxyj.htm)         | [课程教材](https://gs.hust.edu.cn/pygz/zbjs13/kcjc.htm)         | [教学安排](https://gs.hust.edu.cn/pygz/zbjs13/jxap.htm)         | [课表查询](https://gs.hust.edu.cn/pygz/zbjs13/kbcx.htm)         |\r\n| --------------------------------------------------------------- | --------------------------------------------------------------- | --------------------------------------------------------------- | --------------------------------------------------------------- |\r\n| [pygz/zbjs13/jxyj](https://rsshub.app/hust/gs/pygz/zbjs13/jxyj) | [pygz/zbjs13/kcjc](https://rsshub.app/hust/gs/pygz/zbjs13/kcjc) | [pygz/zbjs13/jxap](https://rsshub.app/hust/gs/pygz/zbjs13/jxap) | [pygz/zbjs13/kbcx](https://rsshub.app/hust/gs/pygz/zbjs13/kbcx) |\r\n\r\n#### [培养过程](https://gs.hust.edu.cn/pygz/pygc.htm)\r\n\r\n| [培养方案](https://gs.hust.edu.cn/pygz/pygc/pyfa.htm)       | [硕博连读](https://gs.hust.edu.cn/pygz/pygc/sbld.htm)       |\r\n| ----------------------------------------------------------- | ----------------------------------------------------------- |\r\n| [pygz/pygc/pyfa](https://rsshub.app/hust/gs/pygz/pygc/pyfa) | [pygz/pygc/sbld](https://rsshub.app/hust/gs/pygz/pygc/sbld) |\r\n\r\n#### [国际交流](https://gs.hust.edu.cn/pygz/zbjs11/gjgpxm.htm)\r\n\r\n| [国家公派项目](https://gs.hust.edu.cn/pygz/zbjs11/gjgpxm.htm)       | [国际学术会议](https://gs.hust.edu.cn/pygz/zbjs11/gjxshy.htm)       | [校际合作项目](https://gs.hust.edu.cn/pygz/zbjs11/xjhzxm.htm)       | [国际交流与合作办事流程](https://gs.hust.edu.cn/pygz/zbjs11/gjjlyhzbslc.htm)  |\r\n| ------------------------------------------------------------------- | ------------------------------------------------------------------- | ------------------------------------------------------------------- | ----------------------------------------------------------------------------- |\r\n| [pygz/zbjs11/gjgpxm](https://rsshub.app/hust/gs/pygz/zbjs11/gjgpxm) | [pygz/zbjs11/gjxshy](https://rsshub.app/hust/gs/pygz/zbjs11/gjxshy) | [pygz/zbjs11/xjhzxm](https://rsshub.app/hust/gs/pygz/zbjs11/xjhzxm) | [pygz/zbjs11/gjjlyhzbslc](https://rsshub.app/hust/gs/pygz/zbjs11/gjjlyhzbslc) |\r\n\r\n#### [专业学位](https://gs.hust.edu.cn/pygz/zbjs111/xwsqdml.htm)\r\n\r\n| [学位授权点目录](https://gs.hust.edu.cn/pygz/zbjs111/xwsqdml.htm)       | [专业学位建设](https://gs.hust.edu.cn/pygz/zbjs111/zyxwjs.htm)        | [特色培养](https://gs.hust.edu.cn/pygz/zbjs111/tspy.htm)          |\r\n| ----------------------------------------------------------------------- | --------------------------------------------------------------------- | ----------------------------------------------------------------- |\r\n| [pygz/zbjs111/xwsqdml](https://rsshub.app/hust/gs/pygz/zbjs111/xwsqdml) | [pygz/zbjs111/zyxwjs](https://rsshub.app/hust/gs/pygz/zbjs111/zyxwjs) | [pygz/zbjs111/tspy](https://rsshub.app/hust/gs/pygz/zbjs111/tspy) |\r\n\r\n#### [学位工作](https://gs.hust.edu.cn/xwgz/xwdjs.htm)\r\n\r\n| [学位点建设](https://gs.hust.edu.cn/xwgz/xwdjs.htm) | [学位授予](https://gs.hust.edu.cn/xwgz/xwsy.htm)  | [导师队伍](https://gs.hust.edu.cn/xwgz/dsdw.htm)  |\r\n| --------------------------------------------------- | ------------------------------------------------- | ------------------------------------------------- |\r\n| [xwgz/xwdjs](https://rsshub.app/hust/gs/xwgz/xwdjs) | [xwgz/xwsy](https://rsshub.app/hust/gs/xwgz/xwsy) | [xwgz/dsdw](https://rsshub.app/hust/gs/xwgz/dsdw) |\r\n  `,\r\n    categories: ['university'],\r\n\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportRadar: true,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['gs.hust.edu.cn/:category'],\r\n            target: (params) => {\r\n                const category = params.category;\r\n\r\n                return `/hust/gs${category ? `/${category}` : ''}`;\r\n            },\r\n        },\r\n        {\r\n            title: '新闻动态',\r\n            source: ['gs.hust.edu.cn/xwdt.htm'],\r\n            target: '/gs/xwdt',\r\n        },\r\n        {\r\n            title: '研究生服务专区',\r\n            source: ['gs.hust.edu.cn/yjsfwzq.htm'],\r\n            target: '/gs/yjsfwzq',\r\n        },\r\n        {\r\n            title: '综合管理',\r\n            source: ['gs.hust.edu.cn/gzzd/zhgl.htm'],\r\n            target: '/gs/gzzd/zhgl',\r\n        },\r\n        {\r\n            title: '通知公告 - 课程及考试安排',\r\n            source: ['gs.hust.edu.cn/tzgg/kcjksap.htm'],\r\n            target: '/gs/tzgg/kcjksap',\r\n        },\r\n        {\r\n            title: '通知公告 - 国际交流',\r\n            source: ['gs.hust.edu.cn/tzgg/gjjl.htm'],\r\n            target: '/gs/tzgg/gjjl',\r\n        },\r\n        {\r\n            title: '通知公告 - 学位工作',\r\n            source: ['gs.hust.edu.cn/tzgg/xwgz.htm'],\r\n            target: '/gs/tzgg/xwgz',\r\n        },\r\n        {\r\n            title: '通知公告 - 同济医学院',\r\n            source: ['gs.hust.edu.cn/tzgg/tjyxy.htm'],\r\n            target: '/gs/tzgg/tjyxy',\r\n        },\r\n        {\r\n            title: '通知公告 - 其他',\r\n            source: ['gs.hust.edu.cn/tzgg/qt.htm'],\r\n            target: '/gs/tzgg/qt',\r\n        },\r\n        {\r\n            title: '学籍管理 - 学籍异动',\r\n            source: ['gs.hust.edu.cn/pygz/zbjs1/xjyd.htm'],\r\n            target: '/gs/pygz/zbjs1/xjyd',\r\n        },\r\n        {\r\n            title: '学籍管理 - 毕业管理',\r\n            source: ['gs.hust.edu.cn/pygz/zbjs1/bygl.htm'],\r\n            target: '/gs/pygz/zbjs1/bygl',\r\n        },\r\n        {\r\n            title: '教学管理 - 教学研究',\r\n            source: ['gs.hust.edu.cn/pygz/zbjs13/jxyj.htm'],\r\n            target: '/gs/pygz/zbjs13/jxyj',\r\n        },\r\n        {\r\n            title: '教学管理 - 课程教材',\r\n            source: ['gs.hust.edu.cn/pygz/zbjs13/kcjc.htm'],\r\n            target: '/gs/pygz/zbjs13/kcjc',\r\n        },\r\n        {\r\n            title: '教学管理 - 教学安排',\r\n            source: ['gs.hust.edu.cn/pygz/zbjs13/jxap.htm'],\r\n            target: '/gs/pygz/zbjs13/jxap',\r\n        },\r\n        {\r\n            title: '教学管理 - 课表查询',\r\n            source: ['gs.hust.edu.cn/pygz/zbjs13/kbcx.htm'],\r\n            target: '/gs/pygz/zbjs13/kbcx',\r\n        },\r\n        {\r\n            title: '培养过程 - 培养方案',\r\n            source: ['gs.hust.edu.cn/pygz/pygc/pyfa.htm'],\r\n            target: '/gs/pygz/pygc/pyfa',\r\n        },\r\n        {\r\n            title: '培养过程 - 硕博连读',\r\n            source: ['gs.hust.edu.cn/pygz/pygc/sbld.htm'],\r\n            target: '/gs/pygz/pygc/sbld',\r\n        },\r\n        {\r\n            title: '国际交流 - 国家公派项目',\r\n            source: ['gs.hust.edu.cn/pygz/zbjs11/gjgpxm.htm'],\r\n            target: '/gs/pygz/zbjs11/gjgpxm',\r\n        },\r\n        {\r\n            title: '国际交流 - 国际学术会议',\r\n            source: ['gs.hust.edu.cn/pygz/zbjs11/gjxshy.htm'],\r\n            target: '/gs/pygz/zbjs11/gjxshy',\r\n        },\r\n        {\r\n            title: '国际交流 - 校际合作项目',\r\n            source: ['gs.hust.edu.cn/pygz/zbjs11/xjhzxm.htm'],\r\n            target: '/gs/pygz/zbjs11/xjhzxm',\r\n        },\r\n        {\r\n            title: '国际交流 - 国际交流与合作办事流程',\r\n            source: ['gs.hust.edu.cn/pygz/zbjs11/gjjlyhzbslc.htm'],\r\n            target: '/gs/pygz/zbjs11/gjjlyhzbslc',\r\n        },\r\n        {\r\n            title: '专业学位 - 学位授权点目录',\r\n            source: ['gs.hust.edu.cn/pygz/zbjs111/xwsqdml.htm'],\r\n            target: '/gs/pygz/zbjs111/xwsqdml',\r\n        },\r\n        {\r\n            title: '专业学位 - 专业学位建设',\r\n            source: ['gs.hust.edu.cn/pygz/zbjs111/zyxwjs.htm'],\r\n            target: '/gs/pygz/zbjs111/zyxwjs',\r\n        },\r\n        {\r\n            title: '专业学位 - 特色培养',\r\n            source: ['gs.hust.edu.cn/pygz/zbjs111/tspy.htm'],\r\n            target: '/gs/pygz/zbjs111/tspy',\r\n        },\r\n        {\r\n            title: '学位工作 - 学位点建设',\r\n            source: ['gs.hust.edu.cn/xwgz/xwdjs.htm'],\r\n            target: '/gs/xwgz/xwdjs',\r\n        },\r\n        {\r\n            title: '学位工作 - 学位授予',\r\n            source: ['gs.hust.edu.cn/xwgz/xwsy.htm'],\r\n            target: '/gs/xwgz/xwsy',\r\n        },\r\n        {\r\n            title: '学位工作 - 导师队伍',\r\n            source: ['gs.hust.edu.cn/xwgz/dsdw.htm'],\r\n            target: '/gs/xwgz/dsdw',\r\n        },\r\n    ],\r\n};\r\n"],"mappings":"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"}