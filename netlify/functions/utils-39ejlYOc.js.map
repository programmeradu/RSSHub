{"version":3,"file":"utils-39ejlYOc.js","names":[],"sources":["../../lib/routes/zhihu/pin/utils.ts"],"sourcesContent":["import { parseDate } from '@/utils/parse-date';\r\n\r\nconst generateDescription = (target, description = '') => {\r\n    for (const item of target.content) {\r\n        switch (item.type) {\r\n            case 'text':\r\n                description += `<div>${item.content}</div>`;\r\n                break;\r\n\r\n            case 'image':\r\n                description += `<img src=\"${item.url.replaceAll(/_.+\\.jpg/g, '.jpg')}\" />`;\r\n                break;\r\n\r\n            case 'video':\r\n                try {\r\n                    description += `<video\r\n            controls=\"controls\"\r\n            width=\"${item.playlist.hd.width}\"\r\n            height=\"${item.playlist.hd.height}\"\r\n            poster=\"${item.cover_info.thumbnail}\"\r\n            src=\"${item.playlist.hd.play_url}\"\r\n          >`;\r\n                } catch {\r\n                    description += `<video\r\n                controls=\"controls\"\r\n                width=\"${item.playlist.pop().width}\"\r\n                height=\"${item.playlist.pop().height}\"\r\n                poster=\"${item.thumbnail}\"\r\n                src=\"${item.playlist.pop().play_url}\"\r\n              >`;\r\n                }\r\n                break;\r\n\r\n            case 'link':\r\n                description += `<div><a href=\"${item.url}\">${item.title}</a><br><img src=\"${item.image_url}\" /></div>`;\r\n                break;\r\n\r\n            default:\r\n                description += '未知类型，请点击<a href=\"https://github.com/DIYgod/RSSHub/issues\">链接</a>提交issue';\r\n        }\r\n    }\r\n    return description;\r\n};\r\n\r\nconst generateData = (data) =>\r\n    data.map((item) => {\r\n        const target = item.target ?? item;\r\n        const pubDate = parseDate(target.created * 1000);\r\n        const author = target.author.name;\r\n        const title = `${author}：${target.excerpt_title}`;\r\n        const link = `https://www.zhihu.com/pin/${target.id}`;\r\n        let description = generateDescription(target, `<a href=\"https://www.zhihu.com${target.author.url}\">${author}</a>：`);\r\n        if (target.origin_pin !== undefined) {\r\n            const t = target.origin_pin;\r\n            const origin_link = `<a href=\"https://www.zhihu.com/pin/${t.id}\">转发原文</a>：`;\r\n            const origin_description = generateDescription(t, `<a href=\"https://www.zhihu.com${t.author.url}\">${t.author.name}</a>：`);\r\n            description = `${description} ${origin_link} ${origin_description}`;\r\n        }\r\n        return {\r\n            title,\r\n            description,\r\n            author,\r\n            pubDate,\r\n            link,\r\n        };\r\n    });\r\n\r\nexport { generateData };\r\n"],"mappings":"qDAEA,MAAM,GAAuB,EAAQ,EAAc,KAAO,CACtD,IAAK,IAAM,KAAQ,EAAO,QACtB,OAAQ,EAAK,KAAb,CACI,IAAK,OACD,GAAe,QAAQ,EAAK,QAAQ,QACpC,MAEJ,IAAK,QACD,GAAe,aAAa,EAAK,IAAI,WAAW,YAAa,QAAQ,MACrE,MAEJ,IAAK,QACD,GAAI,CACA,GAAe;;qBAEd,EAAK,SAAS,GAAG,MAAM;sBACtB,EAAK,SAAS,GAAG,OAAO;sBACxB,EAAK,WAAW,UAAU;mBAC7B,EAAK,SAAS,GAAG,SAAS;kBAErB,CACJ,GAAe;;yBAEV,EAAK,SAAS,MAAM,MAAM;0BACzB,EAAK,SAAS,MAAM,OAAO;0BAC3B,EAAK,UAAU;uBAClB,EAAK,SAAS,MAAM,SAAS;iBAGpC,MAEJ,IAAK,OACD,GAAe,iBAAiB,EAAK,IAAI,IAAI,EAAK,MAAM,oBAAoB,EAAK,UAAU,YAC3F,MAEJ,QACI,GAAe,0EAG3B,OAAO,GAGL,EAAgB,GAClB,EAAK,IAAK,GAAS,CACf,IAAM,EAAS,EAAK,QAAU,EACxB,EAAU,EAAU,EAAO,QAAU,KACrC,EAAS,EAAO,OAAO,KACvB,EAAQ,GAAG,EAAO,GAAG,EAAO,gBAC5B,EAAO,6BAA6B,EAAO,KAC7C,EAAc,EAAoB,EAAQ,iCAAiC,EAAO,OAAO,IAAI,IAAI,EAAO,QAC5G,GAAI,EAAO,aAAe,IAAA,GAAW,CACjC,IAAM,EAAI,EAAO,WACX,EAAc,sCAAsC,EAAE,GAAG,aACzD,EAAqB,EAAoB,EAAG,iCAAiC,EAAE,OAAO,IAAI,IAAI,EAAE,OAAO,KAAK,QAClH,EAAc,GAAG,EAAY,GAAG,EAAY,GAAG,IAEnD,MAAO,CACH,QACA,cACA,SACA,UACA"}