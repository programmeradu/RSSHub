import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{art as n}from"./render-CxhTJIsl.js";import{parseDate as r}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as i}from"./got-CdvI2yKX.js";import{timezone as a}from"./timezone-BrNu6iXe.js";import o from"node:path";import{load as s}from"cheerio";import c from"iconv-lite";t();const l={path:`/tieba/search/:qw/:routeParams?`,categories:[`bbs`],example:`/baidu/tieba/search/neuro`,parameters:{qw:`搜索关键词`,routeParams:`额外参数；请参阅以下说明和表格`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`贴吧搜索`,maintainers:[`JimenezLi`],handler:u,description:`| 键           | 含义                                                       | 接受的值      | 默认值 |
| ------------ | ---------------------------------------------------------- | ------------- | ------ |
| kw           | 在名为 kw 的贴吧中搜索                                     | 任意名称 / 无 | 无     |
| only_thread  | 只看主题帖，默认为 0 关闭                                  | 0/1           | 0      |
| rn           | 返回条目的数量                                             | 1-20          | 20     |
| sm           | 排序方式，0 为按时间顺序，1 为按时间倒序，2 为按相关性顺序 | 0/1/2         | 1      |

  用例：\`/baidu/tieba/search/neuro/kw=neurosama&only_thread=1&sm=2\``};async function u(t){let l=t.req.param(`qw`),u=new URLSearchParams(t.req.param(`routeParams`));u.set(`ie`,`utf-8`),u.set(`qw`,l),u.set(`rn`,u.get(`rn`)||`20`);let d=`https://tieba.baidu.com/f/search/res?${u.toString()}`,f=await i.get(d,{headers:{Referer:`https://tieba.baidu.com`},responseType:`buffer`}),p=c.decode(f.data,`gbk`),m=s(p),h=m(`div.s_post`);return{title:`${l} - ${u.get(`kw`)||`百度贴`}吧搜索`,link:d,item:h.toArray().map(t=>{let i=m(t),s=i.find(`.p_title a`),c=s.text().trim(),l=s.attr(`href`),u=i.find(`.p_date`).text().trim(),d=i.find(`.p_content`).text().trim(),f=i.find(`.p_mediaCont img`).toArray().map(e=>{let t=m(e);return`<img src="${t.attr(`original`)}">`}).join(``),p=i.find(`a.p_forum`).text().trim(),h=i.find(`a`).last().text().trim();return{title:c,description:n(o.join(e,`templates/tieba_search-c24d60a1.art`),{details:d,medias:f,tieba:p,author:h}),author:h,pubDate:a(r(u,`YYYY-MM-DD HH:mm`),8),link:l}})}}export{l as route};
//# sourceMappingURL=search-C0q4ctxN.js.map