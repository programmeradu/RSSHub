{"version":3,"file":"category-BHTWUCV-.js","names":["ofetch","InvalidParameterError","route: Route"],"sources":["../../lib/routes/tfc-taiwan/category.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport ofetch from '@/utils/ofetch';\r\nimport { baseUrl, parsePost, parseItem } from './utils';\r\nimport InvalidParameterError from '@/errors/types/invalid-parameter';\r\n\r\nconst handler = async (ctx) => {\r\n    const { category } = ctx.req.param();\r\n    const limit = ctx.req.query('limit') ? Number.parseInt(ctx.req.query('limit'), 10) : undefined;\r\n    const isNumericCategory = !Number.isNaN(Number.parseInt(category, 10));\r\n\r\n    const categoryResponse = await ofetch(`${baseUrl}/wp-json/wp/v2/categories${isNumericCategory ? `/${category}` : ''}`, {\r\n        query: {\r\n            slug: isNumericCategory ? undefined : category,\r\n        },\r\n    });\r\n\r\n    if (Array.isArray(categoryResponse) && !categoryResponse.length) {\r\n        throw new InvalidParameterError(`Category \"${category}\" not found`);\r\n    }\r\n    const categoryInfo = isNumericCategory ? categoryResponse : categoryResponse[0];\r\n    if (!categoryInfo.id) {\r\n        throw new InvalidParameterError(`Category \"${category}\" not found`);\r\n    }\r\n\r\n    const postsResponse = await parsePost(limit, categoryInfo.id);\r\n    const items = parseItem(postsResponse);\r\n\r\n    return {\r\n        title: categoryInfo.yoast_head_json.title,\r\n        description: categoryInfo.yoast_head_json.og_site_name,\r\n        image: categoryInfo.yoast_head_json.og_image[0].url,\r\n        logo: categoryInfo.yoast_head_json.og_image[0].url,\r\n        icon: categoryInfo.yoast_head_json.og_image[0].url,\r\n        link: categoryInfo.link,\r\n        lang: 'zh-TW',\r\n        item: items,\r\n    };\r\n};\r\n\r\nexport const route: Route = {\r\n    name: '分類',\r\n    maintainers: ['TonyRL'],\r\n    example: '/tfc-taiwan/category/weekly-top-ten-rumors',\r\n    path: '/category/:category',\r\n    parameters: {\r\n        category: '分類，見下表，預設為 `weekly-top-ten-rumors`',\r\n    },\r\n    handler,\r\n    url: 'tfc-taiwan.org.tw/category/rumor-mill/',\r\n    description: `| 謠言風向球 | 議題觀察室        | TOP10                 | 名家專欄       | 國際視野             |\r\n| ---------- | ----------------- | --------------------- | -------------- | -------------------- |\r\n| rumor-mill | issue-observatory | weekly-top-ten-rumors | expert-columns | research-and-updates |`,\r\n};\r\n"],"mappings":"gYAKA,MAAM,EAAU,KAAO,IAAQ,CAC3B,GAAM,CAAE,YAAa,EAAI,IAAI,QACvB,EAAQ,EAAI,IAAI,MAAM,SAAW,OAAO,SAAS,EAAI,IAAI,MAAM,SAAU,IAAM,IAAA,GAC/E,EAAoB,CAAC,OAAO,MAAM,OAAO,SAAS,EAAU,KAE5D,EAAmB,MAAMA,EAAO,GAAG,EAAQ,2BAA2B,EAAoB,IAAI,IAAa,KAAM,CACnH,MAAO,CACH,KAAM,EAAoB,IAAA,GAAY,KAI9C,GAAI,MAAM,QAAQ,IAAqB,CAAC,EAAiB,OACrD,MAAM,IAAIC,EAAsB,aAAa,EAAS,cAE1D,IAAM,EAAe,EAAoB,EAAmB,EAAiB,GAC7E,GAAI,CAAC,EAAa,GACd,MAAM,IAAIA,EAAsB,aAAa,EAAS,cAG1D,IAAM,EAAgB,MAAM,EAAU,EAAO,EAAa,IACpD,EAAQ,EAAU,GAExB,MAAO,CACH,MAAO,EAAa,gBAAgB,MACpC,YAAa,EAAa,gBAAgB,aAC1C,MAAO,EAAa,gBAAgB,SAAS,GAAG,IAChD,KAAM,EAAa,gBAAgB,SAAS,GAAG,IAC/C,KAAM,EAAa,gBAAgB,SAAS,GAAG,IAC/C,KAAM,EAAa,KACnB,KAAM,QACN,KAAM,IAIDC,EAAe,CACxB,KAAM,KACN,YAAa,CAAC,UACd,QAAS,6CACT,KAAM,sBACN,WAAY,CACR,SAAU,sCAEd,UACA,IAAK,yCACL,YAAa"}