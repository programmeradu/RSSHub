{"version":3,"file":"cse-BQBz9UDj.js","names":["route: Route","got"],"sources":["../../lib/routes/sysu/cse.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\n\r\nexport const route: Route = {\r\n    path: '/cse',\r\n    categories: ['university'],\r\n    example: '/sysu/cse',\r\n    parameters: {},\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: true,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['cse.sysu.edu.cn/'],\r\n        },\r\n    ],\r\n    name: '数据科学与计算机学院动态',\r\n    maintainers: [],\r\n    handler,\r\n    url: 'cse.sysu.edu.cn/',\r\n};\r\n\r\nasync function handler() {\r\n    const response = await got({\r\n        method: 'get',\r\n        url: 'http://cse.sysu.edu.cn/',\r\n        headers: {\r\n            Referer: `http://cse.sysu.edu.cn/`,\r\n        },\r\n    });\r\n    const $ = load(response.data);\r\n\r\n    // 首页有多个板块，每个板块的css选择器不同，而且每个板块的信息分类也不一样\r\n    const block_index = [\r\n        {\r\n            index: 1,\r\n            description_header: '学院新闻',\r\n        },\r\n        {\r\n            index: 2,\r\n            description_header: '学院通知',\r\n        },\r\n        {\r\n            index: 3,\r\n            description_header: '人才招聘',\r\n        },\r\n        {\r\n            index: 4,\r\n            description_header: '学术活动',\r\n        },\r\n        {\r\n            index: 5,\r\n            description_header: '学工通知',\r\n        },\r\n        {\r\n            index: 6,\r\n            description_header: '学生活动',\r\n        },\r\n        {\r\n            index: 7,\r\n            description_header: '教务通知',\r\n        },\r\n        {\r\n            index: 8,\r\n            description_header: '科研通知',\r\n        },\r\n        {\r\n            index: 9,\r\n            description_header: '人事通知',\r\n        },\r\n        {\r\n            index: 10,\r\n            description_header: '党群工作',\r\n        },\r\n        {\r\n            index: 11,\r\n            description_header: '校友工作',\r\n        },\r\n        {\r\n            index: 12,\r\n            description_header: '社会工作',\r\n        },\r\n    ];\r\n\r\n    function getDetail(item, description_header) {\r\n        return {\r\n            title: description_header + ': ' + item.attribs.title,\r\n            description: description_header + ': ' + item.attribs.title,\r\n            link: item.attribs.href,\r\n            category: description_header,\r\n        };\r\n    }\r\n\r\n    const item_data = [];\r\n    for (const element of block_index) {\r\n        const block_news = $('#block-views-homepage-block-' + element.index + '> div > div.view-content > div > ul > li > a');\r\n        for (const block_new of block_news) {\r\n            item_data.push(getDetail(block_new, element.description_header));\r\n        }\r\n    }\r\n\r\n    function compareLink(a, b) {\r\n        let a_str = a.link;\r\n        a_str = a_str.slice(-4, a_str.length - 4 + 4);\r\n        const a_int = Number.parseInt(a_str);\r\n        let b_str = b.link;\r\n        b_str = b_str.slice(-4, b_str.length - 4 + 4);\r\n        const b_int = Number.parseInt(b_str);\r\n        return b_int - a_int;\r\n    }\r\n    // 使得新的通知排在前面，假设通知的发布和链接地址是相关的，而且链接地址都是\"/content/4961\"这样，只有四位数的。\r\n    item_data.sort(compareLink);\r\n    // console.log(item_data);\r\n\r\n    return {\r\n        title: `中山大学 - 数据科学与计算机学院`,\r\n        link: `http://cse.sysu.edu.cn`,\r\n        description: `中山大学 - 数据科学与计算机学院`,\r\n        language: `zh-cn`,\r\n        item: item_data,\r\n    };\r\n}\r\n"],"mappings":"+PAIA,MAAaA,EAAe,CACxB,KAAM,OACN,WAAY,CAAC,cACb,QAAS,YACT,WAAY,GACZ,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,sBAGjB,KAAM,eACN,YAAa,GACb,UACA,IAAK,oBAGT,eAAe,GAAU,CACrB,IAAM,EAAW,MAAMC,EAAI,CACvB,OAAQ,MACR,IAAK,0BACL,QAAS,CACL,QAAS,6BAGX,EAAI,EAAK,EAAS,MAGlB,EAAc,CAChB,CACI,MAAO,EACP,mBAAoB,QAExB,CACI,MAAO,EACP,mBAAoB,QAExB,CACI,MAAO,EACP,mBAAoB,QAExB,CACI,MAAO,EACP,mBAAoB,QAExB,CACI,MAAO,EACP,mBAAoB,QAExB,CACI,MAAO,EACP,mBAAoB,QAExB,CACI,MAAO,EACP,mBAAoB,QAExB,CACI,MAAO,EACP,mBAAoB,QAExB,CACI,MAAO,EACP,mBAAoB,QAExB,CACI,MAAO,GACP,mBAAoB,QAExB,CACI,MAAO,GACP,mBAAoB,QAExB,CACI,MAAO,GACP,mBAAoB,SAI5B,SAAS,EAAU,EAAM,EAAoB,CACzC,MAAO,CACH,MAAO,EAAqB,KAAO,EAAK,QAAQ,MAChD,YAAa,EAAqB,KAAO,EAAK,QAAQ,MACtD,KAAM,EAAK,QAAQ,KACnB,SAAU,GAIlB,IAAM,EAAY,GAClB,IAAK,IAAM,KAAW,EAAa,CAC/B,IAAM,EAAa,EAAE,+BAAiC,EAAQ,MAAQ,gDACtE,IAAK,IAAM,KAAa,EACpB,EAAU,KAAK,EAAU,EAAW,EAAQ,qBAIpD,SAAS,EAAY,EAAG,EAAG,CACvB,IAAI,EAAQ,EAAE,KACd,EAAQ,EAAM,MAAM,GAAI,EAAM,OAAS,EAAI,GAC3C,IAAM,EAAQ,OAAO,SAAS,GAC1B,EAAQ,EAAE,KACd,EAAQ,EAAM,MAAM,GAAI,EAAM,OAAS,EAAI,GAC3C,IAAM,EAAQ,OAAO,SAAS,GAC9B,OAAO,EAAQ,EAMnB,OAHA,EAAU,KAAK,GAGR,CACH,MAAO,oBACP,KAAM,yBACN,YAAa,oBACb,SAAU,QACV,KAAM"}