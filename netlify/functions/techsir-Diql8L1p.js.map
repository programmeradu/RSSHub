{"version":3,"file":"techsir-Diql8L1p.js","names":["route: Route","got","cache","response","$"],"sources":["../../lib/routes/techsir/index.ts"],"sourcesContent":["import { Route } from '@/types';\r\n\r\nimport cache from '@/utils/cache';\r\nimport got from '@/utils/got';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport { load } from 'cheerio';\r\n\r\nexport const route: Route = {\r\n    path: '/',\r\n    categories: ['new-media'],\r\n    example: '/techsir',\r\n    url: 'www.techsir.com',\r\n    name: '最新资讯',\r\n    maintainers: ['p3psi-boo'],\r\n    handler,\r\n};\r\n\r\nasync function handler() {\r\n    const baseUrl = 'https://techsir.com';\r\n\r\n    const response = await got({\r\n        method: 'get',\r\n        url: baseUrl,\r\n    });\r\n\r\n    const $ = load(response.data);\r\n\r\n    const alist = $(\r\n        '#kt_wrapper > div.main-content-area > div.container.container-fluid > div:nth-child(1) > div.col-xs-12.col-sm-6.col-md-8.post-listing > div.row.flex-row-fluid > div:nth-child(2) > div > div > div.card-body.pt-2 > div.d-flex'\r\n    );\r\n\r\n    const list = alist.toArray().map((item) => {\r\n        const $item = $(item);\r\n\r\n        const path = $item.find('a').attr('href');\r\n        const link = `${baseUrl}${path}`;\r\n        const title = $item.find('a').text();\r\n\r\n        return {\r\n            title,\r\n            link,\r\n        };\r\n    });\r\n\r\n    const items = await Promise.all(\r\n        list.map((item) =>\r\n            cache.tryGet(item.link, async () => {\r\n                const response = await got({\r\n                    method: 'get',\r\n                    url: item.link,\r\n                });\r\n\r\n                const $ = load(response.data);\r\n                item.description = $('.kg-card-markdown').html();\r\n                item.pubDate = parseDate($('time.time').text());\r\n                item.author = $('a.author').text();\r\n                return item;\r\n            })\r\n        )\r\n    );\r\n\r\n    return {\r\n        title: 'TechSir - 最新资讯',\r\n        link: baseUrl,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"wWAOA,MAAaA,EAAe,CACxB,KAAM,IACN,WAAY,CAAC,aACb,QAAS,WACT,IAAK,kBACL,KAAM,OACN,YAAa,CAAC,aACd,WAGJ,eAAe,GAAU,CACrB,IAAM,EAAU,sBAEV,EAAW,MAAMC,EAAI,CACvB,OAAQ,MACR,IAAK,IAGH,EAAI,EAAK,EAAS,MAElB,EAAQ,EACV,mOAGE,EAAO,EAAM,UAAU,IAAK,GAAS,CACvC,IAAM,EAAQ,EAAE,GAEV,EAAO,EAAM,KAAK,KAAK,KAAK,QAC5B,EAAO,GAAG,IAAU,IACpB,EAAQ,EAAM,KAAK,KAAK,OAE9B,MAAO,CACH,QACA,UAIF,EAAQ,MAAM,QAAQ,IACxB,EAAK,IAAK,GACNC,EAAM,OAAO,EAAK,KAAM,SAAY,CAChC,IAAMC,EAAW,MAAMF,EAAI,CACvB,OAAQ,MACR,IAAK,EAAK,OAGRG,EAAI,EAAKD,EAAS,MAIxB,MAHA,GAAK,YAAcC,EAAE,qBAAqB,OAC1C,EAAK,QAAU,EAAUA,EAAE,aAAa,QACxC,EAAK,OAASA,EAAE,YAAY,OACrB,MAKnB,MAAO,CACH,MAAO,iBACP,KAAM,EACN,KAAM"}