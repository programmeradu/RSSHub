{"version":3,"file":"ratings-CBfMASUt.js","names":["route: Route","got"],"sources":["../../lib/routes/spglobal/ratings.ts"],"sourcesContent":["import { Route, ViewType } from '@/types';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport got from '@/utils/got';\r\n\r\nexport const route: Route = {\r\n    path: '/ratings/:language?',\r\n    categories: ['finance'],\r\n    view: ViewType.Notifications,\r\n    example: '/spglobal/ratings/en',\r\n    parameters: {\r\n        language: {\r\n            description: '语言',\r\n            options: [\r\n                { value: 'zh', label: '中文' },\r\n                { value: 'en', label: 'English' },\r\n                { value: 'es', label: 'Español' },\r\n                { value: 'pt', label: 'Português' },\r\n                { value: 'jp', label: '日本語' },\r\n                { value: 'ru', label: 'Русский' },\r\n                { value: 'ar', label: 'العربية' },\r\n            ],\r\n        },\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['www.spglobal.com/ratings/:language'],\r\n        },\r\n    ],\r\n    name: 'Ratings',\r\n    description: `\r\n| language | Description |\r\n| ---   | ---   |\r\n| zh | 中文 |\r\n| en | English |\r\n| es | Español |\r\n| pt | Português |\r\n| jp | 日本語 |\r\n| ru | Русский |\r\n| ar | العربية |\r\n    `,\r\n    maintainers: ['Cedaric'],\r\n    handler,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const language = ctx.req.param('language');\r\n\r\n    const responseData = await got(\r\n        `https://www.spglobal.com/crownpeaksearchproxy.aspx?q=https%3A%2F%2Fsearchg2-restricted.crownpeak.net%2Fsandpglobal-spglobal-live%2Fselect%3Fq%3D*%253A*%26echoParams%3Dexplicit%26fl%3Dtitle%2Ccustom_i_article_id%2Ccustom_ss_theme%2Ccustom_ss_theme_full%2Ccustom_dt_meta_publish_date%2Ccustom_s_meta_location%20%2Ccustom_s_local_url%2Ccustom_s_tile_image%2Ccustom_s_cshtml_path%2Ccustom_s_sub_type%2Ccustom_s_meta_type%2Cscore%2Ccustom_s_division%2Ccustom_ss_contenttype%2Ccustom_ss_location%2Ccustom_ss_region%2Ccustom_ss_theme%2Ccustom_ss_author_thumbnails%2Ccustom_ss_authors%2Ccustom_ss_author_titles%2Ccustom_s_meta_videoid%2Ctaxonomy_tag_freeform%2Ccustom_ss_tags%2Ccustom_ss_freeform%26defType%3Dedismax%26wt%3Djson%26start%3D0%26rows%3D10%26fq%3Dcustom_s_type%3Aarticle%26fq%3Dcustom_s_sub_type%3A(%22blog%22%2C%20%22news%22%2C%20%22research%22%2C%20%22podcast%22%2C%20%22video%22%2C%20%22article%22%2C%20%22pdf%20details%22)%26fq%3Dcustom_s_division%3A%22Ratings%22%26fq%3Dcustom_s_region%3A%22${language}%22%26facet%3Dtrue%26facet.mincount%3D1%26facet.field%3Dcustom_ss_theme_full%26facet.limit%3D15%26sort%3Dcustom_dt_meta_publish_date%20desc%26f.custom_ss_theme_full.facet.sort%3Dindex`\r\n    );\r\n\r\n    const items = responseData?.data?.response?.docs || [];\r\n\r\n    return {\r\n        title: `S&P Global Ratings(${language})`,\r\n        link: `https://www.spglobal.com/ratings/${language}/`,\r\n        allowEmpty: true,\r\n        item: items.map((x) => ({\r\n            title: x.title,\r\n            pubDate: parseDate(x.custom_dt_meta_publish_date),\r\n            link: `https://www.spglobal.com${x.custom_s_local_url}`,\r\n        })),\r\n    };\r\n}\r\n"],"mappings":"oUAIA,MAAaA,EAAe,CACxB,KAAM,sBACN,WAAY,CAAC,WACb,KAAM,EAAS,cACf,QAAS,uBACT,WAAY,CACR,SAAU,CACN,YAAa,KACb,QAAS,CACL,CAAE,MAAO,KAAM,MAAO,MACtB,CAAE,MAAO,KAAM,MAAO,WACtB,CAAE,MAAO,KAAM,MAAO,WACtB,CAAE,MAAO,KAAM,MAAO,aACtB,CAAE,MAAO,KAAM,MAAO,OACtB,CAAE,MAAO,KAAM,MAAO,WACtB,CAAE,MAAO,KAAM,MAAO,cAIlC,MAAO,CACH,CACI,OAAQ,CAAC,wCAGjB,KAAM,UACN,YAAa;;;;;;;;;;MAWb,YAAa,CAAC,WACd,WAGJ,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAW,EAAI,IAAI,MAAM,YAEzB,EAAe,MAAMC,EACvB,4+BAA4+B,EAAS,0LAGn/B,EAAQ,GAAc,MAAM,UAAU,MAAQ,GAEpD,MAAO,CACH,MAAO,sBAAsB,EAAS,GACtC,KAAM,oCAAoC,EAAS,GACnD,WAAY,GACZ,KAAM,EAAM,IAAK,IAAO,CACpB,MAAO,EAAE,MACT,QAAS,EAAU,EAAE,6BACrB,KAAM,2BAA2B,EAAE"}