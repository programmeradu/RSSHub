{"version":3,"file":"usenix-C5YcpkR8.js","names":["route: Route","url","ofetch","cache"],"sources":["../../lib/routes/usenix/usenix.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport cache from '@/utils/cache';\r\nimport ofetch from '@/utils/ofetch';\r\nimport { load } from 'cheerio';\r\nconst url = 'https://www.usenix.org';\r\nimport { parseDate } from '@/utils/parse-date';\r\n\r\nconst seasons = ['spring', 'summer', 'fall', 'winter'];\r\n\r\nexport const route: Route = {\r\n    path: '/usenix-security-sympoium',\r\n    categories: ['journal'],\r\n    example: '/usenix/usenix-security-sympoium',\r\n    radar: [\r\n        {\r\n            source: ['usenix.org/conferences/all', 'usenix.org/conferences', 'usenix.org/'],\r\n        },\r\n    ],\r\n    name: 'Security Symposia',\r\n    maintainers: ['ZeddYu'],\r\n    handler,\r\n    url: 'usenix.org/conferences/all',\r\n    description: `Return results from 2020`,\r\n};\r\n\r\nasync function handler() {\r\n    const last = new Date().getFullYear() + 1;\r\n    const urlList = Array.from({ length: last - 2020 }, (_, v) => `${url}/conference/usenixsecurity${v + 20}`).flatMap((url) => seasons.map((season) => `${url}/${season}-accepted-papers`));\r\n    const responses = await Promise.allSettled(\r\n        urlList.map(async (url) => {\r\n            let res;\r\n            try {\r\n                res = await ofetch(url);\r\n            } catch {\r\n                // ignore 404\r\n            }\r\n            return res;\r\n        })\r\n    );\r\n\r\n    const list = responses\r\n        .filter((r) => r.status === 'fulfilled' && r.value)\r\n        .flatMap((response) => {\r\n            const $ = load(response.value);\r\n            const pubDate = parseDate($('meta[property=article:modified_time]').attr('content'));\r\n            return $('article.node-paper')\r\n                .toArray()\r\n                .map((item) => {\r\n                    item = $(item);\r\n                    return {\r\n                        title: item.find('h2.node-title > a').text().trim(),\r\n                        link: `${url}${item.find('h2.node-title > a').attr('href')}`,\r\n                        author: item.find('div.field.field-name-field-paper-people-text.field-type-text-long.field-label-hidden p').text().trim(),\r\n                        pubDate,\r\n                    };\r\n                });\r\n        });\r\n\r\n    const items = await Promise.allSettled(\r\n        list.map((item) =>\r\n            cache.tryGet(item.link, async () => {\r\n                const response = await ofetch(item.link);\r\n                const $ = load(response);\r\n                item.description = $('.content').html();\r\n\r\n                return item;\r\n            })\r\n        )\r\n    );\r\n\r\n    return {\r\n        title: 'USENIX',\r\n        link: url,\r\n        description: 'USENIX Security Symposium Accpeted Papers',\r\n        allowEmpty: true,\r\n        item: items.filter((r) => r.status === 'fulfilled').map((r) => (r as PromiseFulfilledResult<any>).value),\r\n    };\r\n}\r\n"],"mappings":"mTAIA,MAAM,EAAM,yBAGN,EAAU,CAAC,SAAU,SAAU,OAAQ,UAEhCA,EAAe,CACxB,KAAM,4BACN,WAAY,CAAC,WACb,QAAS,mCACT,MAAO,CACH,CACI,OAAQ,CAAC,6BAA8B,yBAA0B,iBAGzE,KAAM,oBACN,YAAa,CAAC,UACd,UACA,IAAK,6BACL,YAAa,4BAGjB,eAAe,GAAU,CACrB,IAAM,EAAO,IAAI,OAAO,cAAgB,EAClC,EAAU,MAAM,KAAK,CAAE,OAAQ,EAAO,OAAS,EAAG,IAAM,GAAG,EAAI,4BAA4B,EAAI,MAAM,QAAS,GAAQ,EAAQ,IAAK,GAAW,GAAGC,EAAI,GAAG,EAAO,oBAC/J,EAAY,MAAM,QAAQ,WAC5B,EAAQ,IAAI,KAAO,IAAQ,CACvB,IAAI,EACJ,GAAI,CACA,EAAM,MAAMC,EAAOD,QACf,EAGR,OAAO,KAIT,EAAO,EACR,OAAQ,GAAM,EAAE,SAAW,aAAe,EAAE,OAC5C,QAAS,GAAa,CACnB,IAAM,EAAI,EAAK,EAAS,OAClB,EAAU,EAAU,EAAE,wCAAwC,KAAK,YACzE,OAAO,EAAE,sBACJ,UACA,IAAK,IACF,EAAO,EAAE,GACF,CACH,MAAO,EAAK,KAAK,qBAAqB,OAAO,OAC7C,KAAM,GAAG,IAAM,EAAK,KAAK,qBAAqB,KAAK,UACnD,OAAQ,EAAK,KAAK,0FAA0F,OAAO,OACnH,eAKd,EAAQ,MAAM,QAAQ,WACxB,EAAK,IAAK,GACNE,EAAM,OAAO,EAAK,KAAM,SAAY,CAChC,IAAM,EAAW,MAAMD,EAAO,EAAK,MAC7B,EAAI,EAAK,GAGf,MAFA,GAAK,YAAc,EAAE,YAAY,OAE1B,MAKnB,MAAO,CACH,MAAO,SACP,KAAM,EACN,YAAa,4CACb,WAAY,GACZ,KAAM,EAAM,OAAQ,GAAM,EAAE,SAAW,aAAa,IAAK,GAAO,EAAkC"}