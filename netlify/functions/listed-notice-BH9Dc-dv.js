import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{parseDate as e}from"./parse-date-Bgabdhlb.js";import{ofetch_default as t}from"./ofetch-Bzt0BXUH.js";import{timezone as n}from"./timezone-BrNu6iXe.js";import{ViewType as r}from"./types-A5bA50Mg.js";import{load as i}from"cheerio";const a=async r=>{let{category:a=``}=r.req.param(),o=Number.parseInt(r.req.query(`limit`)??`50`,10),s=`https://www.szse.cn`,c=new URL(`api/disc/announcement/annList`,s).href,l=new URL(`disclosure/listed/notice${a}`,s).href,u=await t(l),d=i(u),f=d(`html`).attr(`lang`)??`zh-CN`,p=await t(c,{method:`POST`,body:{seDate:[``,``],channelCode:[`listedNotice_disc`],pageSize:o,pageNum:1}}),m=p.data.slice(0,o).map(t=>{let r=t.title,i=t.publishTime,a=`disclosure/listed/bulletinDetail/index.html?${t.id}`,o=[...new Set([...t.secCode,...t.secName,t.bigCategoryId,t.bigIndustryCode,t.smallCategoryId].filter(Boolean))],c=`szse-${t.id}`,l=t.publishTime,u={title:r,pubDate:i?n(e(i),8):void 0,link:new URL(a,s).href,category:o,guid:c,id:c,updated:l?n(e(l),8):void 0,language:f},d=new URL(`download${t.attachPath}`,`https://disc.static.szse.cn`).href;if(d){let e=`application/${t.attachFormat}`;u={...u,enclosure_url:d,enclosure_type:e,enclosure_title:r,enclosure_length:void 0}}return u}).filter(e=>!0);return{title:`深圳证券交易所 - 上市公司公告`,description:d(`meta[name="description"]`).attr(`content`),link:l,item:m,allowEmpty:!0,image:d(`a.navbar-brand img`).attr(`src`),author:d(`meta[name="author"]`).attr(`content`),language:f,id:l}},o={path:`/disclosure/listed/notice`,name:`上市公司公告`,url:`www.szse.cn`,maintainers:[`nczitzk`],handler:a,example:`/szse/disclosure/listed/notice`,parameters:void 0,description:void 0,categories:[`finance`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.szse.cn/disclosure/listed/notice/index.html`],target:`/disclosure/listed/notice`}],view:r.Articles};export{a as handler,o as route};
//# sourceMappingURL=listed-notice-BH9Dc-dv.js.map