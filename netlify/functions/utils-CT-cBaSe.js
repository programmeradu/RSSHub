import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import{cache_default as n}from"./cache-kimkMTWJ.js";import{art as r}from"./render-CxhTJIsl.js";import{parseDate as i}from"./parse-date-Bgabdhlb.js";import{ofetch_default as a}from"./ofetch-Bzt0BXUH.js";import o from"node:path";import{load as s}from"cheerio";t();const c=`https://dribbble.com`;async function l(t){let n=await a(t),c=s(n),l=JSON.parse(c(`script`).text().match(/shotData:\s({.+?}),\n/)?.[1]??`{}`),u=c(`.media-shot, .main-shot, .block-media-wrapper`).toArray().map(e=>{let t=c(e);return t.find(`span.cropped-indicator, button`).remove(),t.find(`video`).each((e,t)=>{t=c(t),!t.attr(`src`)&&t.data(`src`)&&(t.attr(`src`,t.data(`src`)),t.removeAttr(`data-src`),t.removeAttr(`data-video-small`),t.removeAttr(`data-video-medium`),t.removeAttr(`data-video-large`))}),t.find(`img`).each((e,t)=>{t=c(t),t.data(`animated-url`)&&(t.attr(`src`,t.data(`animated-url`)),t.removeAttr(`data-animated-url`),t.removeAttr(`srcset`)),!t.attr(`src`)&&t.data(`src`)&&(t.attr(`src`,t.data(`src`).split(`?`)[0]),t.removeAttr(`data-src`)),t.attr(`src`,t.attr(`src`).split(`?`)[0]),t.removeAttr(`srcset`),t.removeAttr(`data-srcset`)}),t.find(`a`).each((e,t)=>{t=c(t),t.removeAttr(`data-pswp-srcset`)}),t.html()}).join(``),d=c(`.shot-description-container`),f=`${l.shotUser.name}${l.shotUser.team.length?` for ${l.shotUser.team.name}`:``}`,p=r(o.join(e,`templates/description-7f10ab43.art`),{shotMedia:u,shotData:l,description:d}),m=i(l.postedOn);return{description:p,pubDate:m,author:f,category:l.tags}}function u(e){return Promise.all(e.map(e=>{let t=s(e),r=t(e).data(`thumbnail-id`),i=new URL(`/shots/${r}`,c).href,a=new URL(t(e).find(`.shot-thumbnail-link`).attr(`href`),c).href;return n.tryGet(i,async()=>{let{description:e,pubDate:n,author:r,category:o}=await l(a);return{title:t(`.shot-title`).text(),link:a,guid:i,description:e,pubDate:n,author:r,category:o}})}))}const d=async(e,t)=>{let n=await a(e),r=s(n),i=r(`ol.dribbbles.group > li`).toArray(),o=await u(i);return{title:t,link:e,description:r(`meta[name="description"]`).attr(`content`),item:o}};var f={getData:d};export{f as utils_default};
//# sourceMappingURL=utils-CT-cBaSe.js.map