{"version":3,"file":"whpj-J9fk-hP5.js","names":["route: Route","got"],"sources":["../../lib/routes/boc/whpj.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\n\r\nexport const route: Route = {\r\n    path: '/whpj/:format?',\r\n    categories: ['other'],\r\n    example: '/boc/whpj/zs?filter_title=%E8%8B%B1%E9%95%91',\r\n    parameters: { format: '输出的标题格式，默认为标题 + 所有价格。短格式仅包含货币名称。' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['boc.cn/sourcedb/whpj', 'boc.cn/'],\r\n            target: '/whpj',\r\n        },\r\n    ],\r\n    name: '外汇牌价',\r\n    maintainers: ['LogicJake', 'HenryQW'],\r\n    handler,\r\n    url: 'boc.cn/sourcedb/whpj',\r\n    description: `| 短格式 | 中行折算价 | 现汇买卖 | 现钞买卖 | 现汇买入 | 现汇卖出 | 现钞买入 | 现钞卖出 |\r\n| ------ | ---------- | -------- | -------- | -------- | -------- | -------- | -------- |\r\n| short  | zs         | xh       | xc       | xhmr     | xhmc     | xcmr     | xcmc     |`,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const link = 'https://www.boc.cn/sourcedb/whpj/';\r\n    const response = await got(link);\r\n    const $ = load(response.data);\r\n\r\n    const format = ctx.req.param('format');\r\n\r\n    const en_names = {\r\n        阿联酋迪拉姆: 'AED',\r\n        澳大利亚元: 'AUD',\r\n        巴西里亚尔: 'BRL',\r\n        加拿大元: 'CAD',\r\n        瑞士法郎: 'CHF',\r\n        丹麦克朗: 'DKK',\r\n        欧元: 'EUR',\r\n        英镑: 'GBP',\r\n        港币: 'HKD',\r\n        印尼卢比: 'IDR',\r\n        印度卢比: 'INR',\r\n        日元: 'JPY',\r\n        韩国元: 'KRW',\r\n        澳门元: 'MOP',\r\n        林吉特: 'MYR',\r\n        挪威克朗: 'NOK',\r\n        新西兰元: 'NZD',\r\n        菲律宾比索: 'PHP',\r\n        卢布: 'RUB',\r\n        沙特里亚尔: 'SAR',\r\n        瑞典克朗: 'SEK',\r\n        新加坡元: 'SGD',\r\n        泰国铢: 'THB',\r\n        土耳其里拉: 'TRY',\r\n        新台币: 'TWD',\r\n        美元: 'USD',\r\n        南非兰特: 'ZAR',\r\n    };\r\n\r\n    const out = $('div.publish table tbody tr')\r\n        .slice(2)\r\n        .toArray()\r\n        .map((e) => {\r\n            e = $(e);\r\n            const zh_name = e.find('td:nth-child(1)').text();\r\n            const en_name = en_names[zh_name] || '';\r\n            const name = `${zh_name} ${en_name}`;\r\n            const date = e.find('td:nth-child(7)').text();\r\n\r\n            const xhmr = `现汇买入价：${e.find('td:nth-child(2)').text()}`;\r\n\r\n            const xcmr = `现钞买入价：${e.find('td:nth-child(3)').text()}`;\r\n\r\n            const xhmc = `现汇卖出价：${e.find('td:nth-child(4)').text()}`;\r\n\r\n            const xcmc = `现钞卖出价：${e.find('td:nth-child(5)').text()}`;\r\n\r\n            const zs = `中行折算价：${e.find('td:nth-child(6)').text()}`;\r\n\r\n            const content = `${xhmr} ${xcmr} ${xhmc} ${xcmc} ${zs}`;\r\n\r\n            const formatTitle = () => {\r\n                switch (format) {\r\n                    case 'short':\r\n                        return name;\r\n                    case 'xh':\r\n                        return `${name} ${xhmr} ${xhmc}`;\r\n                    case 'xc':\r\n                        return `${name} ${xcmr} ${xcmc}`;\r\n                    case 'zs':\r\n                        return `${name} ${zs}`;\r\n                    case 'xhmr':\r\n                        return `${name} ${xhmr}`;\r\n                    case 'xhmc':\r\n                        return `${name} ${xhmc}`;\r\n                    case 'xcmr':\r\n                        return `${name} ${xcmr}`;\r\n                    case 'xcmc':\r\n                        return `${name} ${xcmc}`;\r\n                    default:\r\n                        return `${name} ${content}`;\r\n                }\r\n            };\r\n\r\n            const info = {\r\n                title: formatTitle(),\r\n                description: content.replaceAll(/\\s/g, '<br>'),\r\n                pubDate: new Date(date).toUTCString(),\r\n                guid: `${name} ${content}`,\r\n            };\r\n            return info;\r\n        });\r\n\r\n    return {\r\n        title: '中国银行外汇牌价',\r\n        link,\r\n        item: out,\r\n    };\r\n}\r\n"],"mappings":"+PAIA,MAAaA,EAAe,CACxB,KAAM,iBACN,WAAY,CAAC,SACb,QAAS,+CACT,WAAY,CAAE,OAAQ,oCACtB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,uBAAwB,WACjC,OAAQ,UAGhB,KAAM,OACN,YAAa,CAAC,YAAa,WAC3B,UACA,IAAK,uBACL,YAAa;;4FAKjB,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAO,oCACP,EAAW,MAAMC,EAAI,GACrB,EAAI,EAAK,EAAS,MAElB,EAAS,EAAI,IAAI,MAAM,UAEvB,EAAW,CACb,OAAQ,MACR,MAAO,MACP,MAAO,MACP,KAAM,MACN,KAAM,MACN,KAAM,MACN,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,KAAM,MACN,KAAM,MACN,GAAI,MACJ,IAAK,MACL,IAAK,MACL,IAAK,MACL,KAAM,MACN,KAAM,MACN,MAAO,MACP,GAAI,MACJ,MAAO,MACP,KAAM,MACN,KAAM,MACN,IAAK,MACL,MAAO,MACP,IAAK,MACL,GAAI,MACJ,KAAM,OAGJ,EAAM,EAAE,8BACT,MAAM,GACN,UACA,IAAK,GAAM,CACR,EAAI,EAAE,GACN,IAAM,EAAU,EAAE,KAAK,mBAAmB,OACpC,EAAU,EAAS,IAAY,GAC/B,EAAO,GAAG,EAAQ,GAAG,IACrB,EAAO,EAAE,KAAK,mBAAmB,OAEjC,EAAO,SAAS,EAAE,KAAK,mBAAmB,SAE1C,EAAO,SAAS,EAAE,KAAK,mBAAmB,SAE1C,EAAO,SAAS,EAAE,KAAK,mBAAmB,SAE1C,EAAO,SAAS,EAAE,KAAK,mBAAmB,SAE1C,EAAK,SAAS,EAAE,KAAK,mBAAmB,SAExC,EAAU,GAAG,EAAK,GAAG,EAAK,GAAG,EAAK,GAAG,EAAK,GAAG,IAE7C,MAAoB,CACtB,OAAQ,EAAR,CACI,IAAK,QACD,OAAO,EACX,IAAK,KACD,MAAO,GAAG,EAAK,GAAG,EAAK,GAAG,IAC9B,IAAK,KACD,MAAO,GAAG,EAAK,GAAG,EAAK,GAAG,IAC9B,IAAK,KACD,MAAO,GAAG,EAAK,GAAG,IACtB,IAAK,OACD,MAAO,GAAG,EAAK,GAAG,IACtB,IAAK,OACD,MAAO,GAAG,EAAK,GAAG,IACtB,IAAK,OACD,MAAO,GAAG,EAAK,GAAG,IACtB,IAAK,OACD,MAAO,GAAG,EAAK,GAAG,IACtB,QACI,MAAO,GAAG,EAAK,GAAG,MAIxB,EAAO,CACT,MAAO,IACP,YAAa,EAAQ,WAAW,MAAO,QACvC,QAAS,IAAI,KAAK,GAAM,cACxB,KAAM,GAAG,EAAK,GAAG,KAErB,OAAO,IAGf,MAAO,CACH,MAAO,WACP,OACA,KAAM"}