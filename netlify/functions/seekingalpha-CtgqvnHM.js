import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{cache_default as n}from"./cache-kimkMTWJ.js";import{art as r}from"./render-CxhTJIsl.js";import{parseDate as i}from"./parse-date-Bgabdhlb.js";import{ofetch_default as a}from"./ofetch-Bzt0BXUH.js";import o from"node:path";t();const s=`https://seekingalpha.com`,c={path:`/:symbol/:category?`,categories:[`finance`],example:`/seekingalpha/TSM/transcripts`,parameters:{symbol:`Stock symbol`,category:"Category, see below, `news` by default"},features:{antiCrawler:!0},radar:[{source:[`seekingalpha.com/symbol/:symbol/:category`,`seekingalpha.com/symbol/:symbol/earnings/:category`],target:`/:symbol/:category`}],name:`Summary`,maintainers:[`TonyRL`],handler:d,description:`| Analysis | News | Transcripts | Press Releases | Related Analysis |
| -------- | ---- | ----------- | -------------- | ---------------- |
| analysis | news | transcripts | press-releases | related-analysis |`},l=()=>n.tryGet(`seekingalpha:machine_cookie`,async()=>{let e=await a.raw(s);return e.headers.getSetCookie().map(e=>e.split(`;`)[0])}),u={article:{slug:`/articles`,include:`author,primaryTickers,secondaryTickers,otherTags,presentations,presentations.slides,author.authorResearch,author.userBioTags,co_authors,promotedService,sentiments`},news:{slug:`/news`,include:`author,primaryTickers,secondaryTickers,otherTags`},pr:{slug:`/press_releases`,include:`acquireService,primaryTickers`}};async function d(t){let{category:c=`news`,symbol:d}=t.req.param(),f=`${s}/symbol/${d.toUpperCase()}/${c===`transcripts`?`earnings/${c}`:c}`,p=await l(),m=await a(`${s}/api/v3/symbols/${d.toUpperCase()}/${c}`,{headers:{cookie:p.join(`; `)},query:{"filter[since]":0,"filter[until]":0,id:d.toLowerCase(),include:`author,primaryTickers,secondaryTickers,sentiments`,"page[size]":t.req.query(`limit`)?Number.parseInt(t.req.query(`limit`),10):c===`news`?40:20,"page[number]":1}}),h=m.data?.map(e=>({title:e.attributes.title,link:new URL(e.links.self,s).href,pubDate:i(e.attributes.publishOn),author:m.included.find(t=>t.id===e.relationships.author.data.id).attributes.nick,id:e.id,articleType:e.links.self.split(`/`)[1]})),g=h?await Promise.all(h.map(t=>n.tryGet(t.link,async()=>{let n=await a(`${s}/api/v3${u[t.articleType].slug}/${t.id}`,{headers:{cookie:p.join(`; `)},query:{include:u[t.articleType].include}});return t.category=n.included.filter(e=>e.type===`tag`).map(e=>e.attributes.company?`${e.attributes.company} (${e.attributes.name})`:e.attributes.name),t.description=(n.data.attributes.summary?.length?r(o.join(e,`templates/summary-5a23a582.art`),{summary:n.data.attributes.summary}):``)+n.data.attributes.content,t.updated=i(n.data.attributes.lastModified),t}))):[];return{title:m.meta.page.title,description:m.meta.page.description,link:f,image:`https://seekingalpha.com/samw/static/images/favicon.svg`,item:g,allowEmpty:!0,language:`en-US`}}export{c as route};
//# sourceMappingURL=seekingalpha-CtgqvnHM.js.map