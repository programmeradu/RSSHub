import{cache_default as e}from"./cache-kimkMTWJ.js";import{parseDate as t}from"./parse-date-Bgabdhlb.js";import{ofetch_default as n}from"./ofetch-Bzt0BXUH.js";import{load as r}from"cheerio";function i(e,t){return[...new Map(e.map(e=>[e[t],e])).values()]}function a(i){return e.tryGet(i.link,async()=>{let e=await n(i.link),a=r(e);if(a(`#link-ld-json`).length===0){let e=a(`meta[name="gtm-dataLayer"]`).attr(`content`);if(e){let n=JSON.parse(e);return{title:n.headline,pubDate:t(n.publication_date),description:a(`div.RichTextStoryBody`).html()||a(`:is(.VideoLead, .VideoPage-pageSubHeading)`).html(),category:n.tag_array.split(`,`),guid:a(`meta[name='brightspot.contentId']`).attr(`content`),author:n.author,...i}}else return i}let o=JSON.parse(a(`#link-ld-json`).text()),s;if(o[`@type`]===`NewsArticle`||Array.isArray(o)&&o.some(e=>e[`@type`]===`NewsArticle`)){s=Array.isArray(o)?o.find(e=>e[`@type`]===`NewsArticle`):o,a(`div.Enhancement`).remove();let e=a(`meta[property='article:section']`).attr(`content`);return{...i,title:s.headline,pubDate:t(s.datePublished),updated:t(s.dateModified),description:a(`div.RichTextStoryBody`).html()||a(`:is(.VideoLead, .VideoPage-pageSubHeading)`).html(),category:[...e?[e]:[],...s.keywords??[]],guid:a(`meta[name='brightspot.contentId']`).attr(`content`),author:s.author?.map(e=>e.mainEntity)}}else{s=o;let e=new URL(i.link),n=e.hash?a(e.hash).parent().find(`.LiveBlogPost-body`).html():s.description,r=e.hash?t(Number.parseInt(a(e.hash).parent().attr(`data-posted-date-timestamp`),10)):t(s.coverageStartTime);return{...i,category:s.keywords,pubDate:r,description:n,guid:a(`meta[name='brightspot.contentId']`).attr(`content`)}}})}export{a as fetchArticle,i as removeDuplicateByKey};
//# sourceMappingURL=utils-BXdY0xFm.js.map