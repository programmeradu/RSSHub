import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import{config as n}from"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as r}from"./cache-kimkMTWJ.js";import{art as i}from"./render-CxhTJIsl.js";import"./ofetch-Bzt0BXUH.js";import{got_default as a}from"./got-CdvI2yKX.js";import{ViewType as o}from"./types-A5bA50Mg.js";import s from"node:path";import{load as c}from"cheerio";t();let l=`false`,u=`false`;const d={path:`/search/hot/:fulltext?`,categories:[`social-media`],view:o.SocialMedia,example:`/weibo/search/hot`,parameters:{fulltext:{description:"\n-   使用`/weibo/search/hot`可以获取热搜条目列表；\n-   使用`/weibo/search/hot/fulltext`可以进一步获取热搜条目下的摘要信息（不含图片视频）；\n-   使用`/weibo/search/hot/fulltext?pic=true`可以获取图片缩略（但需要配合额外的手段，例如浏览器上的 Header Editor 等来修改 referer 参数为`https://weibo.com`，以规避微博的外链限制，否则图片无法显示。）\n-   使用`/weibo/search/hot/fulltext?pic=true&fullpic=true`可以获取 Original 图片（但需要配合额外的手段，例如浏览器上的 Header Editor 等来修改 referer 参数为`https://weibo.com`，以规避微博的外链限制，否则图片无法显示。）"}},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`s.weibo.com/top/summary`]}],name:`热搜榜`,maintainers:[`xyqfer`,`shinemoon`],handler:f,url:`s.weibo.com/top/summary`};async function f(e){l=e.req.query(`pic`)??`false`,u=e.req.query(`fullpic`)??`false`;let{data:{data:t}}=await a({method:`get`,url:`https://m.weibo.cn/api/container/getIndex?containerid=106003type%3D25%26t%3D3%26disable_hot%3D1%26filter_type%3Drealtimehot&title=%E5%BE%AE%E5%8D%9A%E7%83%AD%E6%90%9C&extparam=filter_type%3Drealtimehot%26mi_cid%3D100103%26pos%3D0_0%26c_type%3D30%26display_time%3D1540538388&luicode=10000011&lfid=231583`,headers:{Referer:`https://s.weibo.com/top/summary?cate=realtimehot`,"MWeibo-Pwa":1,"X-Requested-With":`XMLHttpRequest`,"User-Agent":`Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1`}}),n=null;if(e.req.param(`fulltext`)===`fulltext`){let e=t.cards[0].card_group,i=e.map(e=>{let t=e.desc,n=`https://m.weibo.cn/search?containerid=100103type%3D1%26q%3D${encodeURIComponent(e.desc)}`,r=`https://m.weibo.cn/api/container/getIndex?containerid=100103type%3D1%26q%3D${encodeURIComponent(e.desc)}`;return{title:t,link:n,plink:r}});n=await Promise.all(i.map(e=>r.tryGet(e.plink,async()=>{let t=await p(e.plink);return e.description=t.content,e})))}else n=t.cards[0].card_group.map(e=>{let t=e.desc,n=`https://m.weibo.cn/search?containerid=100103type%3D1%26q%3D${encodeURIComponent(e.desc)}`,r=e.desc;return{title:t,description:r,link:n}});return{title:`微博热搜榜`,link:`https://s.weibo.com/top/summary?cate=realtimehot`,description:`实时热点，每分钟更新一次`,item:n}}async function p(e){let t=n.weibo.cookies??``,r=await a(e,{headers:{Cookie:t}}),i=``;try{let e=r.data,t=e.data.cards;i=m(t)}catch{}let o=i;return{content:o}}function m(t){let n=c(`<div id="wbcontent"></div>`),r=n(`#wbcontent`);for(let n of t){if(n.card_type===9){let t=n.mblog.thumbnail_pic??``,a=t.lastIndexOf(`/`),o=t.slice(0,a+1),d=c(n.mblog.text);l===`true`?d(`img`).attr(`width`,`1em`).attr(`height`,`1em`):d(`img`).remove();let f=i(s.join(e,`templates/digest-1cdd1c64.art`),{author:{link:n.mblog.user.profile_url,name:n.mblog.user.screen_name},msg:d.html(),link:n.scheme,postinfo:n.mblog.created_at,picnum:l===`true`?n.mblog.pic_num:0,pics:l===`true`&&n.mblog.pic_num>0?n.mblog.pics.map(e=>{let t=e.pid;return u===`false`?{url:o+t+`.jpg`,rurl:e.url}:{url:e.url,rurl:e.url}}):[]});r.append(f)}n.card_type===11&&r.append(m(n.card_group))}return r.html()}export{d as route};
//# sourceMappingURL=hot-uMshH7IO.js.map