import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{art as n}from"./render-CxhTJIsl.js";import{parseDate as r}from"./parse-date-Bgabdhlb.js";import{md5 as i}from"./md5-4BNsOP-F.js";import"./ofetch-Bzt0BXUH.js";import{got_default as a}from"./got-CdvI2yKX.js";import o from"node:path";import{load as s}from"cheerio";t();const c={path:`/pulse/:user/:repo/:period?`,categories:[`programming`],example:`/github/pulse/DIYgod/RSSHub`,parameters:{user:`User name`,repo:`Repo name`,period:"Time frame, selected from a repository's Pulse/Insights page. Possible values are: `daily`, `halfweekly`, `weekly`, or `monthly`. Default: `weekly`. If your RSS client supports it, consider aligning the polling frequency of the feed to the period."},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`github.com/:user/:repo/pulse`,`github.com/:user/:repo/pulse/:period`]}],name:`Repo Pulse`,maintainers:[`jameschensmith`],handler:l};async function l(t){let{user:c,repo:l,period:u}=t.req.param(),d=[`daily`,`halfweekly`,`weekly`,`monthly`],f=d.includes(u)?u:d[2],p=`https://github.com/${c}/${l}/pulse/${f}`,{data:m}=await a(p),h=s(m),g=h(`main .Layout-main`).children(),_=g.eq(0),[v,y]=_.find(`h2`).text().split(`â€“`),b=g.eq(1),x=b.find(`ul ul li`).toArray().map(e=>h(e).text()),S=g.eq(2),C,w=S.find(`.js-pulse-contribution-data`);if(w.length){let e=w.attr(`data-pulse-diffstat-summary-url`);C=(await a(`https://github.com${e}`)).data}else C=S.text();let T=g.eq(3),E,D=T.find(`h3`);return D.length&&(E=D.toArray().map(e=>{let t=h(e),n=t.nextUntil(`h3`),r=t.nextUntil(`ul`),i=n.last();return{heading:t.text(),paragraph:r.length>0?r.text():void 0,items:i.children().toArray().map(e=>{let t=h(e),n=t.find(`a`),r=t.find(`p`),i=r.find(`relative-time`);return i.replaceWith(i.attr(`datetime`)),{link:{text:n.text(),url:n.attr(`href`)},details:r.text()}})}})),{title:`${c}/${l} ${f} Pulse`,link:p,item:[{guid:i(`${c}${l}${u}${v}${y}`),title:`${v} - ${y}`,description:n(o.join(e,`templates/pulse-description-3048c248.art`),{overviewItems:x,commitActivity:C,githubActivity:E}),pubDate:r(y)}]}}export{c as route};
//# sourceMappingURL=pulse-DfhDLcZf.js.map