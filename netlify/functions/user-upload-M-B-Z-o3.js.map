{"version":3,"file":"user-upload-M-B-Z-o3.js","names":["route: Route","ofetch"],"sources":["../../lib/routes/makerworld/user-upload.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport ofetch from '@/utils/ofetch';\r\nimport { baseUrl, getNextBuildId } from './utils';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport { config } from '@/config';\r\n\r\nexport const route: Route = {\r\n    path: '/user/:handle/upload',\r\n    categories: ['design'],\r\n    example: '/makerworld/user/@Wcad00/upload',\r\n    parameters: {\r\n        handle: 'User handle',\r\n    },\r\n    name: 'User Uploads',\r\n    maintainers: ['TonyRL'],\r\n    handler,\r\n    radar: [\r\n        {\r\n            source: ['makerworld.com/:lang/:handle/upload', 'makerworld.com/:lang/:handle'],\r\n        },\r\n    ],\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const { handle } = ctx.req.param();\r\n\r\n    const nextBuildId = await getNextBuildId();\r\n    const response = await ofetch(`${baseUrl}/_next/data/${nextBuildId}/en/${handle}/upload.json`, {\r\n        headers: {\r\n            'User-Agent': config.trueUA,\r\n        },\r\n        query: {\r\n            handle,\r\n        },\r\n    });\r\n    const { userInfo, designs } = response.pageProps;\r\n\r\n    const items = designs.map((d) => ({\r\n        title: d.title,\r\n        link: `${baseUrl}/en/models/${d.id}-${d.slug}`,\r\n        pubDate: parseDate(d.createTime),\r\n        author: d.designCreator.name,\r\n        category: d.tags,\r\n        description: d.instances.map((i) => `<figure><img src=\"${i.cover}\" alt=\"${d.title}\"><figcaption>${i.title}</figcaption></figure>`).join(''),\r\n    }));\r\n\r\n    return {\r\n        title: `${userInfo.name} | Published - MakerWorld`,\r\n        link: `${baseUrl}/en/${handle}/upload`,\r\n        description: userInfo.personal.bio,\r\n        image: userInfo.avatar,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"+UAMA,MAAaA,EAAe,CACxB,KAAM,uBACN,WAAY,CAAC,UACb,QAAS,kCACT,WAAY,CACR,OAAQ,eAEZ,KAAM,eACN,YAAa,CAAC,UACd,UACA,MAAO,CACH,CACI,OAAQ,CAAC,sCAAuC,mCAK5D,eAAe,EAAQ,EAAK,CACxB,GAAM,CAAE,UAAW,EAAI,IAAI,QAErB,EAAc,MAAM,IACpB,EAAW,MAAMC,EAAO,GAAG,EAAQ,cAAc,EAAY,MAAM,EAAO,cAAe,CAC3F,QAAS,CACL,aAAc,EAAO,QAEzB,MAAO,CACH,YAGF,CAAE,WAAU,WAAY,EAAS,UAEjC,EAAQ,EAAQ,IAAK,IAAO,CAC9B,MAAO,EAAE,MACT,KAAM,GAAG,EAAQ,aAAa,EAAE,GAAG,GAAG,EAAE,OACxC,QAAS,EAAU,EAAE,YACrB,OAAQ,EAAE,cAAc,KACxB,SAAU,EAAE,KACZ,YAAa,EAAE,UAAU,IAAK,GAAM,qBAAqB,EAAE,MAAM,SAAS,EAAE,MAAM,gBAAgB,EAAE,MAAM,yBAAyB,KAAK,OAG5I,MAAO,CACH,MAAO,GAAG,EAAS,KAAK,2BACxB,KAAM,GAAG,EAAQ,MAAM,EAAO,SAC9B,YAAa,EAAS,SAAS,IAC/B,MAAO,EAAS,OAChB,KAAM"}