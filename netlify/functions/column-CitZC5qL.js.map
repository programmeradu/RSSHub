{"version":3,"file":"column-CitZC5qL.js","names":["route: Route","ofetch","cache","response"],"sources":["../../lib/routes/tencent/cloud/developer/column.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport ofetch from '@/utils/ofetch'; // 统一使用的请求库\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport cache from '@/utils/cache';\r\n\r\nconst PAGE = 1;\r\nconst PAGE_SIZE = 20;\r\n\r\nexport const route: Route = {\r\n    path: '/cloud/developer/column/:categoryId?',\r\n    categories: ['programming'],\r\n    example: '/tencent/cloud/developer/column/1',\r\n    parameters: { categoryId: 'categoryId from page url' },\r\n    radar: [\r\n        {\r\n            source: ['cloud.tencent.com/developer/column'],\r\n        },\r\n    ],\r\n    name: '腾讯云开发者社区专栏',\r\n    maintainers: ['lyling'],\r\n    handler: async (ctx) => {\r\n        const categoryId = ctx.req.param('categoryId') ?? 0;\r\n        const link = `https://cloud.tencent.com/developer/api/home/article-list`;\r\n        const response = await ofetch(link, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n            },\r\n            body: {\r\n                classifyId: categoryId,\r\n                page: PAGE,\r\n                pagesize: PAGE_SIZE,\r\n                type: '',\r\n            },\r\n        });\r\n\r\n        const items = response.list.map((item) => ({\r\n            // 文章标题\r\n            title: item.title,\r\n            // 文章链接\r\n            link: `https://cloud.tencent.com/developer/article/${item.articleId}`,\r\n            // 文章正文\r\n            description: item.summary,\r\n            // 文章发布日期\r\n            pubDate: parseDate(item.createTime * 1000),\r\n            // 如果有的话，文章作者\r\n            author: item.author.nickname,\r\n            // 如果有的话，文章分类\r\n            category: item.tags.map((tag) => tag.tagName),\r\n        }));\r\n\r\n        const classify = await findClassifyById(categoryId);\r\n\r\n        const title = classify ? classify.name : '';\r\n        const description = `${title} - 腾讯云开发者社区`;\r\n\r\n        return {\r\n            title,\r\n            description,\r\n            item: items,\r\n        };\r\n    },\r\n};\r\n\r\nasync function findClassifyById(id) {\r\n    const classifylink = 'https://cloud.tencent.com/developer/api/column/get-classify-list-by-scene';\r\n    const response = await cache.tryGet(classifylink, async () => {\r\n        const response = await ofetch(classifylink, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n            },\r\n            body: {\r\n                scene: 0,\r\n            },\r\n        });\r\n        return response;\r\n    });\r\n\r\n    return response.list.find((classify) => classify.id === Number(id));\r\n}\r\n"],"mappings":"oRAKA,MAGaA,EAAe,CACxB,KAAM,uCACN,WAAY,CAAC,eACb,QAAS,oCACT,WAAY,CAAE,WAAY,4BAC1B,MAAO,CACH,CACI,OAAQ,CAAC,wCAGjB,KAAM,aACN,YAAa,CAAC,UACd,QAAS,KAAO,IAAQ,CACpB,IAAM,EAAa,EAAI,IAAI,MAAM,eAAiB,EAE5C,EAAW,MAAMC,EAAO,4DAAM,CAChC,OAAQ,OACR,QAAS,CACL,eAAgB,oBAEpB,KAAM,CACF,WAAY,EACZ,KAAM,EACN,SAAU,GACV,KAAM,MAIR,EAAQ,EAAS,KAAK,IAAK,IAAU,CAEvC,MAAO,EAAK,MAEZ,KAAM,+CAA+C,EAAK,YAE1D,YAAa,EAAK,QAElB,QAAS,EAAU,EAAK,WAAa,KAErC,OAAQ,EAAK,OAAO,SAEpB,SAAU,EAAK,KAAK,IAAK,GAAQ,EAAI,YAGnC,EAAW,MAAM,EAAiB,GAElC,EAAQ,EAAW,EAAS,KAAO,GACnC,EAAc,GAAG,EAAM,aAE7B,MAAO,CACH,QACA,cACA,KAAM,KAKlB,eAAe,EAAiB,EAAI,CAChC,IAAM,EAAe,4EACf,EAAW,MAAMC,EAAM,OAAO,EAAc,SAAY,CAC1D,IAAMC,EAAW,MAAMF,EAAO,EAAc,CACxC,OAAQ,OACR,QAAS,CACL,eAAgB,oBAEpB,KAAM,CACF,MAAO,KAGf,OAAOE,IAGX,OAAO,EAAS,KAAK,KAAM,GAAa,EAAS,KAAO,OAAO"}