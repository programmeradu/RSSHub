import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as n}from"./cache-kimkMTWJ.js";import{art as r}from"./render-CxhTJIsl.js";import{parseDate as i}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as a}from"./got-CdvI2yKX.js";import o from"node:path";import s from"crypto-js";t();const c=`https://api.creative-comic.tw`,l=`web_desktop`,u=(e,t)=>a(`${c}/book/${e}/info`,{headers:{device:l,uuid:t}}),d=(e,t)=>a(`${c}/book/chapter/${e}`,{headers:{device:l,uuid:t}}),f=(e,t)=>a(`${c}/book/${e}/chapter`,{headers:{device:l,uuid:t}}),p=async(e,t)=>{let{data:n}=await a(`https://storage.googleapis.com/ccc-www/fs/chapter_content/encrypt/${e}/${t}`,{headers:{device:l},responseType:`buffer`});return Buffer.from(n).toString(`base64`)},m=(e,t)=>a(`${c}/book/chapter/image/${e}`,{headers:{device:l,uuid:t}}),h=e=>e(`creative-comic:uuid`,async()=>{let{data:e}=await a(`${c}/guest`,{headers:{device:l}});return e.data}),g=(e,t)=>s.AES.decrypt(e,s.enc.Hex.parse(t.key),{iv:s.enc.Hex.parse(t.iv),mode:s.mode.CBC,padding:s.pad.Pkcs7}).toString(s.enc.Utf8),_=e=>{let t=s.SHA512(e).toString();return{key:t.slice(0,64),iv:t.slice(30,62)}},v=(e,t=`freeforccc2020reading`)=>{let n=_(t),r=g(e,n),i=r.split(`:`);return{key:i[0],iv:i[1]}},y={path:`/book/:id/:coverOnly?/:quality?`,categories:[`anime`],example:`/creative-comic/book/117`,parameters:{id:`漫畫 ID，可在 URL 中找到`,coverOnly:"僅獲取封面，非 `true` 時將獲取**全部**頁面，預設 `true`",quality:"閱讀品質，標準畫質 `1`，高畫質 `2`，預設 `1`"},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`creative-comic.tw/book/:id/*`],target:`/:id`}],name:`漫畫`,maintainers:[`TonyRL`],handler:b};async function b(t){let{id:a,coverOnly:s=`true`,quality:l=`1`}=t.req.param(),_=await h(n.tryGet),{data:{data:y}}=await u(a,_),{data:{data:b}}=await f(a,_),x=await Promise.all(b.chapters.sort((e,t)=>t.idx-e.idx).slice(0,t.req.query(`limit`)?Number.parseInt(t.req.query(`limit`),10):3).map(async t=>{let a;if(s!==`true`&&s!==`1`){let{data:{data:e}}=await d(t.id,_);(e.chapter.free_day===null||e.chapter.free_day===0)&&(a=await Promise.all(e.chapter.proportion.map(async e=>{let{data:t}=await m(e.id,_);t=t.data.key;let r=v(t),i=await p(e.id,l);return n.tryGet(`${c}/fs/chapter_content/encrypt/${e.id}/${l}`,()=>g(i,r))})))}return{title:t.vol_name,description:r(o.join(e,`templates/chapter-534d3dc4.art`),{chapter:t,pages:a,cover:t.image1}),pubDate:i(t.online_at),updated:i(t.updated_at),link:`https://www.creative-comic.tw/reader_comic/${t.id}`,author:y.author.map(e=>e.name).join(`, `),category:y.tags.map(e=>e.name)}}));return{title:`${y.name} | CCC創作集`,description:`${y.brief} ${y.description}`,link:y.share_link,image:y.image1,item:x,language:`zh-hant`}}export{y as route};
//# sourceMappingURL=book-D7COhq5C.js.map