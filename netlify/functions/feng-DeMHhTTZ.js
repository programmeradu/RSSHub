import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as n}from"./cache-kimkMTWJ.js";import{art as r}from"./render-CxhTJIsl.js";import{parseDate as i}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as a}from"./got-CdvI2yKX.js";import{timezone as o}from"./timezone-BrNu6iXe.js";import s from"node:path";import{load as c}from"cheerio";t();const l=e=>e.map(e=>{let t=e.type;return t===`video`?u(e.data):t===`text`?e.data.replaceAll(/data-lazyload=(.+?) src=(.+?) style=".+?"/g,`src=$1`):``}).join(`<br>`),u=t=>r(s.join(e,`templates/video-ce1c2c9a.art`),{videoInfo:t}),d={path:`/feng/:id/:type`,categories:[`new-media`],example:`/ifeng/feng/2583/doc`,parameters:{id:`对应 id，可在 大风号作者页面 找到`,type:`类型，见下表`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`大风号`,maintainers:[`Jamch`],handler:f,description:`| 文章 | 视频  |
| ---- | ----- |
| doc  | video |`};async function f(e){let{id:t,type:r}=e.req.param(),{data:s}=await a(`https://ishare.ifeng.com/mediaShare/home/${t}/media`,{headers:{Referer:`https://feng.ifeng.com/author/${t}`}}),{data:d}=await a(`https://shankapi.ifeng.com/season/ishare/getShareListData/${t}/${r}/1/ifengnewsh5/getListData`,{headers:{Referer:`https://feng.ifeng.com/author/${t}`}}),f=c(s),{sockpuppetInfo:p}=JSON.parse(f(`script`).text().match(/var allData = (.*?);/)[1]),{data:m}=JSON.parse(d.match(/getListData\((.*)\)/)[1]),{weMediaName:h,honorDesc:g,description:_,logo:v}=p,y=m.map(e=>({title:e.title,pubDate:o(i(e.newsTime),8),author:h,link:`https:${e.url}`})),b=await Promise.all(y.map(e=>n.tryGet(e.link,async()=>{let{data:t}=await a(e.link),n=c(t),i=JSON.parse(n(`script`).text().match(/var allData = ({.*?});/)[1]);return r===`doc`&&(e.description=l(i.docData.contentData.contentList)),r===`video`&&(e.description=u(i.videoInfo)),e.category=i.keywords.split(`,`),e.author=i.docData?.editorName??e.author,e})));return{title:`大风号-${h}-${r===`doc`?`文章`:`视频`}`,description:`${g} ${_}`,image:`https:${v}`,link:`https://ishare.ifeng.com/mediaShare/home/${t}/media`,item:b}}export{d as route};
//# sourceMappingURL=feng-DeMHhTTZ.js.map