import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{cache_default as n}from"./cache-kimkMTWJ.js";import{art as r}from"./render-CxhTJIsl.js";import"./parse-date-Bgabdhlb.js";import{getSubPath as i}from"./common-utils-CvkwbCD5.js";import{ofetch_default as a}from"./ofetch-Bzt0BXUH.js";import o from"node:path";import{load as s}from"cheerio";t();const c={arabic:{rootUrl:`https://www.aljazeera.net`,rssUrl:`rss`},chinese:{rootUrl:`https://chinese.aljazeera.net`,rssUrl:void 0},english:{rootUrl:`https://www.aljazeera.com`,rssUrl:`xml/rss/all.xml`}},l={path:`*`,name:`Unknown`,maintainers:[`nczitzk`],handler:u};async function u(t){let l=i(t)===`/`?[`arabic`]:i(t).replace(/^\//,``).split(`/`);Object.hasOwn(c,l[0])||l.unshift(`arabic`);let u=l.shift(),d=l.length===1&&l.at(-1)===`rss`&&c[u].rssUrl,f=c[u].rootUrl,p=`${f}/${d?c[u].rssUrl:l.join(`/`)}`,m=await a(p),h=s(m),g=d?m.data.match(RegExp(`<link>`+f+`/(.*?)</link>`,`g`)).map(e=>({link:e.match(/<link>(.*?)<\/link>/)[1]})):h(`.u-clickable-card__link`).toArray().map(e=>(e=h(e),{link:`${f}${e.attr(`href`)}`}));return g=await Promise.all(g.slice(0,t.req.query(`limit`)?Number.parseInt(t.req.query(`limit`)):50).map(t=>n.tryGet(t.link,async()=>{let n=await a(t.link),i=s(n);i(`.more-on`).parent().remove(),i(`.responsive-image img`).removeAttr(`srcset`);let c,l=n.match(/"datePublished": ?"(.*?)",/);if(l&&l.length>1)c=n.match(/"datePublished": ?"(.*?)",/)[1];else{let e=n.match(/"uploadDate": ?"(.*?)",/)[1];c=e&&e.length>1?e:i(`div.date-simple > span:nth-child(2)`).text()}return t.title=i(`h1`).first().text(),t.author=i(`.author`).text(),t.pubDate=c,t.description=r(o.join(e,`templates/description-38782361.art`),{image:i(`.article-featured-image`).html(),description:i(`.wysiwyg`).html()}),t}))),{title:h(`title`).first().text(),link:p,item:g}}export{l as route};
//# sourceMappingURL=aljazeera-CEE1FuPM.js.map