{"version":3,"file":"news-and-comment-D1KWmuez.js","names":["route: Route","got"],"sources":["../../lib/routes/nature/news-and-comment.ts"],"sourcesContent":["import { Route } from '@/types';\r\n// example usage: `/nature/news-and-comment/ng`\r\n// The journals from NPG are run by different group of people,\r\n// and the website of may not be consitent for all the journals\r\n//\r\n// This router has **just** been tested in:\r\n// nbt:              Nature Biotechnology\r\n// neuro:            Nature Neuroscience\r\n// ng:               Nature Genetics\r\n// ni:               Nature Immunology\r\n// nmeth:            Nature Method\r\n// nchem:            Nature Chemistry\r\n// nmat:             Nature Materials\r\n// natmachintell:    Nature Machine Intelligence\r\n\r\nimport { load } from 'cheerio';\r\nimport got from '@/utils/got';\r\nimport { baseUrl, cookieJar, getArticleList, getArticle } from './utils';\r\n\r\nexport const route: Route = {\r\n    path: '/news-and-comment/:journal?',\r\n    radar: [\r\n        {\r\n            source: ['nature.com/latest-news', 'nature.com/news', 'nature.com/'],\r\n            target: '/news',\r\n        },\r\n    ],\r\n    name: 'Unknown',\r\n    maintainers: ['y9c', 'TonyRL'],\r\n    handler,\r\n    url: 'nature.com/latest-news',\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const journal = ctx.req.param('journal');\r\n    const pageURL = `${baseUrl}/${journal}/news-and-comment`;\r\n\r\n    const pageResponse = await got(pageURL, { cookieJar });\r\n    const pageCapture = load(pageResponse.data);\r\n    const pageDescription = pageCapture('meta[name=description]').attr('content') || 'Nature, a nature research journal';\r\n\r\n    let items = getArticleList(pageCapture);\r\n\r\n    items = await Promise.all(items.map((item) => getArticle(item)));\r\n\r\n    return {\r\n        title: pageCapture('title').text(),\r\n        description: pageDescription,\r\n        link: pageURL,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"6ZAmBA,MAAaA,EAAe,CACxB,KAAM,8BACN,MAAO,CACH,CACI,OAAQ,CAAC,yBAA0B,kBAAmB,eACtD,OAAQ,UAGhB,KAAM,UACN,YAAa,CAAC,MAAO,UACrB,UACA,IAAK,0BAGT,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAU,EAAI,IAAI,MAAM,WACxB,EAAU,GAAG,EAAQ,GAAG,EAAQ,mBAEhC,EAAe,MAAMC,EAAI,EAAS,CAAE,cACpC,EAAc,EAAK,EAAa,MAChC,EAAkB,EAAY,0BAA0B,KAAK,YAAc,oCAE7E,EAAQ,EAAe,GAI3B,MAFA,GAAQ,MAAM,QAAQ,IAAI,EAAM,IAAK,GAAS,EAAW,KAElD,CACH,MAAO,EAAY,SAAS,OAC5B,YAAa,EACb,KAAM,EACN,KAAM"}