{"version":3,"file":"news-BWGoAUF5.js","names":["handler: Route['handler']","got","cache","route: Route"],"sources":["../../lib/routes/ruankao/news.ts"],"sourcesContent":["import type { DataItem, Route } from '@/types';\r\nimport cache from '@/utils/cache';\r\nimport got from '@/utils/got';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport { load } from 'cheerio';\r\nconst BASE_URL = 'https://www.ruankao.org.cn/index/work.html';\r\n\r\nconst removeFontPresetting = (html: string = ''): string => {\r\n    const $ = load(html);\r\n    $('[style]').each((_, element) => {\r\n        const style = $(element).attr('style') || '';\r\n        const cleanedStyle = style.replaceAll(/font-family:[^;]*;?/gi, '').trim();\r\n        $(element).attr('style', cleanedStyle || null);\r\n    });\r\n    $('style').each((_, styleElement) => {\r\n        const cssText = $(styleElement).html() || '';\r\n        const cleanedCssText = cssText.replaceAll(/font-family:[^;]*;?/gi, '');\r\n        $(styleElement).html(cleanedCssText);\r\n    });\r\n\r\n    return $.html();\r\n};\r\n\r\nconst handler: Route['handler'] = async () => {\r\n    // Fetch the index page\r\n    const { data: listResponse } = await got(BASE_URL);\r\n    const $ = load(listResponse);\r\n\r\n    // Select all list items containing news information\r\n    const ITEM_SELECTOR = 'ul[class*=\"newsList\"] > li';\r\n    const listItems = $(ITEM_SELECTOR);\r\n\r\n    // Map through each list item to extract details\r\n    const contentLinkList = listItems.toArray().map((element) => {\r\n        const date = $(element).find('label.time').text().trim().slice(1, -1);\r\n        const title = $(element).find('a').attr('title')!;\r\n        const link = $(element).find('a').attr('href')!;\r\n\r\n        const formattedDate = parseDate(date);\r\n        return {\r\n            date: formattedDate,\r\n            title,\r\n            link,\r\n        };\r\n    });\r\n\r\n    return {\r\n        title: '计算机职业技术资格考试（软考）动态',\r\n        description: '计算机职业技术资格考试（软考）消息推送',\r\n        link: BASE_URL,\r\n        image: 'https://bm.ruankao.org.cn/asset/image/public/logo.png',\r\n        item: (await Promise.all(\r\n            contentLinkList.map((item) =>\r\n                cache.tryGet(item.link, async () => {\r\n                    const CONTENT_SELECTOR = '#contentTxt';\r\n                    const { data: contentResponse } = await got(item.link);\r\n                    const contentPage = load(contentResponse);\r\n                    const content = removeFontPresetting(contentPage(CONTENT_SELECTOR).html() || '');\r\n                    return {\r\n                        title: item.title,\r\n                        pubDate: item.date,\r\n                        link: item.link,\r\n                        description: content,\r\n                        category: ['study'],\r\n                        guid: item.link,\r\n                        id: item.link,\r\n                        image: 'https://bm.ruankao.org.cn/asset/image/public/logo.png',\r\n                        content,\r\n                        updated: item.date,\r\n                        language: 'zh-CN',\r\n                    };\r\n                })\r\n            )\r\n        )) as DataItem[],\r\n        allowEmpty: true,\r\n        language: 'zh-CN',\r\n        feedLink: 'https://rsshub.app/ruankao/news',\r\n        id: 'https://rsshub.app/ruankao/news',\r\n    };\r\n};\r\n\r\nexport const route: Route = {\r\n    path: '/news',\r\n    name: '软考动态',\r\n    description: '**注意：** 官方网站限制了国外网络请求，可能需要通过部署在中国大陆内的 RSSHub 实例访问。',\r\n    maintainers: ['PrinOrange'],\r\n    handler,\r\n    categories: ['study'],\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: true,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n        supportRadar: true,\r\n    },\r\n    radar: [\r\n        {\r\n            title: '计算机职业技术资格考试（软考）动态',\r\n            source: ['www.ruankao.org.cn/index/work', 'www.ruankao.org.cn'],\r\n            target: `/news`,\r\n        },\r\n    ],\r\n    example: '/ruankao/news',\r\n};\r\n"],"mappings":"wWAKA,MAAM,EAAW,6CAEX,GAAwB,EAAe,KAAe,CACxD,IAAM,EAAI,EAAK,GAYf,OAXA,EAAE,WAAW,MAAM,EAAG,IAAY,CAC9B,IAAM,EAAQ,EAAE,GAAS,KAAK,UAAY,GACpC,EAAe,EAAM,WAAW,wBAAyB,IAAI,OACnE,EAAE,GAAS,KAAK,QAAS,GAAgB,QAE7C,EAAE,SAAS,MAAM,EAAG,IAAiB,CACjC,IAAM,EAAU,EAAE,GAAc,QAAU,GACpC,EAAiB,EAAQ,WAAW,wBAAyB,IACnE,EAAE,GAAc,KAAK,KAGlB,EAAE,QAGPA,EAA4B,SAAY,CAE1C,GAAM,CAAE,KAAM,GAAiB,MAAMC,EAAI,GACnC,EAAI,EAAK,GAIT,EAAY,EAAE,8BAGd,EAAkB,EAAU,UAAU,IAAK,GAAY,CACzD,IAAM,EAAO,EAAE,GAAS,KAAK,cAAc,OAAO,OAAO,MAAM,EAAG,IAC5D,EAAQ,EAAE,GAAS,KAAK,KAAK,KAAK,SAClC,EAAO,EAAE,GAAS,KAAK,KAAK,KAAK,QAEjC,EAAgB,EAAU,GAChC,MAAO,CACH,KAAM,EACN,QACA,UAIR,MAAO,CACH,MAAO,oBACP,YAAa,sBACb,KAAM,EACN,MAAO,wDACP,KAAO,MAAM,QAAQ,IACjB,EAAgB,IAAK,GACjBC,EAAM,OAAO,EAAK,KAAM,SAAY,CAChC,GACM,CAAE,KAAM,GAAoB,MAAMD,EAAI,EAAK,MAC3C,EAAc,EAAK,GACnB,EAAU,EAAqB,EAAY,eAAkB,QAAU,IAC7E,MAAO,CACH,MAAO,EAAK,MACZ,QAAS,EAAK,KACd,KAAM,EAAK,KACX,YAAa,EACb,SAAU,CAAC,SACX,KAAM,EAAK,KACX,GAAI,EAAK,KACT,MAAO,wDACP,UACA,QAAS,EAAK,KACd,SAAU,aAK1B,WAAY,GACZ,SAAU,QACV,SAAU,kCACV,GAAI,oCAICE,EAAe,CACxB,KAAM,QACN,KAAM,OACN,YAAa,qDACb,YAAa,CAAC,cACd,UACA,WAAY,CAAC,SACb,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,GACf,aAAc,IAElB,MAAO,CACH,CACI,MAAO,oBACP,OAAQ,CAAC,gCAAiC,sBAC1C,OAAQ,UAGhB,QAAS"}