{"version":3,"file":"czech-news-DcpKWKvi.js","names":["limit: number","baseUrl: string","targetUrl: string","ofetch","$: CheerioAPI","items: DataItem[]","$el: Cheerio<Element>","processedItem: DataItem","cache","$$: CheerioAPI","title: string","description: string | undefined","pubDateStr: string | undefined","categories: string[]","authorEls: Element[]","authors: DataItem['author']","$$authorEl: Cheerio<Element>","image: string | undefined","upDatedStr: string | undefined","route: Route","category: string"],"sources":["../../lib/routes/expats/czech-news.ts"],"sourcesContent":["import { type Data, type DataItem, type Route, ViewType } from '@/types';\r\n\r\nimport cache from '@/utils/cache';\r\nimport ofetch from '@/utils/ofetch';\r\nimport { parseDate } from '@/utils/parse-date';\r\n\r\nimport { type CheerioAPI, type Cheerio, load } from 'cheerio';\r\nimport type { Element } from 'domhandler';\r\nimport { type Context } from 'hono';\r\n\r\nexport const handler = async (ctx: Context): Promise<Data> => {\r\n    const { category = 'daily-news' } = ctx.req.param();\r\n    const limit: number = Number.parseInt(ctx.req.query('limit') ?? '30', 10);\r\n\r\n    const baseUrl: string = 'https://www.expats.cz';\r\n    const targetUrl: string = new URL(`czech-news/${category}`, baseUrl).href;\r\n\r\n    const response = await ofetch(targetUrl);\r\n    const $: CheerioAPI = load(response);\r\n    const language = $('html').attr('lang') ?? 'en';\r\n\r\n    let items: DataItem[] = [];\r\n\r\n    items = $('div.main h3 a')\r\n        .slice(0, limit)\r\n        .toArray()\r\n        .map((el): Element => {\r\n            const $el: Cheerio<Element> = $(el);\r\n\r\n            const processedItem: DataItem = {\r\n                title: $el.text(),\r\n                link: new URL($el.attr('href') as string, baseUrl).href,\r\n                language,\r\n            };\r\n\r\n            return processedItem;\r\n        });\r\n\r\n    items = await Promise.all(\r\n        items.map((item) => {\r\n            if (!item.link) {\r\n                return item;\r\n            }\r\n\r\n            return cache.tryGet(item.link, async (): Promise<DataItem> => {\r\n                const detailResponse = await ofetch(item.link);\r\n                const $$: CheerioAPI = load(detailResponse);\r\n\r\n                $$('div.promo-widget, div.eas').remove();\r\n\r\n                const title: string = $$('div.title h1').text();\r\n                const description: string | undefined = $$('div#expats-article-content').html() ?? undefined;\r\n                const pubDateStr: string | undefined = $$('meta[property=\"article:published_time\"]').attr('content');\r\n                const categories: string[] = [$$('meta[property=\"article:section\"]').attr('content') ?? ''];\r\n                const authorEls: Element[] = $$('span.written-by a').toArray();\r\n                const authors: DataItem['author'] = authorEls.map((authorEl) => {\r\n                    const $$authorEl: Cheerio<Element> = $$(authorEl);\r\n\r\n                    return {\r\n                        name: $$authorEl.text(),\r\n                        url: $$authorEl.attr('href') ? new URL($$authorEl.attr('href') as string, baseUrl).href : undefined,\r\n                        avatar: $$('div.authors div.photos a img').attr('src') ? new URL($$('div.authors div.photos a img').attr('src') as string, baseUrl).href : undefined,\r\n                    };\r\n                });\r\n                const image: string | undefined = $$('meta[property=\"og:image\"]').attr('content');\r\n                const upDatedStr: string | undefined = pubDateStr;\r\n\r\n                const processedItem: DataItem = {\r\n                    title,\r\n                    description,\r\n                    pubDate: pubDateStr ? parseDate(pubDateStr) : item.pubDate,\r\n                    category: categories,\r\n                    author: authors,\r\n                    content: {\r\n                        html: description,\r\n                        text: description,\r\n                    },\r\n                    image,\r\n                    banner: image,\r\n                    updated: upDatedStr ? parseDate(upDatedStr) : item.updated,\r\n                    language,\r\n                };\r\n\r\n                return {\r\n                    ...item,\r\n                    ...processedItem,\r\n                };\r\n            });\r\n        })\r\n    );\r\n\r\n    return {\r\n        title: $('title').text(),\r\n        description: $('meta[property=\"og:description\"]').attr('content'),\r\n        link: targetUrl,\r\n        item: items,\r\n        allowEmpty: true,\r\n        image: $('meta[property=\"og:image\"]').attr('content'),\r\n        author: $('meta[property=\"og:site_name\"]').attr('content'),\r\n        language,\r\n        id: targetUrl,\r\n    };\r\n};\r\n\r\nexport const route: Route = {\r\n    path: '/czech-news/:category?',\r\n    name: 'Czech News',\r\n    url: 'www.expats.cz',\r\n    maintainers: ['nczitzk'],\r\n    handler,\r\n    example: '/expats/czech-news/daily-news',\r\n    parameters: {\r\n        category: {\r\n            description: 'Category, `daily-news` by default',\r\n            options: [\r\n                {\r\n                    label: 'Daily News',\r\n                    value: 'daily-news',\r\n                },\r\n                {\r\n                    label: 'Prague Guide',\r\n                    value: 'prague-guide',\r\n                },\r\n                {\r\n                    label: 'Culture & Events',\r\n                    value: 'culture-events',\r\n                },\r\n                {\r\n                    label: 'Food & Drink',\r\n                    value: 'food-drink',\r\n                },\r\n                {\r\n                    label: 'Expat Life',\r\n                    value: 'expat-life',\r\n                },\r\n                {\r\n                    label: 'Housing',\r\n                    value: 'housing',\r\n                },\r\n                {\r\n                    label: 'Education',\r\n                    value: 'education',\r\n                },\r\n                {\r\n                    label: 'Health',\r\n                    value: 'health',\r\n                },\r\n                {\r\n                    label: 'Work',\r\n                    value: 'work',\r\n                },\r\n                {\r\n                    label: 'Travel',\r\n                    value: 'travel',\r\n                },\r\n                {\r\n                    label: 'Economy',\r\n                    value: 'economy',\r\n                },\r\n                {\r\n                    label: 'Language',\r\n                    value: 'language',\r\n                },\r\n            ],\r\n        },\r\n    },\r\n    description: `:::tip\r\nTo subscribe to [Daily News](https://www.expats.cz/czech-news/daily-news), where the source URL is \\`https://www.expats.cz/czech-news/daily-news\\`, extract the certain parts from this URL to be used as parameters, resulting in the route as [\\`/expats/czech-news/daily-news\\`](https://rsshub.app/expats/czech-news/daily-news).\r\n:::\r\n\r\n<details>\r\n  <summary>More categories</summary>\r\n\r\n| Category                                                      | ID                                                                    |\r\n| ------------------------------------------------------------- | --------------------------------------------------------------------- |\r\n| [Daily News](https://www.expats.cz/czech-news/daily-news)     | [daily-news](https://rsshub.app/expats/czech-news/daily-news)         |\r\n| [Prague Guide](https://www.expats.cz/czech-news/prague-guide) | [prague-guide](https://rsshub.app/expats/czech-news/prague-guide)     |\r\n| [Culture](https://www.expats.cz/czech-news/culture-events)    | [culture-events](https://rsshub.app/expats/czech-news/culture-events) |\r\n| [Food & Drink](https://www.expats.cz/czech-news/food-drink)   | [food-drink](https://rsshub.app/expats/czech-news/food)               |\r\n| [Expat Life](https://www.expats.cz/czech-news/expat-life)     | [expat-life](https://rsshub.app/expats/czech-news/expat-life)         |\r\n| [Housing](https://www.expats.cz/czech-news/housing)           | [housing](https://rsshub.app/expats/czech-news/housing)               |\r\n| [Education](https://www.expats.cz/czech-news/education)       | [education](https://rsshub.app/expats/czech-news/education)           |\r\n| [Health](https://www.expats.cz/czech-news/health)             | [health](https://rsshub.app/expats/czech-news/health)                 |\r\n| [Work](https://www.expats.cz/czech-news/work)                 | [work](https://rsshub.app/expats/czech-news/work)                     |\r\n| [Travel](https://www.expats.cz/czech-news/travel)             | [travel](https://rsshub.app/expats/czech-news/travel)                 |\r\n| [Economy](https://www.expats.cz/czech-news/economy)           | [economy](https://rsshub.app/expats/czech-news/economy)               |\r\n| [Language](https://www.expats.cz/czech-news/language)         | [language](https://rsshub.app/expats/czech-news/language)             |\r\n\r\n</details>\r\n`,\r\n    categories: ['new-media'],\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportRadar: true,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['www.expats.cz/czech-news/:category'],\r\n            target: (params) => {\r\n                const category: string = params.category;\r\n\r\n                return `/expats/czech-news${category ? `/${category}` : ''}`;\r\n            },\r\n        },\r\n        {\r\n            title: 'Daily News',\r\n            source: ['www.expats.cz/czech-news/daily-news'],\r\n            target: '/expats/czech-news/daily-news',\r\n        },\r\n        {\r\n            title: 'Prague Guide',\r\n            source: ['www.expats.cz/czech-news/prague-guide'],\r\n            target: '/expats/czech-news/prague-guide',\r\n        },\r\n        {\r\n            title: 'Culture & Events',\r\n            source: ['www.expats.cz/czech-news/culture-events'],\r\n            target: '/expats/czech-news/culture-events',\r\n        },\r\n        {\r\n            title: 'Food & Drink',\r\n            source: ['www.expats.cz/czech-news/food-drink'],\r\n            target: '/expats/czech-news/food-drink',\r\n        },\r\n        {\r\n            title: 'Expat Life',\r\n            source: ['www.expats.cz/czech-news/expat-life'],\r\n            target: '/expats/czech-news/expat-life',\r\n        },\r\n        {\r\n            title: 'Housing',\r\n            source: ['www.expats.cz/czech-news/housing'],\r\n            target: '/expats/czech-news/housing',\r\n        },\r\n        {\r\n            title: 'Education',\r\n            source: ['www.expats.cz/czech-news/education'],\r\n            target: '/expats/czech-news/education',\r\n        },\r\n        {\r\n            title: 'Health',\r\n            source: ['www.expats.cz/czech-news/health'],\r\n            target: '/expats/czech-news/health',\r\n        },\r\n        {\r\n            title: 'Work',\r\n            source: ['www.expats.cz/czech-news/work'],\r\n            target: '/expats/czech-news/work',\r\n        },\r\n        {\r\n            title: 'Travel',\r\n            source: ['www.expats.cz/czech-news/travel'],\r\n            target: '/expats/czech-news/travel',\r\n        },\r\n        {\r\n            title: 'Economy',\r\n            source: ['www.expats.cz/czech-news/economy'],\r\n            target: '/expats/czech-news/economy',\r\n        },\r\n        {\r\n            title: 'Language',\r\n            source: ['www.expats.cz/czech-news/language'],\r\n            target: '/expats/czech-news/language',\r\n        },\r\n    ],\r\n    view: ViewType.Articles,\r\n};\r\n"],"mappings":"kWAUA,MAAa,EAAU,KAAO,IAAgC,CAC1D,GAAM,CAAE,WAAW,cAAiB,EAAI,IAAI,QACtCA,EAAgB,OAAO,SAAS,EAAI,IAAI,MAAM,UAAY,KAAM,IAEhEC,EAAkB,wBAClBC,EAAoB,IAAI,IAAI,cAAc,IAAY,GAAS,KAE/D,EAAW,MAAMC,EAAO,GACxBC,EAAgB,EAAK,GACrB,EAAW,EAAE,QAAQ,KAAK,SAAW,KAEvCC,EAAoB,GAsExB,MApEA,GAAQ,EAAE,iBACL,MAAM,EAAG,GACT,UACA,IAAK,GAAgB,CAClB,IAAMC,EAAwB,EAAE,GAE1BC,EAA0B,CAC5B,MAAO,EAAI,OACX,KAAM,IAAI,IAAI,EAAI,KAAK,QAAmB,GAAS,KACnD,YAGJ,OAAO,IAGf,EAAQ,MAAM,QAAQ,IAClB,EAAM,IAAK,GACF,EAAK,KAIHC,EAAM,OAAO,EAAK,KAAM,SAA+B,CAC1D,IAAM,EAAiB,MAAML,EAAO,EAAK,MACnCM,EAAiB,EAAK,GAE5B,EAAG,6BAA6B,SAEhC,IAAMC,EAAgB,EAAG,gBAAgB,OACnCC,EAAkC,EAAG,8BAA8B,QAAU,IAAA,GAC7EC,EAAiC,EAAG,2CAA2C,KAAK,WACpFC,EAAuB,CAAC,EAAG,oCAAoC,KAAK,YAAc,IAClFC,EAAuB,EAAG,qBAAqB,UAC/CC,EAA8B,EAAU,IAAK,GAAa,CAC5D,IAAMC,EAA+B,EAAG,GAExC,MAAO,CACH,KAAM,EAAW,OACjB,IAAK,EAAW,KAAK,QAAU,IAAI,IAAI,EAAW,KAAK,QAAmB,GAAS,KAAO,IAAA,GAC1F,OAAQ,EAAG,gCAAgC,KAAK,OAAS,IAAI,IAAI,EAAG,gCAAgC,KAAK,OAAkB,GAAS,KAAO,IAAA,MAG7IC,EAA4B,EAAG,6BAA6B,KAAK,WACjEC,EAAiC,EAEjCX,EAA0B,CAC5B,QACA,cACA,QAAS,EAAa,EAAU,GAAc,EAAK,QACnD,SAAU,EACV,OAAQ,EACR,QAAS,CACL,KAAM,EACN,KAAM,GAEV,QACA,OAAQ,EACR,QAAS,EAAa,EAAU,GAAc,EAAK,QACnD,YAGJ,MAAO,CACH,GAAG,EACH,GAAG,KA5CA,IAkDZ,CACH,MAAO,EAAE,SAAS,OAClB,YAAa,EAAE,mCAAmC,KAAK,WACvD,KAAM,EACN,KAAM,EACN,WAAY,GACZ,MAAO,EAAE,6BAA6B,KAAK,WAC3C,OAAQ,EAAE,iCAAiC,KAAK,WAChD,WACA,GAAI,IAICY,EAAe,CACxB,KAAM,yBACN,KAAM,aACN,IAAK,gBACL,YAAa,CAAC,WACd,UACA,QAAS,gCACT,WAAY,CACR,SAAU,CACN,YAAa,oCACb,QAAS,CACL,CACI,MAAO,aACP,MAAO,cAEX,CACI,MAAO,eACP,MAAO,gBAEX,CACI,MAAO,mBACP,MAAO,kBAEX,CACI,MAAO,eACP,MAAO,cAEX,CACI,MAAO,aACP,MAAO,cAEX,CACI,MAAO,UACP,MAAO,WAEX,CACI,MAAO,YACP,MAAO,aAEX,CACI,MAAO,SACP,MAAO,UAEX,CACI,MAAO,OACP,MAAO,QAEX,CACI,MAAO,SACP,MAAO,UAEX,CACI,MAAO,UACP,MAAO,WAEX,CACI,MAAO,WACP,MAAO,eAKvB,YAAa;;;;;;;;;;;;;;;;;;;;;;;EAwBb,WAAY,CAAC,aACb,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,aAAc,GACd,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,sCACT,OAAS,GAAW,CAChB,IAAMC,EAAmB,EAAO,SAEhC,MAAO,qBAAqB,EAAW,IAAI,IAAa,OAGhE,CACI,MAAO,aACP,OAAQ,CAAC,uCACT,OAAQ,iCAEZ,CACI,MAAO,eACP,OAAQ,CAAC,yCACT,OAAQ,mCAEZ,CACI,MAAO,mBACP,OAAQ,CAAC,2CACT,OAAQ,qCAEZ,CACI,MAAO,eACP,OAAQ,CAAC,uCACT,OAAQ,iCAEZ,CACI,MAAO,aACP,OAAQ,CAAC,uCACT,OAAQ,iCAEZ,CACI,MAAO,UACP,OAAQ,CAAC,oCACT,OAAQ,8BAEZ,CACI,MAAO,YACP,OAAQ,CAAC,sCACT,OAAQ,gCAEZ,CACI,MAAO,SACP,OAAQ,CAAC,mCACT,OAAQ,6BAEZ,CACI,MAAO,OACP,OAAQ,CAAC,iCACT,OAAQ,2BAEZ,CACI,MAAO,SACP,OAAQ,CAAC,mCACT,OAAQ,6BAEZ,CACI,MAAO,UACP,OAAQ,CAAC,oCACT,OAAQ,8BAEZ,CACI,MAAO,WACP,OAAQ,CAAC,qCACT,OAAQ,gCAGhB,KAAM,EAAS"}