{"version":3,"file":"voting-CFiv1e4J.js","names":["route: Route","title: string","description: string","ofetch","title","description"],"sources":["../../lib/routes/openrice/voting.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport ofetch from '@/utils/ofetch';\r\nconst baseUrl = 'https://www.openrice.com';\r\n\r\nexport const route: Route = {\r\n    path: '/:lang/hongkong/voting/top/:categoryKey',\r\n    maintainers: ['after9'],\r\n    handler,\r\n    categories: ['shopping'],\r\n    example: '/openrice/zh/hongkong/voting/top/chinese',\r\n    parameters: { lang: '语言，缺省为 zh', categoryKey: '类别，缺省为 chinese' },\r\n    name: 'OpenRice 開飯熱店 - 年度餐廳投票',\r\n    description: `\r\n  lang: 语言，见下方列表\r\n| 简体 | 繁體 | EN |\r\n| ----- | ------ | ----- |\r\n| zh-cn | zh | en |\r\n\r\n  categoryKey: 部分类别，见下方列表 (更多的类别可以在页面的link中对照获取)\r\n| 中菜館 | 上海菜 | 粵菜 | 川菜 | 港式 | 粥粉麵店 | 廚師發辦 | 韓國菜 | 泰國菜 | 越南菜 |\r\n| -------- | -------- | -------- |  -------- | -------- | -------- | -------- | -------- | -------- | -------- |\r\n| chinese | shanghainese | guangdong | sichuan | hkstyle | congee_noodles | omakase | korean | thai | vietnamese |\r\n  `,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const lang = ctx.req.param('lang') ?? 'zh';\r\n    const categoryKey = ctx.req.param('categoryKey') ?? 'chinese';\r\n\r\n    const apiPath = '/api/v2/voting/search/poi';\r\n    const urlPath = `/${lang}/hongkong/voting/top`;\r\n    let title: string, description: string;\r\n    switch (lang) {\r\n        case 'zh-cn':\r\n            title = 'OpenRice 开饭热店';\r\n            description = 'OpenRice用戶可以在網站或手機應用程式，點擊餐廳頁面中「投票」按鈕，即可完成投票。參加投票的用戶有機會參加大抽獎，贏取豐富獎品。';\r\n            break;\r\n        case 'en':\r\n            title = 'OpenRice Best Restaurant';\r\n            description =\r\n                'OpenRice users can vote by clicking the &quot;Vote&quot; button on the restaurant page on the website or mobile app. Voters will have the opportunity to participate in the grand lottery and win grand prizes.';\r\n            break;\r\n        case 'zh':\r\n        default:\r\n            title = 'OpenRice 開飯熱店';\r\n            description = 'OpenRice用戶可以在網站或手機應用程式，點擊餐廳頁面中「投票」按鈕，即可完成投票。參加投票的用戶有機會參加大抽獎，贏取豐富獎品。';\r\n    }\r\n    const response = await ofetch(baseUrl + apiPath, {\r\n        headers: {\r\n            accept: 'application/json',\r\n        },\r\n        query: {\r\n            uiLang: lang,\r\n            uiCity: 'hongkong',\r\n            categoryKey,\r\n            shortlistIndexLt: 20,\r\n            startAt: 0,\r\n            regionId: 0,\r\n            rows: 20,\r\n            needTag: true,\r\n            _isPrivate: true,\r\n        },\r\n    });\r\n\r\n    const data = response.paginationResult.results;\r\n\r\n    const resultList = data.map((item) => {\r\n        const title = item.name ?? '';\r\n        const link = `${baseUrl}/${lang}/hongkong/r-${item.name}-r${item.poiId}`;\r\n        const description = `${item.district.name}-${item.categories.map((category) => category.name).join('-')}`;\r\n        return {\r\n            title,\r\n            description,\r\n            link,\r\n        };\r\n    });\r\n\r\n    return {\r\n        title,\r\n        link: baseUrl + urlPath,\r\n        description,\r\n        item: resultList,\r\n    };\r\n}\r\n"],"mappings":"2KAEA,MAAM,EAAU,2BAEHA,EAAe,CACxB,KAAM,0CACN,YAAa,CAAC,UACd,UACA,WAAY,CAAC,YACb,QAAS,2CACT,WAAY,CAAE,KAAM,YAAa,YAAa,kBAC9C,KAAM,yBACN,YAAa;;;;;;;;;;KAajB,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAO,EAAI,IAAI,MAAM,SAAW,KAChC,EAAc,EAAI,IAAI,MAAM,gBAAkB,UAG9C,EAAU,IAAI,EAAK,sBACrBC,EAAeC,EACnB,OAAQ,EAAR,CACI,IAAK,QACD,EAAQ,gBACR,EAAc,sEACd,MACJ,IAAK,KACD,EAAQ,2BACR,EACI,kNACJ,MACJ,IAAK,KACL,QACI,EAAQ,gBACR,EAAc,sEAEtB,IAAM,EAAW,MAAMC,EAAO,EAAU,4BAAS,CAC7C,QAAS,CACL,OAAQ,oBAEZ,MAAO,CACH,OAAQ,EACR,OAAQ,WACR,cACA,iBAAkB,GAClB,QAAS,EACT,SAAU,EACV,KAAM,GACN,QAAS,GACT,WAAY,MAId,EAAO,EAAS,iBAAiB,QAEjC,EAAa,EAAK,IAAK,GAAS,CAClC,IAAMC,EAAQ,EAAK,MAAQ,GACrB,EAAO,GAAG,EAAQ,GAAG,EAAK,cAAc,EAAK,KAAK,IAAI,EAAK,QAC3DC,EAAc,GAAG,EAAK,SAAS,KAAK,GAAG,EAAK,WAAW,IAAK,GAAa,EAAS,MAAM,KAAK,OACnG,MAAO,CACH,MAAA,EACA,YAAA,EACA,UAIR,MAAO,CACH,QACA,KAAM,EAAU,EAChB,cACA,KAAM"}