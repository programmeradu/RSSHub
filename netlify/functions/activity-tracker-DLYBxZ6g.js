import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{parseDate as e}from"./parse-date-Bgabdhlb.js";import{ofetch_default as t}from"./ofetch-Bzt0BXUH.js";import{ViewType as n}from"./types-A5bA50Mg.js";import{load as r}from"cheerio";const i=(e,t=30)=>{let n=new URLSearchParams(e);return n.set(`offset`,`0`),n.set(`limit`,t.toString()),n},a=e=>{let t={};for(let[n,r]of e.entries())t[n]=r;return t},o=async n=>{let{filters:o}=n.req.param(),s=Number.parseInt(n.req.query(`limit`)??`30`,10),c=i(o,s),l=`https://digitalpolicyalert.org`,u=new URL(`activity-tracker?${c.toString()}`,l).href,d=new URL(`dpa/intervention`,`https://api.globaltradealert.org`).href,f=await t(d,{query:a(c)}),p=await t(u),m=r(p),h=m(`html`).attr(`lang`)??`en`,g=[];return g=f.results.slice(0,s).map(t=>{let n=t.title,r=t.latest_event?.description??void 0,i=t.latest_event?.date,a=t.slug?`change/${t.slug}`:void 0,o=[...new Set([...t.economic_activities?.map(e=>e.name)??[],...t.implementers?.map(e=>e.name)??[],...t.policies?.map(e=>e.name)??[],t.status?.name,t.type?.name])].filter(Boolean),s=t.implementers?.map(e=>({name:e.name,url:void 0,avatar:void 0}))??void 0,c=i,u={title:n,description:r,pubDate:i?e(i):void 0,link:a?new URL(a,l).href:void 0,category:o,author:s,content:{html:r,text:r},updated:c?e(c):void 0,language:h};return u}),{title:m(`title`).text(),description:m(`meta[property="og:description"]`).attr(`content`),link:u,item:g,allowEmpty:!0,image:m(`meta[property="og:image"]`).attr(`content`)?new URL(m(`meta[property="og:image"]`).attr(`content`),l).href:void 0,author:m(`meta[property="og:site_name"]`).attr(`content`),language:h,id:m(`meta[property="og:url"]`).attr(`content`)}},s={path:`/activity-tracker/:filters?`,name:`Activity Tracker`,url:`digitalpolicyalert.org`,maintainers:[`nczitzk`],handler:o,example:`/digitalpolicyalert/activity-tracker`,parameters:{filter:{description:`Filter, all by default`}},description:":::tip\nTo subscribe to [Activity Tracker - International trade](https://digitalpolicyalert.org/activity-tracker?policy=1), where the source URL is `https://digitalpolicyalert.org/activity-tracker?policy=1`, extract the certain parts from this URL to be used as parameters, resulting in the route as [`/digitalpolicyalert/activity-tracker/policy=1`](https://rsshub.app/digitalpolicyalert/activity-tracker/policy=1).\n:::\n",categories:[`other`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`digitalpolicyalert.org`],target:(e,t)=>{let n=new URL(t),r=i(n.searchParams.toString()).toString();return`/digitalpolicyalert/activity-tracker${r?`/${r}`:``}`}}],view:n.Articles};export{o as handler,s as route};
//# sourceMappingURL=activity-tracker-DLYBxZ6g.js.map