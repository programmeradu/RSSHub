import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{cache_default as e}from"./cache-kimkMTWJ.js";import{parseDate as t}from"./parse-date-Bgabdhlb.js";import{ofetch_default as n}from"./ofetch-Bzt0BXUH.js";import{timezone as r}from"./timezone-BrNu6iXe.js";import{Language as i,Parameter as a,SUPPORTED_LANGUAGES as o}from"./constants-Co2rEYdo.js";import*as s from"cheerio";const c=(e,t)=>{if(typeof e==`number`)return e;if(e===void 0)return t===void 0?NaN:t;let n=Number.parseInt(e,10);return t!==void 0&&Number.isNaN(n)?t:n},l=e=>o.includes(e),u=e=>e===i.Chinese?n(`https://media-cdn-mingchao.kurogame.com/akiwebsite/website2.0/json/G152/zh/ArticleMenu.json`,{query:{t:Date.now()}}):n(`https://hw-media-cdn-mingchao.kurogame.com/akiwebsite/website2.0/json/G152/${e}/MainMenu.json`).then(e=>e.article),d=(e,t)=>e===i.Chinese?`https://media-cdn-mingchao.kurogame.com/akiwebsite/website2.0/json/G152/zh/article/${t}.json`:`https://hw-media-cdn-mingchao.kurogame.com/akiwebsite/website2.0/json/G152/${e}/article/${t}.json`,f=(e,t)=>e===i.Chinese?`https://mc.kurogames.com/main/news/detail/${t}`:`https://wutheringwaves.kurogames.com/${e}/main/news/detail/${t}`,p=e=>{switch(e){case i.English:return`en`;case i.Chinese:return`zh-CN`;case i.ChineseTaiwan:return`zh-TW`;case i.French:return`fr`;case i.German:return`de`;case i.Japanese:return`ja`;case i.Korean:return`ko`;case i.Spanish:return`es`;default:throw Error(`Could not resolve handler language from "${e}"`)}},m={path:`/wutheringwaves/news/:${a.Language}?`,categories:[`game`],example:`/kurogames/wutheringwaves/news`,parameters:{[a.Language]:"The language to use for the content. Default: `zh`."},name:`鸣潮 — 游戏公告、新闻与活动`,radar:[{source:[`mc.kurogames.com/m/main/news`,`mc.kurogames.com/main`]},{title:`Wuthering Waves — Game announcements, news and events`,source:[`wutheringwaves.kurogames.com/en/main/news`,`wutheringwaves.kurogames.com/en/main`]}],maintainers:[`goestav`,`enpitsulin`],description:`
Language codes for the \`${a.Language}\` parameter:

| Language | Code         |
|----------|--------------|
| English  | en           |
| 日本語    | jp           |
| 한국어     | kr           |
| 简体中文   | zh (default) |
| 繁體中文   | zh-tw        |
| Español  | es           |
| Français | fr           |
| Deutsch  | de           |
    `,async handler(m){let h=m.req.query(a.Limit),g=m.req.param(a.Language),_=c(h,30),v=g||i.Chinese;if(!l(v))throw TypeError(`Language parameter is not valid. Please use one of the following: ${o.join(`, `)}`);let y=await u(v),b=y.filter(e=>e.articleType!==0).slice(0,_),x=await Promise.all(b.map(i=>{let a=d(v,i.articleId),o={title:i.articleTitle,pubDate:r(t(i.createTime),8),link:f(v,i.articleId)};return e.tryGet(`wutheringwaves:${v}:${i.articleId}`,async()=>{let e=await n(a,{query:{t:Date.now()}}),t=e.articleContent??``,r=s.load(t);return o.description=r.html()??i.articleDesc??``,o})})),S=v===i.Chinese?`《鸣潮》— 游戏公告、新闻和活动`:`Wuthering Waves - Announcements, News and Events`,C=v===i.Chinese?`https://mc.kurogames.com/main#news`:`https://wutheringwaves.kurogames.com/${v}/main/#news`;return{title:S,link:C,item:x,language:p(v)}}};export{m as route};
//# sourceMappingURL=news-BfcH3-gZ.js.map