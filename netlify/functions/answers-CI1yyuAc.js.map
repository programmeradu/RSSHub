{"version":3,"file":"answers-CI1yyuAc.js","names":["route: Route","got"],"sources":["../../lib/routes/zhihu/answers.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport got from '@/utils/got';\r\nimport { header, getSignedHeader } from './utils';\r\nimport { parseDate } from '@/utils/parse-date';\r\n\r\nexport const route: Route = {\r\n    path: '/people/answers/:id',\r\n    categories: ['social-media'],\r\n    example: '/zhihu/people/answers/diygod',\r\n    parameters: { id: '作者 id，可在用户主页 URL 中找到' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: true,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['www.zhihu.com/people/:id/answers'],\r\n        },\r\n    ],\r\n    name: '用户回答',\r\n    maintainers: ['DIYgod', 'prnake'],\r\n    handler,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const id = ctx.req.param('id');\r\n\r\n    // second: get real data from zhihu\r\n    const apiPath = `/api/v4/members/${id}/answers?limit=7&include=data[*].is_normal,content`;\r\n\r\n    const signedHeader = await getSignedHeader(`https://www.zhihu.com/people/${id}`, apiPath);\r\n\r\n    const response = await got(`https://www.zhihu.com${apiPath}`, {\r\n        headers: {\r\n            ...header,\r\n            ...signedHeader,\r\n            Referer: `https://www.zhihu.com/people/${id}/activities`,\r\n            // Authorization: 'oauth c3cef7c66a1843f8b3a9e6a1e3160e20', // hard-coded in js\r\n        },\r\n    });\r\n\r\n    const data = response.data.data;\r\n    const items = data.map((item) => {\r\n        const title = item.question.title;\r\n        // let description = processImage(detail.content);\r\n        const url = `https://www.zhihu.com/question/${item.question.id}/answer/${item.id}`;\r\n        const author = item.author.name;\r\n        const description = item.content;\r\n\r\n        return {\r\n            title,\r\n            author,\r\n            description,\r\n            pubDate: parseDate(item.created_time * 1000),\r\n            link: url,\r\n        };\r\n    });\r\n\r\n    return {\r\n        title: `${data[0].author.name}的知乎回答`,\r\n        link: `https://www.zhihu.com/people/${id}/answers`,\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"6YAKA,MAAaA,EAAe,CACxB,KAAM,sBACN,WAAY,CAAC,gBACb,QAAS,+BACT,WAAY,CAAE,GAAI,wBAClB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,sCAGjB,KAAM,OACN,YAAa,CAAC,SAAU,UACxB,WAGJ,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAK,EAAI,IAAI,MAAM,MAGnB,EAAU,mBAAmB,EAAG,oDAEhC,EAAe,MAAM,EAAgB,gCAAgC,IAAM,GAE3E,EAAW,MAAMC,EAAI,wBAAwB,IAAW,CAC1D,QAAS,CACL,GAAG,EACH,GAAG,EACH,QAAS,gCAAgC,EAAG,gBAK9C,EAAO,EAAS,KAAK,KACrB,EAAQ,EAAK,IAAK,GAAS,CAC7B,IAAM,EAAQ,EAAK,SAAS,MAEtB,EAAM,kCAAkC,EAAK,SAAS,GAAG,UAAU,EAAK,KACxE,EAAS,EAAK,OAAO,KACrB,EAAc,EAAK,QAEzB,MAAO,CACH,QACA,SACA,cACA,QAAS,EAAU,EAAK,aAAe,KACvC,KAAM,KAId,MAAO,CACH,MAAO,GAAG,EAAK,GAAG,OAAO,KAAK,OAC9B,KAAM,gCAAgC,EAAG,UACzC,KAAM"}