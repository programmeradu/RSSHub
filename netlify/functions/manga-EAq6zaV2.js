import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{cache_default as e}from"./cache-kimkMTWJ.js";import{parseDate as t}from"./parse-date-Bgabdhlb.js";import{ofetch_default as n}from"./ofetch-Bzt0BXUH.js";import{load as r}from"cheerio";const i=async i=>{let{name:a}=i.req.param(),o=Number.parseInt(i.req.query(`limit`),15)||15,s=`https://bakamh.com/manga/${a}/`,c=await n(s),l=r(c),u=JSON.parse(l(`script[type="application/ld+json"]`).text()),d=l(`li.wp-manga-chapter`).toArray().slice(0,o).map(e=>{let t=l(e),n=t.find(`i`).text().replaceAll(` `,``);return{title:t.find(`a`).text(),link:t.find(`a`).attr(`href`),guid:t.find(`a`).attr(`href`),pubDate:n}});d.length>0&&(d[0].pubDate=u.dateModified);let f=await Promise.all(d.map(i=>e.tryGet(i.link,async()=>{let e=await n(i.link),a=r(e),o=a(`div.reading-content img`),s=a(`<div class="image-container"></div>`);return o.appendTo(s),i.description=s.html(),i.pubDate=t(i.pubDate,`YYYY年M月D日`),i})));return{title:l(`title`).text(),link:s,description:l(`.post-content_item p`).text(),image:l(`.summary_image a img`).attr(`src`),item:f}},a={path:`/manga/:name`,categories:[`anime`],example:`/bakamh/manga/最强家丁`,parameters:{name:`漫画名称，漫画主页的地址栏中`},radar:[{source:[`bakamh.com/manga/:name/`]}],name:`漫画更新`,maintainers:[`yoyobase`],handler:i,url:`bakamh.com`};export{a as route};
//# sourceMappingURL=manga-EAq6zaV2.js.map