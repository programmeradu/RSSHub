import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{cache_default as e}from"./cache-kimkMTWJ.js";import{parseDate as t}from"./parse-date-Bgabdhlb.js";import{ofetch_default as n}from"./ofetch-Bzt0BXUH.js";import*as r from"cheerio";const i={path:`/user/:pphId`,categories:[`new-media`],example:`/thepaper/user/4221423`,parameters:{pphId:`澎湃号 id，可在澎湃号页 URL 中找到`},name:`澎湃号`,maintainers:[`TonyRL`],handler:a};async function a(i){let{pphId:a}=i.req.param(),o=await e.tryGet(`thepaper:m:buildId`,async()=>{let e=await n(`https://m.thepaper.cn`),t=r.load(e),i=JSON.parse(t(`script#__NEXT_DATA__`).text());return i.buildId}),s=await e.tryGet(`thepaper:user:${a}`,async()=>{let e=await n(`https://api.thepaper.cn/userservice/user/homePage/${a}`,{headers:{"Client-Type":`2`,Origin:`https://m.thepaper.cn`,Referer:`https://m.thepaper.cn/`}});return e.userInfo}),c=await n(`https://api.thepaper.cn/contentapi/cont/pph/user`,{method:`POST`,body:{pageSize:10,pageNum:1,contType:0,excludeContIds:[],pphId:a,startTime:0}}),l=c.data.list.map(e=>({title:e.name,link:`https://www.thepaper.cn/newsDetail_forward_${e.contId}`,pubDate:t(e.pubTimeLong),author:e.authorInfo.sname,contId:e.contId,image:e.pic})),u=await Promise.all(l.map(r=>e.tryGet(r.link,async()=>{let e=await n(`https://m.thepaper.cn/_next/data/${o}/detail/${r.contId}.json`,{query:{id:r.contId}});return r.description=e.pageProps.detailData.contentDetail.content,r.updated=t(e.pageProps.detailData.contentDetail.updateTime),r})));return{title:s.sname,description:s.perDesc,link:`https://www.thepaper.cn/user_${a}`,item:u,itunes_author:s.sname,image:s.pic}}export{i as route};
//# sourceMappingURL=user-DAY8fs2A.js.map