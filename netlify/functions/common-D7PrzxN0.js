import{config as e}from"./config-Dl8a1sIg.js";import{cache_default as t}from"./cache-kimkMTWJ.js";import{parseDate as n}from"./parse-date-Bgabdhlb.js";import{got_default as r}from"./got-CdvI2yKX.js";import{timezone as i}from"./timezone-BrNu6iXe.js";import{load as a}from"cheerio";import o from"crypto-js";function s(n){return t.tryGet(`sis001:cookie`,async()=>{let e=await r(n),t=e.data,i=/toNumbers\("([a-fA-F0-9]+)"\)/g,a=[],s;for(;(s=i.exec(t))!==null;)a.push(s[1]);if(a.length!==3)return``;let c=o.enc.Hex.parse(a[0]),l=o.enc.Hex.parse(a[1]),u=o.enc.Hex.parse(a[2]),d=o.AES.decrypt({ciphertext:u},c,{iv:l,padding:o.pad.NoPadding});return`CeRaHigh1=`+d.toString(o.enc.Hex)},e.cache.routeExpire,!1)}async function c(e,t){let o=await r(t.link,{headers:{cookie:e}}),s=a(o.data);return t.guid=t.link?.replace(/^https?:\/\/.+?\//,`https://www.sis001.com/`),t.category=s(`.posttags a`).toArray().map(e=>s(e).text()),t.pubDate=i(n(s(`.postinfo`).eq(0).text().match(/发表于 (.*)\s*只看该作者/)[1],`YYYY-M-D HH:mm`),8),s(`div[id^=postmessage_] table, fieldset, .posttags, strong font, span:empty`).remove(),t.description=s(`div[id^=postmessage_]`).eq(0).html()?.replaceAll(`
`,``).replaceAll(/\u3000{2}.+?(((?:<br>){2})|(&nbsp;))/g,e=>`<p>${e.replaceAll(`<br>`,``)}</p>`).replaceAll(/<p>\u3000{6,}(.+?)<\/p>/g,`<center><p style="text-align:center;">$1</p></center>`).replaceAll(`&nbsp;`,``).replace(/<br><br> +<br><br>/,``)+(s(`.defaultpost .postattachlist`).html()??``),t}export{s as getCookie,c as getThread};
//# sourceMappingURL=common-D7PrzxN0.js.map