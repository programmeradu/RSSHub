{"version":3,"file":"utils-DHPSiFDz.js","names":["got"],"sources":["../../lib/routes/vocus/utils.ts"],"sourcesContent":["import got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\nimport { parseDate } from '@/utils/parse-date';\r\n\r\nconst baseUrl = 'https://vocus.cc';\r\nconst apiUrl = 'https://api.vocus.cc';\r\n\r\nconst processList = (articleData) =>\r\n    articleData.map((item) => ({\r\n        title: item.title,\r\n        description: item.abstract,\r\n        pubDate: parseDate(item.createdAt),\r\n        link: `${baseUrl}/article/${item._id}`,\r\n        author: item.user.fullname,\r\n        _id: item._id,\r\n    }));\r\n\r\nconst ProcessFeed = (list, tryGet) =>\r\n    Promise.all(\r\n        list.map((item) =>\r\n            tryGet(item.link, async () => {\r\n                const {\r\n                    data: { article },\r\n                } = await got(`${apiUrl}/api/article/${item._id}`, {\r\n                    headers: {\r\n                        referer: item.link,\r\n                    },\r\n                });\r\n\r\n                const $ = load(article.content, null, false);\r\n\r\n                $('div.draft--imgNormal').each((_, elem) => (elem.name = 'figure'));\r\n                $('.image-block-prerender').each((_, elem) => {\r\n                    elem.name = 'img';\r\n                    elem.attribs.src = elem.attribs['data-src'].split('?')[0];\r\n                });\r\n\r\n                item.description = $.html();\r\n                item.category = article.tags?.map((tag) => tag.title);\r\n\r\n                return item;\r\n            })\r\n        )\r\n    );\r\n\r\nexport { processList, ProcessFeed, baseUrl, apiUrl };\r\n"],"mappings":"oIAIA,MAAM,EAAU,mBACV,EAAS,uBAET,EAAe,GACjB,EAAY,IAAK,IAAU,CACvB,MAAO,EAAK,MACZ,YAAa,EAAK,SAClB,QAAS,EAAU,EAAK,WACxB,KAAM,GAAG,EAAQ,WAAW,EAAK,MACjC,OAAQ,EAAK,KAAK,SAClB,IAAK,EAAK,OAGZ,GAAe,EAAM,IACvB,QAAQ,IACJ,EAAK,IAAK,GACN,EAAO,EAAK,KAAM,SAAY,CAC1B,GAAM,CACF,KAAM,CAAE,YACR,MAAMA,EAAI,GAAG,EAAO,eAAe,EAAK,MAAO,CAC/C,QAAS,CACL,QAAS,EAAK,QAIhB,EAAI,EAAK,EAAQ,QAAS,KAAM,IAWtC,OATA,EAAE,wBAAwB,MAAM,EAAG,IAAU,EAAK,KAAO,UACzD,EAAE,0BAA0B,MAAM,EAAG,IAAS,CAC1C,EAAK,KAAO,MACZ,EAAK,QAAQ,IAAM,EAAK,QAAQ,YAAY,MAAM,KAAK,KAG3D,EAAK,YAAc,EAAE,OACrB,EAAK,SAAW,EAAQ,MAAM,IAAK,GAAQ,EAAI,OAExC"}