import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{cache_default as n}from"./cache-kimkMTWJ.js";import{art as r}from"./render-CxhTJIsl.js";import{parseDate as i}from"./parse-date-Bgabdhlb.js";import{ofetch_default as a}from"./ofetch-Bzt0BXUH.js";import{timezone as o}from"./timezone-BrNu6iXe.js";import{ViewType as s}from"./types-A5bA50Mg.js";import c from"node:path";import{load as l}from"cheerio";t();const u=async t=>{let s=Number.parseInt(t.req.query(`limit`)??`10`,10),u=`https://musikguru.de`,d=new URL(`news/`,u).href,f=await a(d),p=l(f),m=p(`html`).attr(`lang`)??`de`,h=[];return h=p(`section`).eq(1).find(`div.card`).slice(0,s).toArray().map(t=>{let n=p(t),i=n.find(`h5.card-title`).text(),a=n.find(`img`).attr(`src`),o=r(c.join(e,`templates/description-b958bde9.art`),{images:a?[{src:a,alt:i}]:void 0,intro:n.find(`p.card-text`).text()}),s=n.find(`a`).first().attr(`href`),l={title:i,description:o,link:s?new URL(s,u).href:void 0,content:{html:o,text:o},image:a,banner:a,language:m};return l}),h=await Promise.all(h.map(t=>t.link?n.tryGet(t.link,async()=>{let n=await a(t.link),s=l(n),u=s(`div.article h1`).text(),d=t.description+r(c.join(e,`templates/description-b958bde9.art`),{description:(s(`p.lead`).html()??``)+(s(`div.lead`).html()??``)}),f=s(`div.article div.text-muted`).text().split(/\sUhr/)?.[0],p=s(`div.article img`).first().attr(`src`),h=f,g={title:u,description:d,pubDate:f?o(i(f,`DD.MM.YYYY HH:mm`),1):t.pubDate,content:{html:d,text:d},image:p,banner:p,updated:h?o(i(h,`DD.MM.YYYY HH:mm`),1):t.updated,language:m};return{...t,...g}}):t)),{title:p(`title`).text(),description:p(`meta[name="description"]`).attr(`content`),link:d,item:h,allowEmpty:!0,image:p(`a.navbar-brand img`).attr(`src`)?new URL(p(`a.navbar-brand img`).attr(`src`),u).href:void 0,author:p(`a.navbar-brand img`).attr(`alt`),language:m,id:d}},d={path:`/news`,name:`News`,url:`musikguru.de`,maintainers:[`nczitzk`],handler:u,example:`/musikguru/news`,parameters:void 0,description:void 0,categories:[`multimedia`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`musikguru.de/news`],target:`news`}],view:s.Articles};export{u as handler,d as route};
//# sourceMappingURL=news-DW5j24EW.js.map