import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as e}from"./cache-kimkMTWJ.js";import"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as t}from"./got-CdvI2yKX.js";import{ViewType as n}from"./types-A5bA50Mg.js";import{constructTopicEntry as r,topicDataHanding as i}from"./utils-C2n-5NTQ.js";import a from"dayjs";import{load as o}from"cheerio";const s=/(https?:\/\/[^\s"'<>]+)/g,c={path:`/topic/:id/:showUid?`,categories:[`social-media`],view:n.SocialMedia,example:`/jike/topic/556688fae4b00c57d9dd46ee`,parameters:{id:`圈子 id, 可在即刻 web 端圈子页或 APP 分享出来的圈子页 URL 中找到`,showUid:{description:`是否在内容中显示用户信息，设置为 1 则开启`,options:[{value:`1`,label:`显示`}]}},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`web.okjike.com/topic/:id`],target:`/topic/:id`}],name:`圈子`,maintainers:[`DIYgod`,`prnake`],handler:l};async function l(n){let c=n.req.param(`id`),l=`https://m.okjike.com/topics/${c}`,u=await r(n,l);if(u){let r=u.result;return r.item=i(u,n),(c===`553870e8e4b0cafb0a1bef68`||c===`55963702e4b0d84d2c30ce6f`)&&(r.item=await Promise.all(r.item.map(async n=>{let r={...n},i=/https:\/\/www\.okjike\.com\/medium\/[\dA-Za-z]*/.exec(r.description);if(i){let n=i[0];r.description=await e.tryGet(n,async()=>{let{data:e}=await t(n),r=o(e),i=r(`ul.main > li.item`),a=i.find(`a`).map((e,t)=>r(t).attr(`href`)),s=i.find(`span.text`).map((e,t)=>r(t).text()),c=``;for(let[e,t]of a.entries())c+=`${e+1}、<a href="${t}">${s[e]}</a><br>`;return c=c.replace(/<br>$/,``),c})}return r.description=r.description.replaceAll(s,e=>`<a href="${e}">${e}</a>`),r.title=`${u.topic.content} ${a(n.pubDate).format(`MM月DD日`)}`,r}))),r}}export{c as route};
//# sourceMappingURL=topic-CIF9QBZn.js.map