{"version":3,"file":"deadbydaylight-BXSNCY_y.js","names":["MarkdownIt","route: Route","ofetch","cache"],"sources":["../../lib/routes/deadbydaylight/index.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport cache from '@/utils/cache';\r\nimport ofetch from '@/utils/ofetch';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport MarkdownIt from 'markdown-it';\r\nconst md = MarkdownIt({\r\n    html: true,\r\n    linkify: true,\r\n});\r\n\r\nconst baseUrl = 'https://deadbydaylight.com';\r\n\r\nexport const route: Route = {\r\n    path: '/blog',\r\n    categories: ['game'],\r\n    example: '/deadbydaylight/blog',\r\n    parameters: {},\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['deadbydaylight.com/news'],\r\n            target: '/news',\r\n        },\r\n    ],\r\n    name: 'Latest News',\r\n    maintainers: ['NeverBehave'],\r\n    handler,\r\n};\r\n\r\nasync function handler() {\r\n    const data = await ofetch(`${baseUrl}/page-data/news/page-data.json`);\r\n\r\n    const articleMeta = data.result.pageContext.postsData.articles.edges;\r\n    // { 0: node: { id, locale, slug, title, excerpt, image, published_at, article_category}}\r\n\r\n    const items = await Promise.all(\r\n        Object.keys(articleMeta).map((id) => {\r\n            const content = articleMeta[id].node;\r\n            const slug = content.slug;\r\n            const dataUrl = `${baseUrl}/page-data/news/${slug}/page-data.json`;\r\n\r\n            return cache.tryGet(dataUrl, async () => {\r\n                const articleData = await ofetch(dataUrl);\r\n                const pageData = articleData.result.data.pageData;\r\n\r\n                return {\r\n                    title: pageData.title,\r\n                    link: `${baseUrl}${articleData.path}`,\r\n                    description: md.render(pageData.content),\r\n                    pubDate: parseDate(pageData.published_at),\r\n                    category: pageData.article_category.name,\r\n                };\r\n            });\r\n        })\r\n    );\r\n\r\n    return {\r\n        title: 'Latest News',\r\n        link: 'https://deadbydaylight.com/news',\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"+SAKA,MAAM,EAAKA,EAAW,CAClB,KAAM,GACN,QAAS,KAGP,EAAU,6BAEHC,EAAe,CACxB,KAAM,QACN,WAAY,CAAC,QACb,QAAS,uBACT,WAAY,GACZ,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,2BACT,OAAQ,UAGhB,KAAM,cACN,YAAa,CAAC,eACd,WAGJ,eAAe,GAAU,CACrB,IAAM,EAAO,MAAMC,EAAO,GAAG,EAAQ,iCAE/B,EAAc,EAAK,OAAO,YAAY,UAAU,SAAS,MAGzD,EAAQ,MAAM,QAAQ,IACxB,OAAO,KAAK,GAAa,IAAK,GAAO,CACjC,IAAM,EAAU,EAAY,GAAI,KAC1B,EAAO,EAAQ,KACf,EAAU,GAAG,EAAQ,kBAAkB,EAAK,iBAElD,OAAOC,EAAM,OAAO,EAAS,SAAY,CACrC,IAAM,EAAc,MAAMD,EAAO,GAC3B,EAAW,EAAY,OAAO,KAAK,SAEzC,MAAO,CACH,MAAO,EAAS,MAChB,KAAM,GAAG,IAAU,EAAY,OAC/B,YAAa,EAAG,OAAO,EAAS,SAChC,QAAS,EAAU,EAAS,cAC5B,SAAU,EAAS,iBAAiB,WAMpD,MAAO,CACH,MAAO,cACP,KAAM,kCACN,KAAM"}