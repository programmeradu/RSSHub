{"version":3,"file":"discover-O6Pwy7j1.js","names":["ofetch","route: Route"],"sources":["../../lib/routes/aibase/discover.ts"],"sourcesContent":["import { Route } from '@/types';\r\n\r\nimport ofetch from '@/utils/ofetch';\r\nimport { load } from 'cheerio';\r\n\r\nimport { rootUrl, buildApiUrl, processItems } from './util';\r\n\r\nexport const handler = async (ctx) => {\r\n    const { id } = ctx.req.param();\r\n\r\n    const [pid, sid] = id?.split(/-/) ?? [undefined, undefined];\r\n\r\n    const limit = Number.parseInt(ctx.req.query('limit') ?? '30', 10);\r\n\r\n    const currentUrl = new URL(`discover${id ? `/${id}` : ''}`, rootUrl).href;\r\n\r\n    const currentHtml = await ofetch(currentUrl);\r\n\r\n    const $ = load(currentHtml);\r\n\r\n    const { apiRecommListUrl, apiRecommProcUrl, apiTagProcUrl } = await buildApiUrl($);\r\n\r\n    let ptag, stag;\r\n    let isTag = !!(pid && sid);\r\n\r\n    if (isTag) {\r\n        const apiRecommList = await ofetch(apiRecommListUrl);\r\n\r\n        const recommList = apiRecommList?.data?.results ?? [];\r\n\r\n        const parentTag = recommList.find((t) => String(t.Id) === pid);\r\n        const subTag = parentTag ? parentTag.sublist.find((t) => String(t.Id) === sid) : undefined;\r\n\r\n        ptag = parentTag?.tag ?? parentTag?.alias ?? undefined;\r\n        stag = subTag?.tag ?? subTag?.alias ?? undefined;\r\n\r\n        isTag = !!(ptag && stag);\r\n    }\r\n\r\n    const query = {\r\n        page: 1,\r\n        pagesize: limit,\r\n        ticket: '',\r\n    };\r\n\r\n    const {\r\n        data: { results: apiProcs },\r\n    } = await (isTag\r\n        ? ofetch(apiRecommProcUrl, {\r\n              query: {\r\n                  ...query,\r\n                  ptag,\r\n                  stag,\r\n              },\r\n          })\r\n        : ofetch(apiTagProcUrl, {\r\n              query: {\r\n                  ...query,\r\n                  f: 'id',\r\n                  o: 'desc',\r\n              },\r\n          }));\r\n\r\n    const items = processItems(apiProcs?.slice(0, limit) ?? []);\r\n\r\n    const image = new URL($('img.logo').prop('src'), rootUrl).href;\r\n\r\n    const author = $('title').text().split(/_/).pop();\r\n\r\n    return {\r\n        title: `${author}${isTag ? ` | ${ptag} - ${stag}` : ''}`,\r\n        description: $('meta[property=\"og:description\"]').prop('content'),\r\n        link: currentUrl,\r\n        item: items,\r\n        allowEmpty: true,\r\n        image,\r\n        author,\r\n    };\r\n};\r\n\r\nexport const route: Route = {\r\n    path: '/discover/:id?',\r\n    name: '发现',\r\n    url: 'top.aibase.com',\r\n    maintainers: ['nczitzk'],\r\n    handler,\r\n    example: '/aibase/discover',\r\n    parameters: { id: '发现分类，默认为空，即全部产品，可在对应发现分类页 URL 中找到' },\r\n    description: `::: tip\r\n  若订阅 [图片背景移除](https://top.aibase.com/discover/37-49)，网址为 \\`https://top.aibase.com/discover/37-49\\`。截取 \\`https://top.aibase.com/discover/\\` 到末尾的部分 \\`37-49\\` 作为参数填入，此时路由为 [\\`/aibase/discover/37-49\\`](https://rsshub.app/aibase/discover/37-49)。\r\n:::\r\n\r\n<details>\r\n<summary>更多分类</summary>\r\n\r\n#### 图像处理\r\n\r\n| 分类                                                  | ID                                                |\r\n| ----------------------------------------------------- | ------------------------------------------------- |\r\n| [图片背景移除](https://top.aibase.com/discover/37-49) | [37-49](https://rsshub.app/aibase/discover/37-49) |\r\n| [图片无损放大](https://top.aibase.com/discover/37-50) | [37-50](https://rsshub.app/aibase/discover/37-50) |\r\n| [图片AI修复](https://top.aibase.com/discover/37-51)   | [37-51](https://rsshub.app/aibase/discover/37-51) |\r\n| [图像生成](https://top.aibase.com/discover/37-52)     | [37-52](https://rsshub.app/aibase/discover/37-52) |\r\n| [Ai图片拓展](https://top.aibase.com/discover/37-53)   | [37-53](https://rsshub.app/aibase/discover/37-53) |\r\n| [Ai漫画生成](https://top.aibase.com/discover/37-54)   | [37-54](https://rsshub.app/aibase/discover/37-54) |\r\n| [Ai生成写真](https://top.aibase.com/discover/37-55)   | [37-55](https://rsshub.app/aibase/discover/37-55) |\r\n| [电商图片制作](https://top.aibase.com/discover/37-83) | [37-83](https://rsshub.app/aibase/discover/37-83) |\r\n| [Ai图像转视频](https://top.aibase.com/discover/37-86) | [37-86](https://rsshub.app/aibase/discover/37-86) |\r\n\r\n#### 视频创作\r\n\r\n| 分类                                                | ID                                                |\r\n| --------------------------------------------------- | ------------------------------------------------- |\r\n| [视频剪辑](https://top.aibase.com/discover/38-56)   | [38-56](https://rsshub.app/aibase/discover/38-56) |\r\n| [生成视频](https://top.aibase.com/discover/38-57)   | [38-57](https://rsshub.app/aibase/discover/38-57) |\r\n| [Ai动画制作](https://top.aibase.com/discover/38-58) | [38-58](https://rsshub.app/aibase/discover/38-58) |\r\n| [字幕生成](https://top.aibase.com/discover/38-84)   | [38-84](https://rsshub.app/aibase/discover/38-84) |\r\n\r\n#### 效率助手\r\n\r\n| 分类                                                | ID                                                |\r\n| --------------------------------------------------- | ------------------------------------------------- |\r\n| [AI文档工具](https://top.aibase.com/discover/39-59) | [39-59](https://rsshub.app/aibase/discover/39-59) |\r\n| [PPT](https://top.aibase.com/discover/39-60)        | [39-60](https://rsshub.app/aibase/discover/39-60) |\r\n| [思维导图](https://top.aibase.com/discover/39-61)   | [39-61](https://rsshub.app/aibase/discover/39-61) |\r\n| [表格处理](https://top.aibase.com/discover/39-62)   | [39-62](https://rsshub.app/aibase/discover/39-62) |\r\n| [Ai办公助手](https://top.aibase.com/discover/39-63) | [39-63](https://rsshub.app/aibase/discover/39-63) |\r\n\r\n#### 写作灵感\r\n\r\n| 分类                                              | ID                                                |\r\n| ------------------------------------------------- | ------------------------------------------------- |\r\n| [文案写作](https://top.aibase.com/discover/40-64) | [40-64](https://rsshub.app/aibase/discover/40-64) |\r\n| [论文写作](https://top.aibase.com/discover/40-88) | [40-88](https://rsshub.app/aibase/discover/40-88) |\r\n\r\n#### 艺术灵感\r\n\r\n| 分类                                                | ID                                                |\r\n| --------------------------------------------------- | ------------------------------------------------- |\r\n| [音乐创作](https://top.aibase.com/discover/41-65)   | [41-65](https://rsshub.app/aibase/discover/41-65) |\r\n| [设计创作](https://top.aibase.com/discover/41-66)   | [41-66](https://rsshub.app/aibase/discover/41-66) |\r\n| [Ai图标生成](https://top.aibase.com/discover/41-67) | [41-67](https://rsshub.app/aibase/discover/41-67) |\r\n\r\n#### 趣味\r\n\r\n| 分类                                                  | ID                                                |\r\n| ----------------------------------------------------- | ------------------------------------------------- |\r\n| [Ai名字生成器](https://top.aibase.com/discover/42-68) | [42-68](https://rsshub.app/aibase/discover/42-68) |\r\n| [游戏娱乐](https://top.aibase.com/discover/42-71)     | [42-71](https://rsshub.app/aibase/discover/42-71) |\r\n| [其他](https://top.aibase.com/discover/42-72)         | [42-72](https://rsshub.app/aibase/discover/42-72) |\r\n\r\n#### 开发编程\r\n\r\n| 分类                                                | ID                                                |\r\n| --------------------------------------------------- | ------------------------------------------------- |\r\n| [开发编程](https://top.aibase.com/discover/43-73)   | [43-73](https://rsshub.app/aibase/discover/43-73) |\r\n| [Ai开放平台](https://top.aibase.com/discover/43-74) | [43-74](https://rsshub.app/aibase/discover/43-74) |\r\n| [Ai算力平台](https://top.aibase.com/discover/43-75) | [43-75](https://rsshub.app/aibase/discover/43-75) |\r\n\r\n#### 聊天机器人\r\n\r\n| 分类                                              | ID                                                |\r\n| ------------------------------------------------- | ------------------------------------------------- |\r\n| [智能聊天](https://top.aibase.com/discover/44-76) | [44-76](https://rsshub.app/aibase/discover/44-76) |\r\n| [智能客服](https://top.aibase.com/discover/44-77) | [44-77](https://rsshub.app/aibase/discover/44-77) |\r\n\r\n#### 翻译\r\n\r\n| 分类                                          | ID                                                |\r\n| --------------------------------------------- | ------------------------------------------------- |\r\n| [翻译](https://top.aibase.com/discover/46-79) | [46-79](https://rsshub.app/aibase/discover/46-79) |\r\n\r\n#### 教育学习\r\n\r\n| 分类                                              | ID                                                |\r\n| ------------------------------------------------- | ------------------------------------------------- |\r\n| [教育学习](https://top.aibase.com/discover/47-80) | [47-80](https://rsshub.app/aibase/discover/47-80) |\r\n\r\n#### 智能营销\r\n\r\n| 分类                                              | ID                                                |\r\n| ------------------------------------------------- | ------------------------------------------------- |\r\n| [智能营销](https://top.aibase.com/discover/48-81) | [48-81](https://rsshub.app/aibase/discover/48-81) |\r\n\r\n#### 法律\r\n\r\n| 分类                                            | ID                                                    |\r\n| ----------------------------------------------- | ----------------------------------------------------- |\r\n| [法律](https://top.aibase.com/discover/138-139) | [138-139](https://rsshub.app/aibase/discover/138-139) |\r\n</details>\r\n    `,\r\n    categories: ['new-media'],\r\n\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportRadar: true,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['top.aibase.com/discover/:id'],\r\n            target: (params) => {\r\n                const id = params.id;\r\n\r\n                return `/discover${id ? `/${id}` : ''}`;\r\n            },\r\n        },\r\n        {\r\n            title: '图像处理 - 图片背景移除',\r\n            source: ['top.aibase.com/discover/37-49'],\r\n            target: '/discover/37-49',\r\n        },\r\n        {\r\n            title: '图像处理 - 图片无损放大',\r\n            source: ['top.aibase.com/discover/37-50'],\r\n            target: '/discover/37-50',\r\n        },\r\n        {\r\n            title: '图像处理 - 图片AI修复',\r\n            source: ['top.aibase.com/discover/37-51'],\r\n            target: '/discover/37-51',\r\n        },\r\n        {\r\n            title: '图像处理 - 图像生成',\r\n            source: ['top.aibase.com/discover/37-52'],\r\n            target: '/discover/37-52',\r\n        },\r\n        {\r\n            title: '图像处理 - Ai图片拓展',\r\n            source: ['top.aibase.com/discover/37-53'],\r\n            target: '/discover/37-53',\r\n        },\r\n        {\r\n            title: '图像处理 - Ai漫画生成',\r\n            source: ['top.aibase.com/discover/37-54'],\r\n            target: '/discover/37-54',\r\n        },\r\n        {\r\n            title: '图像处理 - Ai生成写真',\r\n            source: ['top.aibase.com/discover/37-55'],\r\n            target: '/discover/37-55',\r\n        },\r\n        {\r\n            title: '图像处理 - 电商图片制作',\r\n            source: ['top.aibase.com/discover/37-83'],\r\n            target: '/discover/37-83',\r\n        },\r\n        {\r\n            title: '图像处理 - Ai图像转视频',\r\n            source: ['top.aibase.com/discover/37-86'],\r\n            target: '/discover/37-86',\r\n        },\r\n        {\r\n            title: '视频创作 - 视频剪辑',\r\n            source: ['top.aibase.com/discover/38-56'],\r\n            target: '/discover/38-56',\r\n        },\r\n        {\r\n            title: '视频创作 - 生成视频',\r\n            source: ['top.aibase.com/discover/38-57'],\r\n            target: '/discover/38-57',\r\n        },\r\n        {\r\n            title: '视频创作 - Ai动画制作',\r\n            source: ['top.aibase.com/discover/38-58'],\r\n            target: '/discover/38-58',\r\n        },\r\n        {\r\n            title: '视频创作 - 字幕生成',\r\n            source: ['top.aibase.com/discover/38-84'],\r\n            target: '/discover/38-84',\r\n        },\r\n        {\r\n            title: '效率助手 - AI文档工具',\r\n            source: ['top.aibase.com/discover/39-59'],\r\n            target: '/discover/39-59',\r\n        },\r\n        {\r\n            title: '效率助手 - PPT',\r\n            source: ['top.aibase.com/discover/39-60'],\r\n            target: '/discover/39-60',\r\n        },\r\n        {\r\n            title: '效率助手 - 思维导图',\r\n            source: ['top.aibase.com/discover/39-61'],\r\n            target: '/discover/39-61',\r\n        },\r\n        {\r\n            title: '效率助手 - 表格处理',\r\n            source: ['top.aibase.com/discover/39-62'],\r\n            target: '/discover/39-62',\r\n        },\r\n        {\r\n            title: '效率助手 - Ai办公助手',\r\n            source: ['top.aibase.com/discover/39-63'],\r\n            target: '/discover/39-63',\r\n        },\r\n        {\r\n            title: '写作灵感 - 文案写作',\r\n            source: ['top.aibase.com/discover/40-64'],\r\n            target: '/discover/40-64',\r\n        },\r\n        {\r\n            title: '写作灵感 - 论文写作',\r\n            source: ['top.aibase.com/discover/40-88'],\r\n            target: '/discover/40-88',\r\n        },\r\n        {\r\n            title: '艺术灵感 - 音乐创作',\r\n            source: ['top.aibase.com/discover/41-65'],\r\n            target: '/discover/41-65',\r\n        },\r\n        {\r\n            title: '艺术灵感 - 设计创作',\r\n            source: ['top.aibase.com/discover/41-66'],\r\n            target: '/discover/41-66',\r\n        },\r\n        {\r\n            title: '艺术灵感 - Ai图标生成',\r\n            source: ['top.aibase.com/discover/41-67'],\r\n            target: '/discover/41-67',\r\n        },\r\n        {\r\n            title: '趣味 - Ai名字生成器',\r\n            source: ['top.aibase.com/discover/42-68'],\r\n            target: '/discover/42-68',\r\n        },\r\n        {\r\n            title: '趣味 - 游戏娱乐',\r\n            source: ['top.aibase.com/discover/42-71'],\r\n            target: '/discover/42-71',\r\n        },\r\n        {\r\n            title: '趣味 - 其他',\r\n            source: ['top.aibase.com/discover/42-72'],\r\n            target: '/discover/42-72',\r\n        },\r\n        {\r\n            title: '开发编程 - 开发编程',\r\n            source: ['top.aibase.com/discover/43-73'],\r\n            target: '/discover/43-73',\r\n        },\r\n        {\r\n            title: '开发编程 - Ai开放平台',\r\n            source: ['top.aibase.com/discover/43-74'],\r\n            target: '/discover/43-74',\r\n        },\r\n        {\r\n            title: '开发编程 - Ai算力平台',\r\n            source: ['top.aibase.com/discover/43-75'],\r\n            target: '/discover/43-75',\r\n        },\r\n        {\r\n            title: '聊天机器人 - 智能聊天',\r\n            source: ['top.aibase.com/discover/44-76'],\r\n            target: '/discover/44-76',\r\n        },\r\n        {\r\n            title: '聊天机器人 - 智能客服',\r\n            source: ['top.aibase.com/discover/44-77'],\r\n            target: '/discover/44-77',\r\n        },\r\n        {\r\n            title: '翻译 - 翻译',\r\n            source: ['top.aibase.com/discover/46-79'],\r\n            target: '/discover/46-79',\r\n        },\r\n        {\r\n            title: '教育学习 - 教育学习',\r\n            source: ['top.aibase.com/discover/47-80'],\r\n            target: '/discover/47-80',\r\n        },\r\n        {\r\n            title: '智能营销 - 智能营销',\r\n            source: ['top.aibase.com/discover/48-81'],\r\n            target: '/discover/48-81',\r\n        },\r\n        {\r\n            title: '法律 - 法律',\r\n            source: ['top.aibase.com/discover/138-139'],\r\n            target: '/discover/138-139',\r\n        },\r\n    ],\r\n};\r\n"],"mappings":"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"}