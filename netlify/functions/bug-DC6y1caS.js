import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{parseDate as e}from"./parse-date-Bgabdhlb.js";import{ofetch_default as t}from"./ofetch-Bzt0BXUH.js";import{invalid_parameter_default as n}from"./invalid-parameter-CUJdROXf.js";import{load as r}from"cheerio";const i=new Map([[`apache`,`bz.apache.org/bugzilla`],[`apache.ooo`,`bz.apache.org/ooo`],[`apache.SpamAssassin`,`bz.apache.org/SpamAssassin`],[`kernel`,`bugzilla.kernel.org`],[`mozilla`,`bugzilla.mozilla.org`],[`webkit`,`bugs.webkit.org`]]);async function a(a){let{site:o,bugId:s}=a.req.param();if(!i.has(o))throw new n(`unknown site: ${o}`);let c=`https://${i.get(o)}/show_bug.cgi?id=${s}`,l=r(await t(`${c}&ctype=xml`)),u=l(`long_desc`).map((t,n)=>{let i=r(n,null,!1);return{title:`comment #${i(`commentid`).text()}`,link:`${c}#c${t}`,description:i(`thetext`).text(),pubDate:e(i(`bug_when`).text()),author:i(`who`).attr(`name`)}});return{title:l(`short_desc`).text(),link:c,item:u.toArray()}}function o(e,t=`, `){return[...e.entries()].map(([e,t])=>`[\`${e}\`](https://${t})`).join(t)}const s={path:`/bug/:site/:bugId`,name:`bugs`,maintainers:[`FranklinYu`],handler:a,example:`/bugzilla/bug/webkit/251528`,parameters:{site:`site identifier`,bugId:`numeric identifier of the bug in the site`},description:`Supported site identifiers: ${o(i)}.`,categories:[`programming`],zh:{name:`bugs`,description:`支持的站点标识符：${o(i,`、`)}。`}};export{s as route};
//# sourceMappingURL=bug-DC6y1caS.js.map