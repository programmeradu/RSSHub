import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as e}from"./cache-kimkMTWJ.js";import{parseDate as t}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as n}from"./got-CdvI2yKX.js";import{timezone as r}from"./timezone-BrNu6iXe.js";import{load as i}from"cheerio";const a={path:`/today/:need_content?`,categories:[`new-media`],example:`/163/today`,parameters:{need_content:`需要获取全文，填写 true/yes 表示需要，默认需要`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`wp.m.163.com/163/html/newsapp/todayFocus/index.html`,`wp.m.163.com/`],target:`/today`}],name:`今日关注`,maintainers:[`nczitzk`],handler:o,url:`wp.m.163.com/163/html/newsapp/todayFocus/index.html`,description:"::: tip\n  参数 **需要获取全文** 设置为 `true` `yes` `t` `y` 等值后，RSS 会携带该新闻条目的对应全文。\n:::"};async function o(a){let o=/t|y/i.test(a.req.param(`need_content`)??`true`),s=`https://gw.m.163.com/nc/api/v1/feed/static/normal-list?start=0&tid=T1573700340788&size=${a.req.query(`limit`)??(o?30:200)}`,c=await n({method:`get`,url:s}),l=c.data.data.items.map(e=>({title:e.title,author:e.source,pubDate:r(t(e.ptime),8),description:`<p>${e.digest}</p><img src="${e.imgsrc}">`,link:e.url||`https://c.m.163.com/news/a/${e.docid}.html`}));return o&&(l=await Promise.all(l.map(t=>e.tryGet(t.link,async()=>{let e=await n({method:`get`,url:t.link}),r=i(e.data);return r(`.bot_word`).remove(),r(`img`).each((e,t)=>{t.attribs.src=t.attribs[`data-src`]??t.attribs.src}),t.description=r(`.content, article`).html(),t})))),{title:`今日关注 - 网易新闻`,link:`https://wp.m.163.com/163/html/newsapp/todayFocus/index.html`,item:l}}export{a as route};
//# sourceMappingURL=today-DwKXTGXS.js.map