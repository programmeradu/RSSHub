{"version":3,"file":"tophub-C8O3F4Tv.js","names":["route: Route","got"],"sources":["../../lib/routes/tophub/index.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport got from '@/utils/got';\r\nimport { load } from 'cheerio';\r\nimport { config } from '@/config';\r\n\r\nexport const route: Route = {\r\n    path: '/:id',\r\n    categories: ['new-media'],\r\n    example: '/tophub/Om4ejxvxEN',\r\n    parameters: { id: '榜单id，可在 URL 中找到' },\r\n    features: {\r\n        requireConfig: [\r\n            {\r\n                name: 'TOPHUB_COOKIE',\r\n                optional: true,\r\n                description: '',\r\n            },\r\n        ],\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['tophub.today/n/:id'],\r\n        },\r\n    ],\r\n    name: '榜单',\r\n    maintainers: ['LogicJake'],\r\n    handler,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const id = ctx.req.param('id');\r\n\r\n    const link = `https://tophub.today/n/${id}`;\r\n    const response = await got.get(link, {\r\n        headers: {\r\n            Referer: 'https://tophub.today',\r\n            Cookie: config.tophub.cookie,\r\n        },\r\n    });\r\n    const $ = load(response.data);\r\n\r\n    const title = $('div.Xc-ec-L.b-L').text().trim();\r\n\r\n    const out = $('div.Zd-p-Sc > div:nth-child(1) tr')\r\n        .toArray()\r\n        .map((e) => {\r\n            const info = {\r\n                title: $(e).find('td.al a').text(),\r\n                link: $(e).find('td.al a').attr('href'),\r\n            };\r\n            return info;\r\n        });\r\n\r\n    return {\r\n        title,\r\n        link,\r\n        item: out,\r\n    };\r\n}\r\n"],"mappings":"gRAKA,MAAaA,EAAe,CACxB,KAAM,OACN,WAAY,CAAC,aACb,QAAS,qBACT,WAAY,CAAE,GAAI,mBAClB,SAAU,CACN,cAAe,CACX,CACI,KAAM,gBACN,SAAU,GACV,YAAa,KAGrB,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,wBAGjB,KAAM,KACN,YAAa,CAAC,aACd,WAGJ,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAK,EAAI,IAAI,MAAM,MAEnB,EAAO,0BAA0B,IACjC,EAAW,MAAMC,EAAI,IAAI,EAAM,CACjC,QAAS,CACL,QAAS,uBACT,OAAQ,EAAO,OAAO,UAGxB,EAAI,EAAK,EAAS,MAElB,EAAQ,EAAE,mBAAmB,OAAO,OAEpC,EAAM,EAAE,qCACT,UACA,IAAK,GAAM,CACR,IAAM,EAAO,CACT,MAAO,EAAE,GAAG,KAAK,WAAW,OAC5B,KAAM,EAAE,GAAG,KAAK,WAAW,KAAK,SAEpC,OAAO,IAGf,MAAO,CACH,QACA,OACA,KAAM"}