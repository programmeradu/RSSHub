{"version":3,"file":"recall-CtMFsEGT.js","names":["route: Route","ofetch","items: DataItem[]"],"sources":["../../lib/routes/qiche365/recall.ts"],"sourcesContent":["import { Route, Data, DataItem } from '@/types';\r\nimport ofetch from '@/utils/ofetch';\r\nimport { load } from 'cheerio';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport timezone from '@/utils/timezone';\r\n\r\nconst baseUrl = 'https://www.qiche365.org.cn';\r\n\r\nexport const route: Route = {\r\n    path: '/recall/:channel',\r\n    name: '汽车召回',\r\n    example: '/qiche365/recall/1',\r\n    parameters: { channel: '频道，见下表' },\r\n    description: `| 国内召回新闻 | 国内召回公告 | 国外召回新闻 | 国外召回公告 |\r\n| ------------ | ------------ | ------------ | ------------ |\r\n| 1            | 2            | 3            | 4            |`,\r\n    categories: ['government'],\r\n    maintainers: ['huanfe1'],\r\n    handler,\r\n    url: 'qiche365.org.cn/index/recall/index.html',\r\n};\r\n\r\nasync function handler(ctx): Promise<Data> {\r\n    const { channel } = ctx.req.param();\r\n\r\n    const { html } = await ofetch(`${baseUrl}/index/recall/index/item/${channel}.html?loadmore=1`, {\r\n        method: 'get',\r\n        headers: {\r\n            'Accept-Language': 'zh-CN,zh;q=0.9',\r\n        },\r\n    });\r\n\r\n    const $ = load(<string>html);\r\n    const items: DataItem[] = $('li')\r\n        .toArray()\r\n        .map((item) => {\r\n            const cheerioItem = $(item);\r\n            return {\r\n                title: cheerioItem.find('h1').text(),\r\n                link: `${baseUrl}${cheerioItem.find('a').attr('href')}`,\r\n                pubDate: timezone(parseDate(cheerioItem.find('h2').html()!.match('</i>(.*?)<b>')![1]), +8),\r\n                description: cheerioItem.find('p').text().trim(),\r\n                author: cheerioItem.find('h3 span').text(),\r\n                image: cheerioItem.find('img').attr('src') && `${baseUrl}${cheerioItem.find('img').attr('src')}`,\r\n            };\r\n        });\r\n    return {\r\n        title: ['国内召回公告', '国内召回新闻', '国外召回公告', '国外召回新闻'][channel - 1],\r\n        link: `${baseUrl}/index/recall/index.html`,\r\n        item: items,\r\n        language: 'zh-CN',\r\n    };\r\n}\r\n"],"mappings":"iTAMA,MAAM,EAAU,8BAEHA,EAAe,CACxB,KAAM,mBACN,KAAM,OACN,QAAS,qBACT,WAAY,CAAE,QAAS,UACvB,YAAa;;+DAGb,WAAY,CAAC,cACb,YAAa,CAAC,WACd,UACA,IAAK,2CAGT,eAAe,EAAQ,EAAoB,CACvC,GAAM,CAAE,WAAY,EAAI,IAAI,QAEtB,CAAE,QAAS,MAAMC,EAAO,GAAG,EAAQ,2BAA2B,EAAQ,kBAAmB,CAC3F,OAAQ,MACR,QAAS,CACL,kBAAmB,oBAIrB,EAAI,EAAa,GACjBC,EAAoB,EAAE,MACvB,UACA,IAAK,GAAS,CACX,IAAM,EAAc,EAAE,GACtB,MAAO,CACH,MAAO,EAAY,KAAK,MAAM,OAC9B,KAAM,GAAG,IAAU,EAAY,KAAK,KAAK,KAAK,UAC9C,QAAS,EAAS,EAAU,EAAY,KAAK,MAAM,OAAQ,MAAM,gBAAiB,IAAK,GACvF,YAAa,EAAY,KAAK,KAAK,OAAO,OAC1C,OAAQ,EAAY,KAAK,WAAW,OACpC,MAAO,EAAY,KAAK,OAAO,KAAK,QAAU,GAAG,IAAU,EAAY,KAAK,OAAO,KAAK,YAGpG,MAAO,CACH,MAAO,CAAC,SAAU,SAAU,SAAU,UAAU,EAAU,GAC1D,KAAM,GAAG,EAAQ,0BACjB,KAAM,EACN,SAAU"}