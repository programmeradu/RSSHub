{"version":3,"file":"utils-dNm26242.js","names":[],"sources":["../../lib/routes/t66y/utils.ts"],"sourcesContent":["import * as cheerio from 'cheerio';\r\n\r\nexport const baseUrl = 'https://www.t66y.com';\r\n\r\nconst killRedircdn = (originUrl) => {\r\n    const decodeStr = /.*\\?http/g;\r\n    const decodeSig = /______/g;\r\n    const htmlSuffix = '&z';\r\n    return originUrl.replaceAll(decodeStr, 'http').replaceAll(decodeSig, '.').replace(htmlSuffix, '');\r\n};\r\n\r\nexport const parseContent = (htmlString) => {\r\n    const $ = cheerio.load(htmlString);\r\n\r\n    const content = $('div.tpc_content').eq(0);\r\n    content.find('.t_like').remove();\r\n\r\n    // Handle video\r\n    // const video = $('a:nth-of-type(2)');\r\n    // if (video) {\r\n    //     const videoScript = video.attr('onclick');\r\n    //     const regVideo = /https?:\\/\\/.*'/;\r\n    //     const videoRes = regVideo.exec(videoScript);\r\n    //     if (videoRes && videoRes.length !== 0) {\r\n    //         let link = videoRes[0];\r\n    //         link = link.slice(0, -1);\r\n    //         $('iframe').attr('src', link);\r\n    //     }\r\n    // }\r\n    // Handle img tag\r\n    content.find('img').each((_, ele) => {\r\n        const $ele = $(ele);\r\n        const essData = $ele.attr('ess-data');\r\n        if (essData) {\r\n            $ele.attr('src', essData);\r\n        }\r\n        $ele.removeAttr('ess-data');\r\n        $ele.removeAttr('iyl-data');\r\n    });\r\n\r\n    // Handle input tag\r\n    // images = $('input');\r\n    // for (const image of images) {\r\n    //     $(image).replaceWith(`<img src=\"${$(image).attr('ess-data')}\" />`);\r\n    // }\r\n\r\n    // Handle links\r\n    content.find('a').each((_, ele) => {\r\n        const $ele = $(ele);\r\n        const href = $ele.attr('href');\r\n        if (href?.includes('redircdn')) {\r\n            $ele.attr('href', killRedircdn(href));\r\n        }\r\n    });\r\n\r\n    return content.html();\r\n};\r\n"],"mappings":"0BAEA,MAAa,EAAU,uBAEjB,EAAgB,GAAc,CAChC,IAAM,EAAY,YACZ,EAAY,UAElB,OAAO,EAAU,WAAW,EAAW,QAAQ,WAAW,EAAW,KAAK,QAAQ,KAAY,KAGrF,EAAgB,GAAe,CACxC,IAAM,EAAI,EAAQ,KAAK,GAEjB,EAAU,EAAE,mBAAmB,GAAG,GAyCxC,OAxCA,EAAQ,KAAK,WAAW,SAexB,EAAQ,KAAK,OAAO,MAAM,EAAG,IAAQ,CACjC,IAAM,EAAO,EAAE,GACT,EAAU,EAAK,KAAK,YACtB,GACA,EAAK,KAAK,MAAO,GAErB,EAAK,WAAW,YAChB,EAAK,WAAW,cAUpB,EAAQ,KAAK,KAAK,MAAM,EAAG,IAAQ,CAC/B,IAAM,EAAO,EAAE,GACT,EAAO,EAAK,KAAK,QACnB,GAAM,SAAS,aACf,EAAK,KAAK,OAAQ,EAAa,MAIhC,EAAQ"}