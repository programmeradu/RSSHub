import"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import"./helpers-DzX-lcQO.js";import{cache_default as e}from"./cache-kimkMTWJ.js";import{parseDate as t}from"./parse-date-Bgabdhlb.js";import"./ofetch-Bzt0BXUH.js";import{got_default as n}from"./got-CdvI2yKX.js";import{invalid_parameter_default as r}from"./invalid-parameter-CUJdROXf.js";import{load as i}from"cheerio";const a={path:`/paper/:id?`,categories:[`traditional-media`],example:`/zjol/paper/zjrb`,parameters:{id:"报纸 id，见下表，默认为 `zjrb`，即浙江日报"},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`浙报集团系列报刊`,maintainers:[`nczitzk`],handler:o,description:`| 浙江日报 | 钱江晚报 | 美术报 | 浙江老年报 | 浙江法制报 | 江南游报 |
| -------- | -------- | ------ | ---------- | ---------- | -------- |
| zjrb     | qjwb     | msb    | zjlnb      | zjfzb      | jnyb     |`};async function o(a){let o=a.req.param(`id`)??`zjrb`,s=a.req.query(`limit`)?Number.parseInt(a.req.query(`limit`)):100,c=[`zjrb`,`qjwb`,`msb`,`zjlnb`,`zjfzb`,`jnyb`];if(!c.includes(o))throw new r(`id not allowed`);let l=o===`jnyb`?`map[name="PagePicMap"] area`:`ul.main-ed-articlenav-list li a`,u=o===`qjwb`?`http://qjwb.thehour.cn`:`https://${o}.zjol.com.cn`,d=`${u}/paperindex.htm`,f=await n({method:`get`,url:d}),p=f.data.match(/URL=(.*)"/)[1],m=t(p.match(/(\d{4}-\d{2}\/\d{2})/)[1],`YYYY-MM/DD`);d=`${u}/${p.replace(`/${p.split(`/`).pop()}`,``)}`,f=await n({method:`get`,url:`${u}/${p}`});let h=i(f.data),g=h(l).toArray().map(e=>`${d}/${h(e).attr(`href`)}`);return await Promise.all(h(`#pageLink`).slice(1).toArray().map(e=>`${d}/${h(e).attr(`href`)}`).map(async e=>{let t=await n({method:`get`,url:e}),r=i(t.data);g.push(...r(l).toArray().map(e=>`${d}/${r(e).attr(`href`)}`))})),g=await Promise.all(g.filter(e=>o===`jnyb`?/\?div=1$/.test(e):!0).slice(0,s).map(t=>e.tryGet(t,async()=>{let e=await n({method:`get`,url:t}),r=i(e.data),a=r(`.main-article-title`).text();return r(`.main-article-alltitle`).remove(),{title:a,pubDate:m,link:t.split(`?`)[0],description:r(`.main-article-content`).html()}}))),{title:h(`title`).text(),link:u,item:g}}export{a as route};
//# sourceMappingURL=paper-CWzU1goX.js.map