{"version":3,"file":"docs-zZ5hvxqy.js","names":["route: Route","ofetch","cache","response","$"],"sources":["../../lib/routes/informedainews/docs.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport ofetch from '@/utils/ofetch'; // 统一使用的请求库\r\nimport { load } from 'cheerio'; // 类似 jQuery 的 API HTML 解析器\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport cache from '@/utils/cache';\r\n\r\nexport const route: Route = {\r\n    path: '/zh-Hans/docs/:type',\r\n    categories: ['new-media'],\r\n    example: '/informedainews/zh-Hans/docs/world-news-daily',\r\n    parameters: { type: 'world-news-daily|tech-enthusiast-weekly|ai-enthusiast-daily' },\r\n    features: {\r\n        requireConfig: false,\r\n        requirePuppeteer: false,\r\n        antiCrawler: false,\r\n        supportBT: false,\r\n        supportPodcast: false,\r\n        supportScihub: false,\r\n    },\r\n    radar: [\r\n        {\r\n            source: ['informedainews.com', 'informedainews.com/zh-Hans/docs/:type', 'informedainews.com/docs/:type'],\r\n            target: '/zh-Hans/docs/:type',\r\n        },\r\n    ],\r\n    name: '知闻AI',\r\n    maintainers: ['guicaiyue'],\r\n    handler,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const { type } = ctx.req.param();\r\n    const response = await ofetch(`https://informedainews.com/zh-Hans/docs/${type}`);\r\n    const $ = load(response);\r\n    const list = $('li.theme-doc-sidebar-item-category ul li')\r\n        .toArray()\r\n        .map((item) => {\r\n            item = $(item);\r\n            const a = item.find('a').first();\r\n            const text = a.text();\r\n            // 找到第一个'('字符的位置\r\n            const start = text.indexOf('(');\r\n            // 找到第一个')'字符的位置\r\n            const end = text.indexOf(')');\r\n            // 从第一个'('到第一个')'之间的子字符串就是日期\r\n            const date = text.substring(start + 1, end);\r\n            return {\r\n                title: text,\r\n                link: `https://informedainews.com${a.attr('href')}`,\r\n                pubDate: parseDate(date),\r\n                author: 'AI',\r\n            };\r\n        });\r\n\r\n    const items = await Promise.all(\r\n        list.map((item) =>\r\n            cache.tryGet(item.link, async () => {\r\n                const response = await ofetch(item.link);\r\n                const $ = load(response);\r\n\r\n                // 选择类名为“comment-body”的第一个元素\r\n                item.description = $('.theme-doc-markdown.markdown').first().html();\r\n\r\n                // 上面每个列表项的每个属性都在此重用，\r\n                // 并增加了一个新属性“description”\r\n                return item;\r\n            })\r\n        )\r\n    );\r\n    return {\r\n        // 源标题\r\n        title: `${type} docs`,\r\n        // 源链接\r\n        link: `https://informedainews.com/zh-Hans/docs/${type}`,\r\n        // 源文章\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"mTAMA,MAAaA,EAAe,CACxB,KAAM,sBACN,WAAY,CAAC,aACb,QAAS,gDACT,WAAY,CAAE,KAAM,+DACpB,SAAU,CACN,cAAe,GACf,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,eAAgB,GAChB,cAAe,IAEnB,MAAO,CACH,CACI,OAAQ,CAAC,qBAAsB,wCAAyC,iCACxE,OAAQ,wBAGhB,KAAM,OACN,YAAa,CAAC,aACd,WAGJ,eAAe,EAAQ,EAAK,CACxB,GAAM,CAAE,QAAS,EAAI,IAAI,QACnB,EAAW,MAAMC,EAAO,2CAA2C,KACnE,EAAI,EAAK,GACT,EAAO,EAAE,4CACV,UACA,IAAK,GAAS,CACX,EAAO,EAAE,GACT,IAAM,EAAI,EAAK,KAAK,KAAK,QACnB,EAAO,EAAE,OAET,EAAQ,EAAK,QAAQ,KAErB,EAAM,EAAK,QAAQ,KAEnB,EAAO,EAAK,UAAU,EAAQ,EAAG,GACvC,MAAO,CACH,MAAO,EACP,KAAM,6BAA6B,EAAE,KAAK,UAC1C,QAAS,EAAU,GACnB,OAAQ,QAId,EAAQ,MAAM,QAAQ,IACxB,EAAK,IAAK,GACNC,EAAM,OAAO,EAAK,KAAM,SAAY,CAChC,IAAMC,EAAW,MAAMF,EAAO,EAAK,MAC7BG,EAAI,EAAKD,GAOf,MAJA,GAAK,YAAcC,EAAE,gCAAgC,QAAQ,OAItD,MAInB,MAAO,CAEH,MAAO,GAAG,EAAK,OAEf,KAAM,2CAA2C,IAEjD,KAAM"}