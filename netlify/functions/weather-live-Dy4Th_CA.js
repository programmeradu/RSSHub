import{__dirname as e,init_esm_shims as t}from"./esm-shims-Dqvxr0BZ.js";import"./config-Dl8a1sIg.js";import"./logger-CWOoofbD.js";import"./dist-IvUHtNe1.js";import{art as n}from"./render-CxhTJIsl.js";import{parseDate as r}from"./parse-date-Bgabdhlb.js";import{ofetch_default as i}from"./ofetch-Bzt0BXUH.js";import{ViewType as a}from"./types-A5bA50Mg.js";import o from"node:path";import{load as s}from"cheerio";t();const c=async t=>{let a=Number.parseInt(t.req.query(`limit`)??`100`,10),c=`https://tf.121.com.cn`,l=`https://wx.121.com.cn`,u=new URL(`web/weatherLive/`,c).href,d=new URL(`weather/weibo/message.js`,c).href,f=await i(u),p=s(f),m=p(`html`).attr(`lang`)??`zh`,h=await i(d),g=await h.text(),_=JSON.parse(g.split(/var\smessage=/).pop()).slice(0,a).map(t=>{let i=t.Title,a=n(o.join(e,`templates/description-40035e44.art`),{description:t.Content,images:t.Img?.map(e=>({src:new URL(`WeChat/data/weiweb/images/lwspic/${e}`,l).href,alt:i}))}),s=t.DDatetime,d=u,f=`121-${i}-${s}`,p=t.Img?.length>0?new URL(`WeChat/data/weiweb/images/lwspic/${t.Img[0]}`,l).href:void 0,h=s,g={title:i,description:a,pubDate:s?r(s):void 0,link:d??new URL(t.id,c).href,guid:f,id:f,content:{html:a,text:a},image:p,banner:p,updated:h?r(h):void 0,language:m};return g}),v=p(`title`).text();return{title:v,description:v,link:u,item:_,allowEmpty:!0,image:p(`img`).first().attr(`src`)?new URL(p(`img`).first().attr(`src`),c).href:void 0,author:p(`div#webnameDiv`).text(),language:m,id:u}},l={path:`/weatherLive`,name:`深圳天气直播`,url:`tf.121.com.cn`,maintainers:[`nczitzk`],handler:c,example:`/121/weatherLive`,parameters:void 0,description:void 0,categories:[`forecast`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`tf.121.com.cn`,`tf.121.com.cn/web/weatherLive`],target:`/weatherLive`}],view:a.Notifications};export{c as handler,l as route};
//# sourceMappingURL=weather-live-Dy4Th_CA.js.map