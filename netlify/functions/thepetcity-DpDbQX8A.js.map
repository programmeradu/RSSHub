{"version":3,"file":"thepetcity-DpDbQX8A.js","names":["route: Route","ofetch","cache","data"],"sources":["../../lib/routes/thepetcity/terms-map.ts","../../lib/routes/thepetcity/index.ts"],"sourcesContent":["const termsMap = {\r\n    '': {\r\n        title: 'PetCity 毛孩日常 | 飼養竉物、竉物用品、萌寵趣聞',\r\n        slug: '/',\r\n    },\r\n    1: {\r\n        title: 'Pet Staff 毛孩好物',\r\n        slug: '/category/cute-item',\r\n    },\r\n    2: {\r\n        title: 'Funny News毛孩趣聞',\r\n        slug: '/category/funny-news',\r\n    },\r\n    3: {\r\n        title: 'Knowledge飼養大全',\r\n        slug: '/category/knowledge',\r\n    },\r\n    4: {\r\n        title: 'Hot Spot 毛孩打卡點',\r\n        slug: '/category/hot-spot',\r\n    },\r\n    5: {\r\n        title: 'Raise Pets 養寵物新手',\r\n        slug: '/category/raise-cats',\r\n    },\r\n};\r\n\r\nexport { termsMap };\r\n","import { Route } from '@/types';\r\nimport cache from '@/utils/cache';\r\nimport ofetch from '@/utils/ofetch';\r\nimport { parseDate } from '@/utils/parse-date';\r\nimport { termsMap } from './terms-map';\r\n\r\nconst baseUrl = 'https://thepetcity.co';\r\n\r\nexport const route: Route = {\r\n    path: '/:term?',\r\n    categories: ['new-media'],\r\n    example: '/thepetcity',\r\n    parameters: { term: '見下表，留空為全部文章' },\r\n    radar: Object.entries(termsMap).map(([key, value]) => ({\r\n        title: value.title,\r\n        source: [...new Set([`thepetcity.co${value.slug}`, 'thepetcity.co/'])],\r\n        target: key ? `/${key}` : '',\r\n    })),\r\n    name: '分類',\r\n    maintainers: ['TonyRL', 'bigfei'],\r\n    handler,\r\n    url: 'thepetcity.co/',\r\n    description: `| Column Name       | TermID |\r\n| -------------------- | ------ |\r\n| Knowledge飼養大全     | 3      |\r\n| Funny News毛孩趣聞    | 2      |\r\n| Raise Pets 養寵物新手  | 5      |\r\n| Hot Spot 毛孩打卡點    | 4      |\r\n| Pet Staff 毛孩好物    | 1      |`,\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const term = ctx.req.param('term');\r\n    const searchParams = term ? { pageId: 977_080_509_047_743, term } : { pageId: 977_080_509_047_743 };\r\n    const data = await ofetch(`${baseUrl}/node_api/v1/articles/posts`, { query: { ...searchParams } });\r\n\r\n    const list = data.data.posts.map((post) => ({\r\n        title: post.title,\r\n        description: post.description,\r\n        link: `${baseUrl}${post.url}`,\r\n        pubDate: parseDate(post.post_date),\r\n        guid: post.guid,\r\n        api: `${baseUrl}/node_api/v1/articles/${post.id}`,\r\n    }));\r\n\r\n    const items = await Promise.all(\r\n        list.map((item) =>\r\n            cache.tryGet(item.guid, async () => {\r\n                const data = await ofetch(item.api, {\r\n                    query: {\r\n                        pageId: 977_080_509_047_743,\r\n                    },\r\n                });\r\n                item.description = data.data.post_content;\r\n                item.category = [...new Set([...data.data.tags.map((t) => t.name), ...data.data.categories.map((c) => c.name)])];\r\n                item.author = data.data.author.display_name;\r\n                return item;\r\n            })\r\n        )\r\n    );\r\n\r\n    return {\r\n        title: termsMap[term] ? termsMap[term].title : termsMap[''].title,\r\n        description: '專屬毛孩愛好者的資訊平台，不論你是貓奴、狗奴，還是其他動物控，一起發掘最新的萌寵趣聞、有趣的寵物飼養知識、訓練動物、竉物用品推介、豐富多樣的寵物可愛影片。',\r\n        link: baseUrl,\r\n        image: 'https://assets.presslogic.com/presslogic-hk-pc/static/favicon.ico',\r\n        item: items,\r\n    };\r\n}\r\n"],"mappings":"oRAAA,MAAM,EAAW,CACb,GAAI,CACA,MAAO,gCACP,KAAM,KAEV,EAAG,CACC,MAAO,iBACP,KAAM,uBAEV,EAAG,CACC,MAAO,iBACP,KAAM,wBAEV,EAAG,CACC,MAAO,gBACP,KAAM,uBAEV,EAAG,CACC,MAAO,iBACP,KAAM,sBAEV,EAAG,CACC,MAAO,mBACP,KAAM,yBCjBR,EAAU,wBAEHA,EAAe,CACxB,KAAM,UACN,WAAY,CAAC,aACb,QAAS,cACT,WAAY,CAAE,KAAM,eACpB,MAAO,OAAO,QAAQ,GAAU,KAAK,CAAC,EAAK,MAAY,CACnD,MAAO,EAAM,MACb,OAAQ,CAAC,GAAG,IAAI,IAAI,CAAC,gBAAgB,EAAM,OAAQ,oBACnD,OAAQ,EAAM,IAAI,IAAQ,MAE9B,KAAM,KACN,YAAa,CAAC,SAAU,UACxB,UACA,IAAK,iBACL,YAAa;;;;;;iCASjB,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAO,EAAI,IAAI,MAAM,QACrB,EAAe,EAAO,CAAE,OAAQ,gBAAqB,QAAS,CAAE,OAAQ,iBACxE,EAAO,MAAMC,EAAO,GAAG,EAAQ,6BAA8B,CAAE,MAAO,CAAE,GAAG,KAE3E,EAAO,EAAK,KAAK,MAAM,IAAK,IAAU,CACxC,MAAO,EAAK,MACZ,YAAa,EAAK,YAClB,KAAM,GAAG,IAAU,EAAK,MACxB,QAAS,EAAU,EAAK,WACxB,KAAM,EAAK,KACX,IAAK,GAAG,EAAQ,wBAAwB,EAAK,QAG3C,EAAQ,MAAM,QAAQ,IACxB,EAAK,IAAK,GACNC,EAAM,OAAO,EAAK,KAAM,SAAY,CAChC,IAAMC,EAAO,MAAMF,EAAO,EAAK,IAAK,CAChC,MAAO,CACH,OAAQ,mBAMhB,MAHA,GAAK,YAAcE,EAAK,KAAK,aAC7B,EAAK,SAAW,CAAC,GAAG,IAAI,IAAI,CAAC,GAAGA,EAAK,KAAK,KAAK,IAAK,GAAM,EAAE,MAAO,GAAGA,EAAK,KAAK,WAAW,IAAK,GAAM,EAAE,SACxG,EAAK,OAASA,EAAK,KAAK,OAAO,aACxB,MAKnB,MAAO,CACH,MAAO,EAAS,GAAQ,EAAS,GAAM,MAAQ,EAAS,IAAI,MAC5D,YAAa,gFACb,KAAM,EACN,MAAO,oEACP,KAAM"}