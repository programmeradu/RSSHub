{"version":3,"file":"cat-BBEOikB1.js","names":["route: Route","ofetch"],"sources":["../../lib/routes/bjnews/cat.ts"],"sourcesContent":["import { Route } from '@/types';\r\nimport { load } from 'cheerio';\r\nimport ofetch from '@/utils/ofetch';\r\n\r\nimport { fetchArticle } from './utils';\r\nimport pMap from 'p-map';\r\n\r\nexport const route: Route = {\r\n    path: '/cat/:cat',\r\n    categories: ['traditional-media'],\r\n    example: '/bjnews/cat/depth',\r\n    parameters: { cat: '分类, 可从URL中找到' },\r\n    features: {},\r\n    radar: [\r\n        {\r\n            source: ['www.bjnews.com.cn/:cat'],\r\n        },\r\n    ],\r\n    name: '分类',\r\n    maintainers: ['dzx-dzx'],\r\n    handler,\r\n    url: 'www.bjnews.com.cn',\r\n};\r\n\r\nasync function handler(ctx) {\r\n    const url = `https://www.bjnews.com.cn/${ctx.req.param('cat')}`;\r\n    const res = await ofetch(url);\r\n    const $ = load(res);\r\n    const list = $('#waterfall-container .pin_demo > a')\r\n        .toArray()\r\n        .slice(0, ctx.req.query('limit') ? Number.parseInt(ctx.req.query('limit')) : 15)\r\n        .map((a) => ({\r\n            title: $(a).text(),\r\n            link: $(a).attr('href'),\r\n            category: $(a).parent().find('.source').text().trim(),\r\n        }));\r\n\r\n    const out = await pMap(list, (item) => fetchArticle(item), { concurrency: 2 });\r\n    return {\r\n        title: `新京报 - 分类 - ${$('.cur').text().trim()}`,\r\n        link: url,\r\n        item: out,\r\n    };\r\n}\r\n"],"mappings":"8WAOA,MAAaA,EAAe,CACxB,KAAM,YACN,WAAY,CAAC,qBACb,QAAS,oBACT,WAAY,CAAE,IAAK,gBACnB,SAAU,GACV,MAAO,CACH,CACI,OAAQ,CAAC,4BAGjB,KAAM,KACN,YAAa,CAAC,WACd,UACA,IAAK,qBAGT,eAAe,EAAQ,EAAK,CACxB,IAAM,EAAM,6BAA6B,EAAI,IAAI,MAAM,SACjD,EAAM,MAAMC,EAAO,GACnB,EAAI,EAAK,GACT,EAAO,EAAE,sCACV,UACA,MAAM,EAAG,EAAI,IAAI,MAAM,SAAW,OAAO,SAAS,EAAI,IAAI,MAAM,UAAY,IAC5E,IAAK,IAAO,CACT,MAAO,EAAE,GAAG,OACZ,KAAM,EAAE,GAAG,KAAK,QAChB,SAAU,EAAE,GAAG,SAAS,KAAK,WAAW,OAAO,UAGjD,EAAM,MAAM,EAAK,EAAO,GAAS,EAAa,GAAO,CAAE,YAAa,IAC1E,MAAO,CACH,MAAO,cAAc,EAAE,QAAQ,OAAO,SACtC,KAAM,EACN,KAAM"}